!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).G2={})}(this,function(R){"use strict";var j=function(t,e){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}j(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var E=function(){return(E=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function _(t,e){var n={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function e(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;0<=s;s--)(r=t[s])&&(a=(o<3?r(a):3<o?r(e,n,a):r(e,n))||a);return 3<o&&a&&Object.defineProperty(e,n,a),a}function B(n,i){return function(t,e){i(t,e,n)}}function n(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function F(t,a,s,u){return new(s=s||Promise)(function(n,e){function i(t){try{o(u.next(t))}catch(t){e(t)}}function r(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(i,r)}o((u=u.apply(t,a||[])).next())})}function P(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function z(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||((i=i||Array.prototype.slice.call(e,0,r))[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}function V(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)}function H(t){var e=typeof t;return null!==t&&"object"==e||"function"==e}var G={}.toString,W=function(t,e){return G.call(t)==="[object "+e+"]"},U=function(t){return W(t,"Function")},Y=function(t){return null==t},q=function(t){return Array.isArray?Array.isArray(t):W(t,"Array")};function X(t,e){if(t)if(q(t))for(var n=0,i=t.length;n<i&&!1!==e(t[n],n);n++);else if(H(t))for(var r in t)if(t.hasOwnProperty(r)&&!1===e(t[r],r))break}function K(t){if(q(t))return t.reduce(function(t,e){return Math.max(t,e)},t[0])}function Z(t){if(q(t))return t.reduce(function(t,e){return Math.min(t,e)},t[0])}var $=function(t){return"object"==typeof t&&null!==t},J=function(t){if(!$(t)||!W(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},Q=function(t){return W(t,"String")};function tt(t,e,n){return t<e?e:n<t?n:t}function et(t){return W(t,"Number")}var nt=1e-5;function it(t,e,n){return void 0===n&&(n=nt),Math.abs(t-e)<n}var rt=function(t,e){if(q(t)){for(var n,i=-1/0,r=0;r<t.length;r++){var o=t[r],a=U(e)?e(o):o[e];i<a&&(n=o,i=a)}return n}},ot=function(t,e){if(q(t)){for(var n,i=1/0,r=0;r<t.length;r++){var o=t[r],a=U(e)?e(o):o[e];a<i&&(n=o,i=a)}return n}},at=Object.values?function(t){return Object.values(t)}:function(n){var i=[];return X(n,function(t,e){U(n)&&"prototype"===e||i.push(t)}),i};function st(t){return null===t}function ut(t){return void 0===t}function lt(t){return t instanceof Element||t instanceof HTMLDocument}function ct(t,e){for(var n in e)e.hasOwnProperty(n)&&"constructor"!==n&&void 0!==e[n]&&(t[n]=e[n])}function ht(t,e,n,i){return e&&ct(t,e),n&&ct(t,n),i&&ct(t,i),t}function dt(o,a){if(U(o))return s.cache=new Map,s;function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=a?a.apply(this,t):t[0],i=s.cache;if(i.has(n))return i.get(n);var r=o.apply(this,t);return i.set(n,r),r}throw new TypeError("Expected a function")}var pt=function(t){if("object"!=typeof t||null===t)return t;if(q(t))for(var e=[],n=0,i=t.length;n<i;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=pt(t[n]):e[n]=t[n];else for(var r in e={},t)"object"==typeof t[r]&&null!=t[r]?e[r]=pt(t[r]):e[r]=t[r];return e},ft=5;function yt(t,e,n){for(var i=0,r=Q(e)?e.split("."):e;t&&i<r.length;)t=t[r[i++]];return void 0===t||i<r.length?n:t}function vt(e,t){if(null===e||!J(e))return{};var n={};return X(t,function(t){Et.call(e,t)&&(n[t]=e[t])}),n}function gt(t,i){var n=function(t,e,n){return i.includes(n)||(t[n]=e),t},e={};if(!q(t)&&!J(t))return t;var r=e;return X(t,function(t,e){r=n(r,t,e)}),r}function mt(n,i,r){function o(){c=!1===r.leading?0:Date.now(),a=null,l=n.apply(s,u),a||(s=u=null)}function t(){var t=Date.now(),e=(c||!1!==r.leading||(c=t),i-(t-c));return s=this,u=arguments,e<=0||i<e?(a&&(clearTimeout(a),a=null),c=t,l=n.apply(s,u),a||(s=u=null)):a||!1===r.trailing||(a=setTimeout(o,e)),l}var a,s,u,l,c=0;return r=r||{},t.cancel=function(){clearTimeout(a),c=0,a=s=u=null},t}function bt(){}function kt(t){return t}var xt,O=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0;i<e.length;i+=1)!function t(e,n,i,r){for(var o in i=i||0,r=r||ft,n){var a;n.hasOwnProperty(o)&&(null!==(a=n[o])&&J(a)?(J(e[o])||(e[o]={}),i<r?t(e[o],a,i+1,r):e[o]=n[o]):q(a)?(e[o]=[],e[o]=e[o].concat(a)):void 0!==a&&(e[o]=a))}}(t,e[i]);return t},wt=function(t,e){if(!V(t))return-1;var n=Array.prototype.indexOf;if(n)return n.call(t,e);for(var i=-1,r=0;r<t.length;r++)if(t[r]===e){i=r;break}return i},St=function(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Q(t)||Q(e))return!1;if(V(t)||V(e)){if(t.length!==e.length)return!1;for(var n=!0,i=0;i<t.length&&(n=St(t[i],e[i]));i++);return n}if($(t)||$(e)){var r=Object.keys(t),o=Object.keys(e);if(r.length!==o.length)return!1;for(n=!0,i=0;i<r.length&&(n=St(t[r[i]],e[r[i]]));i++);return n}return!1},Et=Object.prototype.hasOwnProperty;function Tt(t){return Y(t)?0:(V(t)?t:Object.keys(t)).length}var _t=dt(function(t,e){var n=(e=void 0===e?{}:e).fontSize,i=e.fontFamily,r=e.fontWeight,o=e.fontStyle,e=e.fontVariant;return(xt=xt||document.createElement("canvas").getContext("2d")).font=[o,e,r,n+"px",i].join(" "),xt.measureText(Q(t)?t:"").width},function(t,e){return function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i}([t],at(e=void 0===e?{}:e)).join("")}),Mt="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function Pt(){throw new Error("setTimeout has not been defined")}function Ot(){throw new Error("clearTimeout has not been defined")}var Ct=Pt,At=Ot;function Nt(e){if(Ct===setTimeout)return setTimeout(e,0);if((Ct===Pt||!Ct)&&setTimeout)return(Ct=setTimeout)(e,0);try{return Ct(e,0)}catch(t){try{return Ct.call(null,e,0)}catch(t){return Ct.call(this,e,0)}}}"function"==typeof Mt.setTimeout&&(Ct=setTimeout),"function"==typeof Mt.clearTimeout&&(At=clearTimeout);var Lt,It=[],Dt=!1,Rt=-1;function jt(){Dt&&Lt&&(Dt=!1,Lt.length?It=Lt.concat(It):Rt=-1,It.length&&Bt())}function Bt(){if(!Dt){for(var t=Nt(jt),e=(Dt=!0,It.length);e;){for(Lt=It,It=[];++Rt<e;)Lt&&Lt[Rt].run();Rt=-1,e=It.length}Lt=null,Dt=!1,!function(e){if(At===clearTimeout)return clearTimeout(e);if((At===Ot||!At)&&clearTimeout)return(At=clearTimeout)(e);try{At(e)}catch(t){try{return At.call(null,e)}catch(t){return At.call(this,e)}}}(t)}}function Ft(t,e){this.fun=t,this.array=e}Ft.prototype.run=function(){this.fun.apply(null,this.array)};function zt(){}var i=zt,r=zt,o=zt,Vt=zt,Ht=zt,Gt=zt,a=zt;var Wt=Mt.performance||{},Ut=Wt.now||Wt.mozNow||Wt.msNow||Wt.oNow||Wt.webkitNow||function(){return(new Date).getTime()};var Yt=new Date;var qt,Xt={nextTick:function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];It.push(new Ft(t,e)),1!==It.length||Dt||Nt(Bt)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:i,addListener:r,once:o,off:Vt,removeListener:Ht,removeAllListeners:Gt,emit:a,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*Ut.call(Wt),n=Math.floor(e),e=Math.floor(e%1*1e9);return t&&(n-=t[0],(e-=t[1])<0&&(n--,e+=1e9)),[n,e]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Yt)/1e3}},i=(qt={},function(){var s,u,l,c,i,t,r,h,o,e="object"==typeof Mt?Mt:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=P(qt);function d(t,e,n){var i=o.get(t);if(g(i)){if(!n)return;i=new r,o.set(t,i)}t=i.get(e);if(g(t)){if(!n)return;t=new r,i.set(e,t)}return t}function a(t,e,n){e=d(e,n,!1);return!g(e)&&!!e.has(t)}function p(t,e,n){e=d(e,n,!1);if(!g(e))return e.get(t)}function f(t,e,n,i){d(n,i,!0).set(t,e)}function y(t,e){var n=[],t=d(t,e,!1);if(g(t))return n;for(var i,r,o=function(t){var e=T(t,l);if(!S(e))throw new TypeError;e=e.call(t);if(b(e))return e;throw new TypeError}(t.keys()),a=0;;){var s=function(t){t=t.next();return!t.done&&t}(o);if(!s)return n.length=a,n;s=s.value;try{n[a]=s}catch(t){try{r=void 0,(r=(i=o).return)&&r.call(i)}finally{throw t}}a++}}function v(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function g(t){return void 0===t}function m(t){return null===t}function b(t){return"object"==typeof t?null!==t:"function"==typeof t}function k(t,e){switch(v(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var e=3===e?"string":5===e?"number":"default",n=T(t,u);if(void 0===n){var i=t;if("string"===(a="default"==e?"number":e)){a=i.toString;if(S(a))if(!b(o=a.call(i)))return o;var r=i.valueOf;if(S(r))if(!b(o=r.call(i)))return o}else{r=i.valueOf;if(S(r))if(!b(o=r.call(i)))return o;var o,a=i.toString;if(S(a))if(!b(o=a.call(i)))return o}throw new TypeError}r=n.call(t,e);if(b(r))throw new TypeError;return r}function x(t){t=k(t,3);return"symbol"==typeof t?t:""+t}function w(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function S(t){return"function"==typeof t}function E(t){return"function"==typeof t}function T(t,e){t=t[e];if(null!=t){if(S(t))return t;throw new TypeError}}function _(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===i)return e;if(e!==i)return e;var n=t.prototype,n=n&&Object.getPrototypeOf(n);if(null==n||n===Object.prototype)return e;n=n.constructor;return"function"!=typeof n||n===t?e:n}function M(t){return t.__=void 0,delete t.__,t}function P(n,i){return function(t,e){"function"!=typeof n[t]&&Object.defineProperty(n,t,{configurable:!0,writable:!0,value:e}),i&&i(t,e)}}void 0===e.Reflect?e.Reflect=qt:n=P(e.Reflect,n),e=n,s=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,u=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",l=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",n="function"==typeof Object.create,t={__proto__:[]}instanceof Array,c={create:n?function(){return M(Object.create(null))}:t?function(){return M({__proto__:null})}:function(){return M({})},has:(n=!n&&!t)?function(t,e){return s.call(t,e)}:function(t,e){return e in t},get:n?function(t,e){return s.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},i=Object.getPrototypeOf(Function),t="object"==typeof Xt&&Xt.env&&"true"===Xt.env.REFLECT_METADATA_USE_MAP_POLYFILL,r=t||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var r={},n=[],t=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[l]=function(){return this},t.prototype.next=function(){var t,e=this._index;return 0<=e&&e<this._keys.length?(t=this._selector(this._keys[e],this._values[e]),e+1>=this._keys.length?(this._index=-1,this._keys=n,this._values=n):this._index++,{value:t,done:!1}):{value:void 0,done:!0}},t.prototype.throw=function(t){throw 0<=this._index&&(this._index=-1,this._keys=n,this._values=n),t},t.prototype.return=function(t){return 0<=this._index&&(this._index=-1,this._keys=n,this._values=n),{value:t,done:!0}},t}();function e(){this._keys=[],this._values=[],this._cacheKey=r,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return 0<=this._find(t,!1)},e.prototype.get=function(t){t=this._find(t,!1);return 0<=t?this._values[t]:void 0},e.prototype.set=function(t,e){t=this._find(t,!0);return this._values[t]=e,this},e.prototype.delete=function(t){var e=this._find(t,!1);if(0<=e){for(var n=this._keys.length,i=e+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=r,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=r,this._cacheIndex=-2},e.prototype.keys=function(){return new t(this._keys,this._values,i)},e.prototype.values=function(){return new t(this._keys,this._values,o)},e.prototype.entries=function(){return new t(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[l]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e;function i(t,e){return t}function o(t,e){return e}function a(t,e){return[t,e]}}():Map,h=t||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new r}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[l]=function(){return this.keys()},t}():Set,o=new(t||"function"!=typeof WeakMap?function(){var r=16,e=c.create(),n=i();function t(){this._key=i()}return t.prototype.has=function(t){t=o(t,!1);return void 0!==t&&c.has(t,this._key)},t.prototype.get=function(t){t=o(t,!1);return void 0!==t?c.get(t,this._key):void 0},t.prototype.set=function(t,e){return o(t,!0)[this._key]=e,this},t.prototype.delete=function(t){t=o(t,!1);return void 0!==t&&delete t[this._key]},t.prototype.clear=function(){this._key=i()},t;function i(){for(var t;t="@@WeakMap@@"+function(){for(var t=function(t){return"function"!=typeof Uint8Array?a(new Array(t),t):"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t)}(r),e=(t[6]=79&t[6]|64,t[8]=191&t[8]|128,""),n=0;n<r;++n){var i=t[n];4!==n&&6!==n&&8!==n||(e+="-"),i<16&&(e+="0"),e+=i.toString(16).toLowerCase()}return e}(),c.has(e,t););return e[t]=!0,t}function o(t,e){if(!s.call(t,n)){if(!e)return;Object.defineProperty(t,n,{value:c.create()})}return t[n]}function a(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}}():WeakMap),e("decorate",function(t,e,n,i){{if(g(n)){if(!w(t))throw new TypeError;if(E(e))return function(t,e){for(var n=t.length-1;0<=n;--n){var i=(0,t[n])(e);if(!g(i)&&!m(i)){if(!E(i))throw new TypeError;e=i}}return e}(t,e);throw new TypeError}if(!w(t))throw new TypeError;if(!b(e))throw new TypeError;if(b(i)||g(i)||m(i))return m(i)&&(i=void 0),n=x(n),function(t,e,n,i){for(var r=t.length-1;0<=r;--r){var o=(0,t[r])(e,n,i);if(!g(o)&&!m(o)){if(!b(o))throw new TypeError;i=o}}return i}(t,e,n,i);throw new TypeError}}),e("metadata",function(n,i){return function(t,e){if(!b(t))throw new TypeError;if(!g(e)&&!function(t){switch(v(t)){case 3:case 4:return 1;default:return}}(e))throw new TypeError;f(n,i,t,e)}}),e("defineMetadata",function(t,e,n,i){if(!b(n))throw new TypeError;g(i)||(i=x(i));return f(t,e,n,i)}),e("hasMetadata",function(t,e,n){if(!b(e))throw new TypeError;g(n)||(n=x(n));return function t(e,n,i){var r=a(e,n,i);if(r)return!0;r=_(n);if(!m(r))return t(e,r,i);return!1}(t,e,n)}),e("hasOwnMetadata",function(t,e,n){if(!b(e))throw new TypeError;g(n)||(n=x(n));return a(t,e,n)}),e("getMetadata",function(t,e,n){if(!b(e))throw new TypeError;g(n)||(n=x(n));return function t(e,n,i){var r=a(e,n,i);if(r)return p(e,n,i);r=_(n);if(!m(r))return t(e,r,i);return}(t,e,n)}),e("getOwnMetadata",function(t,e,n){if(!b(e))throw new TypeError;g(n)||(n=x(n));return p(t,e,n)}),e("getMetadataKeys",function(t,e){if(!b(t))throw new TypeError;g(e)||(e=x(e));return function t(e,n){var i=y(e,n);e=_(e);if(null===e)return i;e=t(e,n);if(e.length<=0)return i;if(i.length<=0)return e;var r=new h;var o=[];for(var a=0,s=i;a<s.length;a++){var u=s[a];r.has(u)||(r.add(u),o.push(u))}for(var l=0,c=e;l<c.length;l++){u=c[l];r.has(u)||(r.add(u),o.push(u))}return o}(t,e)}),e("getOwnMetadataKeys",function(t,e){if(!b(t))throw new TypeError;g(e)||(e=x(e));return y(t,e)}),e("deleteMetadata",function(t,e,n){if(!b(e))throw new TypeError;g(n)||(n=x(n));var i=d(e,n,!1);if(g(i))return!1;if(!i.delete(t))return!1;if(0<i.size)return!0;t=o.get(e);return t.delete(n),0<t.size||o.delete(e),!0})}(),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{}),Kt={},r={},Vt=(o=r,Object.defineProperty(o,"__esModule",{value:!0}),o.NON_CUSTOM_TAG_KEYS=o.POST_CONSTRUCT=o.DESIGN_PARAM_TYPES=o.PARAM_TYPES=o.TAGGED_PROP=o.TAGGED=o.MULTI_INJECT_TAG=o.INJECT_TAG=o.OPTIONAL_TAG=o.UNMANAGED_TAG=o.NAME_TAG=o.NAMED_TAG=void 0,o.NAMED_TAG="named",o.NAME_TAG="name",o.UNMANAGED_TAG="unmanaged",o.OPTIONAL_TAG="optional",o.INJECT_TAG="inject",o.MULTI_INJECT_TAG="multi_inject",o.TAGGED="inversify:tagged",o.TAGGED_PROP="inversify:tagged_props",o.PARAM_TYPES="inversify:paramtypes",o.DESIGN_PARAM_TYPES="design:paramtypes",o.POST_CONSTRUCT="post_construct",o.NON_CUSTOM_TAG_KEYS=[o.INJECT_TAG,o.MULTI_INJECT_TAG,o.NAME_TAG,o.UNMANAGED_TAG,o.NAMED_TAG,o.OPTIONAL_TAG],{}),Ht={},Gt={},a=(Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.TargetTypeEnum=Gt.BindingTypeEnum=Gt.BindingScopeEnum=void 0,Gt.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"},Gt.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},Gt.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},{}),Zt=(Object.defineProperty(a,"__esModule",{value:!0}),a.id=void 0,0);a.id=function(){return Zt++},Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.Binding=void 0;var $t=Gt,Jt=a;function Qt(t,e){this.id=Jt.id(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=$t.BindingTypeEnum.Invalid,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}Qt.prototype.clone=function(){var t=new Qt(this.serviceIdentifier,this.scope);return t.activated=t.scope===$t.BindingScopeEnum.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},Ht.Binding=Qt;var o={},s=(Object.defineProperty(o,"__esModule",{value:!0}),o.STACK_OVERFLOW=o.CIRCULAR_DEPENDENCY_IN_FACTORY=o.POST_CONSTRUCT_ERROR=o.MULTIPLE_POST_CONSTRUCT_METHODS=o.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=o.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=o.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=o.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=o.ARGUMENTS_LENGTH_MISMATCH=o.INVALID_DECORATOR_OPERATION=o.INVALID_TO_SELF_VALUE=o.INVALID_FUNCTION_BINDING=o.INVALID_MIDDLEWARE_RETURN=o.NO_MORE_SNAPSHOTS_AVAILABLE=o.INVALID_BINDING_TYPE=o.NOT_IMPLEMENTED=o.CIRCULAR_DEPENDENCY=o.UNDEFINED_INJECT_ANNOTATION=o.MISSING_INJECT_ANNOTATION=o.MISSING_INJECTABLE_ANNOTATION=o.NOT_REGISTERED=o.CANNOT_UNBIND=o.AMBIGUOUS_MATCH=o.KEY_NOT_FOUND=o.NULL_ARGUMENT=o.DUPLICATED_METADATA=o.DUPLICATED_INJECTABLE_DECORATOR=void 0,o.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",o.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",o.NULL_ARGUMENT="NULL argument",o.KEY_NOT_FOUND="Key Not Found",o.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",o.CANNOT_UNBIND="Could not unbind serviceIdentifier:",o.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",o.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",o.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",o.UNDEFINED_INJECT_ANNOTATION=function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},o.CIRCULAR_DEPENDENCY="Circular dependency found:",o.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",o.INVALID_BINDING_TYPE="Invalid binding type:",o.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",o.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",o.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",o.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",o.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",o.ARGUMENTS_LENGTH_MISMATCH=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."},o.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",o.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",o.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",o.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",o.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",o.POST_CONSTRUCT_ERROR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"@postConstruct error in class "+t[0]+": "+t[1]},o.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"It looks like there is a circular dependency in one of the '"+t[0]+"' bindings. Please investigate bindings withservice identifier '"+t[1]+"'."},o.STACK_OVERFLOW="Maximum call stack size exceeded",{}),te=(Object.defineProperty(s,"__esModule",{value:!0}),s.MetadataReader=void 0,r);function ee(){}ee.prototype.getConstructorMetadata=function(t){return{compilerGeneratedMetadata:Reflect.getMetadata(te.PARAM_TYPES,t),userGeneratedMetadata:Reflect.getMetadata(te.TAGGED,t)||{}}},ee.prototype.getPropertiesMetadata=function(t){return Reflect.getMetadata(te.TAGGED_PROP,t)||[]},s.MetadataReader=ee;var ne={},ie={},re=(Object.defineProperty(ie,"__esModule",{value:!0}),ie.BindingCount=void 0,ie.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1},{}),oe=(Object.defineProperty(re,"__esModule",{value:!0}),re.isStackOverflowExeption=void 0,o);re.isStackOverflowExeption=function(t){return t instanceof RangeError||t.message===oe.STACK_OVERFLOW};var u={},ae=(Object.defineProperty(u,"__esModule",{value:!0}),u.circularDependencyToException=u.listMetadataForTarget=u.listRegisteredBindingsForServiceIdentifier=u.getServiceIdentifierAsString=u.getFunctionName=void 0,o);function se(t){return"function"==typeof t?t.name:"symbol"==typeof t?t.toString():t}function ue(t){return function t(e,n){void 0===n&&(n=[]);var i=se(e.serviceIdentifier);return n.push(i),null!==e.parentRequest?t(e.parentRequest,n):n}(t).reverse().join(" --\x3e ")}function le(t){var e;return t.name||((e=(t=t.toString()).match(/^function\s*([^\s(]+)/))?e[1]:"Anonymous function: "+t)}u.getServiceIdentifierAsString=se,u.listRegisteredBindingsForServiceIdentifier=function(t,e,n){var i="";return 0!==(n=n(t,e)).length&&(i="\nRegistered bindings:",n.forEach(function(t){var e="Object";null!==t.implementationType&&(e=le(t.implementationType)),i=i+"\n "+e,t.constraint.metaData&&(i=i+" - "+t.constraint.metaData)})),i},u.circularDependencyToException=function n(t){t.childRequests.forEach(function(t){var e;if(function t(e,n){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===n||t(e.parentRequest,n))}(t,t.serviceIdentifier))throw e=ue(t),new Error(ae.CIRCULAR_DEPENDENCY+" "+e);n(t)})},u.listMetadataForTarget=function(t,e){var n,i;return e.isTagged()||e.isNamed()?(n="",i=e.getNamedTag(),e=e.getCustomTags(),null!==i&&(n+=i.toString()+"\n"),null!==e&&e.forEach(function(t){n+=t.toString()+"\n"})," "+t+"\n "+t+" - "+n):" "+t},u.getFunctionName=le;var ce={},he=(Object.defineProperty(ce,"__esModule",{value:!0}),ce.Context=void 0,a);function de(t){this.id=he.id(),this.container=t}de.prototype.addPlan=function(t){this.plan=t},de.prototype.setCurrentRequest=function(t){this.currentRequest=t},ce.Context=de;var l={},pe=(Object.defineProperty(l,"__esModule",{value:!0}),l.Metadata=void 0,r);function fe(t,e){this.key=t,this.value=e}fe.prototype.toString=function(){return this.key===pe.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},l.Metadata=fe;function ye(t,e){this.parentContext=t,this.rootRequest=e}var c={},ve=(Object.defineProperty(c,"__esModule",{value:!0}),c.Plan=void 0,c.Plan=ye,{}),ge={},me={},be=(Object.defineProperty(me,"__esModule",{value:!0}),me.tagProperty=me.tagParameter=me.decorate=void 0,o),ke=r;function xe(t,e,n,i,r){var o={},a="number"==typeof r,r=void 0!==r&&a?r.toString():n;if(a&&void 0!==n)throw new Error(be.INVALID_DECORATOR_OPERATION);a=(o=Reflect.hasOwnMetadata(t,e)?Reflect.getMetadata(t,e):o)[r];if(Array.isArray(a))for(var s=0,u=a;s<u.length;s++){var l=u[s];if(l.key===i.key)throw new Error(be.DUPLICATED_METADATA+" "+l.key.toString())}else a=[];a.push(i),o[r]=a,Reflect.defineMetadata(t,o,e)}function we(t,e){Reflect.decorate(t,e)}me.tagParameter=function(t,e,n,i){xe(ke.TAGGED,t,e,i,n)},me.tagProperty=function(t,e,n){xe(ke.TAGGED_PROP,t.constructor,e,n)},me.decorate=function(t,e,n){var i,r;"number"==typeof n?we([(i=n,r=t,function(t,e){r(t,e,i)})],e):"string"==typeof n?Reflect.decorate([t],e,n):we([t],e)},Object.defineProperty(ge,"__esModule",{value:!0}),ge.inject=ge.LazyServiceIdentifer=void 0;var Se=o,Ee=r,Te=l,_e=me;function Me(t){this._cb=t}Me.prototype.unwrap=function(){return this._cb()},ge.LazyServiceIdentifer=Me,ge.inject=function(r){return function(t,e,n){if(void 0===r)throw new Error(Se.UNDEFINED_INJECT_ANNOTATION(t.name));var i=new Te.Metadata(Ee.INJECT_TAG,r);"number"==typeof n?_e.tagParameter(t,e,n,i):_e.tagProperty(t,e,i)}};var h={},d={},p=(Object.defineProperty(d,"__esModule",{value:!0}),d.QueryableString=void 0,Pe.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},Pe.prototype.endsWith=function(t){var t=t.split("").reverse().join(""),e=this.str.split("").reverse().join("");return this.startsWith.call({str:e},t)},Pe.prototype.contains=function(t){return-1!==this.str.indexOf(t)},Pe.prototype.equals=function(t){return this.str===t},Pe.prototype.value=function(){return this.str},Pe);function Pe(t){this.str=t}d.QueryableString=p,Object.defineProperty(h,"__esModule",{value:!0}),h.Target=void 0;var Oe,Ce,Ae,Ne,Le,Ie,De,Re=r,je=a,Be=l,Fe=d;function ze(t,e,n,i){this.id=je.id(),this.type=t,this.serviceIdentifier=n,this.name=new Fe.QueryableString(e||""),this.metadata=new Array;t=null;"string"==typeof i?t=new Be.Metadata(Re.NAMED_TAG,i):i instanceof Be.Metadata&&(t=i),null!==t&&this.metadata.push(t)}function Ve(t,e,n,i){var r=t.getConstructorMetadata(n),o=r.compilerGeneratedMetadata;if(void 0===o)throw a=Ae.MISSING_INJECTABLE_ANNOTATION+" "+e+".",new Error(a);var a=r.userGeneratedMetadata,r=Object.keys(a),s=0===n.length&&0<r.length,u=r.length>n.length,i=function(t,e,n,i,r){for(var o=[],a=0;a<r;a++){var s=function(t,e,n,i,r){var r=r[t.toString()]||[],o=He(r),a=!0!==o.unmanaged,i=i[t],s=o.inject||o.multiInject;(i=s||i)instanceof Ce.LazyServiceIdentifer&&(i=i.unwrap());if(a){var s=i===Object,a=i===Function,u=void 0===i,s=s||a||u;if(!e&&s)throw a=Ae.MISSING_INJECT_ANNOTATION+" argument "+t+" in class "+n+".",new Error(a);u=new De.Target(Ne.TargetTypeEnum.ConstructorArgument,o.targetName,i);return u.metadata=r,u}return null}(a,t,e,n,i);null!==s&&o.push(s)}return o}(i,e,o,a,(s||u?r:n).length),e=function t(e,n){var i=e.getPropertiesMetadata(n);var r=[];var o=Object.keys(i);for(var a=0,s=o;a<s.length;a++){var u=s[a],l=i[u],c=He(i[u]),u=c.targetName||u,c=c.inject||c.multiInject,u=new De.Target(Ne.TargetTypeEnum.ClassProperty,u,c);u.metadata=l,r.push(u)}o=Object.getPrototypeOf(n.prototype).constructor;o!==Object&&(n=t(e,o),r=Oe(Oe([],r),n));return r}(t,n);return Oe(Oe([],i),e)}function He(t){var e={};return t.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[Le.INJECT_TAG],multiInject:e[Le.MULTI_INJECT_TAG],targetName:e[Le.NAME_TAG],unmanaged:e[Le.UNMANAGED_TAG]}}ze.prototype.hasTag=function(t){for(var e=0,n=this.metadata;e<n.length;e++)if(n[e].key===t)return!0;return!1},ze.prototype.isArray=function(){return this.hasTag(Re.MULTI_INJECT_TAG)},ze.prototype.matchesArray=function(t){return this.matchesTag(Re.MULTI_INJECT_TAG)(t)},ze.prototype.isNamed=function(){return this.hasTag(Re.NAMED_TAG)},ze.prototype.isTagged=function(){return this.metadata.some(function(e){return Re.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})})},ze.prototype.isOptional=function(){return this.matchesTag(Re.OPTIONAL_TAG)(!0)},ze.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(t){return t.key===Re.NAMED_TAG})[0]:null},ze.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return Re.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})}):null},ze.prototype.matchesNamedTag=function(t){return this.matchesTag(Re.NAMED_TAG)(t)},ze.prototype.matchesTag=function(r){var o=this;return function(t){for(var e=0,n=o.metadata;e<n.length;e++){var i=n[e];if(i.key===r&&i.value===t)return!0}return!1}},h.Target=ze,p=ve,Oe=i&&i.__spreadArray||function(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t},Object.defineProperty(p,"__esModule",{value:!0}),p.getFunctionName=p.getBaseClassDependencyCount=p.getDependencies=void 0,Ce=ge,Ae=o,Ne=Gt,Le=r,Ie=u,Object.defineProperty(p,"getFunctionName",{enumerable:!0,get:function(){return Ie.getFunctionName}}),De=h,p.getDependencies=function(t,e){return Ve(t,Ie.getFunctionName(e),e,!1)},p.getBaseClassDependencyCount=function t(e,n){var i,r,n=Object.getPrototypeOf(n.prototype).constructor;return n!==Object?(i=(r=Ve(e,Ie.getFunctionName(n),n,!0)).map(function(t){return t.metadata.filter(function(t){return t.key===Le.UNMANAGED_TAG})}),i=[].concat.apply([],i).length,0<(r=r.length-i)?r:t(e,n)):0};var d={},Ge=(Object.defineProperty(d,"__esModule",{value:!0}),d.Request=void 0,a);function We(t,e,n,i,r){this.id=Ge.id(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=n,this.target=r,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}We.prototype.addChildRequest=function(t,e,n){t=new We(t,this.parentContext,this,e,n);return this.childRequests.push(t),t},d.Request=We,Object.defineProperty(ne,"__esModule",{value:!0}),ne.getBindingDictionary=ne.createMockRequest=ne.plan=void 0;var Ue=ie,Ye=o,qe=Gt,Xe=r,Ke=re,Ze=u,$e=ce,Je=l,Qe=c,tn=ve,en=d,nn=h;function rn(t){return t._bindingDictionary}function on(t,e,n,i,r){var o=an(n.container,r.serviceIdentifier),a=[];return o.length===Ue.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof r.serviceIdentifier&&t.getConstructorMetadata(r.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(r.serviceIdentifier).toSelf(),o=an(n.container,r.serviceIdentifier)),a=e?o:o.filter(function(t){var e=new en.Request(t.serviceIdentifier,n,i,t,r);return t.constraint(e)}),function(t,e,n,i){switch(e.length){case Ue.BindingCount.NoBindingsAvailable:if(n.isOptional())return;throw r=Ze.getServiceIdentifierAsString(t),o=Ye.NOT_REGISTERED,o=(o+=Ze.listMetadataForTarget(r,n))+Ze.listRegisteredBindingsForServiceIdentifier(i,r,an),new Error(o);case Ue.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return;case Ue.BindingCount.MultipleBindingsAvailable:default:var r,o;if(n.isArray())return;throw r=Ze.getServiceIdentifierAsString(t),o=Ye.AMBIGUOUS_MATCH+" "+r,o+=Ze.listRegisteredBindingsForServiceIdentifier(i,r,an),new Error(o)}}(r.serviceIdentifier,a,r,n.container),a}function an(t,e){var n=[],i=rn(t);return i.hasKey(e)?n=i.get(e):null!==t.parent&&(n=an(t.parent,e)),n}ne.getBindingDictionary=rn,ne.plan=function(t,e,n,i,r,o,a,s){void 0===s&&(s=!1);var u,e=new $e.Context(e),l=(i=i,l=r,u="",o=o,a=a,n=(n=n)?Xe.MULTI_INJECT_TAG:Xe.INJECT_TAG,n=new Je.Metadata(n,l),i=new nn.Target(i,u,l,n),void 0!==o&&(u=new Je.Metadata(o,a),i.metadata.push(u)),i);try{return function r(o,t,e,a,n,s){var i,u;null===n?(i=on(o,t,a,null,s),u=new en.Request(e,a,null,i,s),e=new Qe.Plan(a,u),a.addPlan(e)):(i=on(o,t,a,n,s),u=n.addChildRequest(s.serviceIdentifier,i,s)),i.forEach(function(t){var e=null;if(s.isArray())e=u.addChildRequest(t.serviceIdentifier,t,s);else{if(t.cache)return;e=u}if(t.type===qe.BindingTypeEnum.Instance&&null!==t.implementationType){var n=tn.getDependencies(o,t.implementationType);if(!a.container.options.skipBaseClassChecks){var i=tn.getBaseClassDependencyCount(o,t.implementationType);if(n.length<i)throw i=Ye.ARGUMENTS_LENGTH_MISMATCH(tn.getFunctionName(t.implementationType)),new Error(i)}n.forEach(function(t){r(o,!1,t.serviceIdentifier,a,e,t)})}})}(t,s,r,e,null,l),e}catch(t){throw Ke.isStackOverflowExeption(t)&&e.plan&&Ze.circularDependencyToException(e.plan.rootRequest),t}},ne.createMockRequest=function(t,e,n,i){return n=new nn.Target(qe.TargetTypeEnum.Variable,"",e,new Je.Metadata(n,i)),i=new $e.Context(t),new en.Request(e,i,null,[],n)};var p={},ie={},sn=i&&i.__spreadArray||function(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t},un=(Object.defineProperty(ie,"__esModule",{value:!0}),ie.resolveInstance=void 0,o),ln=Gt,cn=r;ie.resolveInstance=function(t,e,n){var i,r,o=null,e=(o=0<e.length?(a=e.filter(function(t){return null!==t.target&&t.target.type===ln.TargetTypeEnum.ConstructorArgument}).map(n),o=new(t.bind.apply(t,sn([void 0],a))),i=o,a=n,r=(n=(n=e).filter(function(t){return null!==t.target&&t.target.type===ln.TargetTypeEnum.ClassProperty})).map(a),n.forEach(function(t,e){t=t.target.name.value(),e=r[e];i[t]=e}),i):new t,t),a=o;if(Reflect.hasMetadata(cn.POST_CONSTRUCT,e)){n=Reflect.getMetadata(cn.POST_CONSTRUCT,e);try{a[n.value]()}catch(t){throw new Error(un.POST_CONSTRUCT_ERROR(e.name,t.message))}}return o},Object.defineProperty(p,"__esModule",{value:!0}),p.resolve=void 0;var hn=o,dn=Gt,pn=re,fn=u,yn=ie,vn=function(e,n,t){try{return t()}catch(t){throw pn.isStackOverflowExeption(t)?new Error(hn.CIRCULAR_DEPENDENCY_IN_FACTORY(e,n.toString())):t}},gn=function(s){return function(t){t.parentContext.setCurrentRequest(t);var e=t.bindings,n=t.childRequests,i=t.target&&t.target.isArray(),r=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&r)return n.map(function(t){return gn(s)(t)});i=null;if(!t.target.isOptional()||0!==e.length){var o,a=e[0],r=a.scope===dn.BindingScopeEnum.Singleton,e=a.scope===dn.BindingScopeEnum.Request;if(r&&a.activated)return a.cache;if(e&&null!==s&&s.has(a.id))return s.get(a.id);if(a.type===dn.BindingTypeEnum.ConstantValue)i=a.cache,a.activated=!0;else if(a.type===dn.BindingTypeEnum.Function)i=a.cache,a.activated=!0;else if(a.type===dn.BindingTypeEnum.Constructor)i=a.implementationType;else if(a.type===dn.BindingTypeEnum.DynamicValue&&null!==a.dynamicValue)i=vn("toDynamicValue",a.serviceIdentifier,function(){return a.dynamicValue(t.parentContext)});else if(a.type===dn.BindingTypeEnum.Factory&&null!==a.factory)i=vn("toFactory",a.serviceIdentifier,function(){return a.factory(t.parentContext)});else if(a.type===dn.BindingTypeEnum.Provider&&null!==a.provider)i=vn("toProvider",a.serviceIdentifier,function(){return a.provider(t.parentContext)});else{if(a.type!==dn.BindingTypeEnum.Instance||null===a.implementationType)throw o=fn.getServiceIdentifierAsString(t.serviceIdentifier),new Error(hn.INVALID_BINDING_TYPE+" "+o);i=yn.resolveInstance(a.implementationType,n,gn(s))}return"function"==typeof a.onActivation&&(i=a.onActivation(t.parentContext,i)),r&&(a.cache=i,a.activated=!0),e&&null!==s&&!s.has(a.id)&&s.set(a.id,i),i}}};p.resolve=function(t){return gn(t.plan.rootRequest.requestScope)(t.plan.rootRequest)};function mn(t,e){return null!==(t=t.parentRequest)&&(!!e(t)||mn(t,e))}function bn(n){return function(e){function t(t){return null!==t&&null!==t.target&&t.target.matchesTag(n)(e)}return t.metaData=new xn.Metadata(n,e),t}}var ce={},c={},ve={},d={},h={},re={},ie={},kn=(Object.defineProperty(ie,"__esModule",{value:!0}),ie.typeConstraint=ie.namedConstraint=ie.taggedConstraint=ie.traverseAncerstors=void 0,r),xn=l,kn=(ie.traverseAncerstors=mn,(ie.taggedConstraint=bn)(kn.NAMED_TAG)),wn=(ie.namedConstraint=kn,ie.typeConstraint=function(n){return function(t){var e=null;return null!==t&&(e=t.bindings[0],"string"==typeof n?e.serviceIdentifier===n:(e=t.bindings[0].implementationType,n===e))}},Object.defineProperty(re,"__esModule",{value:!0}),re.BindingWhenSyntax=void 0,h),Sn=ie;function En(t){this._binding=t}En.prototype.when=function(t){return this._binding.constraint=t,new wn.BindingOnSyntax(this._binding)},En.prototype.whenTargetNamed=function(t){return this._binding.constraint=Sn.namedConstraint(t),new wn.BindingOnSyntax(this._binding)},En.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){return null!==t.target&&!t.target.isNamed()&&!t.target.isTagged()},new wn.BindingOnSyntax(this._binding)},En.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=Sn.taggedConstraint(t)(e),new wn.BindingOnSyntax(this._binding)},En.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return Sn.typeConstraint(e)(t.parentRequest)},new wn.BindingOnSyntax(this._binding)},En.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return Sn.namedConstraint(e)(t.parentRequest)},new wn.BindingOnSyntax(this._binding)},En.prototype.whenParentTagged=function(e,n){return this._binding.constraint=function(t){return Sn.taggedConstraint(e)(n)(t.parentRequest)},new wn.BindingOnSyntax(this._binding)},En.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return Sn.traverseAncerstors(t,Sn.typeConstraint(e))},new wn.BindingOnSyntax(this._binding)},En.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!Sn.traverseAncerstors(t,Sn.typeConstraint(e))},new wn.BindingOnSyntax(this._binding)},En.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return Sn.traverseAncerstors(t,Sn.namedConstraint(e))},new wn.BindingOnSyntax(this._binding)},En.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!Sn.traverseAncerstors(t,Sn.namedConstraint(e))},new wn.BindingOnSyntax(this._binding)},En.prototype.whenAnyAncestorTagged=function(e,n){return this._binding.constraint=function(t){return Sn.traverseAncerstors(t,Sn.taggedConstraint(e)(n))},new wn.BindingOnSyntax(this._binding)},En.prototype.whenNoAncestorTagged=function(e,n){return this._binding.constraint=function(t){return!Sn.traverseAncerstors(t,Sn.taggedConstraint(e)(n))},new wn.BindingOnSyntax(this._binding)},En.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return Sn.traverseAncerstors(t,e)},new wn.BindingOnSyntax(this._binding)},En.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!Sn.traverseAncerstors(t,e)},new wn.BindingOnSyntax(this._binding)},re.BindingWhenSyntax=En,Object.defineProperty(h,"__esModule",{value:!0}),h.BindingOnSyntax=void 0;var Tn=re;function _n(t){this._binding=t}_n.prototype.onActivation=function(t){return this._binding.onActivation=t,new Tn.BindingWhenSyntax(this._binding)},h.BindingOnSyntax=_n,Object.defineProperty(d,"__esModule",{value:!0}),d.BindingWhenOnSyntax=void 0;var Mn=h,Pn=re;function On(t){this._binding=t,this._bindingWhenSyntax=new Pn.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Mn.BindingOnSyntax(this._binding)}On.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},On.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},On.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},On.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},On.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},On.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},On.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},On.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},On.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},On.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},On.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},On.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},On.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},On.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},On.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},On.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},d.BindingWhenOnSyntax=On,Object.defineProperty(ve,"__esModule",{value:!0}),ve.BindingInSyntax=void 0;var Cn=Gt,An=d;function Nn(t){this._binding=t}Nn.prototype.inRequestScope=function(){return this._binding.scope=Cn.BindingScopeEnum.Request,new An.BindingWhenOnSyntax(this._binding)},Nn.prototype.inSingletonScope=function(){return this._binding.scope=Cn.BindingScopeEnum.Singleton,new An.BindingWhenOnSyntax(this._binding)},Nn.prototype.inTransientScope=function(){return this._binding.scope=Cn.BindingScopeEnum.Transient,new An.BindingWhenOnSyntax(this._binding)},ve.BindingInSyntax=Nn,Object.defineProperty(c,"__esModule",{value:!0}),c.BindingInWhenOnSyntax=void 0;var Ln=ve,In=h,Dn=re;function Rn(t){this._binding=t,this._bindingWhenSyntax=new Dn.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new In.BindingOnSyntax(this._binding),this._bindingInSyntax=new Ln.BindingInSyntax(t)}Rn.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},Rn.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},Rn.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},Rn.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},Rn.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},Rn.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},Rn.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},Rn.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},Rn.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},Rn.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},Rn.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},Rn.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},Rn.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},Rn.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},Rn.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},Rn.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},Rn.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},Rn.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},Rn.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},c.BindingInWhenOnSyntax=Rn,Object.defineProperty(ce,"__esModule",{value:!0}),ce.BindingToSyntax=void 0;var jn=o,Bn=Gt,Fn=c,zn=d;function Vn(t){this._binding=t}Vn.prototype.to=function(t){return this._binding.type=Bn.BindingTypeEnum.Instance,this._binding.implementationType=t,new Fn.BindingInWhenOnSyntax(this._binding)},Vn.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+jn.INVALID_TO_SELF_VALUE);var t=this._binding.serviceIdentifier;return this.to(t)},Vn.prototype.toConstantValue=function(t){return this._binding.type=Bn.BindingTypeEnum.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Bn.BindingScopeEnum.Singleton,new zn.BindingWhenOnSyntax(this._binding)},Vn.prototype.toDynamicValue=function(t){return this._binding.type=Bn.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new Fn.BindingInWhenOnSyntax(this._binding)},Vn.prototype.toConstructor=function(t){return this._binding.type=Bn.BindingTypeEnum.Constructor,this._binding.implementationType=t,this._binding.scope=Bn.BindingScopeEnum.Singleton,new zn.BindingWhenOnSyntax(this._binding)},Vn.prototype.toFactory=function(t){return this._binding.type=Bn.BindingTypeEnum.Factory,this._binding.factory=t,this._binding.scope=Bn.BindingScopeEnum.Singleton,new zn.BindingWhenOnSyntax(this._binding)},Vn.prototype.toFunction=function(t){if("function"!=typeof t)throw new Error(jn.INVALID_FUNCTION_BINDING);t=this.toConstantValue(t);return this._binding.type=Bn.BindingTypeEnum.Function,this._binding.scope=Bn.BindingScopeEnum.Singleton,t},Vn.prototype.toAutoFactory=function(e){return this._binding.type=Bn.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=Bn.BindingScopeEnum.Singleton,new zn.BindingWhenOnSyntax(this._binding)},Vn.prototype.toProvider=function(t){return this._binding.type=Bn.BindingTypeEnum.Provider,this._binding.provider=t,this._binding.scope=Bn.BindingScopeEnum.Singleton,new zn.BindingWhenOnSyntax(this._binding)},Vn.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},ce.BindingToSyntax=Vn;kn={},Object.defineProperty(kn,"__esModule",{value:!0}),kn.ContainerSnapshot=void 0,Hn.of=function(t,e){var n=new Hn;return n.bindings=t,n.middleware=e,n},ve=Hn;function Hn(){}kn.ContainerSnapshot=ve;var h={},Gn=(Object.defineProperty(h,"__esModule",{value:!0}),h.Lookup=void 0,o);function Wn(){this._map=new Map}Wn.prototype.getMap=function(){return this._map},Wn.prototype.add=function(t,e){if(null==t)throw new Error(Gn.NULL_ARGUMENT);if(null==e)throw new Error(Gn.NULL_ARGUMENT);var n=this._map.get(t);void 0!==n?(n.push(e),this._map.set(t,n)):this._map.set(t,[e])},Wn.prototype.get=function(t){if(null==t)throw new Error(Gn.NULL_ARGUMENT);t=this._map.get(t);if(void 0!==t)return t;throw new Error(Gn.KEY_NOT_FOUND)},Wn.prototype.remove=function(t){if(null==t)throw new Error(Gn.NULL_ARGUMENT);if(!this._map.delete(t))throw new Error(Gn.KEY_NOT_FOUND)},Wn.prototype.removeByCondition=function(n){var i=this;this._map.forEach(function(t,e){t=t.filter(function(t){return!n(t)});0<t.length?i._map.set(e,t):i._map.delete(e)})},Wn.prototype.hasKey=function(t){if(null==t)throw new Error(Gn.NULL_ARGUMENT);return this._map.has(t)},Wn.prototype.clone=function(){var n=new Wn;return this._map.forEach(function(t,e){t.forEach(function(t){return n.add(e,t.clone())})}),n},Wn.prototype.traverse=function(n){this._map.forEach(function(t,e){n(e,t)})},h.Lookup=Wn;var Un=i&&i.__awaiter||function(t,a,s,u){return new(s=s||Promise)(function(n,e){function i(t){try{o(u.next(t))}catch(t){e(t)}}function r(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(i,r)}o((u=u.apply(t,a||[])).next())})},Yn=i&&i.__generator||function(i,r){var o,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(n){return function(t){var e=[n,t];if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,a&&(s=2&e[0]?a.return:e[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,e[1])).done)return s;switch(a=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,a=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(i,u)}catch(t){e=[6,t],a=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}},qn=i&&i.__spreadArray||function(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t},Xn=(Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.Container=void 0,Ht),Kn=o,Zn=Gt,$n=r,Jn=s,Qn=ne,ti=p,ei=ce,ni=a,ii=u,ri=kn,oi=h;function ai(t){this._appliedMiddleware=[];t=t||{};if("object"!=typeof t)throw new Error(""+Kn.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=Zn.BindingScopeEnum.Transient;else if(t.defaultScope!==Zn.BindingScopeEnum.Singleton&&t.defaultScope!==Zn.BindingScopeEnum.Transient&&t.defaultScope!==Zn.BindingScopeEnum.Request)throw new Error(""+Kn.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+Kn.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+Kn.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=ni.id(),this._bindingDictionary=new oi.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new Jn.MetadataReader}ai.merge=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=new ai,t=qn([t,e],n).map(function(t){return Qn.getBindingDictionary(t)}),o=Qn.getBindingDictionary(r);return t.forEach(function(t){var n;n=o,t.traverse(function(t,e){e.forEach(function(t){n.add(t.serviceIdentifier,t.clone())})})}),r},ai.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this._getContainerModuleHelpersFactory(),i=0,r=t;i<r.length;i++){var o=r[i],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},ai.prototype.loadAsync=function(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];return Un(this,void 0,void 0,function(){var e,n,i,r,o;return Yn(this,function(t){switch(t.label){case 0:e=this._getContainerModuleHelpersFactory(),n=0,i=a,t.label=1;case 1:return n<i.length?(r=i[n],o=e(r.id),[4,r.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)]):[3,4];case 2:t.sent(),t.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},ai.prototype.unload=function(){for(var i=this,t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach(function(t){function e(t){return t.moduleId===n}var n;n=t.id;i._bindingDictionary.removeByCondition(e)})},ai.prototype.bind=function(t){var e=this.options.defaultScope||Zn.BindingScopeEnum.Transient,e=new Xn.Binding(t,e);return this._bindingDictionary.add(t,e),new ei.BindingToSyntax(e)},ai.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},ai.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(Kn.CANNOT_UNBIND+" "+ii.getServiceIdentifierAsString(e))}},ai.prototype.unbindAll=function(){this._bindingDictionary=new oi.Lookup},ai.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return e=!e&&this.parent?this.parent.isBound(t):e},ai.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,$n.NAMED_TAG,e)},ai.prototype.isBoundTagged=function(t,e,n){var i,r,o=!1;return this._bindingDictionary.hasKey(t)&&(i=this._bindingDictionary.get(t),r=Qn.createMockRequest(this,t,e,n),o=i.some(function(t){return t.constraint(r)})),o=!o&&this.parent?this.parent.isBoundTagged(t,e,n):o},ai.prototype.snapshot=function(){this._snapshots.push(ri.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},ai.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error(Kn.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=t.bindings,this._middleware=t.middleware},ai.prototype.createChild=function(t){t=new ai(t||this.options);return t.parent=this,t},ai.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._appliedMiddleware=this._appliedMiddleware.concat(t);var n=this._middleware||this._planAndResolve();this._middleware=t.reduce(function(t,e){return e(t)},n)},ai.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},ai.prototype.get=function(t){return this._get(!1,!1,Zn.TargetTypeEnum.Variable,t)},ai.prototype.getTagged=function(t,e,n){return this._get(!1,!1,Zn.TargetTypeEnum.Variable,t,e,n)},ai.prototype.getNamed=function(t,e){return this.getTagged(t,$n.NAMED_TAG,e)},ai.prototype.getAll=function(t){return this._get(!0,!0,Zn.TargetTypeEnum.Variable,t)},ai.prototype.getAllTagged=function(t,e,n){return this._get(!1,!0,Zn.TargetTypeEnum.Variable,t,e,n)},ai.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,$n.NAMED_TAG,e)},ai.prototype.resolve=function(t){var e=this.createChild();return e.bind(t).toSelf(),this._appliedMiddleware.forEach(function(t){e.applyMiddleware(t)}),e.get(t)},ai.prototype._getContainerModuleHelpersFactory=function(){function i(t,e){t._binding.moduleId=e}var r=this;return function(t){return{bindFunction:function(t){t=r.bind.bind(r)(t);return i(t,n),t},isboundFunction:function(t){return r.isBound.bind(r)(t)},rebindFunction:(e=n=t,function(t){t=r.rebind.bind(r)(t);return i(t,e),t}),unbindFunction:function(t){r.unbind.bind(r)(t)}};var e,n}},ai.prototype._get=function(t,e,n,i,r,o){var a=null,t={avoidConstraints:t,contextInterceptor:function(t){return t},isMultiInject:e,key:r,serviceIdentifier:i,targetType:n,value:o};if(this._middleware){if(null==(a=this._middleware(t)))throw new Error(Kn.INVALID_MIDDLEWARE_RETURN)}else a=this._planAndResolve()(t);return a},ai.prototype._planAndResolve=function(){var n=this;return function(t){var e=Qn.plan(n._metadataReader,n,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints),e=t.contextInterceptor(e);return ti.resolve(e)}},Vt.Container=ai;function si(t){this.id=ui.id(),this.registry=t}var re={},ui=(Object.defineProperty(re,"__esModule",{value:!0}),re.AsyncContainerModule=re.ContainerModule=void 0,a),c=(re.ContainerModule=function(t){this.id=ui.id(),this.registry=t},re.AsyncContainerModule=si,{}),li=(Object.defineProperty(c,"__esModule",{value:!0}),c.injectable=void 0,o),ci=r;c.injectable=function(){return function(t){if(Reflect.hasOwnMetadata(ci.PARAM_TYPES,t))throw new Error(li.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(ci.DESIGN_PARAM_TYPES,t)||[];return Reflect.defineMetadata(ci.PARAM_TYPES,e,t),t}};var d={},hi=(Object.defineProperty(d,"__esModule",{value:!0}),d.tagged=void 0,l),di=me;d.tagged=function(r,o){return function(t,e,n){var i=new hi.Metadata(r,o);"number"==typeof n?di.tagParameter(t,e,n,i):di.tagProperty(t,e,i)}};var ve={},pi=(Object.defineProperty(ve,"__esModule",{value:!0}),ve.named=void 0,r),fi=l,yi=me;ve.named=function(r){return function(t,e,n){var i=new fi.Metadata(pi.NAMED_TAG,r);"number"==typeof n?yi.tagParameter(t,e,n,i):yi.tagProperty(t,e,i)}};var i={},vi=(Object.defineProperty(i,"__esModule",{value:!0}),i.optional=void 0,r),gi=l,mi=me;i.optional=function(){return function(t,e,n){var i=new gi.Metadata(vi.OPTIONAL_TAG,!0);"number"==typeof n?mi.tagParameter(t,e,n,i):mi.tagProperty(t,e,i)}};var Ht={},bi=(Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.unmanaged=void 0,r),ki=l,xi=me;Ht.unmanaged=function(){return function(t,e,n){var i=new ki.Metadata(bi.UNMANAGED_TAG,!0);xi.tagParameter(t,e,n,i)}};var ne={},wi=(Object.defineProperty(ne,"__esModule",{value:!0}),ne.multiInject=void 0,r),Si=l,Ei=me;ne.multiInject=function(r){return function(t,e,n){var i=new Si.Metadata(wi.MULTI_INJECT_TAG,r);"number"==typeof n?Ei.tagParameter(t,e,n,i):Ei.tagProperty(t,e,i)}};var p={},Ti=(Object.defineProperty(p,"__esModule",{value:!0}),p.targetName=void 0,r),_i=l,Mi=me;p.targetName=function(r){return function(t,e,n){var i=new _i.Metadata(Ti.NAME_TAG,r);Mi.tagParameter(t,e,n,i)}};var ce={},Pi=(Object.defineProperty(ce,"__esModule",{value:!0}),ce.postConstruct=void 0,o),Oi=r,Ci=l;ce.postConstruct=function(){return function(t,e,n){e=new Ci.Metadata(Oi.POST_CONSTRUCT,e);if(Reflect.hasOwnMetadata(Oi.POST_CONSTRUCT,t.constructor))throw new Error(Pi.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(Oi.POST_CONSTRUCT,e,t.constructor)}};var f,Ai,Ni,Li,kn={},h=(Object.defineProperty(kn,"__esModule",{value:!0}),kn.multiBindToService=void 0,kn.multiBindToService=function(i){return function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.forEach(function(t){return i.bind(t).toService(n)})}}},Kt),Ii=(Object.defineProperty(h,"__esModule",{value:!0}),h.multiBindToService=h.getServiceIdentifierAsString=h.typeConstraint=h.namedConstraint=h.taggedConstraint=h.traverseAncerstors=h.decorate=h.id=h.MetadataReader=h.postConstruct=h.targetName=h.multiInject=h.unmanaged=h.optional=h.LazyServiceIdentifer=h.inject=h.named=h.tagged=h.injectable=h.ContainerModule=h.AsyncContainerModule=h.TargetTypeEnum=h.BindingTypeEnum=h.BindingScopeEnum=h.Container=h.METADATA_KEY=void 0,h.METADATA_KEY=r,Vt),Di=(Object.defineProperty(h,"Container",{enumerable:!0,get:function(){return Ii.Container}}),Gt),Ri=(Object.defineProperty(h,"BindingScopeEnum",{enumerable:!0,get:function(){return Di.BindingScopeEnum}}),Object.defineProperty(h,"BindingTypeEnum",{enumerable:!0,get:function(){return Di.BindingTypeEnum}}),Object.defineProperty(h,"TargetTypeEnum",{enumerable:!0,get:function(){return Di.TargetTypeEnum}}),re),ji=(Object.defineProperty(h,"AsyncContainerModule",{enumerable:!0,get:function(){return Ri.AsyncContainerModule}}),Object.defineProperty(h,"ContainerModule",{enumerable:!0,get:function(){return Ri.ContainerModule}}),c),Bi=(Object.defineProperty(h,"injectable",{enumerable:!0,get:function(){return ji.injectable}}),d),Fi=(Object.defineProperty(h,"tagged",{enumerable:!0,get:function(){return Bi.tagged}}),ve),zi=(Object.defineProperty(h,"named",{enumerable:!0,get:function(){return Fi.named}}),ge),Vi=(Object.defineProperty(h,"inject",{enumerable:!0,get:function(){return zi.inject}}),Object.defineProperty(h,"LazyServiceIdentifer",{enumerable:!0,get:function(){return zi.LazyServiceIdentifer}}),i),Hi=(Object.defineProperty(h,"optional",{enumerable:!0,get:function(){return Vi.optional}}),Ht),Gi=(Object.defineProperty(h,"unmanaged",{enumerable:!0,get:function(){return Hi.unmanaged}}),ne),Wi=(Object.defineProperty(h,"multiInject",{enumerable:!0,get:function(){return Gi.multiInject}}),p),Ui=(Object.defineProperty(h,"targetName",{enumerable:!0,get:function(){return Wi.targetName}}),ce),Yi=(Object.defineProperty(h,"postConstruct",{enumerable:!0,get:function(){return Ui.postConstruct}}),s),qi=(Object.defineProperty(h,"MetadataReader",{enumerable:!0,get:function(){return Yi.MetadataReader}}),a),Xi=(Object.defineProperty(h,"id",{enumerable:!0,get:function(){return qi.id}}),me),Ki=(Object.defineProperty(h,"decorate",{enumerable:!0,get:function(){return Xi.decorate}}),ie),Zi=(Object.defineProperty(h,"traverseAncerstors",{enumerable:!0,get:function(){return Ki.traverseAncerstors}}),Object.defineProperty(h,"taggedConstraint",{enumerable:!0,get:function(){return Ki.taggedConstraint}}),Object.defineProperty(h,"namedConstraint",{enumerable:!0,get:function(){return Ki.namedConstraint}}),Object.defineProperty(h,"typeConstraint",{enumerable:!0,get:function(){return Ki.typeConstraint}}),u),$i=(Object.defineProperty(h,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return Zi.getServiceIdentifierAsString}}),kn);function Ji(t){return(Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function tr(t,e,n){return e&&Qi(t.prototype,e),n&&Qi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function er(t){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nr(t,e){return e.lifecycle===f.Lifecycle.singleton?t.inSingletonScope():t.inTransientScope()}function ir(t,e){t.whenTargetNamed(ar(e))}function rr(t,e){return e.bind(sr(t))}function or(e,n){if(n.isBound(sr(e)))try{return n.rebind(sr(e))}catch(t){return n.bind(sr(e))}return n.bind(sr(e))}function ar(t){return Ni.isDefinedToken(t)?t.symbol:t}function sr(t){return Ni.isDefinedToken(t)?t.symbol:t}Object.defineProperty(h,"multiBindToService",{enumerable:!0,get:function(){return $i.multiBindToService}}),(Ai=f=f||{}).defineToken=function(t){return new Ai.DefinedToken(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{multiple:!0})},Ai.DefinedToken=tr(function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=this,r=t;if(!(i instanceof r))throw new TypeError("Cannot call a class as a function");this.prototype={},this.name=void 0,this.multiple=void 0,this.symbol=void 0;i=n.multiple,r=void 0!==i&&i;this.name=e,this.symbol=Symbol(this.name),this.multiple=r}),Ai.isModule=function(t){return!!t&&"object"===Ji(t)&&"id"in t},(l=o=Ai.Lifecycle||(Ai.Lifecycle={})).singleton="singleton",l.transient="transient",Ai.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),Ai.DefaultOption={lifecycle:o.transient},(Li=Ni=Ni||{}).toArray=function(t){return Array.isArray(t)?t:void 0===t?[]:[t]},Li.isClass=function(t){return!!(t&&"function"==typeof t&&"prototype"in t)},Li.isDefinedToken=function(t){return!!(t&&"object"===Ji(t)&&"symbol"in t&&"multiple"in t)},Li.isInjectOption=function(t){return!!(t&&"object"===Ji(t)&&"token"in t)},Li.isNamedToken=function(t){return!!(t&&"object"===Ji(t)&&"token"in t&&"named"in t)},Li.isMultipleEnabled=function(t){return Li.isDefinedToken(t)&&t.multiple};r=new Kt.Container;function ur(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function lr(i){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ur(Object(r),!0).forEach(function(t){var e,n;e=i,n=r[t=t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):ur(Object(r)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(r,t))})}return i}function cr(t){var e=0<arguments.length&&void 0!==t?t:{},n=Kt.injectable();return function(t){Reflect.defineMetadata(f.ClassOptionSymbol,lr(lr({},e),{},{target:t}),t),n(t)}}function y(t){return cr(lr(lr({},0<arguments.length&&void 0!==t?t:{}),{},{lifecycle:f.Lifecycle.singleton}))}function v(t){return Kt.inject(sr(t))}var hr=Symbol("SyringeOptionSymbol");function dr(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function pr(i){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(r),!0).forEach(function(t){var e,n;e=i,n=r[t=t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):dr(Object(r)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(r,t))})}return i}function fr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var yr=function(){function l(t,e,n){if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");this.token=void 0,this.rawToken=void 0,this.named=void 0,this.generalToken=void 0,this.option=void 0,this.register=void 0,this.mutiple=void 0,this.register=t,this.token=e,this.option=n,this.rawToken=Ni.isNamedToken(e)?e.token:e,this.named=Ni.isNamedToken(e)?e.named:void 0,this.mutiple=!!this.named||Ni.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}var t,e,n;return t=l,n=[{key:"resolveTarget",value:function(t,e){var n,i,r,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};try{try{var a=Reflect.getMetadata(hr,e);a&&l.resolveOption(t,a)}catch(t){}Ni.isClass(e)&&(o.useClass?((n=Ni.toArray(o.useClass)).unshift(e),o.useClass=n):o.useClass=[e]);try{i=Reflect.getMetadata(f.ClassOptionSymbol,e)}catch(t){}(i=pr(pr({},i||{}),o)).token?((r=Ni.toArray(i.token)).unshift(e),i.token=r):i.token=[e],l.resolveOption(t,i)}catch(t){}}},{key:"resolveOption",value:function(e,t){t=pr(pr({},l.globalConfig),t),n=Ni.toArray(t.token),i=Ni.toArray(t.useClass),r=Ni.toArray(t.useDynamic),o=Ni.toArray(t.useFactory),a=Ni.toArray(t.contrib),s=t.lifecycle||f.Lifecycle.transient,n={token:n,useClass:i,lifecycle:0<a.length?f.Lifecycle.singleton:s,contrib:a,useDynamic:r,useFactory:o},"useValue"in t&&(n.useValue=t.useValue);var n,i,r,o,a,s,u=n;(0!==u.useClass.length||0!==u.useDynamic.length||0!==u.useFactory.length||"useValue"in u)&&u.token.forEach(function(t){new l(e,t,pr({},u)).resolve()})}}],(e=[{key:"resolve",value:function(){var t,e=this,n=this.register;(t=n)&&"object"===er(t)&&"bind"in t&&"unbind"in t&&"rebind"in t&&"isBound"in t&&(this.mutiple?this.resolveMutilple(n):(this.resolveMono(n),!this.named&&0<this.option.contrib.length&&this.option.contrib.forEach(function(t){(Ni.isMultipleEnabled(t)?rr:or)(t,n).toService(e.generalToken)})))}},{key:"resolveMono",value:function(t){return"useValue"in this.option?or(this.generalToken,t).toConstantValue(this.option.useValue):0<this.option.useDynamic.length?(e=this.option.useDynamic[this.option.useDynamic.length-1],nr(or(this.generalToken,t).toDynamicValue(function(t){t=Ir.getContainer(t.container);return e({container:t})}),this.option)):0<this.option.useFactory.length?(n=this.option.useFactory[this.option.useFactory.length-1],or(this.generalToken,t).toFactory(function(t){t=Ir.getContainer(t.container);return n({container:t})})):0<this.option.useClass.length?(i=this.option.useClass[this.option.useClass.length-1],nr(or(this.generalToken,t).to(i),this.option)):void 0;var e,n,i}},{key:"resolveMutilple",value:function(n){var i=this,t=this.option.useClass.map(function(t){return nr(rr(i.generalToken,n).to(t),i.option)}),e=this.option.useDynamic.map(function(e){return nr(rr(i.generalToken,n).toDynamicValue(function(t){t=Ir.getContainer(t.container);return e({container:t})}),i.option)}),r=this.option.useFactory.map(function(e){return rr(i.generalToken,n).toFactory(function(t){t=Ir.getContainer(t.container);return e({container:t})})}),o="useValue"in this.option?rr(this.generalToken,n).toConstantValue(this.option.useValue):void 0;this.named&&(t.forEach(function(t){return i.named&&ir(t,i.named)}),e.forEach(function(t){return i.named&&ir(t,i.named)}),r.forEach(function(t){return i.named&&ir(t,i.named)}),o&&ir(o,this.named))}}])&&fr(t.prototype,e),n&&fr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(),vr=(yr.globalConfig=f.DefaultOption,f.defineToken("ContributionProvider"));function gr(t){return function(t){if(Array.isArray(t))return mr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return mr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function br(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function kr(i){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?br(Object(r),!0).forEach(function(t){var e,n;e=i,n=r[t=t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):br(Object(r)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(r,t))})}return i}function xr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var wr=function(){function i(t,e,n){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.option={recursive:!1,cache:!0},this.services=void 0,this.serviceIdentifier=void 0,this.container=void 0,this.container=e,this.serviceIdentifier=t,n&&(this.option=kr(kr({},this.option),n))}var t,e,n;return t=i,(e=[{key:"setServices",value:function(t){for(var e,n=[],i=this.container;i;)i.isBound(this.serviceIdentifier)&&(e=i.getAll(this.serviceIdentifier),n.push.apply(n,gr(e))),i=t?i.parent:void 0;return n}},{key:"getContributions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=kr(kr({},this.option),t),e=t.cache,t=t.recursive;return e&&void 0!==this.services||(this.services=this.setServices(!!t)),this.services}}])&&xr(t.prototype,e),n&&xr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Sr(t,e,n){t({token:{token:vr,named:e},useDynamic:function(t){return new wr(e,t.container,n)},lifecycle:f.Lifecycle.singleton})}function Er(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Tr=function(){function e(t){var a=this;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.id=void 0,this.inversifyModule=void 0,this.baseRegistry=void 0,this.optionCollection=void 0,this.inversifyRegister=function(t,e,n,i){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Ni.isInjectOption(t)?yr.resolveOption(o,t):yr.resolveTarget(o,t,e)}var o={bind:t,unbind:e,isBound:n,rebind:i};a.baseRegistry&&a.baseRegistry(r),a.optionCollection&&a.optionCollection.forEach(function(t){return r(t)})},this.baseRegistry=t,this.inversifyModule=new Kt.ContainerModule(this.inversifyRegister),this.id=this.inversifyModule.id}var t,n,i;return t=e,(n=[{key:"options",get:function(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}},{key:"register",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach(function(t){return e.options.push(t)}),this}},{key:"contribution",value:function(){for(var i=this,t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.forEach(function(t){return i.options.push({token:{token:vr,named:e=t},useDynamic:function(t){return new wr(e,t.container,n)},lifecycle:f.Lifecycle.singleton});var e,n}),this}}])&&Er(t.prototype,n),i&&Er(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _r(t){return t&&"inversifyModule"in t}function Mr(t){return new Tr(t)}function Pr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Or(i){return function(t,e,n){Kt.named(ar(i))(t,e,n),v(vr)(t,e,n)}}var Cr,Ar,Nr,Lr=new Map,Ir=function(){function n(t){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this.loadedModules=[],this.container=void 0,this.inversify=!0,this.parent=void 0,this.container=t||new Kt.Container,n.setContainer(this.container,this)}var t,e,i;return t=n,i=[{key:"setContainer",value:function(t,e){return Lr.set(t.id,e)}},{key:"getContainer",value:function(t){var e=Lr.get(t.id);return e||(e=new n(t),n.setContainer(t,e),e)}},{key:"config",value:function(t){yr.globalConfig=t}}],(e=[{key:"load",value:function(t,e){var n=this;return e||!this.loadedModules.includes(t.id)?(_r(t)&&this.container.load(t.inversifyModule),this.loadedModules.push(t.id),{dispose:function(){n.unload(t)}}):(console.warn("Unsupported module."),{dispose:function(){}})}},{key:"unload",value:function(e){_r(e)&&(this.container.unload(e.inversifyModule),this.loadedModules=this.loadedModules.filter(function(t){return t!==e.id}))}},{key:"remove",value:function(t){return this.container.unbind(sr(t))}},{key:"get",value:function(t){return this.container.get(sr(t))}},{key:"getNamed",value:function(t,e){return this.container.getNamed(sr(t),ar(e))}},{key:"getAll",value:function(t){return this.container.getAll(sr(t))}},{key:"getAllNamed",value:function(t,e){return this.container.getAllNamed(sr(t),ar(e))}},{key:"isBound",value:function(t){return this.container.isBound(sr(t))}},{key:"isBoundNamed",value:function(t,e){return this.container.isBoundNamed(sr(t),ar(e))}},{key:"createChild",value:function(){var t=new n(this.container.createChild());return t.parent=this,t}},{key:"register",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Ni.isInjectOption(t)?yr.resolveOption(this.container,t):yr.resolveTarget(this.container,t,e)}}])&&Pr(t.prototype,e),i&&Pr(t,i),Object.defineProperty(t,"prototype",{writable:!1}),n}(),Dr=new Ir(r),Rr=(Dr.register.bind(Dr),(Vt=Cr=Cr||{}).Provider=vr,Vt.register=Sr,{exports:{}});function jr(){}function Br(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function Fr(t,e,n,i,r){if("function"!=typeof n)throw new TypeError("The listener must be a function");n=new Br(n,i||t,r),i=Nr?Nr+e:e;return t._events[i]?t._events[i].fn?t._events[i]=[t._events[i],n]:t._events[i].push(n):(t._events[i]=n,t._eventsCount++),t}function zr(t,e){0==--t._eventsCount?t._events=new jr:delete t._events[e]}function Vr(){this._events=new jr,this._eventsCount=0}Gt=Rr,Ar=Object.prototype.hasOwnProperty,Nr="~",Object.create&&(jr.prototype=Object.create(null),(new jr).__proto__||(Nr=!1)),Vr.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)Ar.call(t,e)&&n.push(Nr?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},Vr.prototype.listeners=function(t){var t=Nr?Nr+t:t,e=this._events[t];if(!e)return[];if(e.fn)return[e.fn];for(var n=0,i=e.length,r=new Array(i);n<i;n++)r[n]=e[n].fn;return r},Vr.prototype.listenerCount=function(t){t=Nr?Nr+t:t,t=this._events[t];return t?t.fn?1:t.length:0},Vr.prototype.emit=function(t,e,n,i,r,o){var a=Nr?Nr+t:t;if(!this._events[a])return!1;var s,u=this._events[a],l=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,i),!0;case 5:return u.fn.call(u.context,e,n,i,r),!0;case 6:return u.fn.call(u.context,e,n,i,r,o),!0}for(d=1,s=new Array(l-1);d<l;d++)s[d-1]=arguments[d];u.fn.apply(u.context,s)}else for(var c,h=u.length,d=0;d<h;d++)switch(u[d].once&&this.removeListener(t,u[d].fn,void 0,!0),l){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,e);break;case 3:u[d].fn.call(u[d].context,e,n);break;case 4:u[d].fn.call(u[d].context,e,n,i);break;default:if(!s)for(c=1,s=new Array(l-1);c<l;c++)s[c-1]=arguments[c];u[d].fn.apply(u[d].context,s)}return!0},Vr.prototype.on=function(t,e,n){return Fr(this,t,e,n,!1)},Vr.prototype.once=function(t,e,n){return Fr(this,t,e,n,!0)},Vr.prototype.removeListener=function(t,e,n,i){t=Nr?Nr+t:t;if(!this._events[t])return this;if(!e)return zr(this,t),this;var r=this._events[t];if(r.fn)r.fn!==e||i&&!r.once||n&&r.context!==n||zr(this,t);else{for(var o=0,a=[],s=r.length;o<s;o++)(r[o].fn!==e||i&&!r[o].once||n&&r[o].context!==n)&&a.push(r[o]);a.length?this._events[t]=1===a.length?a[0]:a:zr(this,t)}return this},Vr.prototype.removeAllListeners=function(t){return t?(t=Nr?Nr+t:t,this._events[t]&&zr(this,t)):(this._events=new jr,this._eventsCount=0),this},Vr.prototype.off=Vr.prototype.removeListener,Vr.prototype.addListener=Vr.prototype.on,Vr.prefixed=Nr,Gt.exports=Vr.EventEmitter=Vr;var Hr=1e-6,Gr="undefined"!=typeof Float32Array?Float32Array:Array;function Wr(){var t=new Gr(9);return Gr!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Ur=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],e=e[8],h=n[0],d=n[1],p=n[2],f=n[3],y=n[4],v=n[5],g=n[6],m=n[7],n=n[8];return t[0]=h*i+d*a+p*l,t[1]=h*r+d*s+p*c,t[2]=h*o+d*u+p*e,t[3]=f*i+y*a+v*l,t[4]=f*r+y*s+v*c,t[5]=f*o+y*u+v*e,t[6]=g*i+m*a+n*l,t[7]=g*r+m*s+n*c,t[8]=g*o+m*u+n*e,t};function Yr(){var t=new Gr(16);return Gr!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function qr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Xr(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Kr(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],y=e[13],v=e[14],e=e[15],g=n*s-i*a,m=n*u-r*a,b=n*l-o*a,k=i*u-r*s,x=i*l-o*s,w=r*l-o*u,S=c*y-h*f,E=c*v-d*f,T=c*e-p*f,_=h*v-d*y,M=h*e-p*y,P=d*e-p*v,O=g*P-m*M+b*_+k*T-x*E+w*S;return O?(t[0]=(s*P-u*M+l*_)*(O=1/O),t[1]=(r*M-i*P-o*_)*O,t[2]=(y*w-v*x+e*k)*O,t[3]=(d*x-h*w-p*k)*O,t[4]=(u*T-a*P-l*E)*O,t[5]=(n*P-r*T+o*E)*O,t[6]=(v*b-f*w-e*m)*O,t[7]=(c*w-d*b+p*m)*O,t[8]=(a*M-s*T+l*S)*O,t[9]=(i*T-n*M-o*S)*O,t[10]=(f*x-y*b+e*g)*O,t[11]=(h*b-c*x-p*g)*O,t[12]=(s*E-a*_-u*S)*O,t[13]=(n*_-i*E+r*S)*O,t[14]=(y*m-f*k-v*g)*O,t[15]=(c*k-h*m+d*g)*O,t):null}function Zr(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],y=e[12],v=e[13],g=e[14],e=e[15],m=n[0],b=n[1],k=n[2],x=n[3];return t[0]=m*i+b*s+k*h+x*y,t[1]=m*r+b*u+k*d+x*v,t[2]=m*o+b*l+k*p+x*g,t[3]=m*a+b*c+k*f+x*e,m=n[4],b=n[5],k=n[6],x=n[7],t[4]=m*i+b*s+k*h+x*y,t[5]=m*r+b*u+k*d+x*v,t[6]=m*o+b*l+k*p+x*g,t[7]=m*a+b*c+k*f+x*e,m=n[8],b=n[9],k=n[10],x=n[11],t[8]=m*i+b*s+k*h+x*y,t[9]=m*r+b*u+k*d+x*v,t[10]=m*o+b*l+k*p+x*g,t[11]=m*a+b*c+k*f+x*e,m=n[12],b=n[13],k=n[14],x=n[15],t[12]=m*i+b*s+k*h+x*y,t[13]=m*r+b*u+k*d+x*v,t[14]=m*o+b*l+k*p+x*g,t[15]=m*a+b*c+k*f+x*e,t}function $r(t,e,n){var i,r,o,a,s,u,l,c,h,d,p,f,y=n[0],v=n[1],n=n[2];e===t?(t[12]=e[0]*y+e[4]*v+e[8]*n+e[12],t[13]=e[1]*y+e[5]*v+e[9]*n+e[13],t[14]=e[2]*y+e[6]*v+e[10]*n+e[14],t[15]=e[3]*y+e[7]*v+e[11]*n+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=i*y+s*v+h*n+e[12],t[13]=r*y+u*v+d*n+e[13],t[14]=o*y+l*v+p*n+e[14],t[15]=a*y+c*v+f*n+e[15])}function Jr(t,e,n){var i=n[0],r=n[1],n=n[2];t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}function Qr(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function to(t,e){var n=e[0],i=e[1],r=e[2],o=e[4],a=e[5],s=e[6],u=e[8],l=e[9],e=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,l,e),t}function eo(t,e){var n=new Gr(3),i=(to(n,e),1/n[0]),r=1/n[1],n=1/n[2],o=e[0]*i,a=e[1]*r,s=e[2]*n,u=e[4]*i,l=e[5]*r,c=e[6]*n,i=e[8]*i,r=e[9]*r,e=e[10]*n,n=o+l+e,h=0;return 0<n?(h=2*Math.sqrt(1+n),t[3]=.25*h,t[0]=(c-r)/h,t[1]=(i-s)/h,t[2]=(a-u)/h):l<o&&e<o?(h=2*Math.sqrt(1+o-l-e),t[3]=(c-r)/h,t[0]=.25*h,t[1]=(a+u)/h,t[2]=(i+s)/h):e<l?(h=2*Math.sqrt(1+l-o-e),t[3]=(i-s)/h,t[0]=(a+u)/h,t[1]=.25*h,t[2]=(c+r)/h):(h=2*Math.sqrt(1+e-o-l),t[3]=(a-u)/h,t[0]=(i+s)/h,t[1]=(c+r)/h,t[2]=.25*h),t}function no(t,e,n,i,r){var o=e[0],a=e[1],s=e[2],e=e[3],u=o+o,l=a+a,c=s+s,h=o*u,d=o*l,o=o*c,p=a*l,a=a*c,s=s*c,u=e*u,l=e*l,e=e*c,c=i[0],f=i[1],i=i[2],y=r[0],v=r[1],r=r[2],g=(1-(p+s))*c,m=(d+e)*c,c=(o-l)*c,d=(d-e)*f,e=(1-(h+s))*f,s=(a+u)*f,f=(o+l)*i,o=(a-u)*i,l=(1-(h+p))*i;t[0]=g,t[1]=m,t[2]=c,t[3]=0,t[4]=d,t[5]=e,t[6]=s,t[7]=0,t[8]=f,t[9]=o,t[10]=l,t[11]=0,t[12]=n[0]+y-(g*y+d*v+f*r),t[13]=n[1]+v-(m*y+e*v+o*r),t[14]=n[2]+r-(c*y+s*v+l*r),t[15]=1}function io(t,e){var n=e[0],i=e[1],r=e[2],e=e[3],o=n+n,a=i+i,s=r+r,n=n*o,u=i*o,i=i*a,l=r*o,c=r*a,r=r*s,o=e*o,a=e*a,e=e*s;return t[0]=1-i-r,t[1]=u+e,t[2]=l-a,t[3]=0,t[4]=u-e,t[5]=1-n-r,t[6]=c+o,t[7]=0,t[8]=l+a,t[9]=c-o,t[10]=1-n-i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}var ro=function(t,e,n,i,r,o,a){var s=1/(e-n),u=1/(i-r),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*u,t[14]=(a+o)*l,t[15]=1,t};function oo(){var t=new Gr(3);return Gr!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ao(t){var e=new Gr(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function so(t){var e=t[0],n=t[1],t=t[2];return Math.hypot(e,n,t)}function g(t,e,n){var i=new Gr(3);return i[0]=t,i[1]=e,i[2]=n,i}function uo(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function lo(t,e,n,i){t[0]=e,t[1]=n,t[2]=i}function co(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function ho(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function po(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function fo(t,e){var n=e[0],i=e[1],r=e[2],n=n*n+i*i+r*r;0<n&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n}function yo(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function vo(t,e,n,i){var r=e[0],o=e[1],e=e[2];t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=e+i*(n[2]-e)}function go(t,e,n){var i=e[0],r=e[1],e=e[2],o=n[3]*i+n[7]*r+n[11]*e+n[15];return t[0]=(n[0]*i+n[4]*r+n[8]*e+n[12])/(o=o||1),t[1]=(n[1]*i+n[5]*r+n[9]*e+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*e+n[14])/o,t}function mo(t,e,n){var i=e[0],r=e[1],e=e[2];t[0]=i*n[0]+r*n[3]+e*n[6],t[1]=i*n[1]+r*n[4]+e*n[7],t[2]=i*n[2]+r*n[5]+e*n[8]}function bo(t,e){var n=t[0],i=t[1],t=t[2],r=e[0],o=e[1],e=e[2];return Math.abs(n-r)<=Hr*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-o)<=Hr*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(t-e)<=Hr*Math.max(1,Math.abs(t),Math.abs(e))}var ko=ho,xo=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],e=e[2]-t[2];return Math.hypot(n,i,e)},wo=so;function So(){var t=new Gr(4);return Gr!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Eo(t,e,n){var i=e[0],r=e[1],o=e[2],e=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*e,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*e,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*e,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*e,t}function To(){var t=new Gr(4);return Gr!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function _o(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function Mo(t,e,n){var i=e[0],r=e[1],o=e[2],e=e[3],a=n[0],s=n[1],u=n[2],n=n[3];return t[0]=i*n+e*a+r*u-o*s,t[1]=r*n+e*s+o*a-i*u,t[2]=o*n+e*u+i*s-r*a,t[3]=e*n-i*a-r*s-o*u,t}function Po(t,e){var n=e[0],i=e[1],r=e[2],e=e[3],o=n*n+i*i+r*r+e*e,o=o?1/o:0;return t[0]=-n*o,t[1]=-i*o,t[2]=-r*o,t[3]=e*o,t}function Oo(t,e,n,i){var r=.5*Math.PI/180,r=(e*=r,n*=r,i*=r,Math.sin(e)),e=Math.cos(e),o=Math.sin(n),n=Math.cos(n),a=Math.sin(i),i=Math.cos(i);t[0]=r*n*i-e*o*a,t[1]=e*o*i+r*n*a,t[2]=e*n*a-r*o*i,t[3]=e*n*i+r*o*a}oo(),So();var Co=function(t,e,n,i){var r=new Gr(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r},Ao=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},No=Mo,Lo=function(t,e){var n=e[0],i=e[1],r=e[2],e=e[3],o=n*n+i*i+r*r+e*e;return 0<o&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=e*o,t};function Io(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Do(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function Ro(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function jo(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function Bo(t,e){var n=e[0]-t[0],e=e[1]-t[1];return Math.hypot(n,e)}function Fo(t,e){var n=e[0],i=e[1],n=n*n+i*i;return 0<n&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t}oo(),g(1,0,0),g(0,1,0),To(),To(),Wr();var zo=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t};function Vo(t,e,n){(t.prototype=e.prototype=n).constructor=t}function Ho(t,e){var n,i=Object.create(t.prototype);for(n in e)i[n]=e[n];return i}function Go(){}re=new Gr(2),Gr!=Float32Array&&(re[0]=0,re[1]=0);var c="\\s*([+-]?\\d+)\\s*",d="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ve="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wo=/^#([0-9a-f]{3,8})$/,Uo=new RegExp("^rgb\\("+[c,c,c]+"\\)$"),Yo=new RegExp("^rgb\\("+[ve,ve,ve]+"\\)$"),qo=new RegExp("^rgba\\("+[c,c,c,d]+"\\)$"),Xo=new RegExp("^rgba\\("+[ve,ve,ve,d]+"\\)$"),Ko=new RegExp("^hsl\\("+[d,ve,ve]+"\\)$"),Zo=new RegExp("^hsla\\("+[d,ve,ve,d]+"\\)$"),$o={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Jo(){return this.rgb().formatHex()}function Qo(){return this.rgb().formatRgb()}function ta(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Wo.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ea(e):3===n?new ia(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?na(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?na(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Uo.exec(t))?new ia(e[1],e[2],e[3],1):(e=Yo.exec(t))?new ia(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=qo.exec(t))?na(e[1],e[2],e[3],e[4]):(e=Xo.exec(t))?na(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ko.exec(t))?sa(e[1],e[2]/100,e[3]/100,1):(e=Zo.exec(t))?sa(e[1],e[2]/100,e[3]/100,e[4]):$o.hasOwnProperty(t)?ea($o[t]):"transparent"===t?new ia(NaN,NaN,NaN,0):null}function ea(t){return new ia(t>>16&255,t>>8&255,255&t,1)}function na(t,e,n,i){return new ia(t=i<=0?e=n=NaN:t,e,n,i)}function ia(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function ra(){return"#"+aa(this.r)+aa(this.g)+aa(this.b)}function oa(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function aa(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function sa(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||1<=n?t=e=NaN:e<=0&&(t=NaN),new la(t,e,n,i)}function ua(t){if(t instanceof la)return new la(t.h,t.s,t.l,t.opacity);if(!(t=t instanceof Go?t:ta(t)))return new la;if(t instanceof la)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),a=NaN,s=o-r,u=(o+r)/2;return s?(a=e===o?(n-i)/s+6*(n<i):n===o?(i-e)/s+2:(e-n)/s+4,s/=u<.5?o+r:2-o-r,a*=60):s=0<u&&u<1?0:a,new la(a,s,u,t.opacity)}function la(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function ca(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function ha(t){return function(t){if(Array.isArray(t))return da(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return da(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?da(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function da(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function pa(t,e,n,i){t-=n,n=e-i;return Math.sqrt(t*t+n*n)}function fa(t,e){return Math.abs(t-e)<.001}function ya(t,e){var n=Math.min.apply(Math,ha(t)),i=Math.min.apply(Math,ha(e));return{x:n,y:i,width:Math.max.apply(Math,ha(t))-n,height:Math.max.apply(Math,ha(e))-i}}Vo(Go,ta,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Jo,formatHex:Jo,formatHsl:function(){return ua(this).formatHsl()},formatRgb:Qo,toString:Qo}),Vo(ia,function(t,e,n,i){return 1===arguments.length?(r=(r=t)instanceof Go?r:ta(r))?new ia((r=r.rgb()).r,r.g,r.b,r.opacity):new ia:new ia(t,e,n,null==i?1:i);var r},Ho(Go,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ia(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ia(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ra,formatHex:ra,formatRgb:oa,toString:oa})),Vo(la,function(t,e,n,i){return 1===arguments.length?ua(t):new la(t,e,n,null==i?1:i)},Ho(Go,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new la(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new la(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,e=n+(n<.5?n:1-n)*e,n=2*n-e;return new ia(ca(240<=t?t-240:120+t,n,e),ca(t,n,e),ca(t<120?240+t:t-120,n,e),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var va={box:function(t,e,n,i){return ya([t,n],[e,i])},length:pa,pointAt:function(t,e,n,i,r){return{x:(1-r)*t+r*n,y:(1-r)*e+r*i}},pointDistance:function(t,e,n,i,r,o){var a=(n-t)*(r-t)+(i-e)*(o-e);return a<0?pa(t,e,r,o):(n-t)*(n-t)+(i-e)*(i-e)<a?pa(n,i,r,o):this.pointToLine(t,e,n,i,r,o)},pointToLine:function(t,e,n,i,r,o){n=[n-t,i-e];if((i=n)[0]===(a=[0,0])[0]&&i[1]===a[1])return Math.sqrt((r-t)*(r-t)+(o-e)*(o-e));var i=[-n[1],n[0]],a=(Fo(i,i),[r-t,o-e]);return Math.abs(a[0]*i[0]+a[1]*i[1])},tangentAngle:function(t,e,n,i){return Math.atan2(i-e,n-t)}};function ga(t,e,n,i,r){var o=1-r;return o*o*o*t+3*e*r*o*o+3*n*r*r*o+i*r*r*r}function ma(t,e,n,i,r){var o=1-r;return 3*(o*o*(e-t)+2*o*r*(n-e)+r*r*(i-n))}function ba(t,e,n,i){var r,o,i=-3*t+9*e-9*n+3*i,n=6*t-12*e+6*n,e=3*e-3*t,t=[];return fa(i,0)?fa(n,0)||0<=(r=-e/n)&&r<=1&&t.push(r):fa(e=n*n-4*i*e,0)?t.push(-n/(2*i)):0<e&&(o=(-n-(e=Math.sqrt(e)))/(2*i),0<=(r=(-n+e)/(2*i))&&r<=1&&t.push(r),0<=o&&o<=1&&t.push(o)),t}function ka(t,e,n,i,r,o,a,s,u){var l=ga(t,n,r,a,u),c=ga(e,i,o,s,u),h=va.pointAt(t,e,n,i,u),n=va.pointAt(n,i,r,o,u),i=va.pointAt(r,o,a,s,u),r=va.pointAt(h.x,h.y,n.x,n.y,u),o=va.pointAt(n.x,n.y,i.x,i.y,u);return[[t,e,h.x,h.y,r.x,r.y,l,c],[l,c,o.x,o.y,i.x,i.y,a,s]]}function xa(t,e,n,i,r,o,a,s,u){if(0===u){for(var l=[t,n,r,a],c=[e,i,o,s],h=0,d=l.length,p=0;p<d;p++)h+=pa(l[p],c[p],l[(p+1)%d],c[(p+1)%d]);return h/2}t=ka(t,e,n,i,r,o,a,s,.5),e=[].concat(ha(t[0]),[u-1]),n=[].concat(ha(t[1]),[u-1]);return xa.apply(void 0,ha(e))+xa.apply(void 0,ha(n))}var wa={extrema:ba,box:function(t,e,n,i,r,o,a,s){for(var u=[t,a],l=[e,s],c=ba(t,n,r,a),h=ba(e,i,o,s),d=0;d<c.length;d++)u.push(ga(t,n,r,a,c[d]));for(var p=0;p<h.length;p++)l.push(ga(e,i,o,s,h[p]));return ya(u,l)},length:function(t,e,n,i,r,o,a,s){return xa(t,e,n,i,r,o,a,s,3)},nearestPoint:function(t,e,n,i,r,o,a,s,u,l,c){for(var h=[t,n,r,a],d=[e,i,o,s],t=u,p=ga,n=c,f=-1,y=1/0,v=[t,l],g=20,m=1/(g=n&&200<n?n/10:g),b=m/10,k=0;k<=g;k++){var x=k*m,w=[p.apply(void 0,ha(h.concat([x]))),p.apply(void 0,ha(d.concat([x])))],w=pa(v[0],v[1],w[0],w[1]);w<y&&(f=x,y=w)}if(0===f)return{x:h[0],y:d[0]};if(1===f)return{x:h[(t=h.length)-1],y:d[t-1]};for(var y=1/0,S=0;S<32&&!(b<1e-4);S++){var E=f-b,T=f+b,_=[p.apply(void 0,ha(h.concat([E]))),p.apply(void 0,ha(d.concat([E])))],_=pa(v[0],v[1],_[0],_[1]);0<=E&&_<y?(f=E,y=_):(E=[p.apply(void 0,ha(h.concat([T]))),p.apply(void 0,ha(d.concat([T])))],_=pa(v[0],v[1],E[0],E[1]),T<=1&&_<y?(f=T,y=_):b*=.5)}return{x:p.apply(void 0,ha(h.concat([f]))),y:p.apply(void 0,ha(d.concat([f])))}},pointDistance:function(t,e,n,i,r,o,a,s,u,l,c){t=this.nearestPoint(t,e,n,i,r,o,a,s,u,l,c);return pa(t.x,t.y,u,l)},interpolationAt:ga,pointAt:function(t,e,n,i,r,o,a,s,u){return{x:ga(t,n,r,a,u),y:ga(e,i,o,s,u)}},divide:ka,tangentAngle:function(t,e,n,i,r,o,a,s,u){t=ma(t,n,r,a,u),n=ma(e,i,o,s,u);return(Math.atan2(n,t)+2*Math.PI)%(2*Math.PI)}};var Sa=function(t){var e=t;if(e.length<2)return 0;for(var n=0,i=0;i<e.length-1;i++){var r=e[i],o=e[i+1];n+=pa(r[0],r[1],o[0],o[1])}return n},Ea=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/gi,Ta=/[^\s,]+/gi;var _a=new RegExp("([a-z])[\\s,]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[\\s]*,?[\\s]*)+)","ig"),Ma=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[\\s]*,?[\\s]*","ig");var Pa=/[a-z]/;function Oa(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}function Ca(t){var o,a,e="string"==typeof(t=t)?t?(o={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},a=[],t.replace(_a,function(t,e,n){var i=[],r=e.toLowerCase();if(n.replace(Ma,function(t,e){e&&i.push(+e)}),"m"===r&&2<i.length&&(a.push([e].concat(i.splice(0,2))),r="l",e="m"===e?"l":"L"),"o"===r&&1===i.length&&a.push([e,i[0]]),"r"===r)a.push([e].concat(i));else for(;i.length>=o[r]&&(a.push([e].concat(i.splice(0,o[r]))),o[r]););return""}),a):null:Array.isArray(t)?t:void 0;if(!e||!e.length)return[["M",0,0]];for(var n=!1,i=0;i<e.length;i++){var r=e[i][0];if(Pa.test(r)||0<=["V","H","T","S"].indexOf(r)){n=!0;break}}if(!n)return e;var s=[],u=0,l=0,c=0,h=0,t=0,d=e[0];"M"!==d[0]&&"m"!==d[0]||(c=u=+d[1],h=l=+d[2],t++,s[0]=["M",u,l]);for(var i=t,p=e.length;i<p;i++){var f=e[i],y=s[i-1],v=[],g=(r=f[0]).toUpperCase();if(r!==g)switch(v[0]=g){case"A":v[1]=f[1],v[2]=f[2],v[3]=f[3],v[4]=f[4],v[5]=f[5],v[6]=+f[6]+u,v[7]=+f[7]+l;break;case"V":v[1]=+f[1]+l;break;case"H":v[1]=+f[1]+u;break;case"M":c=+f[1]+u,h=+f[2]+l,v[1]=c,v[2]=h;break;default:for(var m=1,b=f.length;m<b;m++)v[m]=+f[m]+(m%2?u:l)}else v=e[i];switch(g){case"Z":u=+c,l=+h;break;case"H":v=["L",u=v[1],l];break;case"V":v=["L",u,l=v[1]];break;case"T":var u=v[1],l=v[2],k=Oa([y[1],y[2]],[y[3],y[4]]),v=["Q",k[0],k[1],u,l];break;case"S":u=v[v.length-2],l=v[v.length-1];var k=y.length,x=Oa([y[k-4],y[k-3]],[y[k-2],y[k-1]]);v=["C",x[0],x[1],v[1],v[2],u,l];break;case"M":c=v[v.length-2],h=v[v.length-1];break;default:u=v[v.length-2],l=v[v.length-1]}s.push(v)}return s}function Aa(t,e,n,i){var r=t*n+e*i;return(r=1<r?1:r)<-1&&(r=-1),(t*i-e*n<0?-1:1)*Math.acos(r)}var Na=2*Math.PI,La=function(t,e,n,i,r,o,a){var s=t.x,t=t.y;return{x:i*(s*=e)-r*(t*=n)+o,y:r*s+i*t+a}},Ia=function(t,e){var n=1.5707963267948966===e?.551915024494:-1.5707963267948966===e?-.551915024494:4/3*Math.tan(e/4),i=Math.cos(t),r=Math.sin(t),o=Math.cos(t+e),t=Math.sin(t+e);return[{x:i-r*n,y:r+i*n},{x:o+t*n,y:t-o*n},{x:o,y:t}]},Da=function(t,e,n,i,r,o,a,s,u,l,c,h){var d=Math.pow(r,2),p=Math.pow(o,2),f=Math.pow(c,2),y=Math.pow(h,2),v=d*p-d*y-p*f,d=(v<0&&(v=0),v/=d*y+p*f,(v=Math.sqrt(v)*(a===s?-1:1))*r/o*h),y=v*-o/r*c,p=l*d-u*y+(t+n)/2,f=u*d+l*y+(e+i)/2,a=(c-d)/r,v=(h-y)/o,t=(-c-d)/r,n=(-h-y)/o,u=Aa(1,0,a,v),l=Aa(a,v,t,n);return 0===s&&0<l&&(l-=Na),1===s&&l<0&&(l+=Na),[p,f,u,l]};function Ra(t,e,n,i,r,o,a,s,u){return function(t){var e=t.px,n=t.py,i=t.cx,r=t.cy,o=t.rx,a=t.ry,s=t.xAxisRotation,s=void 0===s?0:s,u=t.largeArcFlag,u=void 0===u?0:u,t=t.sweepFlag,t=void 0===t?0:t,l=[];if(0===o||0===a)return[{x1:0,y1:0,x2:0,y2:0,x:i,y:r}];var c=Math.sin(s*Na/360),h=Math.cos(s*Na/360),s=h*(e-i)/2+c*(n-r)/2,d=-c*(e-i)/2+h*(n-r)/2;if(0==s&&0==d)return[{x1:0,y1:0,x2:0,y2:0,x:i,y:r}];var o=Math.abs(o),a=Math.abs(a),p=Math.pow(s,2)/Math.pow(o,2)+Math.pow(d,2)/Math.pow(a,2),p=(1<p&&(o*=Math.sqrt(p),a*=Math.sqrt(p)),Da(e,n,i,r,o,a,u,t,c,h,s,d)),f=p[0],y=p[1],v=p[2],g=p[3],e=Math.abs(g)/(Na/4),m=(Math.abs(1-e)<1e-7&&(e=1),Math.max(Math.ceil(e),1));g/=m;for(var b=0;b<m;b++)l.push(Ia(v,g)),v+=g;return l.map(function(t){var e=La(t[0],o,a,h,c,f,y),n=e.x,e=e.y,i=La(t[1],o,a,h,c,f,y),r=i.x,i=i.y,t=La(t[2],o,a,h,c,f,y);return{x1:n,y1:e,x2:r,y2:i,x:t.x,y:t.y}})}({px:t,py:e,cx:s,cy:u,rx:n,ry:i,xAxisRotation:r,largeArcFlag:o,sweepFlag:a}).reduce(function(t,e){var n=e.x1,i=e.y1,r=e.x2,o=e.y2,a=e.x,e=e.y;return t.push(n,i,r,o,a,e),t},[])}function ja(t,e,n,i){return[t,e,n,i,n,i]}function Ba(t,e){"TQ".indexOf(t[0])<0&&(e.qx=null,e.qy=null);var n=t.slice(1),i=n[0],r=n[1];switch(t[0]){case"M":return e.x=i,e.y=r,t;case"A":return["C"].concat(Ra.apply(0,[e.x1,e.y1].concat(t.slice(1))));case"Q":return e.qx=i,e.qy=r,["C"].concat(function(t,e,n,i,r,o){return[1/3*t+2/3*n,1/3*e+2/3*i,1/3*r+2/3*n,1/3*o+2/3*i,r,o]}.apply(0,[e.x1,e.y1].concat(t.slice(1))));case"L":return["C"].concat(ja(e.x1,e.y1,t[1],t[2]));case"H":return["C"].concat(ja(e.x1,e.y1,t[1],e.y1));case"V":return["C"].concat(ja(e.x1,e.y1,e.x1,t[1]));case"Z":return["C"].concat(ja(e.x1,e.y1,e.x,e.y))}return t}var m,Fa=Math.PI/180;function za(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Va(t,e){return za(t)*za(e)?(t[0]*e[0]+t[1]*e[1])/(za(t)*za(e)):1}function Ha(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Va(t,e))}function Ga(t,e){return t[0]===e[0]&&t[1]===e[1]}function Wa(t,e){var n=e[1],i=e[2],r=(r=e[3],r=Fa*r,o=2*Math.PI,(r%o+o)%o),o=e[4],a=e[5],s=t[0],u=t[1],l=e[6],e=e[7],c=Math.cos(r)*(s-l)/2+Math.sin(r)*(u-e)/2,h=-1*Math.sin(r)*(s-l)/2+Math.cos(r)*(u-e)/2,d=c*c/(n*n)+h*h/(i*i),d=(1<d&&(n*=Math.sqrt(d),i*=Math.sqrt(d)),n*n*(h*h)+i*i*(c*c)),d=d?Math.sqrt((n*n*(i*i)-d)/d):1,p=(o===a&&(d*=-1),isNaN(d)&&(d=0),i?d*n*h/i:0),d=n?d*-i*c/n:0,s=(s+l)/2+Math.cos(r)*p-Math.sin(r)*d,u=(u+e)/2+Math.sin(r)*p+Math.cos(r)*d,f=[(c-p)/n,(h-d)/i],c=[(-1*c-p)/n,(-1*h-d)/i],p=Ha([1,0],f),h=Ha(f,c);return Va(f,c)<=-1&&(h=Math.PI),1<=Va(f,c)&&(h=0),0===a&&0<h&&(h-=2*Math.PI),1===a&&h<0&&(h+=2*Math.PI),{cx:s,cy:u,rx:Ga(t,[l,e])?0:n,ry:Ga(t,[l,e])?0:i,startAngle:p,endAngle:p+h,xRotation:r,arcFlag:o,sweepFlag:a}}function Ua(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}function Ya(t){i=t||[];for(var i,e=[],n=null,r=null,o=null,a=0,s=(t=Array.isArray(i)?i:"string"==typeof i?((i=i.match(Ea)).forEach(function(n,t){var e;1<(n=n.match(Ta))[0].length&&(e=n[0].charAt(0),n.splice(1,0,n[0].substr(1)),n[0]=e),n.forEach(function(t,e){isNaN(t)||(n[e]=+t)}),i[t]=n}),i):void 0).length,u=0;u<s;u++){var l=t[u],r=t[u+1],c=l[0],h={command:c,prePoint:n,params:l,startTangent:null,endTangent:null};switch(c){case"M":o=[l[1],l[2]],a=u;break;case"A":var d=Wa(n,l);h.arcParams=d}"Z"===c?(n=o,r=t[a+1]):n=[l[(T=l.length)-2],l[T-1]],r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),h.currentPoint=n,e[a]&&Ga(n,e[a].currentPoint)&&(e[a].prePoint=h.prePoint);var p,f,y,v,g,m,b,k,x,w,S,E,T=r?[r[r.length-2],r[r.length-1]]:null,_=(h.nextPoint=T,h.prePoint);["L","H","V"].includes(c)?(h.startTangent=[_[0]-n[0],_[1]-n[1]],h.endTangent=[n[0]-_[0],n[1]-_[1]]):"Q"===c?(p=[l[1],l[2]],h.startTangent=[_[0]-p[0],_[1]-p[1]],h.endTangent=[n[0]-p[0],n[1]-p[1]]):"T"===c?(p=Ua((f=e[u-1]).currentPoint,_),"Q"===f.command?(h.command="Q",h.startTangent=[_[0]-p[0],_[1]-p[1]],h.endTangent=[n[0]-p[0],n[1]-p[1]]):(h.command="TL",h.startTangent=[_[0]-n[0],_[1]-n[1]],h.endTangent=[n[0]-_[0],n[1]-_[1]])):"C"===c?(y=[l[1],l[2]],v=[l[3],l[4]],h.startTangent=[_[0]-y[0],_[1]-y[1]],h.endTangent=[n[0]-v[0],n[1]-v[1]],0===h.startTangent[0]&&0===h.startTangent[1]&&(h.startTangent=[y[0]-v[0],y[1]-v[1]]),0===h.endTangent[0]&&0===h.endTangent[1]&&(h.endTangent=[v[0]-y[0],v[1]-y[1]])):"S"===c?(y=Ua((f=e[u-1]).currentPoint,_),v=[l[1],l[2]],"C"===f.command?(h.command="C",h.startTangent=[_[0]-y[0],_[1]-y[1]]):(h.command="SQ",h.startTangent=[_[0]-v[0],_[1]-v[1]]),h.endTangent=[n[0]-v[0],n[1]-v[1]]):"A"===c&&(c=.001,g=void 0===(g=(w=h.arcParams||{}).cx)?0:g,m=void 0===(m=w.cy)?0:m,S=w.rx,b=void 0===(b=w.ry)?0:b,k=w.sweepFlag,x=void 0===(x=w.startAngle)?0:x,w=void 0===(w=w.endAngle)?0:w,0===(void 0===k?0:k)&&(c*=-1),S=(k=void 0===S?0:S)*Math.cos(x-c)+g,E=b*Math.sin(x-c)+m,h.startTangent=[S-o[0],E-o[1]],S=k*Math.cos(x+w+c)+g,E=b*Math.sin(x+w-c)+m,h.endTangent=[_[0]-S,_[1]-E]),e.push(h)}return e}let qa=1;const Xa="object"==typeof self&&self.self==self?self:"object"==typeof Mt&&Mt.global==Mt?Mt:{},Ka=Date.now();let Za={},$a=Date.now();const Ja=t=>"string"!=typeof t?t=>{if("function"!=typeof t)throw new TypeError(t+" is not a function");const n=Date.now(),e=n-$a,i=16<e?0:16-e,r=qa++;return Za[r]=t,1<Object.keys(Za).length||setTimeout(()=>{$a=n;const e=Za;Za={},Object.keys(e).forEach(t=>e[t](Xa.performance&&"function"==typeof Xa.performance.now?Xa.performance.now():Date.now()-Ka))},i),r}:""===t?Xa.requestAnimationFrame:Xa[t+"RequestAnimationFrame"],Qa=((t,e)=>{let n=0;for(;void 0!==t[n];){if(e(t[n]))return t[n];n+=1}})(["","webkit","moz","ms","o"],t=>!!Ja(t)),ts=Ja(Qa),es="string"!=typeof(ge=Qa)?t=>{delete Za[t]}:""===ge?Xa.cancelAnimationFrame:Xa[ge+"CancelAnimationFrame"]||Xa[ge+"CancelRequestAnimationFrame"];function ns(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function is(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ns(Object(n),!0).forEach(function(t){us(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ns(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function S(){S=function(){return a};var a={},t=Object.prototype,u=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",r=e.toStringTag||"@@toStringTag";function o(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(t){o=function(t,e,n){return t[e]=n}}function s(t,e,n,i){var r,o,a,s,e=e&&e.prototype instanceof h?e:h,e=Object.create(e.prototype),i=new k(i||[]);return e._invoke=(r=t,o=n,a=i,s="suspendedStart",function(t,e){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===t)throw e;return w()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){n=function t(e,n){var i=e.iterator[n.method];if(void 0===i){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=void 0,t(e,n),"throw"===n.method))return c;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}i=l(i,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,c;i=i.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,c):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,c)}(n,a);if(n){if(n===c)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";n=l(r,o,a);if("normal"===n.type){if(s=a.done?"completed":"suspendedYield",n.arg===c)continue;return{value:n.arg,done:a.done}}"throw"===n.type&&(s="completed",a.method="throw",a.arg=n.arg)}}),e}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}a.wrap=s;var c={};function h(){}function d(){}function p(){}var e={},f=(o(e,i,function(){return this}),Object.getPrototypeOf),f=f&&f(f(x([]))),y=(f&&f!==t&&u.call(f,i)&&(e=f),p.prototype=h.prototype=Object.create(e));function v(t){["next","throw","return"].forEach(function(e){o(t,e,function(t){return this._invoke(e,t)})})}function g(a,s){var e;this._invoke=function(n,i){function t(){return new s(function(t,e){!function e(t,n,i,r){var o,t=l(a[t],a,n);if("throw"!==t.type)return(n=(o=t.arg).value)&&"object"==typeof n&&u.call(n,"__await")?s.resolve(n.__await).then(function(t){e("next",t,i,r)},function(t){e("throw",t,i,r)}):s.resolve(n).then(function(t){o.value=t,i(o)},function(t){return e("throw",t,i,r)});r(t.arg)}(n,i,t,e)})}return e=e?e.then(t,t):t()}}function m(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(m,this),this.reset(!0)}function x(e){if(e){var n,t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:w}}function w(){return{value:void 0,done:!0}}return o(y,"constructor",d.prototype=p),o(p,"constructor",d),d.displayName=o(p,r,"GeneratorFunction"),a.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,o(t,r,"GeneratorFunction")),t.prototype=Object.create(y),t},a.awrap=function(t){return{__await:t}},v(g.prototype),o(g.prototype,n,function(){return this}),a.AsyncIterator=g,a.async=function(t,e,n,i,r){void 0===r&&(r=Promise);var o=new g(s(t,e,n,i),r);return a.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},v(y),o(y,r,"Generator"),o(y,i,function(){return this}),o(y,"toString",function(){return"[object Generator]"}),a.keys=function(n){var t,i=[];for(t in n)i.push(t);return i.reverse(),function t(){for(;i.length;){var e=i.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=x,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function t(t,e){return o.type="throw",o.arg=n,i.next=t,e&&(i.method="next",i.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e],o=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var a=u.call(r,"catchLoc"),s=u.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&u.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}var o=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc?null:r)?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,c):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,i,r=this.tryEntries[e];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(i=n.arg,b(r)),i}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},a}function rs(t){return(rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function os(t,e,n,i,r,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,r)}function as(s){return function(){var t=this,a=arguments;return new Promise(function(e,n){var i=s.apply(t,a);function r(t){os(i,e,n,r,o,"next",t)}function o(t){os(i,e,n,r,o,"throw",t)}r(void 0)})}}function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ss(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function w(t,e,n){return e&&ss(t.prototype,e),n&&ss(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function us(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cs(t,e)}function ls(t){return(ls=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cs(t,e){return(cs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function ds(t,e,n){return(ds=hs()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);e=new(Function.bind.apply(t,i));return n&&cs(e,n.prototype),e}).apply(null,arguments)}function ps(t,e){if(null==t)return{};var n,i=function(t,e){if(null==t)return{};for(var n,i={},r=Object.keys(t),o=0;o<r.length;o++)n=r[o],0<=e.indexOf(n)||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(t),o=0;o<r.length;o++)n=r[o],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n]);return i}function fs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M(n){var i=hs();return function(){var t,e=ls(n),e=(t=i?(t=ls(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fs(e)}}function ys(){return(ys="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ls(t)););return t}(t,e);if(i)return i=Object.getOwnPropertyDescriptor(i,e),i.get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function vs(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||ms(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gs(t){return function(t){if(Array.isArray(t))return bs(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ms(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ms(t,e){if(t){if("string"==typeof t)return bs(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bs(t,e):void 0}}function bs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function ks(t,e){var n,i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=ms(t))||e&&t&&"number"==typeof t.length)return i&&(t=i),n=0,{s:e=function(){},n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){a=!0,r=t},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw r}}}}Xa.requestAnimationFrame=ts,Xa.cancelAnimationFrame=es,"undefined"!=typeof module&&module.exports&&(module.exports={requestAnimationFrame:ts,cancelAnimationFrame:es}),(i=m=m||{}).GROUP="g",i.CIRCLE="circle",i.ELLIPSE="ellipse",i.IMAGE="image",i.RECT="rect",i.LINE="line",i.POLYLINE="polyline",i.POLYGON="polygon",i.TEXT="text",i.PATH="path",i.HTML="html",i.MESH="mesh";var C,xs=f.defineToken("CanvasConfig"),ws=function(){function t(){x(this,t),this.pool={},this.htmlPool=[]}return w(t,[{key:"getByEntity",value:function(t){return this.pool[t]}},{key:"add",value:function(t,e){(this.pool[t]=e).nodeName===m.HTML&&this.htmlPool.push(e)}},{key:"remove",value:function(t){var e=this.pool[t];delete this.pool[t],e.nodeName===m.HTML&&(t=this.htmlPool.indexOf(e),this.htmlPool.splice(t,1))}},{key:"getHTMLs",value:function(){return this.htmlPool}}]),t}(),ws=e([y()],ws),Ss=((Ht=C=C||{}).DESTROY="destroy",Ht.ATTR_MODIFIED="DOMAttrModified",Ht.INSERTED="DOMNodeInserted",Ht.CHILD_INSERTED="child-inserted",Ht.REMOVED="removed",Ht.CHILD_REMOVED="child-removed",Ht.MOUNTED="DOMNodeInsertedIntoDocument",Ht.UNMOUNTED="DOMNodeRemovedFromDocument",Ht.BOUNDS_CHANGED="bounds-changed",Ht.GEOMETRY_BOUNDS_CHANGED="geometry-bounds-changed",Ht.RENDER_ORDER_CHANGED="render-order-changed",function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;x(this,n),this.x=0,this.y=0,this.x=t,this.y=e}return w(n,[{key:"clone",value:function(){return new n(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}]),n}()),Es=function(){function e(t){x(this,e),this.type=void 0,this.eventPhase=e.prototype.NONE,this.target=void 0,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.currentTarget=void 0,this.defaultPrevented=!1,this.timeStamp=void 0,this.nativeEvent=void 0,this.originalEvent=void 0,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.manager=void 0,this.detail=void 0,this.layer=new Ss,this.page=new Ss,this.canvas=new Ss,this.viewport=new Ss,this.path=void 0,this.view=void 0,this.which=void 0,this.returnValue=void 0,this.srcElement=void 0,this.composed=!1,this.isTrusted=void 0,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}return w(e,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}}]),e}(),Ts=function(){T(r,Es);var i=M(r);function r(t,e){var n;return x(this,r),(n=i.call(this,null)).type=t,n.detail=e,Object.assign(fs(n),e),n}return w(r)}();function _s(t){if(!t)throw new Error}function Ms(t,e){if(t===e)throw new Error}function Ps(t){return void 0===t}function A(t){return null==t}function Os(t){return"number"==typeof t}function Cs(t){return"function"==typeof t}function As(t){return"boolean"==typeof t}function Ns(t){return"[object Object]"===Object.prototype.toString.call(t)}var Ls={},Is=0;function Ds(b,e,k,n){if(!(0<=b&&b<=1&&0<=k&&k<=1))throw new Error("bezier x values must be in [0, 1] range");if(b===e&&k===n)return function(t){return t};for(var x=new(zs?Float32Array:Array)(11),t=0;t<11;++t)x[t]=Ws(.1*t,b,k);function i(t){for(var e=0,n=1;10!==n&&x[n]<=t;++n)e+=.1;var i=e+.1*((t-x[--n])/(x[n+1]-x[n])),r=Us(i,b,k);if(.001<=r){for(var o=t,a=i,s=b,u=k,l=0;l<js;++l){var c=Us(a,s,u);if(0===c)return a;a-=(Ws(a,s,u)-o)/c}return a}if(0===r)return i;for(var h,d,p=t,f=e,y=e+.1,v=b,g=k,m=0;0<(h=Ws(d=f+(y-f)/2,v,g)-p)?y=d:f=d,Math.abs(h)>Bs&&++m<Fs;);return d}return function(t){return 0===t||1===t?t:Ws(i(t),e,n)}}var Rs="undefined"!=typeof window&&void 0!==window.document,js=4,Bs=1e-7,Fs=10,zs="function"==typeof Float32Array,Vs=function(t,e){return 1-3*e+3*t},Hs=function(t,e){return 3*e-6*t},Gs=function(t){return 3*t},Ws=function(t,e,n){return((Vs(e,n)*t+Hs(e,n))*t+Gs(e))*t},Us=function(t,e,n){return 3*Vs(e,n)*t*t+2*Hs(e,n)*t+Gs(e)};function Ys(t,e,n){return n?Math.min(t,e)===t?e:Math.max(t,n)===t?n:t:Math.max(t,e)===e?t:e}function qs(t){return void 0===t?0:360<t||t<-360?t%360:t}function Xs(t,e,n){e=1<arguments.length&&void 0!==e?e:0,n=2<arguments.length&&void 0!==n?n:0;return Os(t)?g(t,e,n):Array.isArray(t)&&3===t.length?ao(t):g(t[0],t[1]||e,t[2]||n)}function Ks(t){return t*(180/Math.PI)}function Zs(t,e){return 16===e.length?(n=t,i=e,a=.5*Math.PI,s=(l=vs(to(oo(),i),3))[0],u=l[1],l=l[2],(c=Math.asin(-i[2]/s))<a?-a<c?(r=Math.atan2(i[6]/u,i[10]/l),o=Math.atan2(i[1]/s,i[0]/s)):(o=0,r=-Math.atan2(i[4]/u,i[5]/u)):(o=0,r=Math.atan2(i[4]/u,i[5]/u)),n[0]=r,n[1]=c,n[2]=o,n):(a=t,s=(l=e)[0],i=l[1],u=l[2],l=l[3],.499995*(n=s*s+(r=i*i)+(c=u*u)+(o=l*l))<(t=s*l-i*u)?(a[0]=Math.PI/2,a[1]=2*Math.atan2(i,s),a[2]=0):t<-.499995*n?(a[0]=-Math.PI/2,a[1]=2*Math.atan2(i,s),a[2]=0):(a[0]=Math.asin(2*(s*u-l*i)),a[1]=Math.atan2(2*(s*l+i*u),1-2*(c+o)),a[2]=Math.atan2(2*(s*i+u*l),1-2*(r+c))),a);var n,i,r,o,a,s,u,l,c}function $s(t,e,n,i,r){var o,a,s,u,l=Math.cos(t),t=Math.sin(t);return o=i*l,a=r*t,i=-i*t,t=r*l,l=r=0,e=e,n=n,s=1,(u=new Gr(9))[0]=o,u[1]=a,u[2]=r,u[3]=i,u[4]=t,u[5]=l,u[6]=e,u[7]=n,u[8]=s,u}function Js(t){var e=t[0],n=t[1],i=t[3],r=t[4],o=Math.sqrt(e*e+n*n),a=Math.sqrt(i*i+r*r);e*r-n*i<0&&(e<r?o=-o:a=-a),o&&(e*=1/o,n*=1/o),a&&(r*=1/a);i=Ks(Math.atan2(n,e));return[t[6],t[7],o,a,i]}function Qs(t){return Math.pow(t,2)}function tu(t){return Math.pow(t,3)}function eu(t){return Math.pow(t,4)}function nu(t){return Math.pow(t,5)}function iu(t){return Math.pow(t,6)}function ru(t){return 1-Math.cos(t*Math.PI/2)}function ou(t){return 1-Math.sqrt(1-t*t)}function au(t){return t*t*(3*t-2)}function su(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)}function uu(t){var e=(n=vs(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],2))[0],n=void 0===(n=n[1])?.5:n,e=Ys(Number(void 0===e?1:e),1,10),n=Ys(Number(n),.1,2);return 0===t||1===t?t:-e*Math.pow(2,10*(t-1))*Math.sin((t-1-n/(2*Math.PI)*Math.asin(1/e))*(2*Math.PI)/n)}function lu(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length?arguments[2]:void 0,i=(e=vs(e,4))[0],r=void 0===(r=e[1])?100:r,o=void 0===(o=e[2])?10:o,e=void 0===(e=e[3])?0:e,i=Ys(void 0===i?1:i,.1,1e3),r=Ys(r,.1,1e3),o=Ys(o,.1,1e3),e=Ys(e,.1,1e3),a=Math.sqrt(r/i),r=(o=o/(2*Math.sqrt(r*i)))<1?a*Math.sqrt(1-o*o):0,i=o<1?(o*a-e)/r:-e+a,e=n?n*t/1e3:t,e=o<1?Math.exp(-e*o*a)*(+Math.cos(r*e)+i*Math.sin(r*e)):(1+i*e)*Math.exp(-e*a);return 0===t||1===t?t:1-e}function cu(t){var e=vs(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],2),n=void 0===(n=e[0])?10:n;return("start"==e[1]?Math.ceil:Math.floor)(Ys(t,0,1)*n)/n}function hu(t){var e=(r=vs(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],4))[0],n=r[1],i=r[2],r=r[3];return Ds(e,n,i,r)(t)}function du(e){return function(t){return 1-e(1-t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],2<arguments.length?arguments[2]:void 0)}}function pu(i){return function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length?arguments[2]:void 0;return t<.5?i(2*t,e,n)/2:1-i(-2*t+2,e,n)/2}}function fu(i){return function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length?arguments[2]:void 0;return t<.5?(1-i(1-2*t,e,n))/2:(i(2*t-1,e,n)+1)/2}}var ne=Ds(.42,0,1,1),yu={steps:cu,"step-start":function(t){return cu(t,[1,"start"])},"step-end":function(t){return cu(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":hu,ease:function(t){return hu(t,[.25,.1,.25,1])},in:ne,out:du(ne),"in-out":pu(ne),"out-in":fu(ne),"in-quad":Qs,"out-quad":du(Qs),"in-out-quad":pu(Qs),"out-in-quad":fu(Qs),"in-cubic":tu,"out-cubic":du(tu),"in-out-cubic":pu(tu),"out-in-cubic":fu(tu),"in-quart":eu,"out-quart":du(eu),"in-out-quart":pu(eu),"out-in-quart":fu(eu),"in-quint":nu,"out-quint":du(nu),"in-out-quint":pu(nu),"out-in-quint":fu(nu),"in-expo":iu,"out-expo":du(iu),"in-out-expo":pu(iu),"out-in-expo":fu(iu),"in-sine":ru,"out-sine":du(ru),"in-out-sine":pu(ru),"out-in-sine":fu(ru),"in-circ":ou,"out-circ":du(ou),"in-out-circ":pu(ou),"out-in-circ":fu(ou),"in-back":au,"out-back":du(au),"in-out-back":pu(au),"out-in-back":fu(au),"in-bounce":su,"out-bounce":du(su),"in-out-bounce":pu(su),"out-in-bounce":fu(su),"in-elastic":uu,"out-elastic":du(uu),"in-out-elastic":pu(uu),"out-in-elastic":fu(uu),spring:lu,"spring-in":lu,"spring-out":du(lu),"spring-in-out":pu(lu),"spring-out-in":fu(lu)},vu=function(t){return("-"===(t=(t=t).replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})).charAt(0)?t.substr(1):t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},gu=w(function t(){var n=this;x(this,t),this.resolve=void 0,this.reject=void 0,this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})});var mu,N,bu,ku,xu,wu,Su={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Eu=((p=b=b||{}).COORDINATE="<coordinate>",p.COLOR="<color>",p.PAINT="<paint>",p.NUMBER="<number>",p.ANGLE="<angle>",p.OPACITY_VALUE="<opacity-value>",p.SHADOW_BLUR="<shadow-blur>",p.LENGTH="<length>",p.PERCENTAGE="<percentage>",p.LENGTH_PERCENTAGE="<length> | <percentage>",p.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",p.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",p.LIST_OF_POINTS="<list-of-points>",p.PATH="<path>",p.FILTER="<filter>",p.Z_INDEX="<z-index>",p.OFFSET_PATH="<offset-path>",p.OFFSET_DISTANCE="<offset-distance>",p.CLIP_PATH="<clip-path>",p.TRANSFORM="<transform>",p.TRANSFORM_ORIGIN="<transform-origin>",p.TEXT="<text>",p.TEXT_TRANSFORM="<text-transform>",f.defineToken("StyleValueRegistry")),Tu=f.defineToken("GeometryUpdaterFactory"),_u=f.defineToken("GeometryAABBUpdater"),Mu=function(){function v(t,e){x(this,v),this.center=void 0,this.halfExtents=void 0,this.min=oo(),this.max=oo(),this.update(t,e)}return w(v,[{key:"update",value:function(t,e){this.center=uo(oo(),t||oo()),this.halfExtents=uo(oo(),e||g(0,0,0)),this.min=ko(this.min,this.center,this.halfExtents),this.max=co(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,e){co(this.center,e,t),po(this.center,this.center,.5),ko(this.halfExtents,e,t),po(this.halfExtents,this.halfExtents,.5),uo(this.min,t),uo(this.max,e)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(t){var e,n,i,r,o,a,s,u,l,c,h,d,p,f,y;v.isEmpty(t)||(v.isEmpty(this)?this.setMinMax(t.getMin(),t.getMax()):(n=(e=this.center)[0],f=e[1],o=e[2],r=(i=this.halfExtents)[0],h=i[1],a=i[2],u=(d=t.center)[0],y=d[1],d=d[2],l=(t=t.halfExtents)[0],(p=y-(c=t[1]))<(s=f-h)&&(s=p),(p=f+h)<(f=y+c)&&(p=f),(y=d-(h=t[2]))<(c=o-a)&&(c=y),(f=o+a)<(t=d+h)&&(f=t),e[0]=.5*((o=(y=u-l)<(o=n-r)?y:o)+(a=(a=n+r)<(d=u+l)?d:a)),e[1]=.5*(s+p),e[2]=.5*(c+f),i[0]=.5*(a-o),i[1]=.5*(p-s),i[2]=.5*(f-c),this.min[0]=o,this.min[1]=s,this.min[2]=c,this.max[0]=a,this.max[1]=p,this.max[2]=f))}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,i=this.halfExtents,r=t.center,t=t.halfExtents,o=e[0],a=e[4],s=e[8],u=e[1],l=e[5],c=e[9],h=e[2],d=e[6],p=e[10],f=Math.abs(o),y=Math.abs(a),v=Math.abs(s),g=Math.abs(u),m=Math.abs(l),b=Math.abs(c),k=Math.abs(h),x=Math.abs(d),w=Math.abs(p);lo(n,e[12]+o*r[0]+a*r[1]+s*r[2],e[13]+u*r[0]+l*r[1]+c*r[2],e[14]+h*r[0]+d*r[1]+p*r[2]),lo(i,f*t[0]+y*t[1]+v*t[2],g*t[0]+m*t[1]+b*t[2],k*t[0]+x*t[1]+w*t[2]),this.min=ko(this.min,n,i),this.max=co(this.max,n,i)}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),i=t.getMax(),t=t.getMin();return n[0]<=i[0]&&e[0]>=t[0]&&n[1]<=i[1]&&e[1]>=t[1]&&n[2]<=i[2]&&e[2]>=t[2]}},{key:"intersection",value:function(t){if(!this.intersects(t))return null;var e,n,i=new v,r=(n=oo(),r=this.getMin(),e=t.getMin(),n[0]=Math.max(r[0],e[0]),n[1]=Math.max(r[1],e[1]),n[2]=Math.max(r[2],e[2]),n);return e=oo(),n=this.getMax(),t=t.getMax(),e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),i.setMinMax(r,e),i}},{key:"containsPoint",value:function(t){var e=this.getMin(),n=this.getMax();return!(t[0]<e[0]||t[0]>n[0]||t[1]<e[1]||t[1]>n[1]||t[2]<e[2]||t[2]>n[2])}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?uo(oo(),this.min):272===t.pnVertexFlag?g(this.min[0],this.min[1],this.max[2]):257===t.pnVertexFlag?g(this.min[0],this.max[1],this.min[2]):256===t.pnVertexFlag?g(this.min[0],this.max[1],this.max[2]):17===t.pnVertexFlag?g(this.max[0],this.min[1],this.min[2]):16===t.pnVertexFlag?g(this.max[0],this.min[1],this.max[2]):1===t.pnVertexFlag?g(this.max[0],this.max[1],this.min[2]):g(this.max[0],this.max[1],this.max[2])}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?uo(oo(),this.max):272===t.pnVertexFlag?g(this.max[0],this.max[1],this.min[2]):257===t.pnVertexFlag?g(this.max[0],this.min[1],this.max[2]):256===t.pnVertexFlag?g(this.max[0],this.min[1],this.min[2]):17===t.pnVertexFlag?g(this.min[0],this.max[1],this.max[2]):16===t.pnVertexFlag?g(this.min[0],this.max[1],this.min[2]):1===t.pnVertexFlag?g(this.min[0],this.min[1],this.max[2]):g(this.min[0],this.min[1],this.min[2])}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]}}]),v}(),Pu=(oo(),function(){function n(t,e){x(this,n),this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=t||0,this.normal=e||g(0,1,0),this.updatePNVertexFlag()}return w(n,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(0<=this.normal[0])<<8)+(Number(0<=this.normal[1])<<4)+Number(0<=this.normal[2])}},{key:"distanceToPoint",value:function(t){return yo(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/wo(this.normal);po(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,e,n){var i=this.distanceToPoint(t),i=i/(i-this.distanceToPoint(e)),r=0<=i&&i<=1;return r&&n&&vo(n,t,e,i),r}}]),n}()),Ou=((ce=mu=mu||{})[ce.OUTSIDE=4294967295]="OUTSIDE",ce[ce.INSIDE=0]="INSIDE",ce[ce.INDETERMINATE=2147483647]="INDETERMINATE",function(){function n(t){if(x(this,n),this.planes=[],t)this.planes=t;else for(var e=0;e<6;e++)this.planes.push(new Pu)}return w(n,[{key:"extractFromVPMatrix",value:function(t){var t=vs(t,16),e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],d=t[11],p=t[12],f=t[13],y=t[14],t=t[15];lo(this.planes[0].normal,r-e,u-o,d-l),this.planes[0].distance=t-p,lo(this.planes[1].normal,r+e,u+o,d+l),this.planes[1].distance=t+p,lo(this.planes[2].normal,r+n,u+a,d+c),this.planes[2].distance=t+f,lo(this.planes[3].normal,r-n,u-a,d-c),this.planes[3].distance=t-f,lo(this.planes[4].normal,r-i,u-s,d-h),this.planes[4].distance=t-y,lo(this.planes[5].normal,r+i,u+s,d+h),this.planes[5].distance=t+y,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag()})}}]),n}()),Cu=(oo(),oo(),oo(),oo(),oo(),function(){function r(t,e,n,i){x(this,r),this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0,this.x=t,this.y=e,this.width=n,this.height=i,this.left=t,this.right=t+n,this.top=e,this.bottom=e+i}return w(r,[{key:"toJSON",value:function(){}}]),r}()),Au=((s=N=N||{})[s.kUnknown=0]="kUnknown",s[s.kNumber=1]="kNumber",s[s.kPercentage=2]="kPercentage",s[s.kEms=3]="kEms",s[s.kExs=4]="kExs",s[s.kPixels=5]="kPixels",s[s.kCentimeters=6]="kCentimeters",s[s.kMillimeters=7]="kMillimeters",s[s.kInches=8]="kInches",s[s.kPoints=9]="kPoints",s[s.kPicas=10]="kPicas",s[s.kQuarterMillimeters=11]="kQuarterMillimeters",s[s.kViewportWidth=12]="kViewportWidth",s[s.kViewportHeight=13]="kViewportHeight",s[s.kViewportInlineSize=14]="kViewportInlineSize",s[s.kViewportBlockSize=15]="kViewportBlockSize",s[s.kViewportMin=16]="kViewportMin",s[s.kViewportMax=17]="kViewportMax",s[s.kSmallViewportWidth=18]="kSmallViewportWidth",s[s.kSmallViewportHeight=19]="kSmallViewportHeight",s[s.kSmallViewportInlineSize=20]="kSmallViewportInlineSize",s[s.kSmallViewportBlockSize=21]="kSmallViewportBlockSize",s[s.kSmallViewportMin=22]="kSmallViewportMin",s[s.kSmallViewportMax=23]="kSmallViewportMax",s[s.kLargeViewportWidth=24]="kLargeViewportWidth",s[s.kLargeViewportHeight=25]="kLargeViewportHeight",s[s.kLargeViewportInlineSize=26]="kLargeViewportInlineSize",s[s.kLargeViewportBlockSize=27]="kLargeViewportBlockSize",s[s.kLargeViewportMin=28]="kLargeViewportMin",s[s.kLargeViewportMax=29]="kLargeViewportMax",s[s.kDynamicViewportWidth=30]="kDynamicViewportWidth",s[s.kDynamicViewportHeight=31]="kDynamicViewportHeight",s[s.kDynamicViewportInlineSize=32]="kDynamicViewportInlineSize",s[s.kDynamicViewportBlockSize=33]="kDynamicViewportBlockSize",s[s.kDynamicViewportMin=34]="kDynamicViewportMin",s[s.kDynamicViewportMax=35]="kDynamicViewportMax",s[s.kContainerWidth=36]="kContainerWidth",s[s.kContainerHeight=37]="kContainerHeight",s[s.kContainerInlineSize=38]="kContainerInlineSize",s[s.kContainerBlockSize=39]="kContainerBlockSize",s[s.kContainerMin=40]="kContainerMin",s[s.kContainerMax=41]="kContainerMax",s[s.kRems=42]="kRems",s[s.kChs=43]="kChs",s[s.kUserUnits=44]="kUserUnits",s[s.kDegrees=45]="kDegrees",s[s.kRadians=46]="kRadians",s[s.kGradians=47]="kGradians",s[s.kTurns=48]="kTurns",s[s.kMilliseconds=49]="kMilliseconds",s[s.kSeconds=50]="kSeconds",s[s.kHertz=51]="kHertz",s[s.kKilohertz=52]="kKilohertz",s[s.kDotsPerPixel=53]="kDotsPerPixel",s[s.kDotsPerInch=54]="kDotsPerInch",s[s.kDotsPerCentimeter=55]="kDotsPerCentimeter",s[s.kFraction=56]="kFraction",s[s.kInteger=57]="kInteger",s[s.kQuirkyEms=58]="kQuirkyEms",(a=bu=bu||{})[a.kUNumber=0]="kUNumber",a[a.kUPercent=1]="kUPercent",a[a.kULength=2]="kULength",a[a.kUAngle=3]="kUAngle",a[a.kUTime=4]="kUTime",a[a.kUFrequency=5]="kUFrequency",a[a.kUResolution=6]="kUResolution",a[a.kUOther=7]="kUOther",0,(me=ku=ku||{})[me.kYes=0]="kYes",me[me.kNo=1]="kNo",(ie=xu=xu||{})[ie.kYes=0]="kYes",ie[ie.kNo=1]="kNo",[{name:"em",unit_type:N.kEms},{name:"px",unit_type:N.kPixels},{name:"deg",unit_type:N.kDegrees},{name:"rad",unit_type:N.kRadians},{name:"grad",unit_type:N.kGradians},{name:"ms",unit_type:N.kMilliseconds},{name:"s",unit_type:N.kSeconds},{name:"rem",unit_type:N.kRems},{name:"turn",unit_type:N.kTurns}]);(u=wu=wu||{})[u.kUnknownType=0]="kUnknownType",u[u.kUnparsedType=1]="kUnparsedType",u[u.kKeywordType=2]="kKeywordType",u[u.kUnitType=3]="kUnitType",u[u.kSumType=4]="kSumType",u[u.kProductType=5]="kProductType",u[u.kNegateType=6]="kNegateType",u[u.kInvertType=7]="kInvertType",u[u.kMinType=8]="kMinType",u[u.kMaxType=9]="kMaxType",u[u.kClampType=10]="kClampType",u[u.kTransformType=11]="kTransformType",u[u.kPositionType=12]="kPositionType",u[u.kURLImageType=13]="kURLImageType",u[u.kColorType=14]="kColorType",u[u.kUnsupportedColorType=15]="kUnsupportedColorType";var Nu,Lu,Iu=function(){function t(){x(this,t)}return w(t,[{key:"toString",value:function(){return this.buildCSSText(ku.kNo,xu.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=wu.kUnitType&&this.getType()<=wu.kClampType}}],[{key:"parse",value:function(t,e){return[][0]}},{key:"parseAll",value:function(t,e){return[]}},{key:"unitFromName",value:function(t){return t?"number"===t?N.kNumber:"percent"===t||"%"===t?N.kPercentage:this.stringToUnitType(t):N.kUnknown}},{key:"unitTypeToUnitCategory",value:function(t){switch(t){case N.kNumber:case N.kInteger:return bu.kUNumber;case N.kPercentage:return bu.kUPercent;case N.kPixels:case N.kCentimeters:case N.kMillimeters:case N.kQuarterMillimeters:case N.kInches:case N.kPoints:case N.kPicas:case N.kUserUnits:return bu.kULength;case N.kMilliseconds:case N.kSeconds:return bu.kUTime;case N.kDegrees:case N.kRadians:case N.kGradians:case N.kTurns:return bu.kUAngle;case N.kHertz:case N.kKilohertz:return bu.kUFrequency;case N.kDotsPerPixel:case N.kDotsPerInch:case N.kDotsPerCentimeter:return bu.kUResolution;default:return bu.kUOther}}},{key:"unitTypeToString",value:function(t){switch(t){case N.kNumber:case N.kInteger:case N.kUserUnits:return"";case N.kPercentage:return"%";case N.kEms:case N.kQuirkyEms:return"em";case N.kRems:return"rem";case N.kPixels:return"px";case N.kDegrees:return"deg";case N.kRadians:return"rad";case N.kGradians:return"grad";case N.kMilliseconds:return"ms";case N.kSeconds:return"s";case N.kTurns:return"turn"}return""}},{key:"stringToUnitType",value:function(e){return Au.find(function(t){return t.name===e}).unit_type}},{key:"canonicalUnitTypeForCategory",value:function(t){switch(t){case bu.kUNumber:return N.kNumber;case bu.kULength:return N.kPixels;case bu.kUPercent:return N.kUnknown;case bu.kUTime:return N.kSeconds;case bu.kUAngle:return N.kDegrees;case bu.kUFrequency:return N.kHertz;case bu.kUResolution:return N.kDotsPerPixel;default:return N.kUnknown}}},{key:"conversionToCanonicalUnitsScaleFactor",value:function(t){var e=1;switch(t){case N.kPixels:case N.kUserUnits:case N.kDegrees:case N.kSeconds:case N.kHertz:break;case N.kMilliseconds:e=.001;break;case N.kCentimeters:case N.kDotsPerCentimeter:case N.kMillimeters:case N.kQuarterMillimeters:case N.kInches:case N.kDotsPerInch:case N.kPoints:case N.kPicas:break;case N.kRadians:e=180/Math.PI;break;case N.kGradians:e=.9;break;case N.kTurns:e=360;break;case N.kKilohertz:e=1e3}return e}},{key:"isAngle",value:function(t){return t===N.kDegrees||t===N.kRadians||t===N.kGradians||t===N.kTurns}},{key:"isViewportPercentageLength",value:function(t){return t>=N.kViewportWidth&&t<=N.kDynamicViewportMax}},{key:"isContainerPercentageLength",value:function(t){return t>=N.kContainerWidth&&t<=N.kContainerMax}},{key:"isLength",value:function(t){return t>=N.kEms&&t<=N.kUserUnits||t==N.kQuirkyEms}},{key:"isRelativeUnit",value:function(t){return t===N.kPercentage||t===N.kEms||t===N.kExs||t===N.kRems||t===N.kChs||this.isViewportPercentageLength(t)||this.isContainerPercentageLength(t)}},{key:"isTime",value:function(t){return t===N.kSeconds||t===N.kMilliseconds}},{key:"isFrequency",value:function(t){return t==N.kHertz||t==N.kKilohertz}},{key:"isResolution",value:function(t){return t>=N.kDotsPerPixel&&t<=N.kDotsPerCentimeter}},{key:"isFlex",value:function(t){return t===N.kFraction}}]),t}(),Du=function(){T(i,Iu);var n=M(i);function i(t){var e;return x(this,i),(e=n.call(this)).colorSpace=void 0,e.colorSpace=t,e}return w(i,[{key:"getType",value:function(){return wu.kColorType}},{key:"to",value:function(t){return this}}]),i}(),Ru=function(){T(i,Iu);var n=M(i);function i(t){var e;return x(this,i),(e=n.call(this)).value=void 0,e.value=t,e}return w(i,[{key:"clone",value:function(){return new i(this.value)}},{key:"getType",value:function(){return wu.kKeywordType}},{key:"buildCSSText",value:function(t,e,n){return n+this.value}}]),i}();(kn=Nu=Nu||{}).kAdd="+",kn.kSubtract="-",kn.kMultiply="*",kn.kDivide="/",kn.kMin="min",kn.kMax="max",kn.kClamp="clamp",kn.kInvalid="",(h=Lu=Lu||{})[h.kLength=0]="kLength",h[h.kAngle=1]="kAngle",h[h.kTime=2]="kTime",h[h.kFrequency=3]="kFrequency",h[h.kResolution=4]="kResolution",h[h.kFlex=5]="kFlex",h[h.kPercent=6]="kPercent",h[h.kNumBaseTypes=7]="kNumBaseTypes";var ju=function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:N.kNumber,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;x(this,n),this.exponents=[],this.numNonZeroEntries=0,this.percentHint=Lu.kPercent,this.hasPercentHint=!1,this.exponents=new Array(Lu.kNumBaseTypes).fill(0),t!==N.kNumber&&this.setExponent(function(t){switch(Ms(t,N.kNumber),t){case N.kEms:case N.kExs:case N.kPixels:case N.kCentimeters:case N.kMillimeters:case N.kQuarterMillimeters:case N.kInches:case N.kPoints:case N.kPicas:case N.kUserUnits:case N.kViewportWidth:case N.kViewportHeight:case N.kViewportInlineSize:case N.kViewportBlockSize:case N.kViewportMin:case N.kViewportMax:case N.kSmallViewportWidth:case N.kSmallViewportHeight:case N.kSmallViewportInlineSize:case N.kSmallViewportBlockSize:case N.kSmallViewportMin:case N.kSmallViewportMax:case N.kLargeViewportWidth:case N.kLargeViewportHeight:case N.kLargeViewportInlineSize:case N.kLargeViewportBlockSize:case N.kLargeViewportMin:case N.kLargeViewportMax:case N.kDynamicViewportWidth:case N.kDynamicViewportHeight:case N.kDynamicViewportInlineSize:case N.kDynamicViewportBlockSize:case N.kDynamicViewportMin:case N.kDynamicViewportMax:case N.kContainerWidth:case N.kContainerHeight:case N.kContainerInlineSize:case N.kContainerBlockSize:case N.kContainerMin:case N.kContainerMax:case N.kRems:case N.kChs:return Lu.kLength;case N.kMilliseconds:case N.kSeconds:return Lu.kTime;case N.kDegrees:case N.kRadians:case N.kGradians:case N.kTurns:return Lu.kAngle;case N.kHertz:case N.kKilohertz:return Lu.kFrequency;case N.kDotsPerPixel:case N.kDotsPerInch:case N.kDotsPerCentimeter:return Lu.kResolution;case N.kFraction:return Lu.kFlex;case N.kPercentage:return Lu.kPercent;default:return Lu.kLength}}(t),e)}return w(n,[{key:"applyPercentHint",value:function(t){Ms(t,Lu.kPercent),this.setExponent(t,this.exponent(t)+this.exponent(Lu.kPercent)),this.setExponent(Lu.kPercent,0),this.percentHint=t,this.hasPercentHint=!0}},{key:"hasNonZeroEntries",value:function(){return 0<this.numNonZeroEntries}},{key:"isOnlyNonZeroEntry",value:function(t,e){return Ms(e,0),1===this.numNonZeroEntries&&this.exponent(t)===e}},{key:"exponent",value:function(t){return this.exponents[t]}},{key:"setExponent",value:function(t,e){var n=this.exponents[t];0==n&&0!==e?this.numNonZeroEntries++:0!==n&&0==e&&this.numNonZeroEntries--,this.exponents[t]=e}},{key:"matchesBaseType",value:function(t){return Ms(t,Lu.kPercent),this.isOnlyNonZeroEntry(t,1)&&!this.hasPercentHint}},{key:"matchesPercentage",value:function(){return this.isOnlyNonZeroEntry(Lu.kPercent,1)}},{key:"matchesBaseTypePercentage",value:function(t){return Ms(t,Lu.kPercent),this.isOnlyNonZeroEntry(t,1)||this.isOnlyNonZeroEntry(Lu.kPercent,1)}},{key:"matchesNumber",value:function(){return!this.hasNonZeroEntries()&&!this.hasPercentHint}},{key:"matchesNumberPercentage",value:function(){return!this.hasNonZeroEntries()||this.isOnlyNonZeroEntry(Lu.kPercent,1)}}],[{key:"negateExponents",value:function(t){return t.exponents.forEach(function(t){return-1*t}),t}},{key:"add",value:function(t,e,n){if(t.hasPercentHint&&e.hasPercentHint&&t.percentHint!=e.percentHint)return t;t.hasPercentHint?e.applyPercentHint(t.percentHint):e.hasPercentHint&&t.applyPercentHint(e.percentHint);var i=t.percentHint,r=e.percentHint;if(i!==r)throw new Error;for(var o=0;o<Lu.kNumBaseTypes;++o){var a=o;if(t.exponents[o]!==e.exponents[o]&&(a!==Lu.kPercent&&(t.applyPercentHint(a),e.applyPercentHint(a)),t.exponents[o]!==e.exponents[o]))return t}return t}},{key:"multiply",value:function(t,e,n){if(t.hasPercentHint&&e.hasPercentHint&&t.percentHint!=e.percentHint)return t;t.hasPercentHint?e.applyPercentHint(t.percentHint):e.hasPercentHint&&t.applyPercentHint(e.percentHint);for(var i=0;i<Lu.kNumBaseTypes;++i){var r=i;t.setExponent(r,t.exponent(r)+e.exponent(r))}return t}}]),n}(),Bu=function(){T(f,Iu);var n=M(f);function f(t){var e;return x(this,f),(e=n.call(this)).type_=void 0,e.type_=t,e}return w(f,[{key:"getType",value:function(){return wu.kUnknownType}},{key:"equals",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Fu(n).every(function(t){return e.equals(t)})}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=Fu(e),r=(zu(wu.kSumType,i,this),Hu(i,Nu.kAdd));return r||Ju.create(i)}},{key:"sub",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=(i=Fu(e)).map(function(t){return t.negate()}),r=(zu(wu.kSumType,i,this),Hu(i,Nu.kAdd));return r||Ju.create(i)}},{key:"mul",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=Fu(e),r=(zu(wu.kProductType,i,this),Gu(i));return r||Qu.create(i)}},{key:"div",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=(i=Fu(e)).map(function(t){return t.invert()}),r=(zu(wu.kProductType,i,this),Gu(i));return r||Qu.create(i)}},{key:"min",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=Fu(e),r=(zu(wu.kMinType,i,this),Hu(i,Nu.kMin));return r||Zu.create(i)}},{key:"max",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=Fu(e),r=(zu(wu.kMaxType,i,this),Hu(i,Nu.kMax));return r||$u.create(i)}},{key:"to",value:function(t){var e=this.sumValue();if(0===e.length||1!==e.length)return null;e=Vu(e[0]);return e?(t="string"==typeof t?L.unitFromName(t):t,e.convertTo(t)):null}},{key:"toSum",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i=0,r=e;i<r.length;i++){var o=r[i];if(!f.isValidUnit(f.unitFromName(o)))return null}var a=this.sumValue();if(!a.length)return null;var s,u=[],l=ks(a);try{for(l.s();!(s=l.n()).done;){var c=Vu(s.value);if(!c)return null;u.push(c)}}catch(t){l.e(t)}finally{l.f()}if(0===e.length)return u.sort(function(t,e){return t.unit-e.unit}),_s(!!(a=Ju.create(u))),a;for(var h=[],d=0,p=e;d<p.length;d++)!function(){var t=p[d],i=f.unitFromName(t),t=(_s(f.isValidUnit(i)),u.reduce(function(t,e,n){return e&&(e=e.convertTo(i))&&(t+=e.value,u[n]=null),t},0));h.push(new L(t,i))}();if(u.some(function(t){return!!t}))throw new Error("There were leftover terms that were not converted");return Ju.create(h)}},{key:"type",value:function(){var t={length:0,angle:0,time:0,frequency:0,resolution:0,flex:0,percent:0,percentHint:"length"},e=this.type_.exponent(Lu.kLength);return e&&(t.length=e),(e=this.type_.exponent(Lu.kAngle))&&(t.angle=e),(e=this.type_.exponent(Lu.kTime))&&(t.time=e),(e=this.type_.exponent(Lu.kFrequency))&&(t.frequency=e),(e=this.type_.exponent(Lu.kResolution))&&(t.resolution=e),(e=this.type_.exponent(Lu.kFlex))&&(t.flex=e),(e=this.type_.exponent(Lu.kPercent))&&(t.percent=e),this.type_.hasPercentHint&&(t.percentHint=function(t){switch(t){case Lu.kLength:return"length";case Lu.kAngle:return"angle";case Lu.kTime:return"time";case Lu.kFrequency:return"frequency";case Lu.kResolution:return"resolution";case Lu.kFlex:return"flex";case Lu.kPercent:return"percent"}return""}(this.type_.percentHint)),t}},{key:"negate",value:function(){return Yu.create(this)}},{key:"invert",value:function(){return Uu.create(this)}}],[{key:"fromNumberish",value:function(t){return"number"==typeof t?new L(t,N.kNumber):t}},{key:"fromPercentish",value:function(t){return"number"==typeof t?new L(100*t,N.kPercentage):t}},{key:"isValidUnit",value:function(t){return t!==N.kUserUnits&&!!(t===N.kNumber||t==N.kPercentage||this.isLength(t)||this.isAngle(t)||this.isTime(t)||this.isFrequency(t)||this.isResolution(t)||this.isFlex(t))}}]),f}();function Fu(t){return t.map(Bu.fromNumberish)}function zu(t,e,n){_s(!!n),n.getType()===t?e.unshift.apply(e,gs(n.numericValues())):e.unshift(n)}function Vu(t){return 0===Object.keys(t.units).length?new L(t.value):1===Object.keys(t.units).length&&1===t.units[Object.keys(t.units)[0]]?new L(t.value,Number(Object.keys(t.units)[0])):null}function Hu(t,e){_s(!!t.length);var n=t[0]instanceof L?t[0]:null;if(!n)return null;for(var i=n.value,r=1;r<t.length;r++){var o=t[r]instanceof L?t[r]:null;if(!o||o.unit!==n.unit)return null;e===Nu.kAdd?i+=o.value:e===Nu.kMax?i=Math.max(i,o.value):e===Nu.kMin&&(i=Math.min(i,o.value))}return new L(i,n.unit)}function Gu(t){_s(!!t.length);for(var e=N.kNumber,n=1,i=0;i<t.length;i++){var r=t[i]instanceof L?t[i]:null;if(!r)return null;if(r.unit!==N.kNumber){if(e!==N.kNumber)return null;e=r.unit}n*=r.value}return new L(n,e)}var L=function(){T(s,Bu);var i=M(s);function s(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:N.kNumber;return x(this,s),n="string"==typeof n?s.unitFromName(n):n,_s(s.isValidUnit(n)),(e=i.call(this,new ju(n))).unit=void 0,e.value=void 0,e.unit=n,e.value=t,e}return w(s,[{key:"clone",value:function(){return new s(this.value,this.unit)}},{key:"convertTo",value:function(t){if(this.unit===t)return new s(this.value,this.unit);var e=s.toCanonicalUnit(this.unit);if(e!==s.toCanonicalUnit(t)||e===N.kUnknown)return null;e=Iu.conversionToCanonicalUnitsScaleFactor(this.unit)/Iu.conversionToCanonicalUnitsScaleFactor(t);return new s(this.value*e,t)}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit}},{key:"getType",value:function(){return wu.kUnitType}},{key:"sumValue",value:function(){var t=[],e={};return this.unit!==N.kNumber&&(e[s.toCanonicalUnitIfPossible(this.unit)]=1),t.push({value:this.value*Iu.conversionToCanonicalUnitsScaleFactor(this.unit),units:e}),t}},{key:"negate",value:function(){return new s(-this.value,this.unit)}},{key:"invert",value:function(){return this.unit===N.kNumber?0===this.value?null:new s(1/this.value,this.unit):Uu.create(this)}},{key:"buildCSSText",value:function(t,e,n){switch(this.unit){case N.kUnknown:break;case N.kInteger:r=Number(this.value).toFixed(0);break;case N.kNumber:case N.kPercentage:case N.kEms:case N.kQuirkyEms:case N.kExs:case N.kRems:case N.kChs:case N.kPixels:case N.kCentimeters:case N.kDotsPerPixel:case N.kDotsPerInch:case N.kDotsPerCentimeter:case N.kMillimeters:case N.kQuarterMillimeters:case N.kInches:case N.kPoints:case N.kPicas:case N.kUserUnits:case N.kDegrees:case N.kRadians:case N.kGradians:case N.kMilliseconds:case N.kSeconds:case N.kHertz:case N.kKilohertz:case N.kTurns:case N.kFraction:case N.kViewportWidth:case N.kViewportHeight:case N.kViewportInlineSize:case N.kViewportBlockSize:case N.kViewportMin:case N.kViewportMax:case N.kSmallViewportWidth:case N.kSmallViewportHeight:case N.kSmallViewportInlineSize:case N.kSmallViewportBlockSize:case N.kSmallViewportMin:case N.kSmallViewportMax:case N.kLargeViewportWidth:case N.kLargeViewportHeight:case N.kLargeViewportInlineSize:case N.kLargeViewportBlockSize:case N.kLargeViewportMin:case N.kLargeViewportMax:case N.kDynamicViewportWidth:case N.kDynamicViewportHeight:case N.kDynamicViewportInlineSize:case N.kDynamicViewportBlockSize:case N.kDynamicViewportMin:case N.kDynamicViewportMax:case N.kContainerWidth:case N.kContainerHeight:case N.kContainerInlineSize:case N.kContainerBlockSize:case N.kContainerMin:case N.kContainerMax:var i,r,o=this.value,a=s.unitTypeToString(this.unit);r=o<-999999||999999<o?(i=s.unitTypeToString(this.unit),!Number.isFinite(o)||Number.isNaN(o)?s.formatInfinityOrNaN(o,i):s.formatNumber(o,i)):"".concat(o).concat(a)}return n+=r}}],[{key:"toCanonicalUnit",value:function(t){return this.canonicalUnitTypeForCategory(this.unitTypeToUnitCategory(t))}},{key:"toCanonicalUnitIfPossible",value:function(t){var e=this.toCanonicalUnit(t);return e===N.kUnknown?t:e}},{key:"formatInfinityOrNaN",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?(_s(Number.isNaN(t)),"NaN"):0<t?"infinity":"-infinity")+e}},{key:"formatNumber",value:function(t){return t+(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")}}]),s}(),Wu=function(){T(e,Bu);var t=M(e);function e(){return x(this,e),t.apply(this,arguments)}return w(e,[{key:"isUnitValue",value:function(){return!1}}]),e}(),Uu=function(){T(i,Wu);var n=M(i);function i(t,e){return x(this,i),(e=n.call(this,e)).value=void 0,e.operator="invert",e.value=t,e}return w(i,[{key:"clone",value:function(){return new i(this.value,this.type_)}},{key:"getType",value:function(){return wu.kInvertType}},{key:"equals",value:function(t){return t.getType()===wu.kInvertType&&this.value.equals(t.value)}},{key:"sumValue",value:function(){var e=this.value.sumValue();return 0===e.length||1!==e.length||0===e[0].value?null:(Object.keys(e[0].units).forEach(function(t){e[0].units[t]*=-1}),e[0].value=1/e[0].value,e)}},{key:"buildCSSText",value:function(t,e,n){return e==xu.kNo&&(n+=t===ku.kYes?"(":"calc("),n=this.value.buildCSSText(ku.kYes,xu.kNo,n+="1 / "),e===xu.kNo&&(n+=")"),n}}],[{key:"create",value:function(t){return new i(t,ju.negateExponents(t.type_))}}]),i}(),Yu=function(){T(i,Wu);var n=M(i);function i(t,e){return x(this,i),(e=n.call(this,e)).value=void 0,e.operator="negate",e.value=t,e}return w(i,[{key:"clone",value:function(){return new i(this.value,this.type_)}},{key:"getType",value:function(){return wu.kNegateType}},{key:"equals",value:function(t){return t.getType()===wu.kNegateType&&this.value.equals(t.value)}},{key:"sumValue",value:function(){var t=this.value.sumValue();return 0===t.length?null:(t.forEach(function(t){t.value*=-1}),t)}},{key:"buildCSSText",value:function(t,e,n){return e==xu.kNo&&(n+=t===ku.kYes?"(":"calc("),n=this.value.buildCSSText(ku.kYes,xu.kNo,n+="-"),e===xu.kNo&&(n+=")"),n}}],[{key:"create",value:function(t){return new i(t,t.type_)}}]),i}();function qu(t,e){for(var n=t[0].type_,i=1;i<t.length;i++)n=e(n,t[i].type_,!1);return n}var Xu,Ku=function(){T(i,Wu);var n=M(i);function i(t,e){return x(this,i),(e=n.call(this,e)).values=void 0,e.values=t,e}return w(i,[{key:"numericValues",value:function(){return this.values}},{key:"equals",value:function(n){return this.getType()===n.getType()&&this.values.every(function(t,e){return t.equals(n.values[e])})}}]),i}(),Zu=function(){T(o,Ku);var r=M(o);function o(){var t;x(this,o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))).operator="min",t}return w(o,[{key:"clone",value:function(){return new o(this.values,this.type_)}},{key:"getType",value:function(){return wu.kMinType}},{key:"sumValue",value:function(){var t=this.numericValues()[0].sumValue();if(!t.length)return null;var e,n=ks(this.numericValues());try{for(n.s();!(e=n.n()).done;){var i=e.value.sumValue();if(!i.length||JSON.stringify(i[0].units)!==JSON.stringify(t[0].units))return null;i[0].value<t[0].value&&(t=i)}}catch(t){n.e(t)}finally{n.f()}return t}},{key:"buildCSSText",value:function(t,e,n){n+="min(";var i,r=!0,o=ks(this.numericValues());try{for(o.s();!(i=o.n()).done;){var a=i.value;r||(n+=", "),r=!1,n=a.buildCSSText(ku.kYes,xu.kYes,n)}}catch(t){o.e(t)}finally{o.f()}return n+=")"}}],[{key:"create",value:function(t){return new o(t,qu(t,ju.add))}}]),o}(),$u=function(){T(o,Ku);var r=M(o);function o(){var t;x(this,o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))).operator="max",t}return w(o,[{key:"clone",value:function(){return new o(this.values,this.type_)}},{key:"getType",value:function(){return wu.kMaxType}},{key:"sumValue",value:function(){var t=this.numericValues()[0].sumValue();if(!t.length)return null;var e,n=ks(this.numericValues());try{for(n.s();!(e=n.n()).done;){var i=e.value.sumValue();if(!i.length||JSON.stringify(i[0].units)!==JSON.stringify(t[0].units))return null;i[0].value<t[0].value&&(t=i)}}catch(t){n.e(t)}finally{n.f()}return t}},{key:"buildCSSText",value:function(t,e,n){n+="max(";var i,r=!0,o=ks(this.numericValues());try{for(o.s();!(i=o.n()).done;){var a=i.value;r||(n+=", "),r=!1,n=a.buildCSSText(ku.kYes,xu.kYes,n)}}catch(t){o.e(t)}finally{o.f()}return n+=")"}}],[{key:"create",value:function(t){return new o(t,qu(t,ju.add))}}]),o}(),Ju=function(){T(o,Ku);var r=M(o);function o(){var t;x(this,o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))).operator="sum",t}return w(o,[{key:"clone",value:function(){return new o(this.values,this.type_)}},{key:"getType",value:function(){return wu.kSumType}},{key:"sumValue",value:function(){var n=[];return this.numericValues().forEach(function(t){t=t.sumValue();if(!t.length)return null;t.forEach(function(e){var t=n.findIndex(function(t){return JSON.stringify(t.units)===JSON.stringify(e.units)});-1===t?n.push(is({},e)):n[t].value+=e.value})}),o.canCreateNumericTypeFromSumValue(n)?n:null}},{key:"buildCSSText",value:function(t,e,n){e==xu.kNo&&(n+=t===ku.kYes?"(":"calc(");var i=this.numericValues();n=i[0].buildCSSText(ku.kYes,xu.kNo,n);for(var r=1;r<i.length;r++){var o=i[r];n=o.getType()===wu.kNegateType?(n+=" - ",o.value.buildCSSText(ku.kYes,xu.kNo,n)):(n+=" + ",o.buildCSSText(ku.kYes,xu.kNo,n))}return e===xu.kNo&&(n+=")"),n}}],[{key:"create",value:function(t){return new o(t,qu(t,ju.add))}},{key:"numericTypeFromUnitMap",value:function(n){var i=new ju;return Object.keys(n).forEach(function(t){var e=n[t];i=ju.multiply(i,new ju(Number(t),e),!1),_s(!0)}),i}},{key:"canCreateNumericTypeFromSumValue",value:function(t){var e=this,n=(_s(!!t.length),this.numericTypeFromUnitMap(t[0].units));return t.every(function(t){return ju.add(n,e.numericTypeFromUnitMap(t.units),!1),!0})}}]),o}(),Qu=function(){T(o,Ku);var r=M(o);function o(){var t;x(this,o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))).operator="product",t}return w(o,[{key:"clone",value:function(){return new o(this.values,this.type_)}},{key:"getType",value:function(){return wu.kProductType}},{key:"sumValue",value:function(){var e=[{value:1,units:{}}];return this.numericValues().forEach(function(t){var n=t.sumValue();if(!n.length)return null;var i=[];e.forEach(function(e){n.forEach(function(t){i.push({value:e.value*t.value,units:o.multiplyUnitMaps(e.units,t.units)})})}),e=i}),e}},{key:"buildCSSText",value:function(t,e,n){e==xu.kNo&&(n+=t===ku.kYes?"(":"calc(");var i=this.numericValues();n=i[0].buildCSSText(ku.kYes,xu.kNo,n);for(var r=1;r<i.length;r++){var o=i[r];n=o.getType()===wu.kInvertType?(n+=" / ",o.value.buildCSSText(ku.kYes,xu.kNo,n)):(n+=" * ",o.buildCSSText(ku.kYes,xu.kNo,n))}return e===xu.kNo&&(n+=")"),n}}],[{key:"create",value:function(t){return new o(t,qu(t,ju.multiply))}},{key:"multiplyUnitMaps",value:function(n,i){return Object.keys(i).forEach(function(t){Ms(i[t].value,0);var e=t in n?n[t].value:0;e+i[t].value===0?delete n[t]:n[t]=e+i[t].value}),n}}]),o}(),tl=new L(0,"px"),el=new L(0,"deg"),nl=function(){T(s,Du);var a=M(s);function s(t,e,n){var i,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,o=4<arguments.length&&void 0!==arguments[4]&&arguments[4];return x(this,s),(i=a.call(this,"rgb")).r=void 0,i.g=void 0,i.b=void 0,i.alpha=void 0,i.isNone=void 0,i.r=t,i.g=e,i.b=n,i.alpha=r,i.isNone=o,i}return w(s,[{key:"clone",value:function(){return new s(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,e,n){return n+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}]),s}(),il=((l=Xu=Xu||{})[l.Constant=0]="Constant",l[l.LinearGradient=1]="LinearGradient",l[l.RadialGradient=2]="RadialGradient",l[l.Pattern=3]="Pattern",function(){T(r,Iu);var i=M(r);function r(t,e){var n;return x(this,r),(n=i.call(this)).type=void 0,n.value=void 0,n.type=t,n.value=e,n}return w(r,[{key:"clone",value:function(){return new r(this.type,this.value)}},{key:"buildCSSText",value:function(t,e,n){var i="";return this.type===Xu.LinearGradient?i="linear-gradient(".concat(this.value.steps.map(function(t){return t.join(",")}).join(","),")"):this.type===Xu.RadialGradient?i="radial-gradient(".concat(this.value.steps.map(function(t){return t.join(",")}).join(","),")"):this.type===Xu.Pattern&&(i="url(".concat(this.value.src,")")),n+i}},{key:"getType",value:function(){return wu.kColorType}}]),r}()),rl=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,ol=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,al=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,sl=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function ul(t){if("transparent"===(t=A(t)?"":t))return new nl(0,0,0,0);var e=(t="currentColor"===t?"black":t)[0];if("("===t[1]||"("===t[2])if("l"===e){var n=function(t){var e,n,i=rl.exec(t);{var r,o,a;if(i)return a=parseFloat(i[1])%360*(Math.PI/180),i=(null==(i=i[2].match(sl))?void 0:i.map(function(t){return t.split(":")}))||[],0,n=0<=a&&a<.5*Math.PI?(e={x:0,y:0},{x:1,y:1}):.5*Math.PI<=a&&a<Math.PI?(e={x:1,y:0},{x:0,y:1}):Math.PI<=a&&a<1.5*Math.PI?(e={x:1,y:1},{x:0,y:0}):(e={x:0,y:1},{x:1,y:0}),a=Math.tan(a),r=a*a,o=(n.x-e.x+a*(n.y-e.y))/(1+r)+e.x,a=a*(n.x-e.x+a*(n.y-e.y))/(1+r)+e.y,{x0:e.x,y0:e.y,x1:o,y1:a,steps:i,hash:t}}return null}(t);if(n)return new il(Xu.LinearGradient,n)}else if("r"===e){n=function(t){var e=ol.exec(t);{var n,i,r,o;if(e)return n=parseFloat(e[1]),i=parseFloat(e[2]),r=parseFloat(e[3]),o=(null==(o=e[4].match(sl))?void 0:o.map(function(t){return t.split(":")}))||[],0===r?(e=e[4].match(sl))[e.length-1].split(":")[1]:{x0:n,y0:i,r0:0,x1:.5,y1:.5,r1:r,steps:o,hash:t}}return null}(t);if(n){if(!wc(n))return new il(Xu.RadialGradient,n);t=n}}else if("p"===e){n=function(t){var e=al.exec(t);if(e){var n=e[1],e=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat"}return{src:e,repetition:n,hash:t}}return null}(t);if(n)return new il(Xu.Pattern,n)}e=ta(t),n=[0,0,0,0];return null!==e&&(n[0]=e.r||0,n[1]=e.g||0,n[2]=e.b||0,n[3]=e.opacity),ds(nl,n)}function ll(t,e){if(A(e))return new L(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if(0<="px".search(t))return new L(Number(e),"px");if(0<="deg".search(t))return new L(Number(e),"deg")}var n=[],i=(e=e.replace(t,function(t){return n.push(t),"U"+t}),"U("+t.source+")");return n.map(function(t){return new L(Number(e.replace(new RegExp("U"+t,"g"),"").replace(new RegExp(i,"g"),"*0")),t)})[0]}var cl=ll.bind(null,new RegExp("px","g")),hl=(ll.bind(null,new RegExp("%","g")),ll.bind(null,new RegExp("px|%|em|rem","g"))),dl=ll.bind(null,new RegExp("deg|rad|grad|turn","g"));function pl(t,e,n,i){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o="",a=t.value||0,s=e.value||0;return(L.isLength(t.unit)||L.isLength(e.unit))&&(a=gl(t,r,n),s=gl(e,r,n),o="px"),(L.isAngle(t.unit)||L.isAngle(e.unit))&&(a=fl(t),s=fl(e),o="deg"),[a,s,function(t){return(t=i?Math.max(t,0):t)+o}]}function fl(t){var e=0;return t.unit===N.kDegrees?e=t.value:t.unit===N.kRadians?e=Ks(Number(t.value)):t.unit===N.kTurns&&(e=360*Number(t.value)),e}function yl(t){return wc(t)?t.split(" ").map(function(t){return hl(t)}):t.map(function(t){return hl(t.toString())})}function vl(t,e,n){var i;if(t.length===e.length)return i=t[0].unit,[t.map(function(t){return t.value}),e.map(function(t){return t.value}),function(t){return t.map(function(t){return new L(t,i)}).join(" ")}]}function gl(t,e,n){return t.unit===N.kPixels?Number(t.value):t.unit===N.kPercentage&&n?(n=n.getGeometryBounds(),i=0,Mu.isEmpty(n)||(i=2*n.halfExtents[e]),Number(t.value)/100*i):0;var i}function ml(t){return t.toString()}function bl(t){return"number"==typeof t?new L(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?new L(Number(t)):new L(0)}function kl(t,e){return[t.value,e.value,ml]}function xl(n,i){return function(t,e){return[t.value,e.value,function(t){return ml(Ys(t,n,i))}]}}function wl(t,e,n){var i=t[0],t=t[1];return[i+(e[0]-i)*n,t+(e[1]-t)*n]}function Sl(t){return t.map(function(t,e,n){var n=e&&n[e-1].slice(-2).concat(t.slice(1)),i=e?wa.length.apply(wa,gs(n)):0,e=e?i?function(t,e){var e=1<arguments.length&&void 0!==e?e:.5,n=t.slice(0,2),i=t.slice(2,4),r=t.slice(4,6),t=t.slice(6,8),n=wl(n,i,e),i=wl(i,r,e),r=wl(r,t,e),o=wl(n,i,e),i=wl(i,r,e),e=wl(o,i,e);return[["C"].concat(n,o,e),["C"].concat(i,r,t)]}(n):[t,t]:[t];return{s:t,ss:e,l:i}})}function El(t){return(a=o=r=i=n=0)<=t.map(function(t){switch(t[0]){case"M":case"Z":return r="M"===t[0]?t[1]:r,o="M"===t[0]?t[2]:o,n=r,i=o,0;default:a=function(t,e,n,i,r,o,a,s){return 3*((s-e)*(n+r)-(a-t)*(i+o)+i*(t-r)-n*(e-o)+s*(r+t/3)-a*(o+e/3))/20}.apply(0,[n,i].concat(t.slice(1)));var e=vs(t.slice(-2),2);return n=e[0],i=e[1],a}}).reduce(function(t,e){return t+e},0);var n,i,r,o,a}function Tl(r,o){var a,s,u,l=r.length-1,e=[],c=0,t=(s=(a=r).length,u=s-1,a.map(function(t,i){return a.map(function(t,e){var n=i+e;return 0===e||a[n]&&"M"===a[n][0]?(e=a[n],["M"].concat(e.slice(-2))):(s<=n&&(n-=u),a[n])})}));return t.forEach(function(t,i){r.slice(1).forEach(function(t,e){var n;c+=(n=r[(i+e)%l].slice(-2),e=o[e%l].slice(-2),Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])))}),e[i]=c,c=0}),t[e.indexOf(Math.min.apply(null,e))]}var _l,Ml,Pl=ll.bind(null,/deg|rad|grad|turn|px|%/g),Ol=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];(o=_l=_l||{}).Layout="layout",o.IntrinsicSizes="intrinsic-sizes",(r=Ml=Ml||{}).LAYOUT="display",r.LEFT="left",r.TOP="top",r.BOTTOM="bottom",r.RIGHT="right",r.WIDTH="width",r.HEIGHT="height",r.MIN_WIDTH="minWidth",r.MAX_WIDTH="maxWidth",r.MIN_HEIGHT="minHeight",r.MAX_HEIGHT="maxHeight",r.BOX_SIZING="boxSizing",r.PADDING="padding",r.PADDING_TOP="paddingTop",r.PADDING_BOTTOM="paddingBottom",r.PADDING_START="paddingLeft",r.PADDING_END="paddingRight",r.MARGIN="margin",r.MARGIN_TOP="marginTop",r.MARGIN_BOTTOM="marginBottom",r.MARGIN_START="marginLeft",r.MARGIN_END="marginRight",r.BORDER="border",r.BORDER_TOP="borderTop",r.BORDER_BOTTOM="borderBottom",r.BORDER_START="borderLeft",r.BORDER_END="borderRight",r.FLEX_DIRECTION="flexDirection",r.FLEX_WRAP="flexWrap",r.FLEX_FLOW="flexFlow",r.ALIGN_ITEMS="alignItems",r.ALIGN_CONTENT="alignContent",r.JUSTIFY_CONTENT="justifyContent",r.FLEX="flex",r.ALIGN_SELF="alignSelf",r.FLEX_SHRINK="flexShrink",r.FLEX_BASIS="flexBasis",r.FLEX_GROW="flexGrow",r.OFFSET_WIDTH="offsetWidth",r.OFFSET_HEIGHT="offsetHeight",r.ORDER="order";function Cl(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(t){setTimeout(function(){t()},e)})}var Al,Nl=1,Vt=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Map;x(this,e),this.id=void 0,this.style=void 0,this.dirty=void 0,this.parent=void 0,this.children=void 0,this.internalIntrisicSizes=void 0,this.computedLayout=void 0,this.measureFn=void 0,this.id=Nl++,this.style=t,this.parent=void 0,this.children=[],this.dirty=!1}var t;return w(e,[{key:"intrisicSizes",get:function(){return this.internalIntrisicSizes}},{key:"childCount",get:function(){return this.children.length}},{key:"setMeasure",value:function(t){this.measureFn=t}},{key:"setIntrisicSizes",value:function(t){this.internalIntrisicSizes=t}},{key:"addChild",value:function(t){var e;null!=(e=this.children)&&e.push(t)}},{key:"insertChild",value:function(t,e){this.children.splice(t,0,e)}},{key:"removeChild",value:function(e){var t=null==(t=this.children)?void 0:t.findIndex(function(t){return t.id===e.id});this.removeChildAtIndex(t)}},{key:"removeChildAtIndex",value:function(t){this.children.splice(t,1)}},{key:"replaceChildAtIndex",value:function(t,e){this.children.splice(t,1,e)}},{key:"setStyle",value:function(t,e){this.style.set(t,e)}},{key:"getStyle",value:function(){for(var n=this,i=new Map,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.forEach(function(t){var e=n.style.get(t);e&&i.set(t,e)}),i}},{key:"getAllStyle",value:function(){return this.style}},{key:"markDirty",value:function(){this.dirty=!0}},{key:"idDirty",value:function(){return this.dirty}},{key:"getSize",value:function(){var t;return{width:null!=(t=null==(t=this.style.get(Ml.WIDTH))?void 0:t.value)?t:0,height:null!=(t=null==(t=this.style.get(Ml.HEIGHT))?void 0:t.value)?t:0}}},{key:"computeLayout",value:(t=as(S().mark(function t(){var e;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getSize(),t.next=3,Yd.computeLayout(this,{availableInlineSize:e.width,availableBlockSize:e.height,fixedInlineSize:e.width,fixedBlockSize:e.height,percentageInlineSize:e.width,percentageBlockSize:e.height,data:void 0});case 3:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})},{key:"setComputedLayout",value:function(t){this.computedLayout=t}},{key:"getComputedLayout",value:function(){return this.computedLayout}},{key:"getAllComputedLayout",value:function(){}},{key:"toString",value:function(){return"LayoutObject ".concat(this.id)}}]),e}(),Ll=f.defineToken("LayoutContextFactory"),Il=f.defineToken("LayoutContextOptions"),Dl=0,Rl=function(){function e(t){x(this,e),this.options=void 0,this.contextId=void 0,this.workQueue=[],this.mode=void 0,this.layoutChildrenFactory=void 0,this.fragmentResultFactory=void 0,this.layoutFragmentFactory=void 0,this.options=t,this.contextId="".concat(Dl++),this.mode=t.mode,this.layoutChildrenFactory=t.layoutChildrenFactory,this.fragmentResultFactory=t.fragmentResultFactory,this.layoutFragmentFactory=t.layoutFragmentFactory}return w(e,[{key:"appendWorkTask",value:function(t){this.workQueue.push(t)}},{key:"clearWorkQueue",value:function(){this.workQueue=[]}}]),e}(),Rl=e([y(),B(0,v(Il)),n("design:paramtypes",[Object])],Rl),jl=f.defineToken("FragmentResultFactory"),Bl=f.defineToken("FragmentResultOptions"),Fl=f.defineToken("contextNode"),zl=w(function t(e,n,i){x(this,t),this._layoutContext=void 0,this._node=void 0,this.options=void 0,this.layoutContext=void 0,this.inlineSize=void 0,this.blockSize=void 0,this.node=void 0,this.childFragments=void 0,this.data=void 0,this._layoutContext=e,this._node=n,this.options=i,this.layoutContext=e,this.inlineSize=null==i?void 0:i.inlineSize,this.blockSize=null==i?void 0:i.blockSize,this.childFragments=null==i?void 0:i.childFragments,this.data=i.data,this.node=n}),zl=e([cr(),B(0,v(Rl)),B(1,v(Fl)),B(2,v(Bl)),n("design:paramtypes",[Rl,Vt,Object])],zl),Vl=f.defineToken("LayoutChildrenFactory"),Hl=f.defineToken("LayoutChildrenOptions"),Gl=function(){function n(t,e){x(this,n),this._layoutContext=void 0,this.options=void 0,this.node=void 0,this.styleMap=void 0,this.layoutContext=void 0,this._layoutContext=t,this.options=e,this.layoutContext=t,this.node=e.node,this.styleMap=e.node.getAllStyle()}return w(n,[{key:"intrinsicSizes",value:function(){var t=new gu;return this.layoutContext.appendWorkTask({layoutChild:this,taskType:_l.IntrinsicSizes,deferred:t}),t.promise}},{key:"layoutNextFragment",value:function(t){if(this.layoutContext.mode===_l.IntrinsicSizes)throw new Error("Not Supported: cant call layoutNextFragment in intrinsicSizes");var e=new gu;return this.layoutContext.appendWorkTask({layoutConstraints:t,layoutChild:this,taskType:_l.Layout,deferred:e}),e.promise}}]),n}(),Gl=e([cr(),B(0,v(Rl)),B(1,v(Hl)),n("design:paramtypes",[Rl,Object])],Gl),Gt=w(function t(){x(this,t)}),Wl=(Gt.inputProperties=void 0,Gt.childrenInputProperties=void 0,Gt.layoutOptions=void 0,f.defineToken("LayoutEdgesFactory")),Ul=f.defineToken("LayoutEdgesOptions"),Yl=[0,0,0,0],ql=w(function t(e){x(this,t),this.options=void 0,this.inlineStart=void 0,this.inlineEnd=void 0,this.blockStart=void 0,this.blockEnd=void 0,this.inline=void 0,this.block=void 0;var e=(this.options=e).node.getAllStyle(),n=null!=(n=null==(n=e.get(Ml.PADDING_TOP))?void 0:n.value)?n:0,i=null!=(i=null==(i=e.get(Ml.PADDING_END))?void 0:i.value)?i:0,r=null!=(r=null==(r=e.get(Ml.PADDING_BOTTOM))?void 0:r.value)?r:0,o=null!=(o=null==(o=e.get(Ml.PADDING_START))?void 0:o.value)?o:0,a=null!=(a=null==(a=e.get(Ml.PADDING_TOP))?void 0:a.value)?a:0,s=null!=(s=null==(s=e.get(Ml.PADDING_END))?void 0:s.value)?s:0,u=null!=(u=null==(u=e.get(Ml.PADDING_BOTTOM))?void 0:u.value)?u:0,e=null!=(e=null==(e=e.get(Ml.PADDING_START))?void 0:e.value)?e:0;this.blockStart=n+Yl[0]+a,this.inlineStart=i+Yl[1]+s,this.blockEnd=r+Yl[2]+u,this.inlineEnd=o+Yl[3]+e,this.block=this.blockStart+this.blockEnd,this.inline=this.inlineStart+this.inlineEnd}),ql=e([cr(),B(0,v(Ul)),n("design:paramtypes",[Object])],ql),Xl=((re=function(){function t(){x(this,t),this.registry=new Map}return w(t,[{key:"size",get:function(){return this.registry.size}},{key:"hasLayout",value:function(t){return this.registry.has(t)}},{key:"getLayout",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"absolute";if(this.hasLayout(t))return this.registry.get(t);throw new Error("invalid layout property: ".concat(t))}},{key:"updateLayout",value:function(t,e){this.registry.set(t,e)}},{key:"registerLayout",value:function(t,e){if(""===t)throw new TypeError("layout name cant't be empty");if(Al.reservedLayout.includes(t))throw new Error("layout name '".concat(t,"' is a system reserved layout name, please use another name"));if(this.hasLayout(t))throw new Error("layout '".concat(t,"' already exist."));this.registry.set(t,e)}},{key:"deleteLayout",value:function(t){this.registry.delete(t)}}]),t}()).reservedLayout=[],Al=re),Xl=Al=e([y()],Xl),Kl=function(){function i(t,e,n){x(this,i),this._layoutRegistry=void 0,this._layoutContextFactory=void 0,this._layoutEdgesFactory=void 0,this.layoutRegistry=void 0,this.layoutContextFactory=void 0,this.layoutEdgesFactory=void 0,this._layoutRegistry=t,this._layoutContextFactory=e,this._layoutEdgesFactory=n,this.layoutRegistry=t,this.layoutContextFactory=e,this.layoutEdgesFactory=n}var r,o,a,n,e,s;return w(i,[{key:"computeLayout",value:(s=as(S().mark(function t(e,n){return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.determineIntrinsicSizes(e,e.children);case 2:return t.next=4,this.calculateLayout(e,e.children,n);case 4:case"end":return t.stop()}},t,this)})),function(t,e){return s.apply(this,arguments)})},{key:"determineAllIntrinsicSizes",value:(e=as(S().mark(function t(e){return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)})),function(t){return e.apply(this,arguments)})},{key:"getLayoutDefinitionName",value:function(t){t=t.getAllStyle().get(Ml.LAYOUT);if(t)return t.value;throw new Error("layout property not found")}},{key:"determineIntrinsicSizes",value:(n=as(S().mark(function t(e,n){var i;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.getLayoutDefinitionName(e),t.next=3,this.invokeIntrinsicSizesCallback(i,e,n);case 3:case"end":return t.stop()}},t,this)})),function(t,e){return n.apply(this,arguments)})},{key:"invokeIntrinsicSizesCallback",value:(a=as(S().mark(function t(e,n,i){var r,o,a,s,u;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=this.layoutRegistry.getLayout(e),a=new u,r=this.layoutContextFactory({mode:_l.IntrinsicSizes}),u=u.inputProperties,u=void 0===u?[]:u,o=[],i.forEach(function(t){t=r.layoutChildrenFactory({node:t});o.push(t)}),s=this.layoutEdgesFactory({node:n}),u=n.getStyle.apply(n,gs(u)),a=a.intrinsicSizes(o,s,u),(s=this.runWorkQueue(a,r.workQueue)).next(),t.next=13,Cl();case 13:u=s.next().value,r.clearWorkQueue(),n.setIntrisicSizes(u);case 16:case"end":return t.stop()}},t,this)})),function(t,e,n){return a.apply(this,arguments)})},{key:"calculateLayout",value:(o=as(S().mark(function t(e,n,i){var r;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.getLayoutDefinitionName(e),t.next=3,this.invokeLayoutCallback(r,e,n,i);case 3:case"end":return t.stop()}},t,this)})),function(t,e,n){return o.apply(this,arguments)})},{key:"invokeLayoutCallback",value:(r=as(S().mark(function t(e,n,i,r){var o,a,s,u,l,c;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=this.layoutRegistry.getLayout(e),c=new u,o=this.layoutContextFactory({mode:_l.Layout}),u=u.inputProperties,u=void 0===u?[]:u,a=[],i.forEach(function(t){t=o.layoutChildrenFactory({node:t});a.push(t)}),s=this.layoutEdgesFactory({node:n}),u=n.getStyle.apply(n,gs(u)),c=c.layout(a,s,r,u),(s=this.runWorkQueue(c,o.workQueue)).next(),t.next=13,Cl();case 13:u=s.next().value,o.clearWorkQueue(),l=u instanceof zl?u:o.fragmentResultFactory(u),c=o.layoutFragmentFactory({inlineSize:l.inlineSize,blockSize:l.blockSize,data:l.data}),n.setComputedLayout(c),i.forEach(function(t,e){t.setComputedLayout(l.childFragments[e])});case 19:case"end":return t.stop()}},t,this)})),function(t,e,n,i){return r.apply(this,arguments)})},{key:"runWorkQueue",value:S().mark(function t(e,n){var i,r=this;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=function(t){if(t.isRejected||t.isFulfilled)return t;var e,n=!0,i=!1,r=!1,t=t.then(function(t){return n=!(r=!0),e=t},function(t){throw n=!(i=!0),t});return t.isFulfilled=function(){return r},t.isPending=function(){return n},t.isRejected=function(){return i},t.getFullFilledValue=function(){return e},t}(e),0<n.length&&i.isPending()&&n.forEach(function(t){var e,n,i;t.taskType===_l.IntrinsicSizes&&(e=t.layoutChild,n=t.deferred,e=e.node,n.resolve(r.getNodeIntrisicSizes(e))),t.taskType===_l.Layout&&(n=t.layoutChild,e=t.deferred,t=t.layoutConstraints,i=n.node,n=n.layoutContext,i=r.getNodeFragment(i,t),e.resolve(n.layoutFragmentFactory(i)))}),void(t.next=4);case 4:if(i.isFulfilled()){t.next=6;break}throw new Error("promise not fullfilled!");case 6:return t.abrupt("return",i.getFullFilledValue());case 7:case"end":return t.stop()}},t)})},{key:"getNodeIntrisicSizes",value:function(t){var e,n=t.getAllStyle();return{minContentInlineSize:(null==(e=n.get(Ml.MIN_WIDTH))?void 0:e.value)||(null==(e=t.intrisicSizes)?void 0:e.minContentInlineSize)||(null==(e=n.get(Ml.WIDTH))?void 0:e.value)||0,maxContentInlineSize:(null==(e=n.get(Ml.MAX_WIDTH))?void 0:e.value)||(null==(e=t.intrisicSizes)?void 0:e.maxContentInlineSize)||(null==(e=n.get(Ml.WIDTH))?void 0:e.value)||0,minContentBlockSize:(null==(e=n.get(Ml.MIN_HEIGHT))?void 0:e.value)||(null==(e=t.intrisicSizes)?void 0:e.minContentBlockSize)||(null==(e=n.get(Ml.HEIGHT))?void 0:e.value)||0,maxContentBlockSize:(null==(e=n.get(Ml.MAX_HEIGHT))?void 0:e.value)||(null==(e=t.intrisicSizes)?void 0:e.maxContentBlockSize)||(null==(t=n.get(Ml.HEIGHT))?void 0:t.value)||0}}},{key:"getNodeFragment",value:function(t,e){var n;return{inlineSize:(null==(n=t.getComputedLayout())?void 0:n.inlineSize)||(null==(n=t.getAllStyle().get(Ml.MIN_WIDTH))?void 0:n.value)||(null==(n=t.getAllStyle().get(Ml.WIDTH))?void 0:n.value)||0,blockSize:(null==(n=t.getComputedLayout())?void 0:n.blockSize)||(null==(n=t.getAllStyle().get(Ml.MIN_HEIGHT))?void 0:n.value)||(null==(n=t.getAllStyle().get(Ml.HEIGHT))?void 0:n.value)||0,data:e.data}}}]),i}(),Kl=e([y(),B(0,v(Xl)),B(1,v(Ll)),B(2,v(Wl)),n("design:paramtypes",[Xl,Function,Function])],Kl),Zl=f.defineToken("LayoutFragmentFactory"),$l=f.defineToken("LayoutFragmentOptions"),Jl=w(function t(e,n){x(this,t),this._layoutContext=void 0,this.options=void 0,this.layoutContext=void 0,this.inlineSize=void 0,this.blockSize=void 0,this.inlineOffset=void 0,this.blockOffset=void 0,this.data=void 0,this._layoutContext=e,this.options=n,this.layoutContext=e,this.inlineSize=n.inlineSize,this.blockSize=n.blockSize,this.inlineOffset=0,this.blockOffset=0,this.data=n.data}),Jl=e([cr(),B(0,v(Rl)),B(1,v($l)),n("design:paramtypes",[Rl,Object])],Jl),c=function(t){return new L(t)},Ql=null;function tc(t){return function(e){var n=0;return t.map(function(t){return t===Ql?e[n++]:t})}}function ec(t){return t}var nc={rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],scale:["Nn",tc([Ql,Ql,c(1)]),ec],scalex:["N",tc([Ql,c(1),c(1)]),tc([Ql,c(1)])],scaley:["N",tc([c(1),Ql,c(1)]),tc([c(1),Ql])],scalez:["N",tc([c(1),c(1),Ql])],scale3d:["NNN",ec],translate:["Tt",tc([Ql,Ql,tl]),ec],translatex:["T",tc([Ql,tl,tl]),tc([Ql,tl])],translatey:["T",tc([tl,Ql,tl]),tc([tl,Ql])],translatez:["L",tc([tl,tl,Ql])],translate3d:["TTL",ec]};function ic(t){return t.replace(/[xy]/,"")}function rc(t){return t.replace(/(x|y|z|3d)?$/,"3d")}function oc(t){return"center"===t?"50%":"left"===t||"top"===t?"0":"right"===t||"bottom"===t?"100%":t}ve={parser:dl,mixer:pl,calculator:function(t,e,n,i){return new L(fl(n),"deg")}},d={calculator:function(t,e,n,i){var r;return n instanceof Ru&&(n=null),e&&e!==n&&e.style.clipPathTargets&&(r=e.style.clipPathTargets.indexOf(i),e.style.clipPathTargets.splice(r,1)),n&&(n.style.clipPathTargets||(n.style.clipPathTargets=[]),n.style.clipPathTargets.push(i)),td(i),n}},ge={parser:ul,calculator:function(t,e,n,i,r){return n instanceof Ru?new nl(0,0,0,0,"none"===n.value):n},mixer:function(t,e){if(t instanceof nl&&e instanceof nl)return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(Ys(e[n],0,255));return e[3]=Ys(e[3],0,1),"rgba(".concat(e.join(","),")")}]}},i={parser:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,i=[],r=0;e=n.exec(t);){if(e.index!==r)return[];if(r=e.index+e[0].length,-1<Ol.indexOf(e[1])&&i.push({name:e[1],params:e[2].split(" ").map(function(t){return Pl(t)||ul(t)})}),n.lastIndex===t.length)return i}return[]}};function ac(t){t=t.parsedStyle.fontSize;return t&&!L.isRelativeUnit(t.unit)?t.clone():new L(0,"px")}function sc(t){return t}var Ht={parser:hl,mixer:pl,calculator:function(t,e,n,i,r){return L.isRelativeUnit(n.unit)?n.unit===N.kPercentage?new L(0,"px"):n.unit===N.kEms?i.parentNode?((o=ac(i.parentNode)).value*=n.value,o):new L(0,"px"):n.unit===N.kRems?null!=i&&(null!=(o=i.ownerDocument)&&o.documentElement)?((o=ac(i.ownerDocument.documentElement)).value*=n.value,o):new L(0,"px"):void 0:n.clone();var o}},ne={parser:function(t){t=yl(Os(t)?[t]:t),t=1===t.length?[t[0],t[0]]:[t[0],t[1]];return t},mixer:vl},p={parser:function(t){t=yl(Os(t)?[t]:t),t=1===t.length?[t[0],t[0],t[0],t[0]]:2===t.length?[t[0],t[1],t[0],t[1]]:3===t.length?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]];return t},mixer:vl},ce={parser:bl,mixer:xl(0,1),postProcessor:function(t){var e;!t.attributes.offsetPath||(e=t.attributes.offsetPath.nodeName)!==m.LINE&&e!==m.PATH&&e!==m.POLYLINE||(e=t.attributes.offsetPath.getPoint(t.parsedStyle.offsetDistance.value))&&t.setLocalPosition(e.x,e.y)}},s={parser:bl,mixer:xl(0,1)},a={parser:function(t,e){var n,i,r,o,a,s,u,l,c,h,d,p,f,y,v,g=function(t){for(var e=!1,n=t.length,i=0;i<n;i++){var r=t[i][0];if("C"===r||"A"===r||"Q"===r){e=!0;break}}return e}(t=Ca(t)),m=t.slice(),b=(k=function(t){for(var e=[],n=[],i=[],r=0;r<t.length;r++){var o=t[r],a=o[0];"M"===a?(i.length&&(n.push(i),i=[]),i.push([o[1],o[2]])):"Z"===a?i.length&&(e.push(i),i=[]):i.push([o[1],o[2]])}0<i.length&&n.push(i);return{polygons:e,polylines:n}}(m)).polygons,k=k.polylines,x=(w=vs(function(t,e){void 0===e&&(e=!1);for(var n,i,r=Ca(t),o={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},a=[],s="",u=r.length,l=[],c=0;c<u;c+=1){r[c]&&(s=r[c][0]),a[c]=s,r[c]=Ba(r[c],o),y=f=p=d=h=void 0;var h=r,d=a,p=c;if(7<h[p].length){h[p].shift();for(var f=h[p],y=p;f.length;)d[p]="A",h.splice(y+=1,0,["C"].concat(f.splice(0,6)));h.splice(p,1)}u=r.length,"Z"===s&&l.push(c),i=(n=r[c]).length,o.x1=+n[i-2],o.y1=+n[i-1],o.x2=+n[i-4]||o.x1,o.y2=+n[i-3]||o.y1}return e?[r,l]:r}(m,!0),2))[0],w=w[1],m=Ya(m);u=s=0,l=[];var S=(E=(n=x)?(n.forEach(function(t,e){o=n[e+1],a=t.length,o&&(s+=wa.length(t[a-2],t[a-1],o[1],o[2],o[3],o[4],o[5],o[6])||0)}),0!==s?(n.forEach(function(t,e){o=n[e+1],a=t.length,o&&((i=[])[0]=u/s,r=wa.length(t[a-2],t[a-1],o[1],o[2],o[3],o[4],o[5],o[6]),u+=r||0,i[1]=u/s,l.push(i))}),{curveSegments:l,totalLength:s}):{curveSegments:[],totalLength:s}):{curveSegments:[],totalLength:s}).totalLength,E=E.curveSegments,T=(d=h=0,p=[],f=[],(c=x).forEach(function(t){var e=vs(t.slice(-2),2),n=e[0],e=e[1];"M"===t[0]?(h=n,d=e,p.push(n),f.push(e)):"C"===t[0]&&(t=wa.box.apply(wa,gs([h,d].concat(t.slice(1)))),p=p.concat(t.x,t.x+t.width),f=f.concat(t.y,t.y+t.height),h=n,d=e)}),c=Math.min.apply(0,p),y=Math.min.apply(0,f),T=Math.max.apply(0,p),v=Math.max.apply(0,f),new Cu(c,y,T-c,v-y));return e&&(e.parsedStyle.defX=T.x,e.parsedStyle.defY=T.y),{absolutePath:t,hasArc:g,segments:m,polygons:b,polylines:k,curve:x,totalLength:S,curveSegments:E,zCommandIndexes:w,rect:T}},calculator:function(t,e,n){return n instanceof Ru&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:[],totalLength:0,curveSegments:[],zCommandIndexes:[],rect:new Cu(0,0,0,0)}:n},mixer:function(t,e,n){var i,t=t.curve,e=e.curve,r=[t,e];return[e=El((r=t.length!==e.length?function t(e,n,i){var r,e=Sl(e),n=Sl(n),o=e.length,a=n.length,s=e.filter(function(t){return t.l}).length,u=n.filter(function(t){return t.l}).length,s=e.filter(function(t){return t.l}).reduce(function(t,e){return t+e.l},0)/s||0,u=n.filter(function(t){return t.l}).reduce(function(t,e){return t+e.l},0)/u||0,l=i||Math.max(o,a),c=[s,u],h=[l-o,l-a],i=[e,n].map(function(t,n){return t.l===l?t.map(function(t){return t.s}):t.map(function(t,e){return r=e&&h[n]&&t.l>=c[n],h[n]-=r?1:0,r?t.ss:[t.s]}).flat()});return i[0].length===i[1].length?i:t(i[0],i[1],l)}(t,e):r)[0])!==El(r[1])?(i=r[0],t=i.slice(1).map(function(t,e,n){return(e?n[e-1].slice(-2):i[0].slice(1)).concat(t.slice(1))}).map(function(n){return n.map(function(t,e){return n[n.length-e-2*(1-e%2)]})}).reverse(),[["M"].concat(t[0].slice(0,2))].concat(t.map(function(t){return["C"].concat(t.slice(2))}))):function e(t){return t.map(function(t){return Array.isArray(t)?e(t):Number.isNaN(+t)?t:+t})}(r[0]),Tl(r[1],e),function(t){return t}]},postProcessor:function(t){var e,n;t.nodeName===m.PATH&&(e=(n=t.parsedStyle).defX,n=n.defY,t.setLocalPosition(void 0===e?0:e,void 0===n?0:n))}},me={parser:function(t,e){var n,i,r=wc(t)?t.split(" ").map(function(t){var t=vs(t.split(","),2),e=t[0],t=t[1];return[Number(e),Number(t)]}):t,o=[],a=0,s=Sa(r),t=(r.forEach(function(t,e){r[e+1]&&((n=[0,0])[0]=a/s,i=va.length(t[0],t[1],r[e+1][0],r[e+1][1]),a+=i,n[1]=a/s,o.push(n))}),Math.min.apply(Math,gs(r.map(function(t){return t[0]})))),u=Math.min.apply(Math,gs(r.map(function(t){return t[1]})));return e&&(e.parsedStyle.defX=t,e.parsedStyle.defY=u),{points:r,totalLength:s,segments:o}},postProcessor:function(t){var e,n;t.nodeName!==m.POLYGON&&t.nodeName!==m.POLYLINE||(e=(n=t.parsedStyle).defX,n=n.defY,t.setLocalPosition(e,n))}},ie={parser:Ht.parser,mixer:xl(0,1/0),calculator:Ht.calculator},u={calculator:function(t,e,n,i){return n instanceof Ru?"unset"===n.value?"":n.value:n},postProcessor:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}},kn={parser:function(t){if("none"===(t=(t||"none").toLowerCase().trim()))return[];for(var e,n=/\s*(\w+)\(([^)]*)\)/g,i=[],r=0;e=n.exec(t);){if(e.index!==r)return[];var r=e.index+e[0].length,o=e[1],a=nc[o];if(!a)return[];var s=e[2].split(","),u=a[0];if(u.length<s.length)return[];for(var l=[],c=0;c<u.length;c++){var h=s[c],d=u[c],p=void 0;if(void 0===(p=h?{A:function(t){return"0"===t.trim()?el:dl(t)},N:bl,T:hl,L:cl}[d.toUpperCase()](h):{a:el,n:l[0],t:tl}[d]))return[];l.push(p)}if(i.push({t:o,d:l}),n.lastIndex===t.length)return i}return[]},mixer:function(i,r,t){var e=!1;if(!i.length||!r.length){i.length||(e=!0,i=r,r=[]);for(var n=0;n<i.length;n++)!function(t){var t=i[t],e=t.t,t=t.d,n="scale"===e.substr(0,5)?1:0;r.push({t:e,d:t.map(function(t){return"number"==typeof t?new L(n):new L(n,t.unit)})})}(n)}var o,a,s=[],u=[],l=[];if(i.length===r.length)for(var c=0;c<i.length;c++){var h=i[c].t,d=r[c].t,p=i[c].d,f=r[c].d,y=nc[h],v=nc[d],g=void 0;if(a=d,("perspective"!==(o=h)||"perspective"!==a)&&("matrix"!==o&&"matrix3d"!==o||"matrix"!==a&&"matrix3d"!==a)){if(h===d)g=h;else if(y[2]&&v[2]&&ic(h)===ic(d))g=ic(h),p=y[2](p),f=v[2](f);else{if(!y[1]||!v[1]||rc(h)!==rc(d))break;g=rc(h),p=y[1](p),f=v[1](f)}for(var m=[],b=[],k=[],x=0;x<p.length;x++){var w=(p[x].unit===N.kNumber?kl:pl)(p[x],f[x],t,!1,x);m[x]=w[0],b[x]=w[1],k.push(w[2])}s.push(m),u.push(b),l.push([g,k])}}return e&&(e=s,s=u,u=e),[s,u,function(t){return t.map(function(t,n){t=t.map(function(t,e){return l[n][1][e](t)}).join(",");return"matrix"===l[n][0]&&16===t.split(",").length&&(l[n][0]="matrix3d"),l[n][0]+"("+t+")"}).join(" ")}]},postProcessor:function(i){var t=i.parsedStyle,e=t.transform,n=t.defX,t=t.defY;e&&e.length&&(i.resetLocalTransform(),i.setLocalPosition(n,t),e.forEach(function(t){var e,n=t.t,t=t.d;"scale"===n?(e=t.map(function(t){return t.value})||[1,1],i.scaleLocal(e[0],e[1],1)):"scalex"===n?(e=t.map(function(t){return t.value})||[1],i.scaleLocal(e[0],1,1)):"scaley"===n?(e=t.map(function(t){return t.value})||[1],i.scaleLocal(1,e[0],1)):"scalez"===n?(e=t.map(function(t){return t.value})||[1],i.scaleLocal(1,1,e[0])):"scale3d"===n?(e=t.map(function(t){return t.value})||[1,1,1],i.scaleLocal(e[0],e[1],e[2])):"translate"===n?i.translateLocal((e=t||[tl,tl])[0].value,e[1].value,0):"translatex"===n?i.translateLocal((t||[tl])[0].value,0,0):"translatey"===n?i.translateLocal(0,(t||[tl])[0].value,0):"translatez"===n?i.translateLocal(0,0,(t||[tl])[0].value):"translate3d"===n?i.translateLocal((e=t||[tl,tl,tl])[0].value,e[1].value,e[2].value):"rotate"===n?i.rotateLocal(0,0,(t||[el])[0].value):"rotatex"===n?i.rotateLocal((t||[el])[0].value,0,0):"rotatey"===n?i.rotateLocal(0,(t||[el])[0].value,0):"rotatez"===n&&i.rotateLocal(0,0,(t||[el])[0].value)}))}},h={parser:function(t){var e;return wc(t)?(1===(e=t.split(" ")).length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length?null:[hl(oc(e[0])),hl(oc(e[1]))]):[new L(t[0]||0,"px"),new L(t[1]||0,"px")]}},l={parser:bl,postProcessor:function(t){var e;t.parentNode&&(e=(t=t.parentNode).renderable,t=t.sortable,e&&(e.dirty=!0),t&&(t.dirty=!0))}},uc=(us(o={},b.COORDINATE,{parser:Ht.parser,mixer:Ht.mixer,calculator:Ht.calculator,postProcessor:function(t){switch(t.nodeName){case m.CIRCLE:case m.ELLIPSE:var e=t.parsedStyle,n=e.cx,e=e.cy;A(n)||(o=n.value),A(e)||(a=e.value);break;case m.LINE:var n=t.parsedStyle,e=n.x1,i=n.x2,r=n.y1,n=n.y2,o=Math.min(e.value,i.value),a=Math.min(r.value,n.value),s=0;break;default:A(t.parsedStyle.x)||(o=t.parsedStyle.x.value),A(t.parsedStyle.y)||(a=t.parsedStyle.y.value)}t.parsedStyle.defX=o||0,t.parsedStyle.defY=a||0;var u=vs(t.getLocalPosition(),3),l=u[0],c=u[1],u=u[2];t.setLocalPosition(A(o)?l:o,A(a)?c:a,A(s)?u:s)}}),us(o,b.ANGLE,ve),us(o,b.COLOR,ge),us(o,b.PAINT,ge),us(o,b.OPACITY_VALUE,s),us(o,b.LENGTH_PERCENTAGE,Ht),us(o,b.LENGTH_PERCENTAGE_12,ne),us(o,b.LENGTH_PERCENTAGE_14,p),us(o,b.SHADOW_BLUR,ie),us(o,b.LIST_OF_POINTS,me),us(o,b.PATH,a),us(o,b.FILTER,i),us(o,b.Z_INDEX,l),us(o,b.OFFSET_PATH,{calculator:function(t,e,n,i){var r;return e&&e!==n&&e.style.offsetPathTargets&&(r=e.style.offsetPathTargets.indexOf(i),e.style.offsetPathTargets.splice(r,1)),n&&(n.style.offsetPathTargets||(n.style.offsetPathTargets=[]),n.style.offsetPathTargets.push(i)),n}}),us(o,b.OFFSET_DISTANCE,ce),us(o,b.CLIP_PATH,d),us(o,b.TRANSFORM,kn),us(o,b.TRANSFORM_ORIGIN,h),us(o,b.TEXT,u),us(o,b.TEXT_TRANSFORM,{calculator:function(t,e,n,i){var r,o=i.getAttribute("text");return o&&(r=o,"capitalize"===n.value?r=o.charAt(0).toUpperCase()+o.slice(1):"lowercase"===n.value?r=o.toLowerCase():"uppercase"===n.value&&(r=o.toUpperCase()),i.parsedStyle.text=r),n}}),o),lc=[{name:"display",keywords:["none"]},{name:"opacity",interpolable:!0,defaultValue:"1",syntax:b.OPACITY_VALUE},{name:"fillOpacity",interpolable:!0,inherited:!0,defaultValue:"1",syntax:b.OPACITY_VALUE},{name:"strokeOpacity",interpolable:!0,inherited:!0,defaultValue:"1",syntax:b.OPACITY_VALUE},{name:"fill",interpolable:!0,keywords:["none"],defaultValue:"none",syntax:b.PAINT},{name:"stroke",interpolable:!0,keywords:["none"],defaultValue:"none",syntax:b.PAINT},{name:"shadowColor",interpolable:!0,syntax:b.COLOR},{name:"shadowOffsetX",interpolable:!0,layoutDependent:!0,syntax:b.LENGTH_PERCENTAGE},{name:"shadowOffsetY",interpolable:!0,layoutDependent:!0,syntax:b.LENGTH_PERCENTAGE},{name:"shadowBlur",interpolable:!0,layoutDependent:!0,syntax:b.SHADOW_BLUR},{name:"lineWidth",interpolable:!0,inherited:!0,defaultValue:"1",layoutDependent:!0,alias:["strokeWidth"],syntax:b.LENGTH_PERCENTAGE},{name:"increasedLineWidthForHitTesting",inherited:!0,defaultValue:"0",layoutDependent:!0,syntax:b.LENGTH_PERCENTAGE},{name:"lineJoin",inherited:!0,layoutDependent:!0,alias:["strokeLinejoin"],keywords:["miter","bevel","round"],defaultValue:"miter"},{name:"lineCap",inherited:!0,layoutDependent:!0,alias:["strokeLinecap"],keywords:["butt","round","square"],defaultValue:"butt"},{name:"lineDash",interpolable:!0,inherited:!0,keywords:["none"],alias:["strokeDasharray"],syntax:b.LENGTH_PERCENTAGE_12},{name:"lineDashOffset",interpolable:!0,inherited:!0,defaultValue:"0",alias:["strokeDashoffset"],syntax:b.LENGTH_PERCENTAGE},{name:"offsetPath",syntax:b.OFFSET_PATH},{name:"offsetDistance",interpolable:!0,syntax:b.OFFSET_DISTANCE},{name:"dx",interpolable:!0,layoutDependent:!0,defaultValue:"0",syntax:b.LENGTH_PERCENTAGE},{name:"dy",interpolable:!0,layoutDependent:!0,defaultValue:"0",syntax:b.LENGTH_PERCENTAGE},{name:"zIndex",independent:!0,interpolable:!0,defaultValue:"0",keywords:["auto"],syntax:b.Z_INDEX},{name:"visibility",keywords:["visible","hidden"],independent:!0,inherited:!0,defaultValue:"visible"},{name:"pointerEvents",inherited:!0,keywords:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","bounding-box","all"],defaultValue:"auto"},{name:"filter",independent:!0,layoutDependent:!0,syntax:b.FILTER},{name:"clipPath",syntax:b.CLIP_PATH},{name:"transform",parsePriority:100,interpolable:!0,keywords:["none"],defaultValue:"none",syntax:b.TRANSFORM},{name:"transformOrigin",parsePriority:100,defaultValue:"left top",layoutDependent:!0,syntax:b.TRANSFORM_ORIGIN},{name:"anchor",parsePriority:99,defaultValue:"0 0",layoutDependent:!0,syntax:b.LENGTH_PERCENTAGE_12},{name:"cx",interpolable:!0,defaultValue:"0",syntax:b.COORDINATE},{name:"cy",interpolable:!0,defaultValue:"0",syntax:b.COORDINATE},{name:"r",interpolable:!0,layoutDependent:!0,defaultValue:"0",syntax:b.LENGTH_PERCENTAGE},{name:"rx",interpolable:!0,layoutDependent:!0,defaultValue:"auto",syntax:b.LENGTH_PERCENTAGE},{name:"ry",interpolable:!0,layoutDependent:!0,defaultValue:"auto",syntax:b.LENGTH_PERCENTAGE},{name:"x",interpolable:!0,defaultValue:"0",syntax:b.COORDINATE},{name:"y",interpolable:!0,defaultValue:"0",syntax:b.COORDINATE},{name:"z",interpolable:!0,defaultValue:"0",syntax:b.COORDINATE},{name:"width",interpolable:!0,layoutDependent:!0,keywords:["auto","fit-content","min-content","max-content"],defaultValue:"auto",syntax:b.LENGTH_PERCENTAGE},{name:"height",interpolable:!0,layoutDependent:!0,keywords:["auto","fit-content","min-content","max-content"],defaultValue:"auto",syntax:b.LENGTH_PERCENTAGE},{name:"radius",interpolable:!0,layoutDependent:!0,defaultValue:"0",syntax:b.LENGTH_PERCENTAGE_14},{name:"x1",interpolable:!0,layoutDependent:!0,syntax:b.COORDINATE},{name:"y1",interpolable:!0,layoutDependent:!0,syntax:b.COORDINATE},{name:"z1",interpolable:!0,layoutDependent:!0,syntax:b.COORDINATE},{name:"x2",interpolable:!0,layoutDependent:!0,syntax:b.COORDINATE},{name:"y2",interpolable:!0,layoutDependent:!0,syntax:b.COORDINATE},{name:"z2",interpolable:!0,layoutDependent:!0,syntax:b.COORDINATE},{name:"path",interpolable:!0,layoutDependent:!0,defaultValue:"",alias:["d"],syntax:b.PATH},{name:"points",layoutDependent:!0,syntax:b.LIST_OF_POINTS},{name:"text",layoutDependent:!0,defaultValue:"",syntax:b.TEXT,parsePriority:50},{name:"textTransform",layoutDependent:!0,inherited:!0,keywords:["capitalize","uppercase","lowercase","none"],defaultValue:"none",syntax:b.TEXT_TRANSFORM,parsePriority:51},{name:"font",layoutDependent:!0},{name:"fontSize",interpolable:!0,inherited:!0,defaultValue:"16px",layoutDependent:!0,syntax:b.LENGTH_PERCENTAGE},{name:"fontFamily",layoutDependent:!0,inherited:!0,defaultValue:"sans-serif"},{name:"fontStyle",layoutDependent:!0,inherited:!0,keywords:["normal","italic","oblique"],defaultValue:"normal"},{name:"fontWeight",layoutDependent:!0,inherited:!0,keywords:["normal","bold","bolder","lighter"],defaultValue:"normal"},{name:"fontVariant",layoutDependent:!0,inherited:!0,keywords:["normal","small-caps"],defaultValue:"normal"},{name:"lineHeight",layoutDependent:!0},{name:"letterSpacing",layoutDependent:!0},{name:"wordWrap",layoutDependent:!0},{name:"wordWrapWidth",layoutDependent:!0},{name:"leading",layoutDependent:!0},{name:"textBaseline",layoutDependent:!0,inherited:!0,keywords:["top","hanging","middle","alphabetic","ideographic","bottom"],defaultValue:"alphabetic"},{name:"textAlign",layoutDependent:!0,inherited:!0,keywords:["start","center","end","left","right"],defaultValue:"start"},{name:"whiteSpace",layoutDependent:!0}],cc=function(){function t(){x(this,t),this.dirty=!1,this.cache={},this.unresolvedProperties={},this.cascadeProperties={}}return w(t,[{key:"init",value:function(){var e=this;lc.forEach(function(t){e.registerMetadata(t)})}},{key:"registerMetadata",value:function(e){var n=this;[e.name].concat(gs(e.alias||[])).forEach(function(t){n.cache[t]=e})}},{key:"unregisterMetadata",value:function(t){delete this.cache[t]}},{key:"getMetadata",value:function(t){return this.cache[t]}},{key:"processProperties",value:function(n,i){var r=this,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1},o=t.skipUpdateAttribute,t=t.skipParse,a=!1,e=(Object.keys(i).forEach(function(t){var t=vs(Mc(t,i[t]),2),e=t[0],t=t[1];o||(n.attributes[e]=t),!a&&null!=(t=r.getMetadata(e))&&t.layoutDependent&&(a=!0)}),Object.keys(i).sort(function(t,e){return((null==(t=r.getMetadata(t))?void 0:t.parsePriority)||0)-((null==(t=r.getMetadata(e))?void 0:t.parsePriority)||0)})),s=(t||e.forEach(function(t){n.computedStyle[t]=r.parseProperty(t,n.attributes[t],n)}),!1);e.forEach(function(t){t in n.computedStyle&&(s=r.computeProperty(t,n.computedStyle[t],n))}),s?this.dirty=!0:(a&&this.updateGeometry(n),e.forEach(function(t){t in n.parsedStyle&&r.postProcessProperty(t,n)}),e.forEach(function(e){e in n.parsedStyle&&r.isPropertyInheritable(e)&&n.children.forEach(function(t){t.internalSetAttribute(e,null,{skipUpdateAttribute:!0,skipParse:!0})})}))}},{key:"parseProperty",value:function(t,e,n){var i,t=this.getMetadata(t),r=e;return"unset"===(e=""!==e&&!A(e)?e:"unset")||"initial"===e||"inherit"===e?r=new Ru(e):t&&(i=t.keywords,t=(t=t.syntax)&&uc[t],i&&-1<i.indexOf(e)?r=new Ru(e):t&&t.parser&&(r=t.parser(e,n))),r}},{key:"computeProperty",value:function(t,e,n){var i=this.getMetadata(t),r="g-root"===n.id,o=e instanceof Iu?e.clone():e;if(i){var a=i.syntax,s=i.inherited,i=i.defaultValue;if(e instanceof Ru){var u=e.value;if("initial"===(u="unset"===u?s&&!r?"inherit":"initial":u))A(i)||(e=this.parseProperty(t,i,n));else if("inherit"===u)return(s=this.tryToResolveProperty(n,t,{inherited:!0}))?(n.parsedStyle[t]=s,!1):(this.addUnresolveProperty(n,t),!0)}r=a&&uc[a];o=r&&r.calculator?(i=n.parsedStyle[t],r.calculator(t,i,e,n,this)):e}return n.parsedStyle[t]=o,!1}},{key:"postProcessProperty",value:function(t,e){var t=this.getMetadata(t);t&&t.syntax&&((t=t.syntax&&uc[t.syntax])&&t.postProcessor&&t.postProcessor(e))}},{key:"isPropertyResolved",value:function(t,e){return!this.unresolvedProperties[t.entity]||0===this.unresolvedProperties[t.entity].length||this.unresolvedProperties[t.entity].includes(e)}},{key:"addUnresolveProperty",value:function(t,e){this.unresolvedProperties[t.entity]||(this.unresolvedProperties[t.entity]=[]),-1===this.unresolvedProperties[t.entity].indexOf(e)&&this.unresolvedProperties[t.entity].push(e)}},{key:"tryToResolveProperty",value:function(t,e){var n=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).inherited;if(n&&(t.parentElement&&this.isPropertyResolved(t.parentElement,e)))return(!((n=t.parentElement.parsedStyle[e])instanceof Ru)||"unset"!==n.value&&"initial"!==n.value&&"inherit"!==n.value)&&(!(n instanceof L&&L.isRelativeUnit(n.unit))&&n);return!1}},{key:"recalc",value:function(e){var n,t=this.unresolvedProperties[e.entity];t&&t.length&&(n={},t.forEach(function(t){n[t]=e.attributes[t]}),this.processProperties(e,n),delete this.unresolvedProperties[e.entity])}},{key:"updateGeometry",value:function(t){var s,e,n,i,r,o,a,u,l,c,h,d=Dr.get(Tu)(t.nodeName);d&&((s=t.geometry).contentBounds||(s.contentBounds=new Mu),s.renderBounds||(s.renderBounds=new Mu),e=t.parsedStyle,u=(d=d.update(e,t)).width,o=d.height,a=d.depth,c=void 0===(c=d.offsetX)?0:c,h=void 0===(h=d.offsetY)?0:h,d=void 0===(d=d.offsetZ)?0:d,u=g(u/2,o/2,(void 0===a?0:a)/2),o=e.lineWidth,a=e.increasedLineWidthForHitTesting,l=e.shadowColor,n=void 0===(n=e.filter)?[]:n,i=e.transformOrigin,r=e.anchor,t.nodeName===m.TEXT&&delete e.anchor,h=g((1-2*(r&&r[0].value||0))*u[0]+c,(1-2*(r&&r[1].value||0))*u[1]+h,(1-2*(r&&(null==(c=r[2])?void 0:c.value)||0))*u[2]+d),s.contentBounds.update(h,u),co(u,u,g(c=(((null==o?void 0:o.value)||0)+((null==a?void 0:a.value)||0))/2,c,0)),s.renderBounds.update(h,u),l&&(o=(d=s.renderBounds).min,a=d.max,c=e.shadowBlur,h=e.shadowOffsetX,u=e.shadowOffsetY,l=c&&c.value||0,d=h&&h.value||0,c=u&&u.value||0,h=o[0]-l+d,u=a[0]+l+d,d=o[1]-l+c,l=a[1]+l+c,o[0]=Math.min(o[0],h),a[0]=Math.max(a[0],u),o[1]=Math.min(o[1],d),a[1]=Math.max(a[1],l),s.renderBounds.setMinMax(o,a)),n.forEach(function(t){var e,n,i,r,o,a=t.name,t=t.params;"blur"===a?(r=t[0].value,s.renderBounds.update(s.renderBounds.center,co(s.renderBounds.halfExtents,s.renderBounds.halfExtents,g(r,r,0)))):"drop-shadow"===a&&(r=t[0].value,a=t[1].value,t=t[2].value,e=(n=s.renderBounds).min,n=n.max,i=e[0]-t+r,r=n[0]+t+r,o=e[1]-t+a,t=n[1]+t+a,e[0]=Math.min(e[0],i),n[0]=Math.max(n[0],r),e[1]=Math.min(e[1],o),n[1]=Math.max(n[1],t),s.renderBounds.setMinMax(e,n))}),r=e.anchor,c=gl(i[0],0,t),h=gl(i[1],1,t),c-=(r&&r[0].value||0)*s.contentBounds.halfExtents[0]*2,h-=(r&&r[1].value||0)*s.contentBounds.halfExtents[1]*2,t.setOrigin(c,h),t.emit(C.GEOMETRY_BOUNDS_CHANGED,{}),td(t))}},{key:"isPropertyInheritable",value:function(t){t=this.getMetadata(t);return!!t&&t.inherited}}]),t}();e([Kt.postConstruct(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],cc.prototype,"init",null),cc=e([y({token:Eu})],cc);function hc(n,i){return function(t){if(1<=t)return 1;var e=1/n;return(t+=i*e)-t%e}}var r="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",dc=new RegExp("cubic-bezier\\("+r+","+r+","+r+","+r+"\\)"),pc=/steps\(\s*(\d+)\s*\)/,fc=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function yc(t){var e=dc.exec(t);if(e)return Ds.apply(void 0,gs(e.slice(1).map(Number)));e=pc.exec(t);if(e)return hc(Number(e[1]),0);e=fc.exec(t);return e?hc(Number(e[1]),{start:1,middle:.5,end:0}[e[2]]):yu[vu(t)]||yu.linear}function vc(t){return Math.abs((0!==(e=t).duration&&0!==e.iterations?("auto"===e.duration?0:Number(e.duration))*(null!=(e=e.iterations)?e:1):0)/(t.playbackRate||1));var e}var gc=0,mc=1,bc=2,kc=3;function xc(t,e,n){var i=function(t,e,n){if(null===e)return gc;var i=n.endTime;return e<Math.min(n.delay,i)?mc:e>=Math.min(n.delay+t+n.endDelay,i)?bc:kc}(t,e,n),t=function(t,e,n,i,r){switch(i){case mc:return"backwards"===e||"both"===e?0:null;case kc:return n-r;case bc:return"forwards"===e||"both"===e?t:null;case gc:return null}}(t,n.fill,e,i,n.delay);if(null===t)return null;var r,o,e="auto"===n.duration?0:n.duration,a=(o=e,a=i,s=n.iterations,r=t,u=n.iterationStart,0===o?a!==mc&&(u+=s):u+=r/o,u),s=(s=a,r=n.iterationStart,o=i,u=n.iterations,t=t,e=e,r=0!==(r=s===1/0?r%1:s%1)||o!==bc||0===u||0===t&&0!==e?r:1),e=(o=n.iterations,u=s,t=a,i===bc&&o===1/0?1/0:1===u?Math.floor(t)-1:Math.floor(t)),u=(r=n.direction,a=e,i=s,"normal"!==(o=r)&&"reverse"!==r&&(a=a,"alternate-reverse"===r&&(a+=1),o=a!==1/0&&a%2!=0?"reverse":"normal"),"normal"===o?i:1-i);return n.currentIteration=e,n.progress=u,n.easingFunction(u)}function wc(t){return!A(t)&&"string"==typeof t}function Sc(t,e,n){var o=function(t,e){for(var n={},i=0;i<t.length;i++)for(var r in t[i]){var o;Ec(r)&&(o={offset:t[i].offset,computedOffset:t[i].computedOffset,easing:t[i].easing,easingFunction:yc(t[i].easing)||e.easingFunction,value:t[i][r]},n[r]=n[r]||[],n[r].push(o))}return n}(t,e),a=function(t,e){var n,i=[];for(n in t)for(var r=t[n],o=0;o<r.length-1;o++){var a=o,s=o+1,u=r[a].computedOffset,l=r[s].computedOffset,c=u,h=l;0===o&&(c=-1/0,0===l&&(s=a)),o===r.length-2&&(h=1/0,1===u&&(a=s)),i.push({applyFrom:c,applyTo:h,startOffset:r[a].computedOffset,endOffset:r[s].computedOffset,easingFunction:r[a].easingFunction,property:n,interpolation:function(t,e,n,i){var r=e,o=n,t=Dr.get(Eu).getMetadata(t);if(t&&t.syntax&&t.interpolable&&uc[t.syntax]){t=uc[t.syntax];if(t){t.parser&&(r=t.parser(e,i),o=t.parser(n,i));var a,t=t.mixer(r,o,i);if(t)return a=Tc.apply(void 0,gs(t)),function(t){return 0===t?e:1===t?n:a(t)}}}return Tc(!1,!0,function(t){return t?n:e})}(n,r[a].value,r[s].value,e)})}return i.sort(function(t,e){return t.startOffset-e.startOffset}),i}(o,n);return function(i,r){if(null!==r)a.filter(function(t){return r>=t.applyFrom&&r<t.applyTo}).forEach(function(t){var e=r-t.startOffset,n=t.endOffset-t.startOffset,e=0==n?0:t.easingFunction(e/n);i.style[t.property]=t.interpolation(e)});else for(var t in o)Ec(t)&&(i.style[t]=null)}}function Ec(t){return"offset"!==t&&"easing"!==t&&"composite"!==t&&"computedOffset"!==t}var Tc=function(e,n,i){return function(t){return i(function t(e,n,i){if("number"==typeof e&&"number"==typeof n)return e*(1-i)+n*i;if("boolean"==typeof e&&"boolean"==typeof n||"string"==typeof e&&"string"==typeof n)return i<.5?e:n;if(Array.isArray(e)&&Array.isArray(n)&&e.length===n.length){for(var r=[],o=0;o<e.length;o++)r.push(t(e[o],n[o],i));return r}throw new Error("Mismatched interpolation arguments "+e+":"+n)}(e,n,t))}};var _c={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign",values:{middle:"center"}},src:{alias:"img"}};function Mc(t,e){var t=function(t){return(0<arguments.length&&void 0!==t?t:"").replace(/-([a-z])/g,function(t){return t[1].toUpperCase()})}(t),n=_c[t];return[t=(null==n?void 0:n.alias)||t,(null==n||null==(t=n.values)?void 0:t[e])||e]}function Pc(){return this.call=this._createCall("sync"),this.call.apply(this,arguments)}function Oc(){return this.callAsync=this._createCall("async"),this.callAsync.apply(this,arguments)}function Cc(){return this.promise=this._createCall("promise"),this.promise.apply(this,arguments)}function Ac(t){return Vc.setup(this,t),Vc.create(t)}function Nc(t){return Gc.setup(this,t),Gc.create(t)}function Lc(){throw new Error("tapAsync is not supported on a SyncHook")}function Ic(){throw new Error("tapPromise is not supported on a SyncHook")}function Dc(t){return Uc.setup(this,t),Uc.create(t)}function Rc(){throw new Error("tapAsync is not supported on a SyncWaterfallHook")}function jc(){throw new Error("tapPromise is not supported on a SyncWaterfallHook")}function Bc(t){return qc.setup(this,t),qc.create(t)}var Fc=function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;x(this,n),this.name=void 0,this.taps=void 0,this.promise=void 0,this._promise=void 0,this._args=t,this.name=e,this.taps=[],this.interceptors=[],this._call=Pc,this.call=Pc,this._callAsync=Oc,this.callAsync=Oc,this._promise=Cc,this.promise=Cc,this._x=void 0}return w(n,[{key:"compile",value:function(t){throw new Error("Abstract: should be overridden")}},{key:"_createCall",value:function(t){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:t})}},{key:"_tap",value:function(t,e,n){if("string"==typeof e)e={name:e.trim()};else if("object"!==rs(e)||null===e)throw new Error("Invalid tap options");if("string"!=typeof e.name||""===e.name)throw new Error("Missing name for tap");e=Object.assign({type:t,fn:n},e),e=this._runRegisterInterceptors(e),this._insert(e)}},{key:"tap",value:function(t,e){this._tap("sync",t,e)}},{key:"tapAsync",value:function(t,e){this._tap("async",t,e)}},{key:"tapPromise",value:function(t,e){this._tap("promise",t,e)}},{key:"_runRegisterInterceptors",value:function(t){var e,n=ks(this.interceptors);try{for(n.s();!(e=n.n()).done;){var i,r=e.value;!r.register||void 0!==(i=r.register(t))&&(t=i)}}catch(t){n.e(t)}finally{n.f()}return t}},{key:"withOptions",value:function(e){function n(t){return Object.assign({},e,"string"==typeof t?{name:t}:t)}var i=this;return{name:this.name,tap:function(t,e){return i.tap(n(t),e)},tapAsync:function(t,e){return i.tapAsync(n(t),e)},tapPromise:function(t,e){return i.tapPromise(n(t),e)},isUsed:function(){return i.isUsed()},withOptions:function(t){return i.withOptions(n(t))}}}},{key:"isUsed",value:function(){return 0<this.taps.length||0<this.interceptors.length}},{key:"_resetCompilation",value:function(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise}},{key:"_insert",value:function(t){this._resetCompilation(),"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));for(var e,n=0,i=("number"==typeof t.stage&&(n=t.stage),this.taps.length);0<i;){i--;var r=this.taps[i],o=(this.taps[i+1]=r).stage||0;if(e){if(e.has(r.name)){e.delete(r.name);continue}if(0<e.size)continue}if(!(n<o)){i++;break}}this.taps[i]=t}}]),n}(),zc=function(){function e(t){x(this,e),this.config=t,this.options=void 0,this._args=void 0}return w(e,[{key:"create",value:function(t){var e;switch(this.init(t),this.options.type){case"sync":e=new Function(this.args(),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:function(t){return"throw ".concat(t,";\n")},onResult:function(t){return"return ".concat(t,";\n")},resultReturns:!0,onDone:function(){return""},rethrowIfPossible:!0}));break;case"async":e=new Function(this.args({after:"_callback"}),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:function(t){return"_callback(".concat(t,");\n")},onResult:function(t){return"_callback(null, ".concat(t,");\n")},onDone:function(){return"_callback();\n"}}));break;case"promise":var n=!1,i=this.contentWithInterceptors({onError:function(t){return n=!0,"_error(".concat(t,");\n")},onResult:function(t){return"_resolve(".concat(t,");\n")},onDone:function(){return"_resolve();\n"}}),r="",r=(r+='"use strict";\n')+this.header()+"return new Promise((function(_resolve, _reject) {\n";n&&(r+="var _sync = true;\nfunction _error(_err) {\nif(_sync)\n_resolve(Promise.resolve().then((function() { throw _err; })));\nelse\n_reject(_err);\n};\n"),r+=i,n&&(r+="_sync = false;\n"),r+="}));\n",e=new Function(this.args(),r)}return this.deinit(),e}},{key:"setup",value:function(t,e){t._x=e.taps.map(function(t){return t.fn})}},{key:"init",value:function(t){this.options=t,this._args=t.args.slice()}},{key:"deinit",value:function(){this.options=void 0,this._args=void 0}},{key:"contentWithInterceptors",value:function(t){var i=this;if(0<this.options.interceptors.length){for(var r=t.onError,o=t.onResult,n=t.onDone,e="",a=0;a<this.options.interceptors.length;a++){var s=this.options.interceptors[a];s.call&&(e+="".concat(this.getInterceptor(a),".call(").concat(this.args({before:s.context?"_context":void 0}),");\n"))}return e+=this.content(Object.assign(t,{onError:r&&function(t){for(var e="",n=0;n<i.options.interceptors.length;n++)i.options.interceptors[n].error&&(e+="".concat(i.getInterceptor(n),".error(").concat(t,");\n"));return e+=r(t)},onResult:o&&function(t){for(var e="",n=0;n<i.options.interceptors.length;n++)i.options.interceptors[n].result&&(e+="".concat(i.getInterceptor(n),".result(").concat(t,");\n"));return e+=o(t)},onDone:n&&function(){for(var t="",e=0;e<i.options.interceptors.length;e++)i.options.interceptors[e].done&&(t+="".concat(i.getInterceptor(e),".done();\n"));return t+=n()}}))}return this.content(t)}},{key:"header",value:function(){var t="";return this.needContext()?t+="var _context = {};\n":t+="var _context;\n",t+="var _x = this._x;\n",0<this.options.interceptors.length&&(t+="var _taps = this.taps;\nvar _interceptors = this.interceptors;\n"),t}},{key:"needContext",value:function(){var t,e=ks(this.options.taps);try{for(e.s();!(t=e.n()).done;)if(t.value.context)return!0}catch(t){e.e(t)}finally{e.f()}return!1}},{key:"callTap",value:function(t,e){for(var n=e.onError,i=e.onResult,r=e.onDone,o=e.rethrowIfPossible,a="",s=!1,u=0;u<this.options.interceptors.length;u++){var l=this.options.interceptors[u];l.tap&&(s||(a+="var _tap".concat(t," = ").concat(this.getTap(t),";\n"),s=!0),a+="".concat(this.getInterceptor(u),".tap(").concat(l.context?"_context, ":"","_tap").concat(t,");\n"))}a+="var _fn".concat(t," = ").concat(this.getTapFn(t),";\n");var c=this.options.taps[t];switch(c.type){case"sync":o||(a=a+"var _hasError".concat(t," = false;\n")+"try {\n"),a+=(i?"var _result".concat(t," = _fn"):"_fn").concat(t,"(").concat(this.args({before:c.context?"_context":void 0}),");\n"),o||(a=(a=(a=(a+="} catch(_err) {\n")+"_hasError".concat(t," = true;\n"))+n("_err")+"}\n")+"if(!_hasError".concat(t,") {\n")),i&&(a+=i("_result".concat(t))),r&&(a+=r()),o||(a+="}\n");break;case"async":var h="",h=(h=(h+=(i?"(function(_err".concat(t,", _result"):"(function(_err").concat(t,") {\n"))+"if(_err".concat(t,") {\n"))+n("_err".concat(t))+"} else {\n";i&&(h+=i("_result".concat(t))),r&&(h+=r()),h=h+"}\n"+"})",a+="_fn".concat(t,"(").concat(this.args({before:c.context?"_context":void 0,after:h}),");\n");break;case"promise":a=(a=(a=(a=(a=(a+="var _hasResult".concat(t," = false;\n"))+"var _promise".concat(t," = _fn").concat(t,"(").concat(this.args({before:c.context?"_context":void 0}),");\n"))+"if (!_promise".concat(t," || !_promise").concat(t,".then)\n"))+"  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise".concat(t," + ')');\n"))+"_promise".concat(t,".then((function(_result").concat(t,") {\n"))+"_hasResult".concat(t," = true;\n"),i&&(a+=i("_result".concat(t))),r&&(a+=r()),a=(a=(a+="}), function(_err".concat(t,") {\n"))+"if(_hasResult".concat(t,") throw _err").concat(t,";\n"))+n("_err".concat(t))+"});\n"}return a}},{key:"callTapsSeries",value:function(t){var o=this,a=t.onError,s=t.onResult,e=t.resultReturns,u=t.onDone,n=t.doneReturns,l=t.rethrowIfPossible;if(0===this.options.taps.length)return u();for(var c=this.options.taps.findIndex(function(t){return"sync"!==t.type}),h=e||n,d="",p=u,f=0,i=function(t){function e(t){return t?"":u()}var n=t,i=(p!==u&&("sync"!==o.options.taps[n].type||20<f++)&&(f=0,d=(d+="function _next".concat(n,"() {\n"))+p()+"}\n",p=function(){return"".concat(h?"return ":"","_next").concat(n,"();\n")}),p),r=o.callTap(n,{onError:function(t){return a(n,t,i,e)},onResult:s&&function(t){return s(n,t,i,e)},onDone:!s&&i,rethrowIfPossible:l&&(c<0||n<c)});p=function(){return r}},r=this.options.taps.length-1;0<=r;r--)i(r);return d+=p()}},{key:"callTapsLooping",value:function(t){var e=t.onError,n=t.onDone,t=t.rethrowIfPossible;if(0===this.options.taps.length)return n();var o=this.options.taps.every(function(t){return"sync"===t.type}),i="";o||(i+="var _looper = (function() {\nvar _loopAsync = false;\n");for(var i=(i+="var _loop;\n")+"do {\n"+"_loop = false;\n",r=0;r<this.options.interceptors.length;r++){var a=this.options.interceptors[r];a.loop&&(i+="".concat(this.getInterceptor(r),".loop(").concat(this.args({before:a.context?"_context":void 0}),");\n"))}return i=i+this.callTapsSeries({onError:e,onResult:function(t,e,n,i){var r=(r="")+"if(".concat(e," !== undefined) {\n")+"_loop = true;\n";return o||(r+="if(_loopAsync) _looper();\n"),r=(r=r+i(!0)+"} else {\n")+n()+"}\n"},onDone:n&&function(){var t="";return(t+="if(!_loop) {\n")+n()+"}\n"},rethrowIfPossible:t&&o})+"} while(_loop);\n",o||(i+="_loopAsync = true;\n});\n_looper();\n"),i}},{key:"callTapsParallel",value:function(t){var e=this,o=t.onError,a=t.onResult,s=t.onDone,u=t.rethrowIfPossible,t=t.onTap,l=void 0===t?function(t,e){return e()}:t;if(this.options.taps.length<=1)return this.callTapsSeries({onError:o,onResult:a,onDone:s,rethrowIfPossible:u});for(var c="",n=(c=(c+="do {\n")+"var _counter = ".concat(this.options.taps.length,";\n"),s&&(c=(c+="var _done = (function() {\n")+s()+"});\n"),function(n){function i(){return s?"if(--_counter === 0) _done();\n":"--_counter;"}function r(t){return t||!s?"_counter = 0;\n":"_counter = 0;\n_done();\n"}c=(c+="if(_counter <= 0) break;\n")+l(n,function(){return e.callTap(n,{onError:function(t){var e="";return(e+="if(_counter > 0) {\n")+o(n,t,i,r)+"}\n"},onResult:a&&function(t){var e="";return(e+="if(_counter > 0) {\n")+a(n,t,i,r)+"}\n"},onDone:!a&&i,rethrowIfPossible:u})},i,r)}),i=0;i<this.options.taps.length;i++)n(i);return c+="} while(false);\n"}},{key:"args",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.before,t=t.after,n=this._args;return e&&(n=[e].concat(n)),0===(n=t?n.concat(t):n).length?"":n.join(", ")}},{key:"getTapFn",value:function(t){return"_x[".concat(t,"]")}},{key:"getTap",value:function(t){return"_taps[".concat(t,"]")}},{key:"getInterceptor",value:function(t){return"_interceptors[".concat(t,"]")}}]),e}(),Vc=new(function(){T(e,zc);var t=M(e);function e(){return x(this,e),t.apply(this,arguments)}return w(e,[{key:"content",value:function(t){var r=t.onError,t=t.onDone;return this.callTapsParallel({onError:function(t,e,n,i){return r(e)+i(!0)},onDone:t})}}]),e}()),Hc=function(){T(i,Fc);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;return x(this,i),(t=n.call(this,t,e)).compile=Ac,t._call=void 0,t.call=void 0,t}return w(i)}(),Gc=new(function(){T(e,zc);var t=M(e);function e(){return x(this,e),t.apply(this,arguments)}return w(e,[{key:"content",value:function(t){var r=this,o=t.onError,e=t.onResult;return t.onDone,this.callTapsSeries({onError:function(t,e,n,i){return o(e)+i(!0)},onResult:function(t,e,n){var i="";return(i+="if(".concat(e," !== undefined) {\n"))+"".concat(r._args[0]," = ").concat(e,";\n")+"}\n"+n()},onDone:function(){return e(r._args[0])}})}}]),e}()),Wc=function(){T(i,Fc);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;return x(this,i),(t=n.call(this,t,e)).compile=Nc,t._call=void 0,t.call=void 0,t}return w(i)}(),Uc=new(function(){T(e,zc);var t=M(e);function e(){return x(this,e),t.apply(this,arguments)}return w(e,[{key:"content",value:function(t){var n=t.onError,e=t.onDone,t=t.rethrowIfPossible;return this.callTapsSeries({onError:function(t,e){return n(e)},onDone:e,rethrowIfPossible:t})}}]),e}()),Yc=function(){T(i,Fc);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;return x(this,i),(t=n.call(this,t,e)).tapAsync=Lc,t.tapPromise=Ic,t.compile=Dc,t}return w(i)}(),qc=new(function(){T(e,zc);var t=M(e);function e(){return x(this,e),t.apply(this,arguments)}return w(e,[{key:"content",value:function(t){var r=this,n=t.onError,e=t.onResult,i=t.resultReturns,t=t.rethrowIfPossible;return this.callTapsSeries({onError:function(t,e){return n(e)},onResult:function(t,e,n){var i="";return(i+="if(".concat(e," !== undefined) {\n"))+"".concat(r._args[0]," = ").concat(e,";\n")+"}\n"+n()},onDone:function(){return e(r._args[0])},doneReturns:i,rethrowIfPossible:t})}}]),e}()),Xc=function(){T(i,Yc);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;return x(this,i),(t=n.call(this,t,e)).tapAsync=Rc,t.tapPromise=jc,t.compile=Bc,t}return w(i)}(),Kc=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];var Zc,$c=function(){function t(){x(this,t),this.emitter=new Rr.exports.EventEmitter}return w(t,[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this}},{key:"addEventListener",value:function(t,e,n){var i,r,o,a=As(n)&&n||Ns(n)&&n.capture,n=Ns(n)&&n.once,s=Cs(e)?void 0:e,u=!1,l="";return-1<t.indexOf(":")&&(r=(i=vs(t.split(":"),2))[0],t=i[1],l=r,u=!0),t=a?"".concat(t,"capture"):t,e=Cs(e)?e:e.handleEvent,u&&(o=e,e=function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];(null==(t=n[0].target)?void 0:t.name)===l&&o.apply(void 0,n)}),n?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){this.emitter.removeAllListeners()}},{key:"removeEventListener",value:function(t,e,n){var n=As(n)&&n||Ns(n)&&n.capture,i=Cs(e)?void 0:e;return t=n?"".concat(t,"capture"):t,e=Cs(e)?e:null==(n=e)?void 0:n.handleEvent,this.emitter.off(t,e,i),this}},{key:"emit",value:function(t,e){this.dispatchEvent(new Ts(t,e))}},{key:"dispatchEvent",value:function(t){if(!(t instanceof Es))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var e=this.ownerDocument||this.document;return e&&(t.manager=(null==(e=e.defaultView)?void 0:e.getEventService())||null,t.defaultPrevented=!1,t.path=[],t.target=this,null!=(e=t.manager)&&e.dispatchEvent(t)),!t.defaultPrevented}}]),t}(),Jc=function(){T(p,$c);var r=M(p);function p(){var t;x(this,p);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return w(p,[{key:"textContent",get:function(){var t,e="",n=(this.nodeName===m.TEXT&&(e+=this.style.text),ks(this.childNodes));try{for(n.s();!(t=n.n()).done;){var i=t.value;i.nodeName===m.TEXT?e+=i.nodeValue:e+=i.textContent}}catch(t){n.e(t)}finally{n.f()}return e},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t,!0)}),this.nodeName===m.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return 0<this.childNodes.length}},{key:"isDefaultNamespace",value:function(t){throw new Error("Method not implemented.")}},{key:"lookupNamespaceURI",value:function(t){throw new Error("Method not implemented.")}},{key:"lookupPrefix",value:function(t){throw new Error("Method not implemented.")}},{key:"normalize",value:function(){throw new Error("Method not implemented.")}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return 0<this.childNodes.length?this.childNodes[0]:null}},{key:"lastChild",get:function(){return 0<this.childNodes.length?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;if(!(t instanceof p))throw new TypeError("Node.compareDocumentPosition: Argument 1 does not implement interface Node.");for(var e=[r=t],n=[o=this];null!=(i=r.parentNode)?i:o.parentNode;)var i,r=r.parentNode?(e.push(r.parentNode),r.parentNode):r,o=o.parentNode?(n.push(o.parentNode),o.parentNode):o;if(r!==o)return p.DOCUMENT_POSITION_DISCONNECTED|p.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|p.DOCUMENT_POSITION_PRECEDING;var a=e.length>n.length?e:n,s=a===e?n:e;if(a[a.length-s.length]===s[0])return a===e?p.DOCUMENT_POSITION_CONTAINED_BY|p.DOCUMENT_POSITION_FOLLOWING:p.DOCUMENT_POSITION_CONTAINS|p.DOCUMENT_POSITION_PRECEDING;for(var u=a.length-s.length,l=s.length-1;0<=l;l--){var c,h=s[l],d=a[u+l];if(d!==h)return(c=h.parentNode.childNodes).indexOf(h)<c.indexOf(d)?s===e?p.DOCUMENT_POSITION_PRECEDING:p.DOCUMENT_POSITION_FOLLOWING:a===e?p.DOCUMENT_POSITION_PRECEDING:p.DOCUMENT_POSITION_FOLLOWING}return p.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e}},{key:"getAncestor",value:function(t){for(var e=this;0<t&&e;)e=e.parentNode,t--;return e}},{key:"forEach",value:function(e){e(this)||this.childNodes.forEach(function(t){t.forEach(e)})}}],[{key:"isNode",value:function(t){return!!t.childNodes}}]),p}(),Qc=(Jc.DOCUMENT_POSITION_DISCONNECTED=1,Jc.DOCUMENT_POSITION_PRECEDING=2,Jc.DOCUMENT_POSITION_FOLLOWING=4,Jc.DOCUMENT_POSITION_CONTAINS=8,Jc.DOCUMENT_POSITION_CONTAINED_BY=16,Jc.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,w(function t(){x(this,t),this.contentBounds=void 0,this.renderBounds=void 0})),th=(Qc.tag="c-geometry",w(function t(){x(this,t),this.bounds=void 0,this.boundsDirty=!0,this.renderBounds=void 0,this.renderBoundsDirty=!0,this.dirtyRenderBounds=void 0,this.dirty=!1})),eh=(th.tag="c-renderable",w(function t(){x(this,t),this.dirtyFlag=!1,this.localDirtyFlag=!1,this.frozen=!1,this.localPosition=g(0,0,0),this.localRotation=Co(0,0,0,1),this.localScale=g(1,1,1),this.localTransform=Yr(),this.position=g(0,0,0),this.rotation=Co(0,0,0,1),this.scaling=g(1,1,1),this.worldTransform=Yr(),this.origin=g(0,0,0)})),nh=(eh.tag="c-transform",Zc=Zc||{},Zc[Zc.Standard=0]="Standard",function(){function t(){x(this,t),this.strategy=Zc.Standard,this.visibilityPlaneMask=-1,this.visible=!0,this.enable=!0}return w(t,[{key:"isCulled",value:function(){return this.enable&&!this.visible}}]),t}()),ih=(nh.tag="c-cullable",w(function t(){x(this,t),this.dirty=!1,this.sorted=void 0,this.lastSortedIndex=void 0,this.renderOrder=0})),rh=(ih.tag="c-sortable",function(){T(c,Es);var l=M(c);function c(t,e,n,i,r,o,a,s){var u;return x(this,c),(u=l.call(this,null)).relatedNode=void 0,u.prevValue=void 0,u.newValue=void 0,u.attrName=void 0,u.attrChange=void 0,u.prevParsedValue=void 0,u.newParsedValue=void 0,u.relatedNode=e,u.prevValue=n,u.newValue=i,u.attrName=r,u.attrChange=o,u.prevParsedValue=a,u.newParsedValue=s,u.type=t,u}return w(c)}()),oh=(rh.ADDITION=2,rh.MODIFICATION=1,rh.REMOVAL=3,0),ah=function(){T(o,Jc);var r=M(o);function o(){var t;x(this,o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))).sceneGraphService=Dr.get(od),t.entity=oh++,t.renderable=new th,t.cullable=new nh,t.transformable=new eh,t.sortable=new ih,t.geometry=new Qc,t.id=void 0,t.name=void 0,t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return w(o,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){var t;return this.parentNode?(t=this.parentNode.childNodes.indexOf(this),this.parentNode.childNodes[t+1]||null):null}},{key:"previousSibling",get:function(){var t;return this.parentNode?(t=this.parentNode.childNodes.indexOf(this),this.parentNode.childNodes[t-1]||null):null}},{key:"cloneNode",value:function(t){throw new Error("Method not implemented.")}},{key:"appendChild",value:function(t,e){return this.sceneGraphService.attach(t,this,e),this.dispatchEvent(new Ts(C.CHILD_INSERTED,{child:t})),t.dispatchEvent(new rh(C.INSERTED,this,"","","",0,"","")),t}},{key:"insertBefore",value:function(t,e){return e?(e=this.childNodes.indexOf(e),this.appendChild(t,e-1)):this.appendChild(t),t}},{key:"replaceChild",value:function(t,e,n){var i=this.childNodes.indexOf(e);return this.removeChild(e,n),this.appendChild(t,i),e}},{key:"removeChild",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return t.dispatchEvent(new rh(C.REMOVED,this,"","","",0,"","")),e&&(t.dispatchEvent(new Ts(C.DESTROY)),t.destroyed=!0),this.dispatchEvent(new Ts(C.CHILD_REMOVED,{child:t})),this.sceneGraphService.detach(t),e&&t.emitter.removeAllListeners(),t}},{key:"removeChildren",value:function(){var e=this,n=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.childNodes.slice().forEach(function(t){e.removeChild(t,n)})}},{key:"matches",value:function(t){return this.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return this.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return this.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return this.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return this.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return this.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return this.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var e=this;do{if(this.sceneGraphService.matches(t,e))return e}while(null!==(e=e.parentElement));return null}},{key:"find",value:function(e){var n=this,i=null;return this.forEach(function(t){return!(t===n||!e(t))&&(i=t,!0)}),i}},{key:"findAll",value:function(e){var n=this,i=[];return this.forEach(function(t){t!==n&&e(t)&&i.push(t)}),i}},{key:"after",value:function(){var i=this;if(this.parentNode){for(var r=this.parentNode.childNodes.indexOf(this),t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(function(t,e){var n;return null==(n=i.parentNode)?void 0:n.appendChild(t,r+e+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n[0],o=n.slice(1);this.parentNode.appendChild(r,t),r.after.apply(r,gs(o))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach(function(t){return e.appendChild(t)})}},{key:"prepend",value:function(){for(var n=this,t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e.forEach(function(t,e){return n.appendChild(t,e)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this,!(0<arguments.length&&void 0!==arguments[0])||arguments[0]):this}},{key:"destroy",value:function(){this.dispatchEvent(new Ts(C.DESTROY)),this.remove(!1),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return this.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return this.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return this.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return this.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return this.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){t=vs(Mc(t.toString(),""),1)[0],t=this.attributes[t];return A(t)?null:t}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e}},{key:"getAttributeNS",value:function(t,e){throw new Error("Method not implemented.")}},{key:"getAttributeNode",value:function(t){throw new Error("Method not implemented.")}},{key:"getAttributeNodeNS",value:function(t,e){throw new Error("Method not implemented.")}},{key:"hasAttributeNS",value:function(t,e){throw new Error("Method not implemented.")}},{key:"removeAttributeNS",value:function(t,e){throw new Error("Method not implemented.")}},{key:"removeAttributeNode",value:function(t){throw new Error("Method not implemented.")}},{key:"setAttributeNS",value:function(t,e,n){throw new Error("Method not implemented.")}},{key:"setAttributeNode",value:function(t){throw new Error("Method not implemented.")}},{key:"setAttributeNodeNS",value:function(t){throw new Error("Method not implemented.")}},{key:"toggleAttribute",value:function(t,e){throw new Error("Method not implemented.")}}],[{key:"isElement",value:function(t){return!!t.getAttribute}}]),o}(),sh=function(){T(o,Es);var r=M(o);function o(t,e,n,i){return x(this,o),(t=r.call(this,t)).currentTime=void 0,t.timelineTime=void 0,t.currentTime=n,t.timelineTime=i,t.target=e,t.type="finish",t.bubbles=!1,t.currentTarget=e,t.defaultPrevented=!1,t.eventPhase=t.AT_TARGET,t.timeStamp=Date.now(),t.currentTime=n,t.timelineTime=i,t}return w(o)}(),uh=0,lh=function(){function n(t,e){x(this,n),this.effect=void 0,this.timeline=void 0,this.id=void 0,this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this.oldPlayState=void 0,this._holdTime=void 0,this.readyPromise=void 0,this.finishedPromise=void 0,this.resolveReadyPromise=void 0,this.rejectReadyPromise=void 0,this.resolveFinishedPromise=void 0,this.rejectFinishedPromise=void 0,this.onfinish=void 0,this.oncancel=void 0,this.onframe=void 0,this._currentTime=0,this._startTime=void 0,this._playbackRate=1,this._inEffect=void 0,this._inTimeline=!0,this.onremove=void 0,((this.effect=t).animation=this).timeline=e,this.id="".concat(uh++),this._inEffect=!!this.effect.update(0),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return w(n,[{key:"pending",get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var n=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(t,e){n.resolveReadyPromise=function(){t(n)},n.rejectReadyPromise=function(){e(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var n=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(t,e){n.resolveFinishedPromise=function(){t(n)},n.rejectFinishedPromise=function(){e(new Error)}}),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){var e;t=Number(t),isNaN(t)||(this.timeline.restart(),this._paused||null===this._startTime||(this._startTime=Number(null==(e=this.timeline)?void 0:e.currentTime)-t/this.playbackRate),this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this)))}},{key:"startTime",get:function(){return this._startTime},set:function(t){null!==t&&(this.updatePromises(),t=Number(t),isNaN(t)||this._paused||this._idle||(this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()))}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){var e;t!==this._playbackRate&&(this.updatePromises(),e=this.currentTime,this._playbackRate=t,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==e&&(this.currentTime=e),this.updatePromises())}},{key:"_isFinished",get:function(){return!this._idle&&(0<this._playbackRate&&Number(this._currentTime)>=this.totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){var t;return Number(null==(t=this.effect)?void 0:t.getComputedTiming().endTime)}},{key:"_needsTick",get:function(){return this.pending||"running"===this.playState||!this._finishedFlag}},{key:"updatePromises",value:function(){var t=this.oldPlayState,e=this.pending?"pending":this.playState;return this.readyPromise&&e!==t&&("idle"===e?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===t?this.resolveReadyPromise():"pending"===e&&(this.readyPromise=void 0)),this.finishedPromise&&e!==t&&("idle"===e?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===e?this.resolveFinishedPromise():"finished"===t&&(this.finishedPromise=void 0)),this.oldPlayState=e,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),this._idle||(this.currentTime=0<this._playbackRate?this.totalDuration:0,this._startTime=this.totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"reverse",value:function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),null!==t&&(this.currentTime=t),this.updatePromises()}},{key:"updatePlaybackRate",value:function(t){this.playbackRate=t}},{key:"targetAnimations",value:function(){var t;return(null==(t=this.effect)?void 0:t.target).getAnimations()}},{key:"markTarget",value:function(){var t=this.targetAnimations();-1===t.indexOf(this)&&t.push(this)}},{key:"unmarkTarget",value:function(){var t=this.targetAnimations(),e=t.indexOf(this);-1!==e&&t.splice(e,1)}},{key:"tick",value:function(t,e){this._idle||this._paused||(null===this._startTime?e&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(t))}},{key:"rewind",value:function(){if(0<=this.playbackRate)this.currentTime=0;else{if(!(this.totalDuration<1/0))throw new Error("Unable to rewind negative playback rate animation with infinite duration");this.currentTime=this.totalDuration}}},{key:"persist",value:function(){throw new Error("Method not implemented.")}},{key:"addEventListener",value:function(t,e,n){throw new Error("Method not implemented.")}},{key:"removeEventListener",value:function(t,e,n){throw new Error("Method not implemented.")}},{key:"dispatchEvent",value:function(t){throw new Error("Method not implemented.")}},{key:"commitStyles",value:function(){throw new Error("Method not implemented.")}},{key:"ensureAlive",value:function(){var t;this.playbackRate<0&&0===this.currentTime?this._inEffect=!(null==(t=this.effect)||!t.update(-1)):this._inEffect=!(null==(t=this.effect)||!t.update(this.currentTime)),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(t,e){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!e&&(this._currentTime=0<this._playbackRate?this.totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(t){var e,n=this;this._isFinished?this._finishedFlag||(this.onfinish&&(e=new sh(null,this,this.currentTime,t),setTimeout(function(){n.onfinish&&n.onfinish(e)})),this._finishedFlag=!0):(this.onframe&&"running"===this.playState&&(t=new sh(null,this,this.currentTime,t),this.onframe(t)),this._finishedFlag=!1)}}]),n}();function ch(t,e){return Number(t.id)-Number(e.id)}var hh=function(){function e(t){var n=this;x(this,e),this.document=void 0,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.frameId=void 0,this.webAnimationsNextTick=function(t){n.currentTime=t,n.discardAnimations(),0===n.animations.length?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(e){var t=n.rafCallbacks;n.rafCallbacks=[],e<Number(n.currentTime)&&(e=Number(n.currentTime)),n.animations.sort(ch),n.animations=n.tick(e,!0,n.animations)[0],t.forEach(function(t){t[1](e)}),n.applyPendingEffects()},this.document=t}return w(e,[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(t){t=new lh(t,this);return this.animations.push(t),this.restartWebAnimationsNextTick(),t.updatePromises(),t.play(),t.updatePromises(),t}},{key:"applyDirtiedAnimation",value:function(t){var e=this;this.inTick||(t.markTarget(),(t=t.targetAnimations()).sort(ch),this.tick(Number(this.currentTime),!1,t.slice())[1].forEach(function(t){t=e.animations.indexOf(t);-1!==t&&e.animations.splice(t,1)}),this.applyPendingEffects())}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(t){null!=t&&t.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(t){return t.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(t){return"finished"!==t.playState&&"idle"!==t.playState})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(t){var e=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([e,t]),e}},{key:"requestAnimationFrame",value:function(e){var n=this;return this.rAF(function(t){n.updateAnimationsPromises(),e(t),n.updateAnimationsPromises()})}},{key:"tick",value:function(n,i,t){var r=this,o=(this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=n,this.ticking=!1,[]),a=[],s=[],u=[];return t.forEach(function(t){t.tick(n,i),t._inEffect?(a.push(t.effect),t.markTarget()):(o.push(t.effect),t.unmarkTarget()),t._needsTick&&(r.ticking=!0);var e=t._inEffect||t._needsTick;((t._inTimeline=e)?s:u).push(t)}),(t=this.pendingEffects).push.apply(t,o),(t=this.pendingEffects).push.apply(t,a),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[s,u]}}]),e}(),dh={anchor:"",opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:""},ph=function(){T(r,ah);var e=M(r);function r(t){var i;return x(this,r),(i=e.call(this)).config=void 0,i.styleValueRegistry=Dr.get(Eu),i.isCustomElement=!1,i.activeAnimations=[],i.config=t,i.config.interactive=null!=(t=i.config.capture)?t:i.config.interactive,i.id=i.config.id||"",i.name=i.config.name||"",(i.config.className||i.config.class)&&(i.className=i.config.className||i.config.class),i.nodeName=i.config.type||m.GROUP,i.config.style=is(is(is({},dh),{},{zIndex:null!=(t=i.config.zIndex)?t:0,interactive:null==(t=i.config.interactive)||t},i.config.style),i.config.attrs),null!=i.config.visible&&(i.config.style.visibility=!1===i.config.visible?"hidden":"visible"),null!=i.config.interactive&&(i.config.style.pointerEvents=!1===i.config.interactive?"none":"auto"),i.style=new Proxy(is(is({},i.attributes),{},{setProperty:function(t,e){i.setAttribute(t,e)},getPropertyValue:function(t){return i.getAttribute(t)},removeProperty:function(t){i.removeAttribute(t)},item:function(){return""}}),{get:function(t,e){return e in t?t[e]:i.getAttribute(e)},set:function(t,e,n){return i.setAttribute(e,n),!0}}),i.initAttributes(i.config.style),Dr.get(ws).add(i.entity,fs(i)),i}return w(r,[{key:"destroy",value:function(){ys(ls(r.prototype),"destroy",this).call(this),Dr.get(ws).remove(this.entity),this.getAnimations().forEach(function(t){t.cancel()})}},{key:"cloneNode",value:function(e){var n=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:is({},this.attributes)});return e&&this.children.forEach(function(t){t=t.cloneNode(e);n.appendChild(t)}),n}},{key:"initAttributes",value:function(){var t=this.renderable;this.styleValueRegistry.processProperties(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),t.dirty=!0}},{key:"setAttribute",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],t=vs(Mc(t,e),2),i=t[0],t=t[1];Ps(e)||!n&&t==this.attributes[i]||(this.internalSetAttribute(i,t),ys(ls(r.prototype),"setAttribute",this).call(this,i,t))}},{key:"internalSetAttribute",value:function(t,e){var n=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=this.renderable,o=this.attributes[t],a=this.parsedStyle[t];this.styleValueRegistry.processProperties(this,us({},t,e),i),this.attributes.clipPathTargets&&this.attributes.clipPathTargets.length&&this.attributes.clipPathTargets.forEach(function(t){td(t),t.dispatchEvent(new rh(C.ATTR_MODIFIED,t,n,n,"clipPath",rh.MODIFICATION,n,n)),t.isCustomElement&&t.isConnected&&t.attributeChangedCallback&&t.attributeChangedCallback("clipPath",n,n)}),r.dirty=!0,this.dispatchEvent(new rh(C.ATTR_MODIFIED,this,o,e,t,rh.MODIFICATION,a,this.parsedStyle[t])),this.isCustomElement&&this.isConnected&&this.attributeChangedCallback&&this.attributeChangedCallback(t,o,e)}},{key:"getBBox",value:function(){var t=this.getBounds(),e=vs(t.getMin(),2),n=e[0],e=e[1],t=vs(t.getMax(),2),i=t[0],t=t[1];return new Cu(n,e,i-n,t-e)}},{key:"setOrigin",value:function(t){return this.sceneGraphService.setOrigin(this,Xs(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0)),this}},{key:"getOrigin",value:function(){return this.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){return this.sceneGraphService.setPosition(this,Xs(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0)),this}},{key:"setLocalPosition",value:function(t){return this.sceneGraphService.setLocalPosition(this,Xs(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0)),this}},{key:"translate",value:function(t){return this.sceneGraphService.translate(this,Xs(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0)),this}},{key:"translateLocal",value:function(t){return this.sceneGraphService.translateLocal(this,Xs(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0)),this}},{key:"getPosition",value:function(){return this.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return this.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n)}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(t=Xs(t,e=e||t,n=n||t)),this.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(t=Xs(t,e=e||t,n=n||t)),this.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return this.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return this.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var t=vs(Zs(oo(),this.sceneGraphService.getWorldTransform(this)),3);return t[0],t[1],Ks(t[2])}},{key:"getLocalEulerAngles",value:function(){var t=vs(Zs(oo(),this.sceneGraphService.getLocalRotation(this)),3);return t[0],t[1],Ks(t[2])}},{key:"setEulerAngles",value:function(t){return this.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return this.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,e,n){return A(e)&&A(n)?this.sceneGraphService.rotateLocal(this,0,0,t):this.sceneGraphService.rotateLocal(this,t,e,n),this}},{key:"rotate",value:function(t,e,n){return A(e)&&A(n)?this.sceneGraphService.rotate(this,0,0,t):this.sceneGraphService.rotate(this,t,e,n),this}},{key:"setRotation",value:function(t,e,n,i){return this.sceneGraphService.setRotation(this,t,e,n,i),this}},{key:"setLocalRotation",value:function(t,e,n,i){return this.sceneGraphService.setLocalRotation(this,t,e,n,i),this}},{key:"getRotation",value:function(){return this.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return this.sceneGraphService.getLocalRotation(this)}},{key:"getLocalTransform",value:function(){return this.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return this.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return this.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){this.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,e){var n,i=null==(i=this.ownerDocument)?void 0:i.timeline;return this.attributes.clipPathTargets&&this.attributes.clipPathTargets.length&&(i=null==(n=this.attributes.clipPathTargets[0].ownerDocument)?void 0:n.timeline),delete this.parsedStyle.transform,i?i.play(new qh(this,t,e)):null}},{key:"show",value:function(){this.style.visibility="visible"}},{key:"hide",value:function(){this.style.visibility="hidden"}},{key:"isVisible",value:function(){var t;return"visible"===(null==(t=this.parsedStyle)||null==(t=t.visibility)?void 0:t.value)}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return"none"!==(null==(t=this.parsedStyle)||null==(t=t.pointerEvents)?void 0:t.value)}},{key:"isCulled",value:function(){return!(!this.cullable||!this.cullable.isCulled())}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,gs(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,gs(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})))-1),this}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,e){return this.appendChild(t,e)}},{key:"setClip",value:function(t){this.style.clipPath=t}},{key:"getClip",value:function(){return this.style.clipPath||null}},{key:"set",value:function(t,e){this.config[t]=e}},{key:"get",value:function(t){return this.config[t]}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=n[0],o=n[1];return r?Ns(r)?(Object.keys(r).forEach(function(t){e.setAttribute(t,r[t])}),this):2===n.length?(this.setAttribute(r,o),this):this.attributes[r]:this.attributes}},{key:"moveTo",value:function(t){return this.setPosition(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0),this}},{key:"move",value:function(t){return this.setPosition(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}},{key:"getMatrix",value:function(t){var t=t||this.getWorldTransform(),e=vs(Qr(oo(),t),2),n=e[0],e=e[1],i=vs(to(oo(),t),2),r=i[0],i=i[1],t=eo(To(),t),t=vs(Zs(oo(),t),3),o=t[0],t=(t[1],t[2]);return $s(o||t,n,e,r,i)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var t=vs(Js(t),5),e=t[0],n=t[1],i=t[2],r=t[3],t=t[4];this.setEulerAngles(t).setPosition(e,n).setLocalScale(i,r)}},{key:"setLocalMatrix",value:function(t){var t=vs(Js(t),5),e=t[0],n=t[1],i=t[2],r=t[3],t=t[4];this.setLocalEulerAngles(t).setLocalPosition(e,n).setLocalScale(i,r)}}]),r}(),fh=["style"],yh=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,fh);return x(this,i),(e=n.call(this,is({style:is({x:"",y:""},e)},t))).isCustomElement=!0,e}return w(i)}(),vh=["style"],gh=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,vh);return x(this,i),n.call(this,is({type:m.CIRCLE,style:is({cx:"",cy:"",r:"",anchor:"0.5 0.5",transformOrigin:"center"},e)},t))}return w(i)}(),mh=["style"],bh=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,mh);return x(this,i),n.call(this,is({type:m.ELLIPSE,style:is({cx:"",cy:"",rx:"",ry:"",anchor:"0.5 0.5",transformOrigin:"center"},e)},t))}return w(i)}(),kh=["style"],xh=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,kh);return x(this,i),n.call(this,is({type:m.GROUP,style:is({x:"",y:"",width:"",height:""},e)},t))}return w(i)}(),wh=["style"],Sh=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,wh);return x(this,i),n.call(this,is({type:m.IMAGE,style:is({x:"",y:"",img:"",width:"",height:""},e)},t))}return w(i)}(),Eh=["style"],Th=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,Eh);return x(this,i),n.call(this,is({type:m.LINE,style:is({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0,isBillboard:!1},e)},t))}return w(i,[{key:"getPoint",value:function(t){var e=this.parsedStyle,n=e.x1,i=e.y1,r=e.x2,e=e.y2,n=va.pointAt(n.value,i.value,r.value,e.value,t);return new Ss(n.x,n.y)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,i=t.x2,t=t.y2;return va.length(e.value,n.value,i.value,t.value)}}]),i}(),_h=["style"],Mh=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,_h);return x(this,i),n.call(this,is({type:m.PATH,style:is({path:"",miterLimit:4},e)},t))}return w(i,[{key:"getTotalLength",value:function(){return this.parsedStyle.path.totalLength}},{key:"getPoint",value:function(n){var i=0,r=0,t=this.parsedStyle.path.curve;if(!this.parsedStyle.path.curveSegments.length)return t?new Ss(t[0][1],t[0][2]):null;this.parsedStyle.path.curveSegments.forEach(function(t,e){n>=t[0]&&n<=t[1]&&(i=(n-t[0])/(t[1]-t[0]),r=e)});var e=t[r];if(A(e)||A(r))return null;var o=e.length,t=t[r+1],e=wa.pointAt(e[o-2],e[o-1],t[1],t[2],t[3],t[4],t[5],t[6],i),o=e.x,t=e.y;return new Ss(o,t)}},{key:"getStartTangent",value:function(){var t,e,n=this.parsedStyle.path.segments,i=[];return 1<n.length&&(t=n[0].currentPoint,e=n[1].currentPoint,i=[],(n=n[1].startTangent)?i.push([t[0]-n[0],t[1]-n[1]]):i.push([e[0],e[1]]),i.push([t[0],t[1]])),i}},{key:"getEndTangent",value:function(){var t,e,n=this.parsedStyle.path.segments,i=n.length,r=[];return 1<i&&(t=n[i-2].currentPoint,e=n[i-1].currentPoint,r=[],(n=n[i-1].endTangent)?r.push([e[0]-n[0],e[1]-n[1]]):r.push([t[0],t[1]]),r.push([e[0],e[1]])),r}}]),i}(),Ph=["style"],Oh=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,Ph);return x(this,i),n.call(this,is({type:m.POLYGON,style:is({points:"",miterLimit:4},e)},t))}return w(i)}(),Ch=["style"],Ah=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,Ch);return x(this,i),n.call(this,is({type:m.POLYLINE,style:is({points:"",miterLimit:4},e)},t))}return w(i,[{key:"getTotalLength",value:function(){return this.parsedStyle.points.totalLength}},{key:"getPoint",value:function(n){var t=this.parsedStyle.points,e=t.points,t=t.segments,i=0,r=0,t=(t.forEach(function(t,e){n>=t[0]&&n<=t[1]&&(i=(n-t[0])/(t[1]-t[0]),r=e)}),va.pointAt(e[r][0],e[r][1],e[r+1][0],e[r+1][1],i)),e=t.x,t=t.y;return new Ss(e,t)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n}}]),i}(),Nh=["style"],Lh=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,Nh);return x(this,i),n.call(this,is({type:m.RECT,style:is({x:"",y:"",width:"",height:"",radius:""},e)},t))}return w(i)}(),Ih=["style"],Dh=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,Ih);return x(this,i),(e=n.call(this,is({type:m.TEXT,style:is({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:0,lineHeight:0,miterLimit:10,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},e)},t))).LENGTHADJUST_SPACING=1,e.LENGTHADJUST_SPACINGANDGLYPHS=2,e.LENGTHADJUST_UNKNOWN=0,e.lengthAdjust=void 0,e.textLength=void 0,e}return w(i,[{key:"getCharNumAtPosition",value:function(t){throw new Error("Method not implemented.")}},{key:"getComputedTextLength",value:function(){var t;return(null==(t=this.parsedStyle.metrics)?void 0:t.maxLineWidth)||0}},{key:"getEndPositionOfChar",value:function(t){throw new Error("Method not implemented.")}},{key:"getExtentOfChar",value:function(t){throw new Error("Method not implemented.")}},{key:"getNumberOfChars",value:function(){throw new Error("Method not implemented.")}},{key:"getRotationOfChar",value:function(t){throw new Error("Method not implemented.")}},{key:"getStartPositionOfChar",value:function(t){throw new Error("Method not implemented.")}},{key:"getSubStringLength",value:function(t,e){throw new Error("Method not implemented.")}},{key:"selectSubString",value:function(t,e){throw new Error("Method not implemented.")}},{key:"getLineBoundingRects",value:function(){var t;return(null==(t=this.parsedStyle.metrics)?void 0:t.lineMetrics)||[]}}]),i}(),Rh=["style"],jh=function(){T(i,ph);var n=M(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.style,t=ps(t,Rh);return x(this,i),(e=n.call(this,is({type:m.HTML,style:is({x:"",y:"",width:"auto",height:"auto",innerHTML:""},e)},t))).cullable.enable=!1,e}return w(i,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getBoundingClientRect",value:function(){return this.parsedStyle.$el.getBoundingClientRect()}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getBounds",value:function(){var t,e,n=this.getBoundingClientRect(),i=null==(i=this.ownerDocument)||null==(i=i.defaultView)?void 0:i.getContextService().getBoundingClientRect();return i?(t=n.left-i.left,i=n.top-i.top,(e=new Mu).setMinMax(g(t,i,0),g(t+n.width,i+n.height,0)),e):null}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t,e=Kr(Yr(),this.parentNode.getWorldTransform()),n=this.getBounds();if(!Mu.isEmpty(n))return(t=new Mu).setFromTransformedAABB(n,e),t}return this.getBounds()}}]),i}(),Bh=function(){T(r,Jc);var n,i,e=M(r);function r(){x(this,r),(t=e.call(this)).defaultView=null,t.documentElement=void 0,t.timeline=void 0,t.ownerDocument=null,t.nodeName="document",t.timeline=new hh(fs(t));var t,i={};return lc.forEach(function(t){var e=t.name,n=t.inherited,t=t.defaultValue;n&&t&&(i[e]=t)}),t.documentElement=new xh({id:"g-root",style:i}),t.documentElement.ownerDocument=fs(t),t.documentElement.parentNode=fs(t),t.childNodes=[t.documentElement],t}return w(r,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(t,e){var n=this.defaultView.customElements.get(t);return n||(console.warn("Unsupported tagName: ",t),n="tspan"===t?Dh:xh),new n(e)}},{key:"createElementNS",value:function(t,e,n){return this.createElement(e,n)}},{key:"cloneNode",value:function(t){throw new Error("Method not implemented.")}},{key:"destroy",value:function(){try{this.documentElement.destroy()}catch(t){}this.timeline.destroy()}},{key:"elementFromPoint",value:(i=as(S().mark(function t(e,n){var i,r,o,a,s,u;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,r=r.y,a=this.defaultView.getConfig(),o=a.width,a=a.height,i<0||r<0||o<i||a<r)return t.abrupt("return",null);t.next=4;break;case 4:return o=this.defaultView.viewport2Client({x:i,y:r}),a=o.x,s=o.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:i,viewportY:r,clientX:a,clientY:s},picked:[]});case 7:return s=t.sent,u=s.picked,t.abrupt("return",u&&u[0]||this.documentElement);case 10:case"end":return t.stop()}},t,this)})),function(t,e){return i.apply(this,arguments)})},{key:"elementsFromPoint",value:(n=as(S().mark(function t(e,n){var i,r,o,a,s,u;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,r=r.y,a=this.defaultView.getConfig(),o=a.width,a=a.height,i<0||r<0||o<i||a<r)return t.abrupt("return",[]);t.next=4;break;case 4:return o=this.defaultView.viewport2Client({x:i,y:r}),a=o.x,s=o.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:i,viewportY:r,clientX:a,clientY:s},picked:[]});case 7:return s=t.sent,(u=s.picked)[u.length-1]!==this.documentElement&&u.push(this.documentElement),t.abrupt("return",u);case 11:case"end":return t.stop()}},t,this)})),function(t,e){return n.apply(this,arguments)})},{key:"appendChild",value:function(t,e){throw new Error("Use document.documentElement instead.")}},{key:"insertBefore",value:function(t,e){throw new Error("Use document.documentElement instead.")}},{key:"removeChild",value:function(t,e){throw new Error("Use document.documentElement instead.")}},{key:"replaceChild",value:function(t,e,n){throw new Error("Use document.documentElement instead.")}},{key:"append",value:function(){throw new Error("Use document.documentElement instead.")}},{key:"prepend",value:function(){throw new Error("Use document.documentElement instead.")}},{key:"getElementById",value:function(t){return this.documentElement.getElementById(t)}},{key:"getElementsByName",value:function(t){return this.documentElement.getElementsByName(t)}},{key:"getElementsByTagName",value:function(t){return this.documentElement.getElementsByTagName(t)}},{key:"getElementsByClassName",value:function(t){return this.documentElement.getElementsByClassName(t)}},{key:"querySelector",value:function(t){return this.documentElement.querySelector(t)}},{key:"querySelectorAll",value:function(t){return this.documentElement.querySelectorAll(t)}},{key:"find",value:function(t){return this.documentElement.find(t)}},{key:"findAll",value:function(t){return this.documentElement.findAll(t)}}]),r}(),Fh=function(){T(o,Es);var r=M(o);function o(){var t;x(this,o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))).altKey=void 0,t.button=void 0,t.buttons=void 0,t.ctrlKey=void 0,t.metaKey=void 0,t.relatedTarget=void 0,t.shiftKey=void 0,t.client=new Ss,t.movement=new Ss,t.offset=new Ss,t.global=new Ss,t.screen=new Ss,t}return w(o,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw new Error("Method not implemented.")}}]),o}(),zh=function(){T(o,Fh);var r=M(o);function o(){var t;x(this,o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))).pointerId=void 0,t.width=0,t.height=0,t.isPrimary=!1,t.pointerType=void 0,t.pressure=void 0,t.tangentialPressure=void 0,t.tiltX=void 0,t.tiltY=void 0,t.twist=void 0,t}return w(o,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}}]),o}(),Vh=function(){T(o,Fh);var r=M(o);function o(){var t;x(this,o);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))).deltaMode=void 0,t.deltaX=void 0,t.deltaY=void 0,t.deltaZ=void 0,t.DOM_DELTA_LINE=0,t.DOM_DELTA_PAGE=1,t.DOM_DELTA_PIXEL=2,t}return w(o)}(),Hh=function(){function t(){x(this,t),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=sc,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.playbackRate=void 0,this.effect=void 0,this.composite=void 0,this.activeDuration=void 0,this.endTime=void 0,this.currentIteration=null,this.progress=null}return w(t,[{key:"easing",get:function(){return this._easing},set:function(t){this.easingFunction=yc(t),this._easing=t}}]),t}();function Gh(t,r){if(null===t)return[];for(var e=(t=Array.isArray(t)?t:function(t){var e,n=[];for(e in t)if(!(e in["easing","offset","composite"]))for(var i,r=t[e],o=(r=Array.isArray(r)?r:[r]).length,a=0;a<o;a++)n[a]||(i={},"offset"in t&&(i.offset=Number(t.offset)),"easing"in t&&(i.easing=t.easing),"composite"in t&&(i.composite=t.composite),n[a]=i),void 0!==r[a]&&null!==r[a]&&(n[a][e]=r[a]);return n.sort(function(t,e){return(t.computedOffset||0)-(e.computedOffset||0)}),n}(t)).map(function(t){var e,n={};for(e in null!=r&&r.composite&&(n.composite="auto"),t){var i=t[e];if("offset"===e){if(null!==i){if(i=Number(i),!isFinite(i))throw new Error("Keyframe offsets must be numbers.");if(i<0||1<i)throw new Error("Keyframe offsets must be between 0 and 1.");n.computedOffset=i}}else if("composite"===e&&-1===["replace","add","accumulate","auto"].indexOf(i))throw new Error("".concat(i," compositing is not supported"));n[e]=i}return void 0===n.offset&&(n.offset=null),void 0===n.easing&&(n.easing=(null==r?void 0:r.easing)||"linear"),void 0===n.composite&&(n.composite="auto"),n}),n=!0,i=-1/0,o=0;o<e.length;o++){var a=e[o].offset;if(null!=a){if(a<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=a}else n=!1}if(e=e.filter(function(t){return 0<=Number(t.offset)&&Number(t.offset)<=1}),!n)for(var s=e.length,u=(e[s-1].computedOffset=Number(null!=(t=e[s-1].offset)?t:1),1<s&&(e[0].computedOffset=Number(null!=(t=e[0].offset)?t:0)),0),l=Number(e[0].computedOffset),c=1;c<s;c++){var h=Number(e[c].computedOffset);if(null!=h&&null!=l){for(var d=1;d<c-u;d++)e[u+d].computedOffset=l+(h-l)*d/(c-u);u=c,l=h}}return e}var Wh="backwards|forwards|both|none".split("|"),Uh="reverse|alternate|alternate-reverse".split("|");function Yh(t,e){var n,i,r;return t=function(t){"number"==typeof t&&(t=isNaN(t)?{duration:"auto"}:{duration:t});return t}(null!=(i=t)?i:{duration:"auto"}),n=t,i=e,r=new Hh,i&&(r.fill="both",r.duration="auto"),"number"!=typeof n||isNaN(n)?void 0!==n&&Object.keys(n).forEach(function(t){void 0===n[t]||null===n[t]||"auto"===n[t]||!("number"!=typeof r[t]&&"duration"!==t||"number"==typeof n[t]&&!isNaN(n[t]))||"fill"===t&&-1===Wh.indexOf(n[t])||"direction"===t&&-1===Uh.indexOf(n[t])||(r[t]=n[t])}):r.duration=n,r}var qh=function(){function r(t,e,n){var i=this;x(this,r),this.composite="replace",this.iterationComposite="replace",this.target=void 0,this.animation=void 0,this.timing=void 0,this.computedTiming=void 0,this.normalizedKeyframes=void 0,this.timeFraction=void 0,this.interpolations=void 0,this.target=t,this.timing=Yh(n,!1),(this.timing.effect=this).timing.activeDuration=vc(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Gh(e,this.timing),this.interpolations=Sc(this.normalizedKeyframes,this.timing,this.target),this.computedTiming=new Proxy(this.timing,{get:function(t,e){return"duration"===e?"auto"===t.duration?0:t.duration:"fill"===e?"auto"===t.fill?"none":t.fill:"localTime"===e?i.animation&&i.animation.currentTime||null:"currentIteration"===e?i.animation&&"running"===i.animation.playState?t.currentIteration||0:null:"progress"===e?i.animation&&"running"===i.animation.playState?t.progress||0:null:t[e]},set:function(){return!0}})}return w(r,[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(t){return null!==t&&(this.timeFraction=xc(this.timing.activeDuration,t,this.timing),null!==this.timeFraction)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(t){this.normalizedKeyframes=Gh(t)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(e){var n=this;Object.keys(e||{}).forEach(function(t){n.timing=e[t]})}}]),r}(),Xh=function(){function t(){x(this,t),this.registry={},this.define(m.CIRCLE,gh),this.define(m.ELLIPSE,bh),this.define(m.RECT,Lh),this.define(m.IMAGE,Sh),this.define(m.LINE,Th),this.define(m.GROUP,xh),this.define(m.PATH,Mh),this.define(m.POLYGON,Oh),this.define(m.POLYLINE,Ah),this.define(m.TEXT,Dh),this.define(m.HTML,jh)}return w(t,[{key:"define",value:function(t,e){this.registry[t]=e}},{key:"get",value:function(t){return this.registry[t]}}]),t}(),Kh=f.defineToken("SceneGraphSelectorFactory"),Zh=f.defineToken("SceneGraphSelector",{multiple:!1}),$h=/\[\s*(.*)=(.*)\s*\]/,Jh=function(){function t(){x(this,t)}return w(t,[{key:"selectOne",value:function(e,n){var t,i,r,o=this;return e.startsWith(".")?n.find(function(t){return t.className===o.getIdOrClassname(e)}):e.startsWith("#")?n.find(function(t){return t.id===o.getIdOrClassname(e)}):e.startsWith("[")?(t=this.getAttribute(e),i=t.name,r=t.value,i?n.find(function(t){return n!==t&&("name"===i?t.name===r:o.attributeToString(t,i)===r)}):null):n.find(function(t){return n!==t&&t.nodeName===e})}},{key:"selectAll",value:function(e,n){var t,i,r,o=this;return e.startsWith(".")?n.findAll(function(t){return n!==t&&t.className===o.getIdOrClassname(e)}):e.startsWith("#")?n.findAll(function(t){return n!==t&&t.id===o.getIdOrClassname(e)}):e.startsWith("[")?(t=this.getAttribute(e),i=t.name,r=t.value,i?n.findAll(function(t){return n!==t&&("name"===i?t.name===r:o.attributeToString(t,i)===r)}):[]):n.findAll(function(t){return n!==t&&t.nodeName===e})}},{key:"is",value:function(t,e){var n,i;return t.startsWith(".")?e.className===this.getIdOrClassname(t):t.startsWith("#")?e.id===this.getIdOrClassname(t):t.startsWith("[")?(n=(i=this.getAttribute(t)).name,i=i.value,"name"===n?e.name===i:this.attributeToString(e,n)===i):e.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var t=t.match($h),e="",n="";return t&&2<t.length&&(e=t[1].replace(/"/g,""),n=t[2].replace(/"/g,"")),{name:e,value:n}}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";t=t.getAttribute(e);return!A(t)&&t.toString?t.toString():""}}]),t}();function Qh(t,e){var n=Number(t.style.zIndex),i=Number(e.style.zIndex);if(n===i){var r=t.parentNode;if(r)return(r=r.childNodes||[]).indexOf(t)-r.indexOf(e)}return n-i}function td(t,e){for(var e=1<arguments.length&&void 0!==e&&e,n=t;n;){var i=n.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0),n=n.parentNode}t.dispatchEvent(new Ts(C.BOUNDS_CHANGED,{affectChildren:e}))}var ed,nd,id,rd,Jh=e([y({token:Zh})],Jh),od=f.defineToken("SceneGraphService"),ad=function(){function t(){var a,i,r,o,n,y=this;x(this,t),this.sceneGraphSelectorFactory=void 0,this.rotate=(a=To(),function(t,e){"number"==typeof e&&(e=g(e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0));var n,i,r,o=t.transformable;null!==t.parentNode&&t.parentNode.transformable?(Oo(n=To(),e[0],e[1],e[2]),i=y.getRotation(t),r=y.getRotation(t.parentNode),Ao(a,r),Po(a,a),Mo(n,a,n),Mo(o.localRotation,n,i),Lo(o.localRotation,o.localRotation),y.dirtifyLocal(t,o)):y.rotateLocal(t,e)}),this.rotateLocal=(i=To(),function(t,e){"number"==typeof e&&(e=g(e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;Oo(i,e[0],e[1],e[2]),No(n.localRotation,n.localRotation,i),y.dirtifyLocal(t,n)}),this.setEulerAngles=(r=To(),function(t,e){"number"==typeof e&&(e=g(e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0));var n,i=t.transformable;null!==t.parentNode&&t.parentNode.transformable?(Oo(i.localRotation,e[0],e[1],e[2]),n=y.getRotation(t.parentNode),Ao(r,Po(To(),n)),No(i.localRotation,i.localRotation,r),y.dirtifyLocal(t,i)):y.setLocalEulerAngles(t,e)}),this.translateLocal=function(t,e){"number"==typeof e&&(e=g(e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0));var n,i,r,o,a,s,u,l,c,h,d,p,f=t.transformable;bo(e,oo())||(i=n=e,r=f.localRotation,o=r[0],a=r[1],s=r[2],r=r[3],u=i[0],l=i[1],i=i[2],p=a*(d=o*l-a*u)-s*(h=s*u-o*i),s=s*(c=a*i-s*l)-o*d,o=o*h-a*c,h*=a=2*r,d*=a,s*=2,o*=2,n[0]=u+(c*=a)+(p*=2),n[1]=l+h+s,n[2]=i+d+o,co(f.localPosition,f.localPosition,e),y.dirtifyLocal(t,f))},this.setPosition=(o=Yr(),function(t,e){var n,i=t.transformable;e=g(e[0],e[1],e[2]||0),bo(y.getPosition(t),e)||(i.position=e,null!==t.parentNode&&t.parentNode.transformable?(n=t.parentNode.transformable,qr(o,n.worldTransform),Kr(o,o),go(i.localPosition,e,o)):uo(i.localPosition,e),y.dirtifyLocal(t,i))}),this.translate=(n=oo(),function(t,e){bo(e="number"==typeof e?g(e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0):e,oo())||(co(n,y.getPosition(t),e),y.setPosition(t,n))}),this.setRotation=function(){var a=To();return function(t,e,n,i,r){var o=t.transformable;"number"==typeof e&&(e=Co(e,n,i,r)),null!==t.parentNode&&t.parentNode.transformable?(n=y.getRotation(t.parentNode),Ao(a,n),Po(a,a),Mo(o.localRotation,a,e),Lo(o.localRotation,o.localRotation),y.dirtifyLocal(t,o)):y.setLocalRotation(t,e)}}}return w(t,[{key:"matches",value:function(t,e){return this.sceneGraphSelectorFactory().is(t,e)}},{key:"querySelector",value:function(t,e){return this.sceneGraphSelectorFactory().selectOne(t,e)}},{key:"querySelectorAll",value:function(t,e){return this.sceneGraphSelectorFactory().selectAll(t,e)}},{key:"attach",value:function(t,e,n){t.parentNode&&this.detach(t),t.parentNode=e,A(n)?t.parentNode.childNodes.push(t):t.parentNode.childNodes.splice(n,0,t);n=e.sortable,n&&(n.dirty=!0),e=t.transformable;e&&this.dirtifyWorld(t,e),e.frozen&&this.unfreezeParentToRoot(t)}},{key:"detach",value:function(t){var e,n;t.parentNode&&(e=t.transformable,(n=t.parentNode.sortable)&&(n.dirty=!0),-1<(n=t.parentNode.childNodes.indexOf(t))&&t.parentNode.childNodes.splice(n,1),e&&this.dirtifyWorld(t,e),t.parentNode=null)}},{key:"getOrigin",value:function(t){return t.transformable.origin}},{key:"setOrigin",value:function(t,e){"number"==typeof e&&(e=g(e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0));var n,i=t.transformable;bo(e,i.origin)||((n=i.origin)[0]=e[0],n[1]=e[1],n[2]=e[2]||0,this.dirtifyLocal(t,i))}},{key:"setLocalEulerAngles",value:function(t,e){"number"==typeof e&&(e=g(e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;Oo(n.localRotation,e[0],e[1],e[2]),this.dirtifyLocal(t,n)}},{key:"setLocalPosition",value:function(t,e){var n=t.transformable;e=g(e[0],e[1],e[2]||0),bo(n.localPosition,e)||(uo(n.localPosition,e),this.dirtifyLocal(t,n))}},{key:"scaleLocal",value:function(t,e){var n,i,r=t.transformable;n=r.localScale,i=r.localScale,e=g(e[0],e[1],e[2]||1),n[0]=i[0]*e[0],n[1]=i[1]*e[1],n[2]=i[2]*e[2],this.dirtifyLocal(t,r)}},{key:"setLocalScale",value:function(t,e){var n=t.transformable,e=g(e[0],e[1],e[2]||n.localScale[2]);bo(e,n.localScale)||(uo(n.localScale,e),this.dirtifyLocal(t,n))}},{key:"setLocalRotation",value:function(t,e,n,i,r){"number"==typeof e&&(e=Co(e,n,i,r));n=t.transformable;Ao(n.localRotation,e),this.dirtifyLocal(t,n)}},{key:"dirtifyLocal",value:function(t,e){e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtifyWorld(t,e))}},{key:"dirtifyWorld",value:function(t,e){e.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,e),td(t,!0)}},{key:"getPosition",value:function(t){var e=t.transformable;return Qr(e.position,this.getWorldTransform(t,e))}},{key:"getRotation",value:function(t){var e=t.transformable;return eo(e.rotation,this.getWorldTransform(t,e))}},{key:"getScale",value:function(t){var e=t.transformable;return to(e.scaling,this.getWorldTransform(t,e))}},{key:"getWorldTransform",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,e)),e.worldTransform}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalTransform",value:function(t){t=t.transformable;return t.localDirtyFlag&&(no(t.localTransform,t.localRotation,t.localPosition,t.localScale,t.origin),t.localDirtyFlag=!1),t.localTransform}},{key:"setLocalTransform",value:function(t,e){var n=Qr(oo(),e),i=eo(To(),e),e=to(oo(),e);this.setLocalScale(t,e),this.setLocalPosition(t,n),this.setLocalRotation(t,i)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,[1,1,1]),this.setLocalPosition(t,[0,0,0]),this.setLocalEulerAngles(t,[0,0,0])}},{key:"getTransformedGeometryBounds",value:function(t){var e,n=this.getGeometryBounds(t,1<arguments.length&&void 0!==arguments[1]&&arguments[1]);return Mu.isEmpty(n)?null:((e=new Mu).setFromTransformedAABB(n,this.getWorldTransform(t)),e)}},{key:"getGeometryBounds",value:function(t){t=t.geometry,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1]?t.renderBounds:t.contentBounds||null;return t&&new Mu(t.center,t.halfExtents)||new Mu}},{key:"getBounds",value:function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=t.renderable;if(!i.boundsDirty&&!n&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&n&&i.renderBounds)return i.renderBounds;var r,o=this.getTransformedGeometryBounds(t,n),a=(t.childNodes.forEach(function(t){t=e.getBounds(t,n);t&&(o?o.add(t):(o=new Mu).update(t.center,t.halfExtents))}),t.style.clipPath);return a&&((a=this.getTransformedGeometryBounds(a,!0))&&(r=new Mu).setFromTransformedAABB(a,this.getWorldTransform(t)),o?r&&(o=r.intersection(o)):o=r),o&&(n?i.renderBounds=o:i.bounds=o),n?i.renderBoundsDirty=!1:i.boundsDirty=!1,o||new Mu}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e,n=Yr(),i=(t.parentNode.transformable&&(n=Kr(Yr(),this.getWorldTransform(t.parentNode))),this.getBounds(t));if(!Mu.isEmpty(i))return(e=new Mu).setFromTransformedAABB(i,n),e}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var e,n,i,r=this.getGeometryBounds(t),r=(Mu.isEmpty(r)||(i=new Mu).setFromTransformedAABB(r,this.getWorldTransform(t)),null==(r=t.ownerDocument)||null==(t=r.defaultView)?void 0:t.getContextService().getBoundingClientRect());return i?(e=(t=vs(i.getMin(),2))[0],t=t[1],n=(i=vs(i.getMax(),2))[0],i=i[1],new Cu(e+((null==r?void 0:r.left)||0),t+((null==r?void 0:r.top)||0),n-e,i-t)):new Cu((null==r?void 0:r.left)||0,(null==r?void 0:r.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(t,e){var n=this;e.dirtyFlag||(e.dirtyFlag=!0,e.frozen=!1,t.childNodes.forEach(function(t){var e=t.transformable;e.dirtyFlag||n.dirtifyWorldInternal(t,e)}),(e=t.renderable)&&(e.renderBoundsDirty=!0,e.boundsDirty=!0,e.dirty=!0),t.dispatchEvent(new rh(C.ATTR_MODIFIED,t,null,null,"modelMatrix",rh.MODIFICATION,null,null)))}},{key:"syncHierarchy",value:function(t){var e=t.transformable;if(!e.frozen){e.frozen=!0,(e.localDirtyFlag||e.dirtyFlag)&&this.sync(t,e);for(var n=t.childNodes,i=0;i<n.length;i++)this.syncHierarchy(n[i])}}},{key:"sync",value:function(t,e){var n;e.localDirtyFlag&&(no(e.localTransform,e.localRotation,e.localPosition,e.localScale,e.origin),e.localDirtyFlag=!1),e.dirtyFlag&&(n=(t=t.parentNode)&&t.transformable,null!==t&&n?Zr(e.worldTransform,n.worldTransform,e.localTransform):qr(e.worldTransform,e.localTransform),e.dirtyFlag=!1)}},{key:"unfreezeParentToRoot",value:function(t){for(var e=t.parentNode;e;){var n=e.transformable;n&&(n.frozen=!1),e=e.parentNode}}}]),t}(),sd=(e([v(Kh),n("design:type",Function)],ad.prototype,"sceneGraphSelectorFactory",void 0),ad=e([y({token:od})],ad),f.defineToken("ContextService",{multiple:!1})),ud=((Vt=ed=ed||{})[Vt.CAMERA_CHANGED=0]="CAMERA_CHANGED",Vt[Vt.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",Vt[Vt.NONE=2]="NONE",f.defineToken("RenderingContext")),ld=f.defineToken("RenderingPluginContribution"),cd=function(){function t(){x(this,t),this.renderingPluginProvider=void 0,this.renderingContext=void 0,this.sceneGraphService=void 0,this.styleValueRegistry=void 0,this.inited=!1,this.stats={total:0,rendered:0,renderedOnscreen:0},this.zIndexCounter=0,this.hooks={init:new Hc,dirtycheck:new Xc(["object"]),cull:new Xc(["object"]),beginFrame:new Yc([]),beforeRender:new Yc(["objectToRender"]),render:new Yc(["objectToRender"]),afterRender:new Yc(["objectToRender"]),endFrame:new Yc([]),destroy:new Yc([]),pick:new Wc(["result"]),pointerDown:new Yc(["event"]),pointerUp:new Yc(["event"]),pointerMove:new Yc(["event"]),pointerOut:new Yc(["event"]),pointerOver:new Yc(["event"]),pointerWheel:new Yc(["event"]),pointerCancel:new Yc(["event"])}}var e;return w(t,[{key:"init",value:(e=as(S().mark(function t(){var e=this;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.renderingPluginProvider.getContributions({cache:!1}).forEach(function(t){t.apply(e)}),t.next=3,this.hooks.init.promise();case 3:this.inited=!0;case 4:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"getStats",value:function(){return this.stats}},{key:"render",value:function(t){this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.sceneGraphService.syncHierarchy(this.renderingContext.root),this.renderingContext.renderReasons.size&&this.inited&&(this.renderDisplayObject(this.renderingContext.root),(this.renderingContext.dirty||t.renderer.getConfig().enableDirtyRectangleRendering&&1===this.stats.total)&&(this.renderingContext.dirty||this.hooks.beginFrame.call(),this.stats.renderedOnscreen=this.stats.rendered,this.hooks.endFrame.call(),this.renderingContext.dirty=!1),this.renderingContext.renderReasons.clear())}},{key:"renderDisplayObject",value:function(t){var e=this,n=(this.styleValueRegistry.recalc(t),this.hooks.dirtycheck.call(t)),n=(n&&(this.hooks.cull.call(n),this.stats.rendered++,this.renderingContext.dirty||(this.renderingContext.dirty=!0,this.hooks.beginFrame.call()),this.hooks.beforeRender.call(n),this.hooks.render.call(n),this.hooks.afterRender.call(n),t.renderable.dirty=!1),t.sortable.renderOrder=this.zIndexCounter++,this.stats.total++,t.sortable),i=!1;n.dirty&&(n.sorted=t.childNodes.slice().sort(Qh),n.dirty=!(i=!0)),(n.sorted||t.childNodes).forEach(function(t){e.renderDisplayObject(t)}),i&&t.forEach(function(t){t.emit(C.RENDER_ORDER_CHANGED,{renderOrder:t.sortable.renderOrder})})}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call()}},{key:"dirtify",value:function(){this.renderingContext.renderReasons.add(ed.DISPLAY_OBJECT_CHANGED)}}]),t}(),hd=(e([Or(ld),n("design:type",Object)],cd.prototype,"renderingPluginProvider",void 0),e([v(ud),n("design:type",Object)],cd.prototype,"renderingContext",void 0),e([v(od),n("design:type",Object)],cd.prototype,"sceneGraphService",void 0),e([v(Eu),n("design:type",Object)],cd.prototype,"styleValueRegistry",void 0),cd=e([y()],cd),function(){T(a,Rr.exports.EventEmitter);var e,i,n,r,o=M(a);function a(){var d;x(this,a);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(d=o.call.apply(o,[this].concat(e))).renderingContext=void 0,d.contextService=void 0,d.canvasConfig=void 0,d.displayObjectPool=void 0,d.rootTarget=void 0,d.cursor="default",d.mappingTable={},d.mappingState={trackingData:{}},d.eventPool=new Map,d.pickHandler=void 0,d.onPointerDown=function(){var e=as(S().mark(function t(e){var n,i;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof zh){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,d.createPointerEvent(e);case 4:n=t.sent,d.dispatchEvent(n,"pointerdown"),"touch"===n.pointerType?d.dispatchEvent(n,"touchstart"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||(i=2===n.button,d.dispatchEvent(n,i?"rightdown":"mousedown")),d.trackingData(e.pointerId).pressTargetsByButton[e.button]=n.composedPath(),d.freeEvent(n);case 10:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),d.onPointerUp=function(){var e=as(S().mark(function t(e){var n,i,r,o,a,s,u;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof zh){t.next=2;break}return t.abrupt("return");case 2:return n=performance.now(),t.next=5,d.createPointerEvent(e);case 5:if(i=t.sent,d.dispatchEvent(i,"pointerup"),"touch"===i.pointerType?d.dispatchEvent(i,"touchend"):"mouse"!==i.pointerType&&"pen"!==i.pointerType||(r=2===i.button,d.dispatchEvent(i,r?"rightup":"mouseup")),r=d.trackingData(e.pointerId),s=d.findMountedTarget(r.pressTargetsByButton[e.button]),(u=s)&&!i.composedPath().includes(s)){for(o=s;o&&!i.composedPath().includes(o);)i.currentTarget=o,d.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType?d.notifyTarget(i,"touchendoutside"):"mouse"!==i.pointerType&&"pen"!==i.pointerType||(a=2===i.button,d.notifyTarget(i,a?"rightupoutside":"mouseupoutside")),Jc.isNode(o)&&(o=o.parentNode);delete r.pressTargetsByButton[e.button],u=o}u&&((s=d.clonePointerEvent(i,"click")).target=u,s.path=[],r.clicksByButton[e.button]||(r.clicksByButton[e.button]={clickCount:0,target:s.target,timeStamp:n}),(u=r.clicksByButton[e.button]).target===s.target&&n-u.timeStamp<200?++u.clickCount:u.clickCount=1,u.target=s.target,u.timeStamp=n,s.detail=u.clickCount,"mouse"===s.pointerType||"touch"===s.pointerType?d.dispatchEvent(s,"click"):d.dispatchEvent(s,"pointertap"),d.freeEvent(s)),d.freeEvent(i);case 14:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),d.onPointerMove=function(){var e=as(S().mark(function t(e){var n,i,r,o,a,s,u,l,c,h;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof zh){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,d.createPointerEvent(e);case 4:if(n=t.sent,i="mouse"===n.pointerType||"pen"===n.pointerType,r=d.trackingData(e.pointerId),o=d.findMountedTarget(r.overTargets),r.overTargets&&o!==n.target)return u="mousemove"===e.type?"mouseout":"pointerout",t.next=12,d.createPointerEvent(e,u,o||void 0);t.next=23;break;case 12:if(a=t.sent,d.dispatchEvent(a,"pointerout"),i&&d.dispatchEvent(a,"mouseout"),n.composedPath().includes(o)){t.next=22;break}return t.next=18,d.createPointerEvent(e,"pointerleave",o||void 0);case 18:for((s=t.sent).eventPhase=s.AT_TARGET;s.target&&!n.composedPath().includes(s.target);)s.currentTarget=s.target,d.notifyTarget(s),i&&d.notifyTarget(s,"mouseleave"),Jc.isNode(s.target)&&(s.target=s.target.parentNode);d.freeEvent(s);case 22:d.freeEvent(a);case 23:if(o===n.target){t.next=38;break}u="mousemove"===e.type?"mouseover":"pointerover",l=d.clonePointerEvent(n,u),d.dispatchEvent(l,"pointerover"),i&&d.dispatchEvent(l,"mouseover"),c=o&&Jc.isNode(o)&&o.parentNode;case 29:if(!c||c===(Jc.isNode(d.rootTarget)&&d.rootTarget.parentNode)){t.next=35;break}if(c===n.target)return t.abrupt("break",35);t.next=32;break;case 32:c=c.parentNode,t.next=29;break;case 35:if(!c||c===(Jc.isNode(d.rootTarget)&&d.rootTarget.parentNode)){for((h=d.clonePointerEvent(n,"pointerenter")).eventPhase=h.AT_TARGET;h.target&&h.target!==o&&h.target!==(Jc.isNode(d.rootTarget)&&d.rootTarget.parentNode);)h.currentTarget=h.target,d.notifyTarget(h),i&&d.notifyTarget(h,"mouseenter"),Jc.isNode(h.target)&&(h.target=h.target.parentNode);d.freeEvent(h)}d.freeEvent(l);case 38:d.dispatchEvent(n,"pointermove"),"touch"===n.pointerType&&d.dispatchEvent(n,"touchmove"),i&&(d.dispatchEvent(n,"mousemove"),d.cursor=d.getCursor(n.target)),r.overTargets=n.composedPath(),d.freeEvent(n);case 43:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),d.onPointerOut=function(){var e=as(S().mark(function t(e){var n,i,r,o,a;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof zh){t.next=2;break}return t.abrupt("return");case 2:if((n=d.trackingData(e.pointerId)).overTargets)return i="mouse"===e.pointerType||"pen"===e.pointerType,r=d.findMountedTarget(n.overTargets),t.next=8,d.createPointerEvent(e,"pointerout",r||void 0);t.next=19;break;case 8:return o=t.sent,d.dispatchEvent(o),i&&d.dispatchEvent(o,"mouseout"),t.next=13,d.createPointerEvent(e,"pointerleave",r||void 0);case 13:for((a=t.sent).eventPhase=a.AT_TARGET;a.target&&a.target!==(Jc.isNode(d.rootTarget)&&d.rootTarget.parentNode);)a.currentTarget=a.target,d.notifyTarget(a),i&&d.notifyTarget(a,"mouseleave"),Jc.isNode(a.target)&&(a.target=a.target.parentNode);n.overTargets=null,d.freeEvent(o),d.freeEvent(a);case 19:d.cursor=null;case 20:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),d.onPointerOver=function(){var e=as(S().mark(function t(e){var n,i,r,o;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof zh){t.next=2;break}return t.abrupt("return");case 2:return n=d.trackingData(e.pointerId),t.next=5,d.createPointerEvent(e);case 5:for(i=t.sent,r="mouse"===i.pointerType||"pen"===i.pointerType,d.dispatchEvent(i,"pointerover"),r&&d.dispatchEvent(i,"mouseover"),"mouse"===i.pointerType&&(d.cursor=d.getCursor(i.target)),(o=d.clonePointerEvent(i,"pointerenter")).eventPhase=o.AT_TARGET;o.target&&o.target!==(Jc.isNode(d.rootTarget)&&d.rootTarget.parentNode);)o.currentTarget=o.target,d.notifyTarget(o),r&&d.notifyTarget(o,"mouseenter"),Jc.isNode(o.target)&&(o.target=o.target.parentNode);n.overTargets=i.composedPath(),d.freeEvent(i),d.freeEvent(o);case 16:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),d.onPointerUpOutside=function(){var e=as(S().mark(function t(e){var n,i,r,o;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof zh){t.next=2;break}return t.abrupt("return");case 2:return n=d.trackingData(e.pointerId),i=d.findMountedTarget(n.pressTargetsByButton[e.button]),t.next=6,d.createPointerEvent(e);case 6:if(r=t.sent,i){for(o=i;o;)r.currentTarget=o,d.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType||"mouse"!==r.pointerType&&"pen"!==r.pointerType||d.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),Jc.isNode(o)&&(o=o.parentNode);delete n.pressTargetsByButton[e.button]}d.freeEvent(r);case 9:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),d.onWheel=function(){var e=as(S().mark(function t(e){var n;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof Vh){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,d.createWheelEvent(e);case 4:n=t.sent,d.dispatchEvent(n),d.freeEvent(n);case 7:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),d}return w(a,[{key:"init",value:function(){this.rootTarget=this.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}},{key:"client2Viewport",value:function(t){var e=this.contextService.getBoundingClientRect();return new Ss(t.x-((null==e?void 0:e.left)||0),t.y-((null==e?void 0:e.top)||0))}},{key:"viewport2Client",value:function(t){var e=this.contextService.getBoundingClientRect();return new Ss(t.x+((null==e?void 0:e.left)||0),t.y+((null==e?void 0:e.top)||0))}},{key:"viewport2Canvas",value:function(t){var e=t.x,t=t.y,n=this.rootTarget.defaultView.getCamera(),i=this.canvasConfig,r=i.width,i=i.height,o=n.getPerspectiveInverse(),n=n.getWorldTransform(),n=Zr(Yr(),n,o),o=g(e/r*2-1,2*(1-t/i)-1,0);return go(o,o,n),new Ss(o[0],o[1])}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),e=e.getViewTransform(),n=Zr(Yr(),n,e),e=g(t.x,t.y,0),t=(go(e,e,n),this.canvasConfig),n=t.width,t=t.height;return new Ss((e[0]+1)/2*n,(1-(e[1]+1)/2)*t)}},{key:"setPickHandler",value:function(t){this.pickHandler=t}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority})}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,i=e.length;n<i;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}}},{key:"dispatchEvent",value:function(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.emit(e||t.type,t)}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var i=n.length-1;1<=i;i--)if(t.currentTarget=n[i],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var r=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var o=r+1;o<n.length;o++)if(t.currentTarget=n[o],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var i=0;i<2048&&t!==this.rootTarget;i++)Jc.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e}},{key:"hitTest",value:(r=as(S().mark(function t(e){var n,i,r,o;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.viewportX,i=e.viewportY,o=this.canvasConfig,r=o.width,o=o.height,n<0||i<0||r<n||o<i)return t.abrupt("return",null);t.next=4;break;case 4:return t.next=6,this.pickHandler(e);case 6:if(t.t1=t.sent,t.t1){t.next=9;break}t.t1=this.rootTarget;case 9:if(t.t0=t.t1,t.t0){t.next=12;break}t.t0=null;case 12:return t.abrupt("return",t.t0);case 13:case"end":return t.stop()}},t,this)})),function(t){return r.apply(this,arguments)})},{key:"isNativeEventFromCanvas",value:function(t){var e=this.contextService.getDomElement(),n=null==(n=t.nativeEvent)?void 0:n.target;if(n){if(n===e)return!0;if(e&&e.contains)return e.contains(n)}return!!t.nativeEvent.composedPath&&-1<t.nativeEvent.composedPath().indexOf(e)}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath){var e,n=ks(this.displayObjectPool.getHTMLs());try{for(n.s();!(e=n.n()).done;){var i=e.value;if(-1<t.nativeEvent.composedPath().indexOf(i))return i}}catch(t){n.e(t)}finally{n.f()}}return null}},{key:"pickTarget",value:(n=as(S().mark(function t(e){return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY}));case 1:case"end":return t.stop()}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"createPointerEvent",value:(i=as(S().mark(function t(e,n,i){var r,o;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.allocateEvent(zh),this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,o=this.getExistedHTML(r),null==i){t.next=11;break}t.t0=i,t.next=20;break;case 11:if(t.t1=o,t.t1){t.next=19;break}if(t.t2=this.isNativeEventFromCanvas(r),t.t2)return t.next=17,this.pickTarget(r);t.next=18;break;case 17:t.t2=t.sent;case 18:t.t1=t.t2;case 19:t.t0=t.t1;case 20:return r.target=t.t0,"string"==typeof n&&(r.type=n),t.abrupt("return",r);case 23:case"end":return t.stop()}},t,this)})),function(t,e,n){return i.apply(this,arguments)})},{key:"createWheelEvent",value:(e=as(S().mark(function t(e){var n,i;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.allocateEvent(Vh),this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,i=this.getExistedHTML(n),t.t0=i,t.t0){t.next=15;break}if(t.t1=this.isNativeEventFromCanvas(n),t.t1)return t.next=13,this.pickTarget(n);t.next=14;break;case 13:t.t1=t.sent;case 14:t.t0=t.t1;case 15:return n.target=t.t0,t.abrupt("return",n);case 17:case"end":return t.stop()}},t,this)})),function(t){return e.apply(this,arguments)})},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(zh);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n}},{key:"copyPointerData",value:function(t,e){t instanceof zh&&e instanceof zh&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}},{key:"copyMouseData",value:function(t,e){t instanceof Fh&&e instanceof Fh&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset))}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport)}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);t=this.eventPool.get(t).pop()||new t(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}},{key:"notifyTarget",value:function(t,e){e=null!=(n=e)?n:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,i=n._events[e];if(i)if("fn"in i)i.once&&n.removeListener(e,i.fn,void 0,!0),i.fn.call(t.currentTarget||i.context,t);else for(var r=0;r<i.length&&!t.propagationImmediatelyStopped;r++)i[r].once&&n.removeListener(e,i[r].fn,void 0,!0),i[r].fn.call(t.currentTarget||i[r].context,t)}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;0<=n;n--){var i=t[n];if(!(i===this.rootTarget||Jc.isNode(i)&&i.parentNode===e))break;e=t[n]}return e}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=ah.isElement(e)&&e.getAttribute("cursor");if(n)return n;e=Jc.isNode(e)&&e.parentNode}}}]),a}()),dd=(e([v(ud),n("design:type",Object)],hd.prototype,"renderingContext",void 0),e([v(sd),n("design:type",Object)],hd.prototype,"contextService",void 0),e([v(xs),n("design:type",Object)],hd.prototype,"canvasConfig",void 0),e([v(ws),n("design:type",ws)],hd.prototype,"displayObjectPool",void 0),e([Kt.postConstruct(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],hd.prototype,"init",null),hd=e([y()],hd),function(){function t(){x(this,t),this.canvas=void 0,this.context=void 0}return w(t,[{key:"getOrCreateCanvas",value:function(t){if(this.canvas)return this.canvas;if(t)this.canvas=t,this.context=this.canvas.getContext("2d");else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d"),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d")}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t){return this.context||(this.getOrCreateCanvas(t),this.context)}}]),t}()),dd=e([y()],dd),pd={MetricsString:"|ÉqÅ",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},fd=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,yd=new RegExp("".concat(/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/.source,"|").concat(/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/.source,"|").concat(/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/.source,"|").concat(/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/.source)),vd=new RegExp("".concat(/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/.source,"|").concat(/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/.source,"|").concat(/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/.source,"|").concat(/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/.source)),gd=function(){function t(){var n=this;x(this,t),this.cache={},this.offscreenCanvas=void 0,this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!(!t||!vd.exec(e)&&!yd.exec(t))},this.trimByKinsokuShorui=function(t){var e=gs(t),n=e[e.length-2];if(!n)return t;t=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=t+e[e.length-1],e}}return w(t,[{key:"measureFont",value:function(t,e){if(this.cache[t])return this.cache[t];for(var n={ascent:0,descent:0,fontSize:0},i=this.offscreenCanvas.getOrCreateCanvas(e),e=this.offscreenCanvas.getOrCreateContext(e),r=(e.font=t,pd.MetricsString+pd.BaselineSymbol),o=Math.ceil(e.measureText(r).width),a=Math.ceil(e.measureText(pd.BaselineSymbol).width),s=pd.HeightMultiplier*a,a=a*pd.BaselineMultiplier|0,u=(i.width=o,i.height=s,e.fillStyle="#f00",e.fillRect(0,0,o,s),e.font=t,e.textBaseline="alphabetic",e.fillStyle="#000",e.fillText(r,0,a),e.getImageData(0,0,o||1,s||1).data),i=u.length,l=4*o,c=0,h=0,d=!1,c=0;c<a;++c){for(var p=0;p<l;p+=4)if(255!==u[h+p]){d=!0;break}if(d)break;h+=l}for(n.ascent=a-c,h=i-l,d=!1,c=s;a<c;--c){for(var f=0;f<l;f+=4)if(255!==u[h+f]){d=!0;break}if(d)break;h-=l}return n.descent=c-a,n.fontSize=n.ascent+n.descent,this.cache[t]=n}},{key:"measureText",value:function(t,e,n){var i=e.fontSize,r=e.wordWrap,o=e.lineHeight,o=void 0===o?0:o,a=e.lineWidth,s=e.textBaseline,u=e.textAlign,l=e.letterSpacing,c=void 0===l?0:l,l=e.leading,l=void 0===l?0:l,h=function(t){for(var e=t.fontSize,n=t.fontFamily,i=t.fontStyle,r=t.fontVariant,t=t.fontWeight,e=Os(e)?"".concat(e,"px"):e.toString(),o=wc(n)?n.split(","):[n.value],a=o.length-1;0<=a;a--){var s=o[a].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&Kc.indexOf(s)<0&&(s='"'.concat(s,'"')),o[a]=s}return"".concat(i," ").concat(r," ").concat(t," ").concat(e," ").concat(o.join(","))}(e),d=this.measureFont(h,n),p=(0===d.fontSize&&(d.fontSize=i.value,d.ascent=i.value),this.offscreenCanvas.getOrCreateContext(n));p.font=h;for(var f=(r?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),y=new Array(f.length),v=0,g=0;g<f.length;g++){var m=p.measureText(f[g]).width+(f[g].length-1)*c;y[g]=m,v=Math.max(v,m)}var i=v+a.value,b=o||d.fontSize+a.value,r=Math.max(b,d.fontSize+a.value)+(f.length-1)*(b+l),k=0;return"middle"===s.value?k=-r/2:"bottom"===s.value||"alphabetic"===s.value||"ideographic"===s.value?k=-r:"top"!==s.value&&"hanging"!==s.value||(k=0),{font:h,width:i,height:r,lines:f,lineWidths:y,lineHeight:b+=l,maxLineWidth:v,fontProperties:d,lineMetrics:y.map(function(t,e){var n=0;return"center"===u.value?n-=t/2:"right"!==u.value&&"end"!==u.value||(n-=t),new Cu(n-a.value/2,k+e*b,t+a.value,b)})}}},{key:"wordWrap",value:function(r,t,e){function o(t){return a.getFromCache(t,i,d,s)}var a=this,n=t.wordWrapWidth,n=void 0===n?0:n,t=t.letterSpacing,i=void 0===t?0:t,s=this.offscreenCanvas.getOrCreateContext(e),u=n+i,l=[],c=0,h=0,d={};return Array.from(r).forEach(function(t,e){var n=r[e-1],e=r[e+1],i=o(t);if(a.isNewline(t))return h=0,void(l[++c]="");if(0<h&&u<h+i){if(h=0,l[++c]="",a.isBreakingSpace(t))return;a.canBreakInLastChar(t)||(l=a.trimToBreakable(l),h=a.sumTextWidthByCache(l[c]||"",d)),a.shouldBreakByKinsokuShorui(t,e)&&(l=a.trimByKinsokuShorui(l),h+=o(n||""))}h+=i,l[c]=(l[c]||"")+t}),l.join("\n")}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&0<=pd.BreakingSpaces.indexOf(t.charCodeAt(0))}},{key:"isNewline",value:function(t){return"string"==typeof t&&0<=pd.Newlines.indexOf(t.charCodeAt(0))}},{key:"trimToBreakable",value:function(t){var t=gs(t),e=t[t.length-2],n=this.findBreakableIndex(e);if(-1===n||!e)return t;var i=e.slice(n,n+1),i=n+(this.isBreakingSpace(i)?0:1);return t[t.length-1]+=e.slice(n+1,e.length),t[t.length-2]=e.slice(0,i),t}},{key:"canBreakInLastChar",value:function(t){return!t||!fd.test(t)}},{key:"sumTextWidthByCache",value:function(t,n){return t.split("").reduce(function(t,e){if(n[e])return t+n[e];throw Error("cannot count the word without cache")},0)}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;0<=e;e--)if(!fd.test(t[e]))return e;return-1}},{key:"getFromCache",value:function(t,e,n,i){var r=n[t];return"number"!=typeof r&&(e=t.length*e,r=i.measureText(t).width+e,n[t]=r),r}}]),t}(),md=(e([v(dd),n("design:type",dd)],gd.prototype,"offscreenCanvas",void 0),gd=e([y()],gd),function(){function t(){x(this,t)}return w(t,[{key:"update",value:function(t,e){t=t.r;return{width:2*t.value,height:2*t.value}}}]),t}()),md=e([y({token:{token:_u,named:m.CIRCLE}})],md),bd=function(){function t(){x(this,t)}return w(t,[{key:"update",value:function(t,e){var n=t.rx,t=t.ry;return{width:2*n.value,height:2*t.value}}}]),t}(),bd=e([y({token:{token:_u,named:m.ELLIPSE}})],bd),kd=function(){function t(){x(this,t)}return w(t,[{key:"update",value:function(t,e){var n=t.img,i=t.width,t=t.height,r=0,o=0;return i instanceof L&&i.unit===N.kPixels&&(r=i.value),t instanceof L&&t.unit===N.kPixels&&(o=t.value),n&&!wc(n)&&(r=r||n.width,o=o||n.height),i instanceof L&&(i.value=r),t instanceof L&&(t.value=o),{width:r,height:o}}}]),t}(),kd=e([y({token:[{token:_u,named:m.RECT},{token:_u,named:m.IMAGE},{token:_u,named:m.GROUP}]})],kd),xd=function(){function t(){x(this,t),this.textService=void 0}return w(t,[{key:"isReadyToMeasure",value:function(t,e){var n=t.text,i=t.textAlign,r=t.textBaseline,o=t.fontSize,a=t.fontStyle,s=t.fontWeight,u=t.fontVariant,t=t.lineWidth;return n&&o&&a&&s&&u&&i&&r&&t}},{key:"update",value:function(t,e){var n=t.text,i=t.textAlign,r=t.lineWidth,o=t.textBaseline,a=t.dx,s=t.dy,u=((null==e||null==(u=e.ownerDocument)||null==(u=u.defaultView)?void 0:u.getConfig())||{}).offscreenCanvas;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{width:0,height:0,x:0,y:0,offsetX:0,offsetY:0};var e=this.textService.measureText(n,t,u),n=(t.metrics=e).width,u=e.height,l=e.lineHeight,e=e.fontProperties,n=g(n/2,u/2,0),u=[0,1],c=0,i=("center"===i.value?(c=r.value/2,u=[.5,1]):"right"!==i.value&&"end"!==i.value||(c=r.value,u=[1,1]),0);return"middle"===o.value?i=n[1]:"top"===o.value||"hanging"===o.value?i=2*n[1]:"alphabetic"===o.value?i=l-e.ascent:"bottom"!==o.value&&"ideographic"!==o.value||(i=0),a&&(c+=a.value),s&&(i+=s.value),t.anchor=[new L(u[0]),new L(u[1]),new L(0)],{width:2*n[0],height:2*n[1],offsetX:c,offsetY:i}}}]),t}(),wd=(e([v(gd),n("design:type",gd)],xd.prototype,"textService",void 0),xd=e([y({token:{token:_u,named:m.TEXT}})],xd),function(){function t(){x(this,t)}return w(t,[{key:"update",value:function(t){var e=t.x1,n=t.y1,i=t.x2,t=t.y2,r=Math.min(e.value,i.value),e=Math.max(e.value,i.value),i=Math.min(n.value,t.value);return{width:e-r,height:Math.max(n.value,t.value)-i}}}]),t}()),wd=e([y({token:{token:_u,named:m.LINE}})],wd),Sd=function(){function t(){x(this,t)}return w(t,[{key:"update",value:function(t){var t=t.points.points,e=Math.min.apply(Math,gs(t.map(function(t){return t[0]}))),n=Math.max.apply(Math,gs(t.map(function(t){return t[0]}))),i=Math.min.apply(Math,gs(t.map(function(t){return t[1]})));return{width:n-e,height:Math.max.apply(Math,gs(t.map(function(t){return t[1]})))-i}}}]),t}(),Sd=e([y({token:[{token:_u,named:m.POLYLINE},{token:_u,named:m.POLYGON}]})],Sd),Ed=function(){function t(){x(this,t)}return w(t,[{key:"update",value:function(t){t=t.path.rect;return{width:t.width,height:t.height}}}]),t}(),Ed=e([y({token:{token:_u,named:m.PATH}})],Ed),Gt=Mr(function(t){Kt.decorate(cr(),Rr.exports.EventEmitter),t(ws),t(Jh),t({token:Kh,useFactory:function(t){return function(){return t.container.get(Zh)}}}),t(ad),t(dd),t(gd),t(md),t(bd),t(kd),t(xd),t(wd),t(Sd),t(Ed),t({token:Tu,useFactory:function(e){var n={};return function(t){return n[t]||e.container.isBoundNamed(_u,t)&&(n[t]=e.container.getNamed(_u,t)),n[t]}}}),t(Xl),t(cc),t(Kl),t(ql),t({token:Wl,useFactory:function(n){return function(t){var e=n.container.createChild();return e.register({token:Ul,useValue:t}),e.get(ql)}}}),t({token:Ll,useFactory:function(o){return function(t){var e=o.container.createChild(),n=(e.register(Rl),e.register(Gl),e.register({token:Vl,useFactory:function(n){return function(t){var e=n.container.createChild();return e.register({token:Hl,useValue:t}),e.get(Gl)}}}),e.register(zl),e.register({token:jl,useFactory:function(i){return function(t,e){var n=i.container.createChild();return n.register({token:Bl,useValue:t}),n.register({token:Fl,useValue:e}),n.get(zl)}}}),e.register(Jl),e.register({token:Zl,useFactory:function(n){return function(t){var e=n.container.createChild();return e.register({token:$l,useValue:t}),e.get(Jl)}}}),e.get(Vl)),i=e.get(Zl),r=e.get(jl);return e.register({token:Il,useValue:is(is({},t),{},{layoutChildrenFactory:n,layoutFragmentFactory:i,fragmentResultFactory:r})}),e.get(Rl)}}})}),Td=f.defineToken("DefaultCamera");(re=nd=nd||{})[re.ORBITING=0]="ORBITING",re[re.EXPLORING=1]="EXPLORING",re[re.TRACKING=2]="TRACKING",(c=id=id||{})[c.DEFAULT=0]="DEFAULT",c[c.ROTATIONAL=1]="ROTATIONAL",c[c.TRANSLATIONAL=2]="TRANSLATIONAL",c[c.CINEMATIC=3]="CINEMATIC",(ve=rd=rd||{})[ve.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",ve[ve.PERSPECTIVE=1]="PERSPECTIVE";var _d,Md,Pd,Od,Cd,Ad,Nd="updated",Ld=Math.PI/180,Id=180/Math.PI,Dd=function(){T(a,Rr.exports.EventEmitter);var i=M(a);function a(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:nd.EXPLORING,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:id.DEFAULT;return x(this,a),(t=i.call(this)).canvas=void 0,t.matrix=Yr(),t.right=g(1,0,0),t.up=g(0,1,0),t.forward=g(0,0,1),t.position=g(0,0,1),t.focalPoint=g(0,0,0),t.distanceVector=g(0,0,-1),t.distance=1,t.azimuth=0,t.elevation=0,t.roll=0,t.relAzimuth=0,t.relElevation=0,t.relRoll=0,t.dollyingStep=0,t.maxDistance=1/0,t.minDistance=-1/0,t.zoom=1,t.rotateWorld=!1,t.fov=30,t.near=.1,t.far=1e3,t.aspect=1,t.left=void 0,t.rright=void 0,t.top=void 0,t.bottom=void 0,t.projectionMatrix=Yr(),t.projectionMatrixInverse=Yr(),t.jitteredProjectionMatrix=void 0,t.view=void 0,t.enableUpdate=!0,t.type=nd.EXPLORING,t.trackingMode=id.DEFAULT,t.projectionMode=rd.PERSPECTIVE,t.frustum=new Ou,t.landmarks=[],t.landmarkAnimationID=void 0,t.orthoMatrix=Yr(),t.setType(e,n),t}return w(a,[{key:"isOrtho",value:function(){return this.projectionMode===rd.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,e){return this.type=t,this.type===nd.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===nd.TRACKING&&void 0!==e&&this.setTrackingMode(e),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==nd.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return Kr(Yr(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,e){n=Yr(),t=[t,e,0],n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1;var n,e=n;this.jitteredProjectionMatrix=Zr(Yr(),e,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===rd.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===rd.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,e,n,i,r,o){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.projectionMode===rd.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===rd.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===rd.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===rd.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setPerspective",value:function(t,e,n,i){this.projectionMode=rd.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=i;var r,o,a,s,n=this.near*Math.tan(.5*Ld*this.fov)/this.zoom,e=2*n,i=this.aspect*e,u=-.5*i;return null!=(r=this.view)&&r.enabled&&(r=this.view.fullWidth,o=this.view.fullHeight,u+=this.view.offsetX*i/r,n-=this.view.offsetY*e/o,i*=this.view.width/r,e*=this.view.height/o),r=this.projectionMatrix,u=(o=u)+i,n=(i=n)-e,e=this.far,a=2*t/(i-n),s=(u+o)/(u-o),i=(i+n)/(i-n),n=-(e+t)/(e-t),e=-2*e*t/(e-t),r[0]=2*t/(u-o),r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=s,r[9]=i,r[10]=n,r[11]=-1,r[12]=0,r[13]=0,r[14]=e,r[15]=0,Jr(this.projectionMatrix,this.projectionMatrix,g(1,-1,1)),Kr(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,e,n,i,r,o){this.projectionMode=rd.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=i,this.near=r,this.far=o;var a,e=(this.rright-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.rright+this.left)/2,i=(this.top+this.bottom)/2,s=n-e,n=n+e,e=i+t,i=i-t;return null!=(t=this.view)&&t.enabled&&(t=(this.rright-this.left)/this.view.fullWidth/this.zoom,a=(this.top-this.bottom)/this.view.fullHeight/this.zoom,n=(s+=t*this.view.offsetX)+t*this.view.width,i=(e-=a*this.view.offsetY)-a*this.view.height),ro(this.projectionMatrix,s,n,i,e,r,o),Jr(this.projectionMatrix,this.projectionMatrix,g(1,-1,1)),Kr(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){t=Xs(t,(1<arguments.length&&void 0!==arguments[1]?arguments:this.position)[1],(2<arguments.length&&void 0!==arguments[2]?arguments:this.position)[2]);return this._setPosition(t),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var e,n,i,r,o,a,s,u,l,c,h,d=(1<arguments.length&&void 0!==arguments[1]?arguments:this.focalPoint)[1],p=(2<arguments.length&&void 0!==arguments[2]?arguments:this.focalPoint)[2],f=g(0,1,0);return this.focalPoint=Xs(t,d,p),this.trackingMode===id.CINEMATIC&&(t=(h=ho(oo(),this.focalPoint,this.position))[0],d=h[1],p=h[2],h=so(h),d=Math.asin(d/h)*Id,h=90+Math.atan2(p,t)*Id,p=Yr(),c=t=p,h=h*Ld,a=Math.sin(h),h=Math.cos(h),e=c[0],r=c[1],s=c[2],n=c[3],o=c[8],i=c[9],l=c[10],u=c[11],c!==t&&(t[4]=c[4],t[5]=c[5],t[6]=c[6],t[7]=c[7],t[12]=c[12],t[13]=c[13],t[14]=c[14],t[15]=c[15]),t[0]=e*h-o*a,t[1]=r*h-i*a,t[2]=s*h-l*a,t[3]=n*h-u*a,t[8]=e*a+o*h,t[9]=r*a+i*h,t[10]=s*a+l*h,t[11]=n*a+u*h,e=c=p,o=d*Ld,r=Math.sin(o),o=Math.cos(o),i=e[4],s=e[5],l=e[6],t=e[7],n=e[8],a=e[9],u=e[10],h=e[11],e!==c&&(c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[12]=e[12],c[13]=e[13],c[14]=e[14],c[15]=e[15]),c[4]=i*o+n*r,c[5]=s*o+a*r,c[6]=l*o+u*r,c[7]=t*o+h*r,c[8]=n*o-i*r,c[9]=a*o-s*r,c[10]=u*o-l*r,c[11]=h*o-t*r,f=go(oo(),[0,1,0],p)),Kr(this.matrix,(d=Yr(),e=this.position,n=this.focalPoint,i=f,a=e[0],s=e[1],e=e[2],u=i[0],l=i[1],i=i[2],c=n[0],h=n[1],n=n[2],Math.abs(a-c)<Hr&&Math.abs(s-h)<Hr&&Math.abs(e-n)<Hr?Xr(d):(n=e-n,t=l*(n*=o=1/Math.hypot(c=a-c,h=s-h,n))-i*(h*=o),i=i*(c*=o)-u*n,u=u*h-l*c,(o=Math.hypot(t,i,u))?(t*=o=1/o,i*=o,u*=o):u=i=t=0,l=h*u-n*i,r=n*t-c*u,p=c*i-h*t,(o=Math.hypot(l,r,p))?(l*=o=1/o,r*=o,p*=o):p=r=l=0,d[0]=t,d[1]=l,d[2]=c,d[3]=0,d[4]=i,d[5]=r,d[6]=h,d[7]=0,d[8]=u,d[9]=p,d[10]=n,d[11]=0,d[12]=-(t*a+i*s+u*e),d[13]=-(l*a+r*s+p*e),d[14]=-(c*a+h*s+n*e),d[15]=1,d))),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=oo(),n=(t=this.distance,this.forward),i=this.focalPoint;return e[0]=t*n[0]+i[0],e[1]=t*n[1]+i[1],e[2]=t*n[2]+i[2],this._setPosition(e),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=qs(t),this.computeMatrix(),this._getAxes(),this.type===nd.ORBITING||this.type===nd.EXPLORING?this._getPosition():this.type===nd.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=qs(t),this.computeMatrix(),this._getAxes(),this.type===nd.ORBITING||this.type===nd.EXPLORING?this._getPosition():this.type===nd.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=qs(t),this.computeMatrix(),this._getAxes(),this.type===nd.ORBITING||this.type===nd.EXPLORING?this._getPosition():this.type===nd.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"rotate",value:function(t,e,n){if(this.relElevation=qs(e),this.relAzimuth=qs(t),this.relRoll=qs(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===nd.EXPLORING){e=_o(To(),[1,0,0],(this.rotateWorld?1:-1)*this.relElevation*Ld),t=_o(To(),[0,1,0],(this.rotateWorld?1:-1)*this.relAzimuth*Ld),n=_o(To(),[0,0,1],this.relRoll*Ld),t=Mo(To(),t,e),t=Mo(To(),t,n),e=io(Yr(),t);$r(this.matrix,this.matrix,[0,0,-this.distance]),Zr(this.matrix,this.matrix,e),$r(this.matrix,this.matrix,[0,0,this.distance])}else{if(90<Math.abs(this.elevation))return this;this.computeMatrix()}return this._getAxes(),this.type===nd.ORBITING||this.type===nd.EXPLORING?this._getPosition():this.type===nd.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(t,e){t=Xs(t,e,0),e=ao(this.position);return co(e,e,po(oo(),this.right,t[0])),co(e,e,po(oo(),this.up,t[1])),this._setPosition(e),this.triggerUpdate(),this}},{key:"dolly",value:function(t){var e=this.forward,n=ao(this.position),t=(this.dollyingStep,this.distance+t*this.dollyingStep),t=Math.max(Math.min(t,this.maxDistance),this.minDistance)-this.distance;return n[0]+=t*e[0],n[1]+=t*e[1],n[2]+=t*e[2],this._setPosition(n),this.type===nd.ORBITING||this.type===nd.EXPLORING?this._getDistance():this.type===nd.TRACKING&&co(this.focalPoint,n,this.distanceVector),this.triggerUpdate(),this}},{key:"createLandmark",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=e.position,n=void 0===n?this.position:n,i=e.focalPoint,i=void 0===i?this.focalPoint:i,r=e.roll,e=e.zoom,o=new a,r=(o.setType(this.type,void 0),o.setPosition(n[0],n[1]||this.position[1],n[2]||this.position[2]),o.setFocalPoint(i[0],i[1]||this.focalPoint[1],i[2]||this.focalPoint[2]),o.setRoll(r||this.roll),o.setZoom(e||this.zoom),{name:t,matrix:(n=o.matrix,(i=new Gr(16))[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i),right:ao(o.right),up:ao(o.up),forward:ao(o.forward),position:ao(o.position),focalPoint:ao(o.focalPoint),distanceVector:ao(o.distanceVector),distance:o.distance,dollyingStep:o.dollyingStep,azimuth:o.azimuth,elevation:o.elevation,roll:o.roll,relAzimuth:o.relAzimuth,relElevation:o.relElevation,relRoll:o.relRoll,zoom:o.zoom});return this.landmarks.push(r),r}},{key:"gotoLandmark",value:function(e){var s=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=wc(e)?this.landmarks.find(function(t){return t.name===e}):e;if(n){var t=Os(t)?{duration:t}:t,i=t.easing,i=void 0===i?"linear":i,r=t.duration,u=void 0===r?100:r,r=t.easingFunction,r=void 0===r?void 0:r,t=t.onfinish,o=void 0===t?void 0:t,l=.01;if(0===u)return this.syncFromLandmark(n),void(o&&o());void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID);var c,h=n.position,d=n.focalPoint,p=n.zoom,f=n.roll,y=r||yc(i),v=function(){s.setFocalPoint(d),s.setPosition(h),s.setRoll(f),s.setZoom(p),s.computeMatrix(),s.triggerUpdate(),o&&o()};this.canvas.requestAnimationFrame(function t(e){var n,i,r,o,a,e=e-(c=void 0===c?e:c);u<e?v():(n=y(e/u),i=oo(),r=oo(),o=1,a=0,vo(i,s.focalPoint,d,n),vo(r,s.position,h,n),a=s.roll*(1-n)+f*n,o=s.zoom*(1-n)+p*n,s.setFocalPoint(i),s.setPosition(r),s.setRoll(a),s.setZoom(o),xo(i,d)+xo(r,h)<=l?v():(s.computeMatrix(),s.triggerUpdate(),e<u&&(s.landmarkAnimationID=s.canvas.requestAnimationFrame(t))))})}}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=_o(To(),[0,0,1],this.roll*Ld),e=(Xr(this.matrix),_o(To(),[1,0,0],(this.rotateWorld&&this.type!==nd.TRACKING||this.type===nd.TRACKING?1:-1)*this.elevation*Ld)),n=_o(To(),[0,1,0],(this.rotateWorld&&this.type!==nd.TRACKING||this.type===nd.TRACKING?1:-1)*this.azimuth*Ld),n=Mo(To(),n,e),n=Mo(To(),n,t),e=io(Yr(),n);this.type===nd.ORBITING||this.type===nd.EXPLORING?($r(this.matrix,this.matrix,this.focalPoint),Zr(this.matrix,this.matrix,e),$r(this.matrix,this.matrix,[0,0,this.distance])):this.type===nd.TRACKING&&($r(this.matrix,this.matrix,this.position),Zr(this.matrix,this.matrix,e))}},{key:"_setPosition",value:function(t,e,n){this.position=Xs(t,e,n);t=this.matrix;t[12]=this.position[0],t[13]=this.position[1],t[14]=this.position[2],t[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){uo(this.right,Xs(Eo(So(),[1,0,0,0],this.matrix))),uo(this.up,Xs(Eo(So(),[0,1,0,0],this.matrix))),uo(this.forward,Xs(Eo(So(),[0,0,1,0],this.matrix))),fo(this.right,this.right),fo(this.up,this.up),fo(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],i=so(this.distanceVector);if(0===i)return this.elevation=0,void(this.azimuth=0);this.type===nd.TRACKING||this.rotateWorld?(this.elevation=Math.asin(e/i)*Id,this.azimuth=Math.atan2(-t,-n)*Id):(this.elevation=-Math.asin(e/i)*Id,this.azimuth=-Math.atan2(-t,-n)*Id)}},{key:"_getPosition",value:function(){uo(this.position,Xs(Eo(So(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){var t,e;mo(this.distanceVector,[0,0,-this.distance],(t=Wr(),e=this.matrix,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t)),co(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=ho(oo(),this.focalPoint,this.position),this.distance=so(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){var t,e;this.projectionMode===rd.ORTHOGRAPHIC&&(t=this.position,e=_o(To(),[0,0,1],-this.roll*Math.PI/180),no(this.orthoMatrix,e,g((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),g(this.zoom,this.zoom,1),t))}},{key:"triggerUpdate",value:function(){var t;this.enableUpdate&&(t=this.getViewTransform(),t=Zr(Yr(),this.getPerspective(),t),this.getFrustum().extractFromVPMatrix(t),this.emit(Nd))}},{key:"syncFromLandmark",value:function(t){this.matrix=qr(this.matrix,t.matrix),this.right=uo(this.right,t.right),this.up=uo(this.up,t.up),this.forward=uo(this.forward,t.forward),this.position=uo(this.position,t.position),this.focalPoint=uo(this.focalPoint,t.focalPoint),this.distanceVector=uo(this.distanceVector,t.distanceVector),this.azimuth=t.azimuth,this.elevation=t.elevation,this.roll=t.roll,this.relAzimuth=t.relAzimuth,this.relElevation=t.relElevation,this.relRoll=t.relRoll,this.dollyingStep=t.dollyingStep,this.distance=t.distance,this.zoom=t.zoom}}]),a}(),Rd=function(){function e(t){x(this,e),this.plugins=[],this.config=void 0,this.config=is({enableDirtyCheck:!0,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1},t)}return w(e,[{key:"registerPlugin",value:function(t){this.plugins.push(t)}},{key:"unregisterPlugin",value:function(e){var t=this.plugins.findIndex(function(t){return t===e});-1<t&&this.plugins.splice(t,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(e){return this.plugins.find(function(t){return t.name===e})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(t){Object.assign(this.config,t)}}]),e}(),jd=((ge=function(){function t(){x(this,t),this.canvasConfig=void 0,this.renderingContext=void 0}return w(t,[{key:"apply",value:function(t){var o=this;t.hooks.dirtycheck.tap(_d.tag,function(t){var e,n,i,r;return t&&(e=o.canvasConfig.renderer.getConfig().enableDirtyCheck,n=t.renderable,i=o.renderingContext.renderReasons.has(ed.CAMERA_CHANGED),r=o.renderingContext.dirty,n.dirty||i||!e&&r?t:null)})}}]),t}()).tag="DirtyCheck",_d=ge),Bd=(e([v(xs),n("design:type",Object)],jd.prototype,"canvasConfig",void 0),e([v(ud),n("design:type",Object)],jd.prototype,"renderingContext",void 0),jd=_d=e([y({contrib:ld})],jd),f.defineToken("CullingStrategyContribution")),Fd=((s=function(){function t(){x(this,t),this.strategyProvider=void 0}return w(t,[{key:"apply",value:function(t){var n=this.strategyProvider.getContributions();t.hooks.cull.tap(Md.tag,function(e){var t;return e&&(t=e.cullable,0===n.length?t.visible=!0:t.visible=n.every(function(t){return t.isVisible(e)}),!t.isCulled()&&e.isVisible()?e:null)}),t.hooks.afterRender.tap(Md.tag,function(t){t.cullable.visibilityPlaneMask=-1})}}]),t}()).tag="Culling",Md=s),zd=(e([Or(Bd),n("design:type",Object)],Fd.prototype,"strategyProvider",void 0),Fd=Md=e([y({contrib:ld})],Fd),(Ht=function(){function t(){x(this,t),this.renderingContext=void 0,this.styleValueRegistry=void 0}return w(t,[{key:"apply",value:function(e){function n(t){t.target.renderable.dirty=!0,e.dirtify()}function i(){e.dirtify()}function r(t){t=t.target,a.styleValueRegistry.recalc(t),td(t),e.dirtify()}function o(t){td(t.target),e.dirtify()}var a=this;e.hooks.init.tapPromise(Pd.tag,as(S().mark(function t(){return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.renderingContext.root.addEventListener(C.MOUNTED,r),a.renderingContext.root.addEventListener(C.UNMOUNTED,o),a.renderingContext.root.addEventListener(C.ATTR_MODIFIED,n),a.renderingContext.root.addEventListener(C.BOUNDS_CHANGED,i);case 4:case"end":return t.stop()}},t)}))),e.hooks.destroy.tap(Pd.tag,function(){a.renderingContext.root.removeEventListener(C.MOUNTED,r),a.renderingContext.root.removeEventListener(C.UNMOUNTED,o),a.renderingContext.root.removeEventListener(C.ATTR_MODIFIED,n),a.renderingContext.root.removeEventListener(C.BOUNDS_CHANGED,i)})}}]),t}()).tag="Prepare",Pd=Ht),Vd=(e([v(ud),n("design:type",Object)],zd.prototype,"renderingContext",void 0),e([v(Eu),n("design:type",Object)],zd.prototype,"styleValueRegistry",void 0),zd=Pd=e([y({contrib:ld})],zd),[m.CIRCLE,m.ELLIPSE,m.IMAGE,m.RECT,m.LINE,m.POLYLINE,m.POLYGON,m.TEXT,m.PATH,m.HTML]),Hd=function(){function t(){x(this,t),this.camera=void 0}return w(t,[{key:"isVisible",value:function(t){var e=t.cullable;if(!e.enable)return!0;var n=t.getRenderBounds();if(Mu.isEmpty(n))return!1;var i=this.camera.getFrustum(),r=null==(r=t.parentNode)||null==(r=r.cullable)?void 0:r.visibilityPlaneMask;return e.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,n,r||mu.INDETERMINATE,i.planes),e.visible=e.visibilityPlaneMask!==mu.OUTSIDE,e.visible}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,i){if(n===mu.OUTSIDE||n===mu.INSIDE)return n;for(var r=mu.INSIDE,o=-1<Vd.indexOf(t.nodeName),a=0,s=i.length;a<s;++a){var u=1<<a;if(0!=(n&u)&&(!o||4!==a&&5!==a)){var l=i[a],c=l.normal,l=l.distance;if(yo(c,e.getPositiveFarPoint(i[a]))+l<0)return mu.OUTSIDE;yo(c,e.getNegativeFarPoint(i[a]))+l<0&&(r|=u)}}return r}}]),t}(),Gd=(e([v(Td),n("design:type",Dd)],Hd.prototype,"camera",void 0),Hd=e([y({contrib:Bd})],Hd),(ne=function(){function t(){var s=this;x(this,t),this.canvasConfig=void 0,this.contextService=void 0,this.renderingService=void 0,this.renderingContext=void 0,this.eventService=void 0,this.autoPreventDefault=!0,this.rootPointerEvent=new zh(null),this.rootWheelEvent=new Vh(null),this.onPointerMove=function(t){var e,n=null==(e=s.renderingContext.root)||null==(e=e.ownerDocument)?void 0:e.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var i,r=ks(s.normalizeToPointerEvent(t,n));try{for(r.s();!(i=r.n()).done;){var o=i.value,a=s.bootstrapEvent(s.rootPointerEvent,o,n);s.eventService.mapEvent(a)}}catch(t){r.e(t)}finally{r.f()}s.setCursor(s.eventService.cursor)}}}return w(t,[{key:"apply",value:function(t){var s=this,u=this.renderingContext.root.ownerDocument.defaultView;this.eventService.setPickHandler(function(){var e=as(S().mark(function t(e){var n;return S().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.renderingService.hooks.pick.promise({position:e,picked:[],topmost:!0});case 2:return n=t.sent,n=n.picked,t.abrupt("return",n[0]||null);case 5:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()),t.hooks.pointerWheel.tap(Od.tag,function(t){t=s.normalizeWheelEvent(t);s.eventService.mapEvent(t)}),t.hooks.pointerDown.tap(Od.tag,function(t){if(!u.supportsTouchEvents||"touch"!==t.pointerType){var e,n=s.normalizeToPointerEvent(t,u),i=(!s.autoPreventDefault||!n[0].isNormalized||!t.cancelable&&"cancelable"in t||t.preventDefault(),ks(n));try{for(i.s();!(e=i.n()).done;){var r=e.value,o=s.bootstrapEvent(s.rootPointerEvent,r,u);s.eventService.mapEvent(o)}}catch(t){i.e(t)}finally{i.f()}s.setCursor(s.eventService.cursor)}}),t.hooks.pointerUp.tap(Od.tag,function(t){if(!u.supportsTouchEvents||"touch"!==t.pointerType){var e,n=s.contextService.getDomElement(),i=n&&t.target&&t.target!==n&&n.contains&&!n.contains(t.target)?"outside":"",r=ks(s.normalizeToPointerEvent(t,u));try{for(r.s();!(e=r.n()).done;){var o=e.value,a=s.bootstrapEvent(s.rootPointerEvent,o,u);a.type+=i,s.eventService.mapEvent(a)}}catch(t){r.e(t)}finally{r.f()}s.setCursor(s.eventService.cursor)}}),t.hooks.pointerMove.tap(Od.tag,this.onPointerMove),t.hooks.pointerOver.tap(Od.tag,this.onPointerMove),t.hooks.pointerOut.tap(Od.tag,this.onPointerMove)}},{key:"bootstrapEvent",value:function(t,e,n){t.pointerType=e.pointerType;t.view=n,t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var n=this.eventService.client2Viewport(new Ss(e.clientX,e.clientY)),i=n.x,n=n.y,i=(t.viewport.x=i,t.viewport.y=n,this.eventService.viewport2Canvas(t.viewport)),n=i.x,i=i.y;return t.canvas.x=n,t.canvas.y=i,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Su[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent,n=(this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,this.eventService.client2Viewport(new Ss(t.clientX,t.clientY))),i=n.x,n=n.y,i=(e.viewport.x=i,e.viewport.y=n,this.eventService.viewport2Canvas(e.viewport)),n=i.x,i=i.y;return e.canvas.x=n,e.canvas.y=i,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.contextService.applyCursorStyle(t||this.canvasConfig.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var i=0;i<t.changedTouches.length;i++){var r=t.changedTouches[i];Ps(r.button)&&(r.button=t.touches.length?1:0),Ps(r.buttons)&&(r.buttons=t.touches.length?1:0),Ps(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),Ps(r.width)&&(r.width=r.radiusX||1),Ps(r.height)&&(r.height=r.radiusY||1),Ps(r.tiltX)&&(r.tiltX=0),Ps(r.tiltY)&&(r.tiltY=0),Ps(r.pointerType)&&(r.pointerType="touch"),Ps(r.pointerId)&&(r.pointerId=r.identifier||0),Ps(r.pressure)&&(r.pressure=r.force||.5),Ps(r.twist)&&(r.twist=0),Ps(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,r.type=t.type,n.push(r)}else e.isMouseEvent(t)?(Ps((e=t).isPrimary)&&(e.isPrimary=!0),Ps(e.width)&&(e.width=1),Ps(e.height)&&(e.height=1),Ps(e.tiltX)&&(e.tiltX=0),Ps(e.tiltY)&&(e.tiltY=0),Ps(e.pointerType)&&(e.pointerType="mouse"),Ps(e.pointerId)&&(e.pointerId=1),Ps(e.pressure)&&(e.pressure=.5),Ps(e.twist)&&(e.twist=0),Ps(e.tangentialPressure)&&(e.tangentialPressure=0),e.isNormalized=!0,n.push(e)):n.push(t);return n}}]),t}()).tag="Event",Od=ne),Wd=(e([v(xs),n("design:type",Object)],Gd.prototype,"canvasConfig",void 0),e([v(sd),n("design:type",Object)],Gd.prototype,"contextService",void 0),e([v(cd),n("design:type",cd)],Gd.prototype,"renderingService",void 0),e([v(ud),n("design:type",Object)],Gd.prototype,"renderingContext",void 0),e([v(hd),n("design:type",hd)],Gd.prototype,"eventService",void 0),Gd=Od=e([y({contrib:ld})],Gd),Mr(function(t){Cr.register(t,ld,{cache:!1}),Cr.register(t,Bd,{cache:!1}),t(cd),t(hd),t(Gd),t(zd),t(jd),t(Fd),t(Hd)})),Ud=((p=Cd=Cd||{}).READY="ready",p.BEFORE_RENDER="beforerender",p.AFTER_RENDER="afterrender",p.BEFORE_DESTROY="beforedestroy",p.AFTER_DESTROY="afterdestroy",p.RESIZE="resize",function(){T(k,$c);var b=M(k);function k(t){x(this,k),(e=b.call(this)).container=Dr.createChild(),e.document=void 0,e.customElements=void 0,e.requestAnimationFrame=void 0,e.cancelAnimationFrame=void 0,e.devicePixelRatio=void 0,e.supportsPointerEvents=void 0,e.supportsTouchEvents=void 0,e.isTouchEvent=void 0,e.isMouseEvent=void 0,e.Element=ph,e.frameId=void 0,e.eventService=void 0,e.renderingService=void 0,e.inited=!1,e.readyPromise=void 0,e.resolveReadyPromise=void 0,e.document=new Bh,e.document.defaultView=fs(e),e.customElements=new Xh;var e,n=t.container,i=t.canvas,r=t.offscreenCanvas,o=t.width,a=t.height,s=t.devicePixelRatio,u=t.renderer,l=t.background,c=t.requestAnimationFrame,h=t.cancelAnimationFrame,d=t.createImage,p=t.supportsPointerEvents,f=t.supportsTouchEvents,y=t.isTouchEvent,t=t.isMouseEvent,v=(v=n,g=fs(e),v&&(v="string"==typeof v?v:v.id||Is++,Ls[v]&&Ls[v].destroy(),Ls[v]=g),o),g=a,m=s;return i&&(m=1<=(m=s||Rs&&window.devicePixelRatio||1)?Math.ceil(m):1,v=o||i.width/m,g=a||i.height/m),e.devicePixelRatio=m,e.requestAnimationFrame=null!=c?c:ts.bind(globalThis),e.cancelAnimationFrame=null!=h?h:es.bind(globalThis),e.supportsTouchEvents=null!=f?f:"ontouchstart"in globalThis,e.supportsPointerEvents=null!=p?p:!!globalThis.PointerEvent,e.isTouchEvent=null!=y?y:function(t){return e.supportsTouchEvents&&t instanceof globalThis.TouchEvent},e.isMouseEvent=null!=t?t:function(t){return!globalThis.MouseEvent||t instanceof globalThis.MouseEvent&&(!e.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))},e.initRenderingContext({container:n,canvas:i,width:v,height:g,renderer:u,offscreenCanvas:r,devicePixelRatio:m,cursor:"default",background:l,createImage:d}),e.initDefaultCamera(v,g),e.initRenderer(u),e}return w(k,[{key:"initRenderingContext",value:function(t){var e=this;this.container.register({token:xs,useValue:t}),this.container.register({token:ud,useValue:{root:this.document.documentElement,renderReasons:new Set,force:!1,dirty:!1}}),this.document.documentElement.addEventListener(C.CHILD_INSERTED,function(t){e.mountChildren(t.detail.child)}),this.document.documentElement.addEventListener(C.CHILD_REMOVED,function(t){e.unmountChildren(t.detail.child)})}},{key:"initDefaultCamera",value:function(t,e){var t=(new Dd).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(t/-2,t/2,e/2,e/-2,.1,1e3),n=(t.canvas=this).container.get(ud);t.on(Nd,function(){n.renderReasons.add(ed.CAMERA_CHANGED)}),this.container.register({token:Td,useValue:t})}},{key:"getConfig",value:function(){return this.container.get(xs)}},{key:"getContainer",value:function(){return this.container}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.container.get(Td)}},{key:"getContextService",value:function(){return this.container.get(sd)}},{key:"getEventService",value:function(){return this.eventService}},{key:"getRenderingService",value:function(){return this.renderingService}},{key:"getRenderingContext",value:function(){return this.container.get(ud)}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var e=this;return this.readyPromise||(this.readyPromise=new Promise(function(t){e.resolveReadyPromise=function(){t(e)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=(this.emit(Cd.BEFORE_DESTROY,function(){}),this.frameId&&(this.getConfig().cancelAnimationFrame||cancelAnimationFrame)(this.frameId),this.getRoot());this.unmountChildren(e),t&&this.document.destroy(),this.getContextService().destroy(),this.getRenderingService().destroy(),this.emit(Cd.AFTER_DESTROY,{})}},{key:"changeSize",value:function(t,e){this.resize(t,e)}},{key:"resize",value:function(t,e){var n=this.container.get(xs),n=(n.width=t,n.height=e,this.getContextService().resize(t,e),this.container.get(Td)),i=n.getProjectionMode();n.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),i===rd.ORTHOGRAPHIC?n.setOrthographic(t/-2,t/2,e/2,e/-2,n.getNear(),n.getFar()):n.setAspect(t/e),this.emit(Cd.RESIZE,{width:t,height:e})}},{key:"appendChild",value:function(t,e){return this.document.documentElement.appendChild(t,e)}},{key:"insertBefore",value:function(t,e){return this.document.documentElement.insertBefore(t,e)}},{key:"removeChild",value:function(t){return this.document.documentElement.removeChild(t,!(1<arguments.length&&void 0!==arguments[1])||arguments[1])}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])}},{key:"render",value:function(){this.emit(Cd.BEFORE_RENDER,{}),this.container.isBound(cd)&&this.container.get(cd).render(this.getConfig()),this.emit(Cd.AFTER_RENDER,{})}},{key:"run",value:function(){var e=this;(function t(){e.render(),e.frameId=requestAnimationFrame(t)})()}},{key:"initRenderer",value:function(t){var e=this;if(!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.loadCommonContainerModule(),this.loadRendererContainerModule(t);var n=this.container.get(sd);this.renderingService=this.container.get(cd),this.eventService=this.container.get(hd),n.init(),this.renderingService.init().then(function(){e.emit(Cd.READY,{}),e.readyPromise&&e.resolveReadyPromise(),e.inited=!0}),t.getConfig().enableAutoRendering&&this.run(),this.getRoot().forEach(function(t){t=t.renderable;t&&(t.renderBoundsDirty=!0,t.boundsDirty=!0,t.dirty=!0)}),this.mountChildren(this.getRoot())}},{key:"loadCommonContainerModule",value:function(){this.container.unload(Wd),this.container.load(Wd,!0)}},{key:"loadRendererContainerModule",value:function(t){var e=this;t.getPlugins().forEach(function(t){t.init(e.container)})}},{key:"setRenderer",value:function(t){var e,n=this,i=this.getConfig();i.renderer!==t&&(e=i.renderer,i.renderer=t,this.destroy(!1),gs(null==e?void 0:e.getPlugins()).reverse().forEach(function(t){t.destroy(n.container)}),this.initRenderer(t))}},{key:"setCursor",value:function(t){this.getContextService().applyCursorStyle(t)}},{key:"unmountChildren",value:function(t){var e=this,n=[];t.forEach(function(t){t.isConnected&&n.push(t)}),n.reverse().forEach(function(t){t instanceof yh&&t.disconnectedCallback&&t.disconnectedCallback(),t.emit(C.UNMOUNTED,{}),t!==e.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1})}},{key:"mountChildren",value:function(t){var e=this;t.forEach(function(t){t.isConnected||(t.ownerDocument=e.document,t.isConnected=!0,t.dispatchEvent(new Ts(C.MOUNTED)),t instanceof yh&&t.connectedCallback&&t.connectedCallback())})}},{key:"client2Viewport",value:function(t){return this.getEventService().client2Viewport(t)}},{key:"viewport2Client",value:function(t){return this.getEventService().viewport2Client(t)}},{key:"viewport2Canvas",value:function(t){return this.getEventService().viewport2Canvas(t)}},{key:"canvas2Viewport",value:function(t){return this.getEventService().canvas2Viewport(t)}},{key:"getPointByClient",value:function(t,e){return this.client2Viewport({x:t,y:e})}},{key:"getClientByPoint",value:function(t,e){return this.viewport2Client({x:t,y:e})}}]),k}()),Yd=(Dr.load(Gt),Dr.get(Kl));function qd(){qd=function(){return a};var a={},t=Object.prototype,u=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",r=e.toStringTag||"@@toStringTag";function o(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(t){o=function(t,e,n){return t[e]=n}}function s(t,e,n,i){var r,o,a,s,e=e&&e.prototype instanceof h?e:h,e=Object.create(e.prototype),i=new k(i||[]);return e._invoke=(r=t,o=n,a=i,s="suspendedStart",function(t,e){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===t)throw e;return w()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){n=function t(e,n){var i=e.iterator[n.method];if(void 0===i){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=void 0,t(e,n),"throw"===n.method))return c;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}i=l(i,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,c;i=i.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,c):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,c)}(n,a);if(n){if(n===c)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";n=l(r,o,a);if("normal"===n.type){if(s=a.done?"completed":"suspendedYield",n.arg===c)continue;return{value:n.arg,done:a.done}}"throw"===n.type&&(s="completed",a.method="throw",a.arg=n.arg)}}),e}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}a.wrap=s;var c={};function h(){}function d(){}function p(){}var e={},f=(o(e,i,function(){return this}),Object.getPrototypeOf),f=f&&f(f(x([]))),y=(f&&f!==t&&u.call(f,i)&&(e=f),p.prototype=h.prototype=Object.create(e));function v(t){["next","throw","return"].forEach(function(e){o(t,e,function(t){return this._invoke(e,t)})})}function g(a,s){var e;this._invoke=function(n,i){function t(){return new s(function(t,e){!function e(t,n,i,r){var o,t=l(a[t],a,n);if("throw"!==t.type)return(n=(o=t.arg).value)&&"object"==typeof n&&u.call(n,"__await")?s.resolve(n.__await).then(function(t){e("next",t,i,r)},function(t){e("throw",t,i,r)}):s.resolve(n).then(function(t){o.value=t,i(o)},function(t){return e("throw",t,i,r)});r(t.arg)}(n,i,t,e)})}return e=e?e.then(t,t):t()}}function m(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(m,this),this.reset(!0)}function x(e){if(e){var n,t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:w}}function w(){return{value:void 0,done:!0}}return o(y,"constructor",d.prototype=p),o(p,"constructor",d),d.displayName=o(p,r,"GeneratorFunction"),a.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,o(t,r,"GeneratorFunction")),t.prototype=Object.create(y),t},a.awrap=function(t){return{__await:t}},v(g.prototype),o(g.prototype,n,function(){return this}),a.AsyncIterator=g,a.async=function(t,e,n,i,r){void 0===r&&(r=Promise);var o=new g(s(t,e,n,i),r);return a.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},v(y),o(y,r,"Generator"),o(y,i,function(){return this}),o(y,"toString",function(){return"[object Generator]"}),a.keys=function(n){var t,i=[];for(t in n)i.push(t);return i.reverse(),function t(){for(;i.length;){var e=i.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=x,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function t(t,e){return o.type="throw",o.arg=n,i.next=t,e&&(i.method="next",i.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e],o=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var a=u.call(r,"catchLoc"),s=u.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&u.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}var o=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc?null:r)?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,c):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,i,r=this.tryEntries[e];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(i=n.arg,b(r)),i}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},a}function Xd(t,e,n,i,r,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,r)}function Kd(s){return function(){var t=this,a=arguments;return new Promise(function(e,n){var i=s.apply(t,a);function r(t){Xd(i,e,n,r,o,"next",t)}function o(t){Xd(i,e,n,r,o,"throw",t)}r(void 0)})}}function Zd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Jd(t,e,n){e&&$d(t.prototype,e),n&&$d(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(ie=function(){function t(){Zd(this,t),this.contextService=void 0,this.renderingContext=void 0}return Jd(t,[{key:"apply",value:function(e){function r(t){e.hooks.pointerCancel.call(t)}function o(t){e.hooks.pointerWheel.call(t)}var a=this,s=this.renderingContext.root.ownerDocument.defaultView,u=function(t){e.hooks.pointerMove.call(t)},l=function(t){e.hooks.pointerUp.call(t)},c=function(t){e.hooks.pointerDown.call(t)},h=function(t){e.hooks.pointerOver.call(t)},d=function(t){e.hooks.pointerOut.call(t)};e.hooks.init.tapPromise(Ad.tag,Kd(qd().mark(function t(){var i;return qd().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=a.contextService.getDomElement(),globalThis.navigator.msPointerEnabled?(i.style.msContentZooming="none",i.style.msTouchAction="none"):s.supportsPointerEvents&&(i.style.touchAction="none"),s.supportsPointerEvents?(n=i,globalThis.document.addEventListener("pointermove",u,!0),n.addEventListener("pointerdown",c,!0),n.addEventListener("pointerleave",d,!0),n.addEventListener("pointerover",h,!0),globalThis.addEventListener("pointerup",l,!0)):(n=i,globalThis.document.addEventListener("mousemove",u,!0),n.addEventListener("mousedown",c,!0),n.addEventListener("mouseout",d,!0),n.addEventListener("mouseover",h,!0),globalThis.addEventListener("mouseup",l,!0)),s.supportsTouchEvents&&((e=i).addEventListener("touchstart",c,!0),e.addEventListener("touchend",l,!0),e.addEventListener("touchmove",u,!0),e.addEventListener("touchcancel",r,!0)),i.addEventListener("wheel",o,{passive:!0,capture:!0});case 5:case"end":return t.stop()}var e,n},t)}))),e.hooks.destroy.tap(Ad.tag,function(){var t,e,n=a.contextService.getDomElement();s.supportsPointerEvents?(t=n,globalThis.document.removeEventListener("pointermove",u,!0),t.removeEventListener("pointerdown",c,!0),t.removeEventListener("pointerleave",d,!0),t.removeEventListener("pointerover",h,!0),globalThis.removeEventListener("pointerup",l,!0)):(t=n,globalThis.document.removeEventListener("mousemove",u,!0),t.removeEventListener("mousedown",c,!0),t.removeEventListener("mouseout",d,!0),t.removeEventListener("mouseover",h,!0),globalThis.removeEventListener("mouseup",l,!0)),s.supportsTouchEvents&&((e=n).removeEventListener("touchstart",c,!0),e.removeEventListener("touchend",l,!0),e.removeEventListener("touchmove",u,!0)),n.removeEventListener("wheel",o,!0)})}}]),t}()).tag="DOMInteraction";var Qd=Ad=ie,tp=(e([v(sd),n("design:type",Object)],Qd.prototype,"contextService",void 0),e([v(ud),n("design:type",Object)],Qd.prototype,"renderingContext",void 0),Qd=Ad=e([y({contrib:ld})],Qd),Mr(function(t){t(Qd)})),ep=function(){function t(){Zd(this,t),this.name="dom-interaction"}return Jd(t,[{key:"init",value:function(t){t.load(tp,!0)}},{key:"destroy",value:function(t){t.unload(tp)}}]),t}();function np(t,e,n,i,r){!function t(e,n,i,r,o){for(;i<r;){600<r-i&&(a=r-i+1,c=n-i+1,u=Math.log(a),s=.5*Math.exp(2*u/3),u=.5*Math.sqrt(u*s*(a-s)/a)*(c-a/2<0?-1:1),l=Math.max(i,Math.floor(n-c*s/a+u)),c=Math.min(r,Math.floor(n+(a-c)*s/a+u)),t(e,n,l,c,o));var a,s,u,l,c,h=e[n],d=i,p=r;for(ip(e,i,n),0<o(e[r],h)&&ip(e,i,r);d<p;){for(ip(e,d,p),d++,p--;o(e[d],h)<0;)d++;for(;0<o(e[p],h);)p--}0===o(e[i],h)?ip(e,i,p):ip(e,++p,r),p<=n&&(i=p+1),n<=p&&(r=p-1)}}(t,e,n||0,i||t.length-1,r||rp)}function ip(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function rp(t,e){return t<e?-1:e<t?1:0}class op{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const i=[];if(!fp(e,n))return i;const r=this.toBBox,o=[];for(;n;){for(let t=0;t<n.children.length;t++){var a=n.children[t],s=n.leaf?r(a):a;fp(e,s)&&(n.leaf?i.push(a):pp(e,s)?this._all(a,i):o.push(a))}n=o.pop()}return i}collides(e){let n=this.data;if(!fp(e,n))return!1;const i=[];for(;n;){for(let t=0;t<n.children.length;t++){var r=n.children[t],o=n.leaf?this.toBBox(r):r;if(fp(e,o)){if(n.leaf||pp(e,o))return!0;i.push(r)}}n=i.pop()}return!1}load(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(let t=0;t<e.length;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);var n;return this.data.children.length?this.data.height===t.height?this._splitRoot(this.data,t):(this.data.height<t.height&&(n=this.data,this.data=t,t=n),this._insert(t,this.data.height-t.height-1,!0)):this.data=t,this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=yp([]),this}remove(t,e){if(!t)return this;let n=this.data;var i=this.toBBox(t);const r=[],o=[];let a,s,u;for(;n||r.length;){if(n||(n=r.pop(),s=r[r.length-1],a=o.pop(),u=!0),n.leaf){var l=function(e,n,i){if(!i)return n.indexOf(e);for(let t=0;t<n.length;t++)if(i(e,n[t]))return t;return-1}(t,n.children,e);if(-1!==l)return n.children.splice(l,1),r.push(n),this._condense(r),this}u||n.leaf||!pp(n,i)?s?(a++,n=s.children[a],u=!1):n=null:(r.push(n),o.push(a),a=0,n=(s=n).children[0])}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const n=[];for(;t;)(t.leaf?e:n).push(...t.children),t=n.pop();return e}_build(n,t,i,r){var e=i-t+1;let o=this._maxEntries,a;if(e<=o)return ap(a=yp(n.slice(t,i+1)),this.toBBox),a;r||(r=Math.ceil(Math.log(e)/Math.log(o)),o=Math.ceil(e/Math.pow(o,r-1))),(a=yp([])).leaf=!1,a.height=r;var s=Math.ceil(e/o),u=s*Math.ceil(Math.sqrt(o));vp(n,t,i,u,this.compareMinX);for(let e=t;e<=i;e+=u){var l=Math.min(e+u-1,i);vp(n,e,l,s,this.compareMinY);for(let t=e;t<=l;t+=s){var c=Math.min(t+s-1,l);a.children.push(this._build(n,t,c,r-1))}}return ap(a,this.toBBox),a}_chooseSubtree(r,o,t,a){for(;;){if(a.push(o),o.leaf||a.length-1===t)break;let e=1/0,n=1/0,i;for(let t=0;t<o.children.length;t++){var s=o.children[t],u=hp(s),l=(c=r,l=s,(Math.max(l.maxX,c.maxX)-Math.min(l.minX,c.minX))*(Math.max(l.maxY,c.maxY)-Math.min(l.minY,c.minY))-u);l<n?(n=l,e=u<e?u:e,i=s):l===n&&u<e&&(e=u,i=s)}o=i||o.children[0]}var c,l;return o}_insert(t,e,n){var n=n?t:this.toBBox(t),i=[];const r=this._chooseSubtree(n,this.data,e,i);for(r.children.push(t),up(r,n);0<=e&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(n,i,e)}_split(t,e){const n=t[e];var i=n.children.length,r=this._minEntries,r=(this._chooseSplitAxis(n,r,i),this._chooseSplitIndex(n,r,i));const o=yp(n.children.splice(r,n.children.length-r));o.height=n.height,o.leaf=n.leaf,ap(n,this.toBBox),ap(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(n,o)}_splitRoot(t,e){this.data=yp([t,e]),this.data.height=t.height+1,this.data.leaf=!1,ap(this.data,this.toBBox)}_chooseSplitIndex(e,n,i){let r,o=1/0,a=1/0;for(let t=n;t<=i-n;t++){var s=sp(e,0,t,this.toBBox),u=sp(e,t,i,this.toBBox),l=(h=s,l=u,c=p=d=void 0,d=Math.max(h.minX,l.minX),p=Math.max(h.minY,l.minY),c=Math.min(h.maxX,l.maxX),h=Math.min(h.maxY,l.maxY),Math.max(0,c-d)*Math.max(0,h-p)),c=hp(s)+hp(u);l<o?(o=l,r=t,a=c<a?c:a):l===o&&c<a&&(a=c,r=t)}var h,l,d,p,c;return r||i-n}_chooseSplitAxis(t,e,n){var i=t.leaf?this.compareMinX:lp,r=t.leaf?this.compareMinY:cp;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)}_allDistMargin(e,n,i,t){e.children.sort(t);const r=this.toBBox;var o=sp(e,0,n,r),a=sp(e,i-n,i,r);let s=dp(o)+dp(a);for(let t=n;t<i-n;t++){var u=e.children[t];up(o,e.leaf?r(u):u),s+=dp(o)}for(let t=i-n-1;t>=n;t--){var l=e.children[t];up(a,e.leaf?r(l):l),s+=dp(a)}return s}_adjustParentBBoxes(e,n,i){for(let t=i;0<=t;t--)up(n[t],e)}_condense(n){for(let t=n.length-1,e;0<=t;t--)0===n[t].children.length?0<t?(e=n[t-1].children).splice(e.indexOf(n[t]),1):this.clear():ap(n[t],this.toBBox)}}function ap(t,e){sp(t,0,t.children.length,e,t)}function sp(e,n,i,r,o){(o=o||yp(null)).minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let t=n;t<i;t++){var a=e.children[t];up(o,e.leaf?r(a):a)}return o}function up(t,e){t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY)}function lp(t,e){return t.minX-e.minX}function cp(t,e){return t.minY-e.minY}function hp(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function dp(t){return t.maxX-t.minX+(t.maxY-t.minY)}function pp(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function fp(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function yp(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function vp(t,e,n,i,r){const o=[e,n];for(;o.length;){var a;(n=o.pop())-(e=o.pop())<=i||(np(t,a=e+Math.ceil((n-e)/i/2)*i,e,n,r),o.push(e,a,a,n))}}function gp(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function mp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gp(Object(n),!0).forEach(function(t){Tp(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gp(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function bp(){bp=function(){return a};var a={},t=Object.prototype,u=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",r=e.toStringTag||"@@toStringTag";function o(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(t){o=function(t,e,n){return t[e]=n}}function s(t,e,n,i){var r,o,a,s,e=e&&e.prototype instanceof h?e:h,e=Object.create(e.prototype),i=new k(i||[]);return e._invoke=(r=t,o=n,a=i,s="suspendedStart",function(t,e){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===t)throw e;return w()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){n=function t(e,n){var i=e.iterator[n.method];if(void 0===i){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=void 0,t(e,n),"throw"===n.method))return c;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}i=l(i,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,c;i=i.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,c):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,c)}(n,a);if(n){if(n===c)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";n=l(r,o,a);if("normal"===n.type){if(s=a.done?"completed":"suspendedYield",n.arg===c)continue;return{value:n.arg,done:a.done}}"throw"===n.type&&(s="completed",a.method="throw",a.arg=n.arg)}}),e}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}a.wrap=s;var c={};function h(){}function d(){}function p(){}var e={},f=(o(e,i,function(){return this}),Object.getPrototypeOf),f=f&&f(f(x([]))),y=(f&&f!==t&&u.call(f,i)&&(e=f),p.prototype=h.prototype=Object.create(e));function v(t){["next","throw","return"].forEach(function(e){o(t,e,function(t){return this._invoke(e,t)})})}function g(a,s){var e;this._invoke=function(n,i){function t(){return new s(function(t,e){!function e(t,n,i,r){var o,t=l(a[t],a,n);if("throw"!==t.type)return(n=(o=t.arg).value)&&"object"==typeof n&&u.call(n,"__await")?s.resolve(n.__await).then(function(t){e("next",t,i,r)},function(t){e("throw",t,i,r)}):s.resolve(n).then(function(t){o.value=t,i(o)},function(t){return e("throw",t,i,r)});r(t.arg)}(n,i,t,e)})}return e=e?e.then(t,t):t()}}function m(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(m,this),this.reset(!0)}function x(e){if(e){var n,t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:w}}function w(){return{value:void 0,done:!0}}return o(y,"constructor",d.prototype=p),o(p,"constructor",d),d.displayName=o(p,r,"GeneratorFunction"),a.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,o(t,r,"GeneratorFunction")),t.prototype=Object.create(y),t},a.awrap=function(t){return{__await:t}},v(g.prototype),o(g.prototype,n,function(){return this}),a.AsyncIterator=g,a.async=function(t,e,n,i,r){void 0===r&&(r=Promise);var o=new g(s(t,e,n,i),r);return a.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},v(y),o(y,r,"Generator"),o(y,i,function(){return this}),o(y,"toString",function(){return"[object Generator]"}),a.keys=function(n){var t,i=[];for(t in n)i.push(t);return i.reverse(),function t(){for(;i.length;){var e=i.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=x,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function t(t,e){return o.type="throw",o.arg=n,i.next=t,e&&(i.method="next",i.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e],o=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var a=u.call(r,"catchLoc"),s=u.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&u.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}var o=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc?null:r)?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,c):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,i,r=this.tryEntries[e];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(i=n.arg,b(r)),i}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},a}function kp(t,e,n,i,r,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,r)}function xp(s){return function(){var t=this,a=arguments;return new Promise(function(e,n){var i=s.apply(t,a);function r(t){kp(i,e,n,r,o,"next",t)}function o(t){kp(i,e,n,r,o,"throw",t)}r(void 0)})}}function wp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ep(t,e,n){return e&&Sp(t.prototype,e),n&&Sp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tp(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}function _p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pp(t,e)}function Mp(t){return(Mp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pp(t,e){return(Pp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Op(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");e=t;if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cp(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=Mp(n);return Op(this,i?(t=Mp(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function Ap(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||Lp(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Np(t){return function(t){if(Array.isArray(t))return Ip(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Lp(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lp(t,e){if(t){if("string"==typeof t)return Ip(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ip(t,e):void 0}}function Ip(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Dp="undefined"!=typeof Float32Array?Float32Array:Array;function Rp(t,e){var n=e[0],i=e[1],r=e[2],o=e[4],a=e[5],s=e[6],u=e[8],l=e[9],e=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,l,e),t}function jp(){var t=new Dp(3);return Dp!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Bp(t,e,n){var i=new Dp(3);return i[0]=t,i[1]=e,i[2]=n,i}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Fp(){var t=new Dp(4);return Dp!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}jp(),me=new Dp(4),Dp!=Float32Array&&(me[0]=0,me[1]=0,me[2]=0,me[3]=0);jp(),Bp(1,0,0),Bp(0,1,0),Fp(),Fp(),a=new Dp(9),Dp!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1;var zp=Ep(function t(){wp(this,t),this.aabb=void 0}),Vp=(zp.tag="c-canvas-rbush-node",function(){function t(){wp(this,t),this.gradientCache={}}return Ep(t,[{key:"getOrCreateGradient",value:function(t,e){var n=this.generateCacheKey(t),i=t.type,r=t.x0,o=t.y0,a=t.x1,s=t.y1,u=t.steps,l=t.width,c=t.height;if(this.gradientCache[n])return this.gradientCache[n];var h=null;return i===Xu.LinearGradient?h=e.createLinearGradient(r*l,o*c,a*l,s*c):i===Xu.RadialGradient&&(i=Math.sqrt(l*l+c*c)/2,h=e.createRadialGradient(r*l,o*c,0,a*l,s*c,t.r1*i)),h&&(u.forEach(function(t){var e,t=Ap(t,2),n=t[0],t=t[1];null!=(e=h)&&e.addColorStop(Number(n),t)}),this.gradientCache[n]=h),this.gradientCache[n]}},{key:"generateCacheKey",value:function(t){var e=t.type,n=t.x0,i=t.y0,r=t.x1,o=t.y1,a=t.r1,s=t.steps,u=t.width,t=t.height;return"gradient-".concat(e,"-").concat(n,"-").concat(i,"-").concat(r,"-").concat(o,"-").concat(a||0,"-").concat(u,"-").concat(t,"-").concat(s.map(function(t){return t.join("")}).join("-"))}}]),t}()),Vp=e([y()],Vp),Hp=function(){function t(){wp(this,t),this.imageCache={},this.patternCache={},this.canvasConfig=void 0}return Ep(t,[{key:"getImageSync",value:function(t){return this.imageCache[t]}},{key:"getOrCreateImage",value:function(i){var r=this;if(this.imageCache[i])return Promise.resolve(this.imageCache[i]);var o=this.canvasConfig.createImage;return new Promise(function(t,e){var n;o?n=o(i):Rs&&(n=new window.Image),n&&(n.onload=function(){t(n)},n.onerror=function(t){e(t)},n.crossOrigin="Anonymous",n.src=i,r.imageCache[i]=n)})}},{key:"getPatternSync",value:function(t){t=this.generatePatternKey(t);if(this.patternCache[t])return this.patternCache[t]}},{key:"createPattern",value:function(n,i){var r=this;return this.getOrCreateImage(n.src).then(function(t){var e=r.generatePatternKey(n),t=i.createPattern(t,n.repetition);return t&&(r.patternCache[e]=t),r.patternCache[e]})}},{key:"generatePatternKey",value:function(t){var e=t.src,t=t.repetition;return"pattern-".concat(e,"-").concat(t)}}]),t}();e([v(xs),n("design:type",Object)],Hp.prototype,"canvasConfig",void 0);var Gp,Wp,Hp=e([y()],Hp),i=f.defineToken("PathGeneratorFactory"),Up=f.defineToken("PathGenerator"),Yp=f.defineToken("StyleRendererFactory"),qp=f.defineToken("CircleRenderer",{multiple:!1}),Xp=f.defineToken("EllipseRenderer",{multiple:!1}),Kp=f.defineToken("RectRenderer",{multiple:!1}),Zp=f.defineToken("LineRenderer",{multiple:!1}),$p=f.defineToken("PolylineRenderer",{multiple:!1}),Jp=f.defineToken("PolygonRenderer",{multiple:!1}),Qp=f.defineToken("PathRenderer",{multiple:!1}),tf=f.defineToken("TextRenderer",{multiple:!1}),ef=f.defineToken("ImageRenderer",{multiple:!1}),nf=function(){function t(){wp(this,t),this.imagePool=void 0}return Ep(t,[{key:"hash",value:function(t){return""}},{key:"render",value:function(t,e){var n=e.width,i=e.height,e=e.img,n=n.value,i=i.value,e=wc(e)?this.imagePool.getImageSync(e):(n=n||e.width,i=i||e.height,e);if(e)try{t.drawImage(e,0,0,n,i)}catch(t){}}}]),t}(),rf=(e([v(Hp),n("design:type",Hp)],nf.prototype,"imagePool",void 0),nf=e([y({token:ef})],nf),function(){function t(){wp(this,t)}return Ep(t,[{key:"hash",value:function(t){return""}},{key:"render",value:function(t,e,n){var i=e.lineWidth,r=e.textAlign,o=e.textBaseline,a=e.lineJoin,s=e.miterLimit,s=void 0===s?0:s,u=e.letterSpacing,l=void 0===u?0:u,c=e.stroke,h=e.fill,d=e.fillOpacity,p=e.strokeOpacity,f=e.opacity,u=e.metrics,y=e.dx,e=e.dy,v=u.font,g=u.lines,m=u.height,b=u.lineHeight,k=u.lineMetrics,x=(t.font=v,t.lineWidth=i.value,t.textAlign=r.value,t.textBaseline=o.value,t.lineJoin=a.value,t.miterLimit=s,0),w=("middle"===o.value?x=-m/2-b/2:"bottom"===o.value||"alphabetic"===o.value||"ideographic"===o.value?x=-m:"top"!==o.value&&"hanging"!==o.value||(x=-b),0);y&&y.unit===N.kPixels&&(w+=y.value),e&&e.unit===N.kPixels&&(x+=e.value);for(var S=0;S<g.length;S++){var E=i.value/2+w;x+=b,!A(c)&&!c.isNone&&i&&i.value&&this.drawLetterSpacing(t,g[S],k[S],r.value,E,x,l,d.value,p.value,f.value,!0),A(h)||this.drawLetterSpacing(t,g[S],k[S],r.value,E,x,l,d.value,p.value,f.value)}}},{key:"drawLetterSpacing",value:function(t,e,n,i,r,o,a,s,u,l){var c=10<arguments.length&&void 0!==arguments[10]&&arguments[10];if(0===a)c?this.strokeText(t,e,r,o,u):this.fillText(t,e,r,o,s,l);else{for(var h=t.textAlign,d=(t.textAlign="left",r),p=("center"===i?d=r-n.width/2:"right"!==i&&"end"!==i||(d=r-n.width),Array.from(e)),f=t.measureText(e).width,y=0;y<p.length;++y){var v=p[y];c?this.strokeText(t,v,d,o,u):this.fillText(t,v,d,o,s,l),d+=f-(v=t.measureText(e.substring(y+1)).width)+a,f=v}t.textAlign=h}}},{key:"fillText",value:function(t,e,n,i,r,o){var a,s=!A(r)&&1!==r;s&&(a=t.globalAlpha,t.globalAlpha=r*o),t.fillText(e,n,i),s&&(t.globalAlpha=a)}},{key:"strokeText",value:function(t,e,n,i,r){var o,a=!A(r)&&1!==r;a&&(o=t.globalAlpha,t.globalAlpha=r),t.strokeText(e,n,i),a&&(t.globalAlpha=o)}}]),t}()),rf=e([y({token:tf})],rf),of=function(){function t(){wp(this,t)}return Ep(t,[{key:"hash",value:function(t){return""}},{key:"render",value:function(t,e){var n,i,r,o=e.fill,a=e.opacity,s=e.fillOpacity,u=e.stroke,l=e.strokeOpacity,c=e.lineWidth,h=e.lineCap,d=e.lineJoin,p=e.shadowColor,f=e.filter,e=e.miterLimit,y=!A(o)&&!o.isNone,u=!A(u)&&!u.isNone,o=0===o.alpha;y&&(A(s)||1===s.value?t.fill():(t.globalAlpha=s.value,t.fill(),t.globalAlpha=a.value)),u&&c&&0<c.value&&(A(l)||1===l.value||(t.globalAlpha=l.value),t.lineWidth=c.value,A(e)||(t.miterLimit=e),A(h)||(t.lineCap=h.value),A(d)||(t.lineJoin=d.value),s=!A(p),a=!A(f),s&&(n=t.shadowBlur,i=t.shadowColor,A(n)||(t.shadowColor="transparent",t.shadowBlur=0)),a&&!A(r=t.filter)&&-1<r.indexOf("drop-shadow")&&(t.filter=r.replace(/drop-shadow\([^)]*\)/,"").trim()||"none"),(u=y&&!o)&&t.stroke(),s&&(t.shadowColor=i,t.shadowBlur=n),a&&(t.filter=r),u||t.stroke())}}]),t}(),of=e([y()],of),af=function(){_p(e,of);var t=Cp(e);function e(){return wp(this,e),t.apply(this,arguments)}return Ep(e)}(),af=e([y({token:Kp})],af),sf=function(){_p(e,of);var t=Cp(e);function e(){return wp(this,e),t.apply(this,arguments)}return Ep(e)}(),sf=e([y({token:qp})],sf),uf=function(){_p(e,of);var t=Cp(e);function e(){return wp(this,e),t.apply(this,arguments)}return Ep(e)}(),uf=e([y({token:Xp})],uf),lf=function(){_p(e,of);var t=Cp(e);function e(){return wp(this,e),t.apply(this,arguments)}return Ep(e)}(),lf=e([y({token:Zp})],lf),cf=function(){_p(e,of);var t=Cp(e);function e(){return wp(this,e),t.apply(this,arguments)}return Ep(e)}(),cf=e([y({token:$p})],cf),hf=function(){_p(e,of);var t=Cp(e);function e(){return wp(this,e),t.apply(this,arguments)}return Ep(e)}(),hf=e([y({token:Jp})],hf),df=function(){_p(e,of);var t=Cp(e);function e(){return wp(this,e),t.apply(this,arguments)}return Ep(e)}(),df=e([y({token:Qp})],df),pf="RBushRoot",ff=((l=function(){function t(){wp(this,t),this.canvasConfig=void 0,this.camera=void 0,this.contextService=void 0,this.renderingContext=void 0,this.imagePool=void 0,this.gradientPool=void 0,this.pathGeneratorFactory=void 0,this.styleRendererFactory=void 0,this.displayObjectPool=void 0,this.rBush=void 0,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreen=!1,this.enableBatch=!1,this.batchedStyleHash="",this.batchedDisplayObject=null,this.toSync=new Set}return Ep(t,[{key:"syncRTree",value:function(){var a=this,s=[];Array.from(this.toSync).filter(function(t){return t.isConnected}).forEach(function(t){var e,n,i,r=t.rBushNode,o=(r&&a.rBush.remove(r.aabb),t.getRenderBounds());o&&(e=(n=Ap(o.getMin(),2))[0],n=n[1],i=(o=Ap(o.getMax(),2))[0],o=o[1],r.aabb={id:t.entity,minX:e,minY:n,maxX:i,maxY:o}),r.aabb&&s.push(r.aabb)}),this.rBush.load(s),this.toSync.clear()}},{key:"pushToSync",value:function(t){var e=this;t.forEach(function(t){e.toSync.add(t)})}},{key:"apply",value:function(u){function r(t){t.target.rBushNode=new zp,l.pushToSync(t.composedPath().slice(0,-2))}function o(t){var e=(t=t.target).rBushNode;e.aabb&&(l.rBush.remove(e.aabb),l.toSync.delete(t),l.removedRBushNodeAABBs.push(e.aabb))}function a(t){var e,n=t.target;(null==(e=n.ownerDocument)?void 0:e.documentElement)===l.renderingContext.root&&(t.detail.affectChildren&&n.forEach(function(t){l.pushToSync([t])}),l.pushToSync(t.composedPath().slice(0,-2)))}var l=this;u.hooks.init.tapPromise(Gp.tag,xp(bp().mark(function t(){var e,n,i;return bp().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:l.renderingContext.root.addEventListener(C.MOUNTED,r),l.renderingContext.root.addEventListener(C.UNMOUNTED,o),l.renderingContext.root.addEventListener(C.BOUNDS_CHANGED,a),n=l.canvasConfig,e=n.width,n=n.height,i=l.contextService.getContext(),l.clearRect(i,0,0,e,n);case 6:case"end":return t.stop()}},t)}))),u.hooks.destroy.tap(Gp.tag,function(){l.renderingContext.root.removeEventListener(C.MOUNTED,r),l.renderingContext.root.removeEventListener(C.UNMOUNTED,o),l.renderingContext.root.removeEventListener(C.BOUNDS_CHANGED,a)}),u.hooks.beginFrame.tap(Gp.tag,function(){var t=l.contextService.getContext(),e=l.canvasConfig,n=e.renderer,i=e.width,e=e.height,n=n.getConfig().enableDirtyRectangleRendering;l.clearFullScreen=!n||l.renderingContext.renderReasons.has(ed.CAMERA_CHANGED),t&&(t.save(),l.clearFullScreen&&l.clearRect(t,0,0,i,e),l.applyTransform(t,l.camera.getOrthoMatrix()))}),u.hooks.endFrame.tap(Gp.tag,function(){l.syncRTree();var t=l.canvasConfig.renderer.getConfig(),e=t.enableDirtyRectangleRendering,t=t.enableDirtyRectangleRenderingDebug,n=l.contextService.getContext(),i=l.renderQueue;if(e){if(!l.clearFullScreen){e=l.safeMergeAABB.apply(l,[l.mergeDirtyAABBs(l.renderQueue)].concat(Np(l.removedRBushNodeAABBs.map(function(t){var e=t.minX,n=t.minY,i=t.maxX,t=t.maxY,r=new Mu;return r.setMinMax(Bp(e,n,0),Bp(i,t,0)),r}))));if(l.removedRBushNodeAABBs=[],Mu.isEmpty(e))return void(l.renderQueue=[]);var r=l.convertAABB2Rect(e),o=r.x,a=r.y,s=r.width,r=r.height;l.clearRect(n,o,a,s,r),n.beginPath(),n.rect(o,a,s,r),n.clip(),t&&(n.lineWidth=4,n.strokeStyle="rgba(".concat(255*Math.random(),", ").concat(255*Math.random(),", ").concat(255*Math.random(),", 1)"),n.strokeRect(o,a,s,r)),i=l.searchDirtyObjects(e)}i.sort(function(t,e){return t.sortable.renderOrder-e.sortable.renderOrder}).forEach(function(t){t&&t.isVisible()&&!t.isCulled()&&l.renderDisplayObject(t,u)}),l.enableBatch&&l.batchedStyleHash&&l.flush(n,u),l.renderQueue.forEach(function(t){l.saveDirtyAABB(t)}),l.renderQueue=[]}l.restoreStack.forEach(function(t){n.restore()}),l.restoreStack=[],l.clearFullScreen=!1,n.restore()}),u.hooks.render.tap(Gp.tag,function(t){l.canvasConfig.renderer.getConfig().enableDirtyRectangleRendering?l.renderQueue.push(t):t.isVisible()&&!t.isCulled()&&l.renderDisplayObject(t,u)})}},{key:"clearRect",value:function(t,e,n,i,r){t.clearRect(e,n,i,r);var o=this.canvasConfig.background;o&&(t.fillStyle=o,t.fillRect(e,n,i,r))}},{key:"flush",value:function(t,e){var n;this.batchedDisplayObject&&((n=this.styleRendererFactory(this.batchedDisplayObject.nodeName))&&(this.applyAttributesToContext(t,this.batchedDisplayObject,e),t.closePath(),n.render(t,this.batchedDisplayObject.parsedStyle,this.batchedDisplayObject),t.restore()),this.batchedStyleHash="",this.batchedDisplayObject=null)}},{key:"renderDisplayObject",value:function(e,t){for(var n=this,i=this.contextService.getContext(),r=this.restoreStack[this.restoreStack.length-1];r&&e.parentNode!==r;)i.restore(),this.restoreStack.pop(),r=this.restoreStack[this.restoreStack.length-1];var o,a=e.nodeName,s=this.styleRendererFactory(a),u=!1,l=(this.enableBatch&&s&&(a=s.hash(e.attributes),this.batchedStyleHash&&a!==this.batchedStyleHash&&this.flush(i,t),this.batchedStyleHash||(this.batchedStyleHash=a,this.batchedDisplayObject=e,u=!0)),i.save(),this.applyTransform(i,e.getLocalTransform()),e.style.clipPath);l&&(i.save(),this.applyTransform(i,l.getLocalTransform()),(o=this.pathGeneratorFactory(l.nodeName))&&this.useAnchor(i,l,function(){i.beginPath(),o(i,l.parsedStyle),i.closePath()}),i.restore(),i.clip()),this.enableBatch||(i.save(),this.applyAttributesToContext(i,e,t)),this.useAnchor(i,e,function(){var t=n.pathGeneratorFactory(e.nodeName);t&&(!u&&n.enableBatch||i.beginPath(),t(i,e.parsedStyle),n.enableBatch||e.nodeName===m.LINE||e.nodeName===m.PATH||e.nodeName===m.POLYLINE||i.closePath()),s&&!n.enableBatch&&s.render(i,e.parsedStyle,e)}),this.enableBatch||i.restore(),e.renderable.dirty=!1,this.restoreStack.push(e)}},{key:"convertAABB2Rect",value:function(t){var e=t.getMin(),t=t.getMax(),n=Math.floor(e[0]),e=Math.floor(e[1]);return{x:n,y:e,width:Math.ceil(t[0])-n,height:Math.ceil(t[1])-e}}},{key:"mergeDirtyAABBs",value:function(t){var n=new Mu;return t.forEach(function(t){var e=t.getRenderBounds(),e=(n.add(e),t.renderable.dirtyRenderBounds);e&&n.add(e)}),n}},{key:"searchDirtyObjects",value:function(t){var e=this,n=Ap(t.getMin(),2),i=n[0],n=n[1],t=Ap(t.getMax(),2),r=t[0],t=t[1];return this.rBush.search({minX:i,minY:n,maxX:r,maxY:t}).map(function(t){t=t.id;return e.displayObjectPool.getByEntity(t)})}},{key:"saveDirtyAABB",value:function(t){var e=t.renderable,t=(e.dirtyRenderBounds||(e.dirtyRenderBounds=new Mu),t.getRenderBounds());t&&e.dirtyRenderBounds.update(t.center,t.halfExtents)}},{key:"applyTransform",value:function(t,e){c=jp(),l=e,c[0]=l[12],c[1]=l[13],c[2]=l[14];var n,i,r,o,a,s,u,l=Ap(c,2),c=l[0],l=l[1],h=Ap(Rp(jp(),e),2),d=h[0],h=h[1],p=(n=Fp(),e=e,Rp(p=new Dp(3),e),i=1/p[0],r=1/p[1],p=1/p[2],f=e[0]*i,v=e[1]*r,o=e[2]*p,a=e[4]*i,y=e[5]*r,s=e[6]*p,i=e[8]*i,r=e[9]*r,e=e[10]*p,(u=0)<(p=f+y+e)?(u=2*Math.sqrt(1+p),n[3]=.25*u,n[0]=(s-r)/u,n[1]=(i-o)/u,n[2]=(v-a)/u):y<f&&e<f?(u=2*Math.sqrt(1+f-y-e),n[3]=(s-r)/u,n[0]=.25*u,n[1]=(v+a)/u,n[2]=(i+o)/u):e<y?(u=2*Math.sqrt(1+y-f-e),n[3]=(i-o)/u,n[0]=(v+a)/u,n[1]=.25*u,n[2]=(s+r)/u):(u=2*Math.sqrt(1+e-f-y),n[3]=(v-a)/u,n[0]=(i+o)/u,n[1]=(s+r)/u,n[2]=.25*u),n),e=Ap(Zs(jp(),p),3),f=e[0],y=(e[1],e[2]),v=$s(f||y,c,l,d,h);t.transform(v[0],v[1],v[3],v[4],v[6],v[7])}},{key:"getColor",value:function(t,e,n,i){var r,o;return t instanceof il?t.type===Xu.LinearGradient||t.type===Xu.RadialGradient?(r=(o=e.getGeometryBounds())&&2*o.halfExtents[0]||0,o=o&&2*o.halfExtents[1]||0,r=this.gradientPool.getOrCreateGradient(mp(mp({type:t.type},t.value),{},{width:r,height:o}),n)):t.type===Xu.Pattern&&((o=this.imagePool.getPatternSync(t.value))?r=o:this.imagePool.createPattern(t.value,n).then(function(){e.renderable.dirty=!0,i.dirtify()})):r=t.toString(),r}},{key:"applyAttributesToContext",value:function(t,e,n){var i=e.parsedStyle,r=i.stroke,o=i.fill,a=i.opacity,s=i.lineDash,u=i.lineDashOffset,l=i.filter,c=i.shadowColor,h=i.shadowBlur,d=i.shadowOffsetX,i=i.shadowOffsetY;s&&Array.isArray(s)&&t.setLineDash(s.map(function(t){return t.value})),A(u)||(t.lineDashOffset=u.value),A(a)||(t.globalAlpha*=a.value),A(r)||r.isNone||(t.strokeStyle=this.getColor(r,e,t,n)),A(o)||o.isNone||(t.fillStyle=this.getColor(o,e,t,n)),A(l)||(t.filter=e.style.filter),A(c)||(t.shadowColor=c.toString(),t.shadowBlur=h&&h.value||0,t.shadowOffsetX=d&&d.value||0,t.shadowOffsetY=i&&i.value||0)}},{key:"useAnchor",value:function(t,e,n){var i=e.getGeometryBounds();i&&(i=i.halfExtents,e=(e.parsedStyle||{}).anchor,t.translate(-(e&&e[0].value||0)*i[0]*2,-(e&&e[1].value||0)*i[1]*2)),n()}},{key:"safeMergeAABB",value:function(){for(var e=new Mu,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach(function(t){e.add(t)}),e}}]),t}()).tag="CanvasRenderer",Gp=l),yf=(e([v(xs),n("design:type",Object)],ff.prototype,"canvasConfig",void 0),e([v(Td),n("design:type",Dd)],ff.prototype,"camera",void 0),e([v(sd),n("design:type",Object)],ff.prototype,"contextService",void 0),e([v(ud),n("design:type",Object)],ff.prototype,"renderingContext",void 0),e([v(Hp),n("design:type",Hp)],ff.prototype,"imagePool",void 0),e([v(Vp),n("design:type",Vp)],ff.prototype,"gradientPool",void 0),e([v(i),n("design:type",Function)],ff.prototype,"pathGeneratorFactory",void 0),e([v(Yp),n("design:type",Function)],ff.prototype,"styleRendererFactory",void 0),e([v(ws),n("design:type",ws)],ff.prototype,"displayObjectPool",void 0),e([v(pf),n("design:type",op)],ff.prototype,"rBush",void 0),ff=Gp=e([y({contrib:ld})],ff),(ce=function(){function t(){wp(this,t),this.imagePool=void 0,this.renderingContext=void 0}return Ep(t,[{key:"apply",value:function(i){function e(t){var e=t.target,t=e.nodeName,n=e.attributes;t===m.IMAGE&&wc(t=n.img)&&r.imagePool.getOrCreateImage(t).then(function(){e.renderable.dirty=!0,i.dirtify()})}function n(t){var e=t.target,n=t.attrName,t=t.newValue;e.nodeName===m.IMAGE&&"img"===n&&wc(t)&&r.imagePool.getOrCreateImage(t).then(function(){e.renderable.dirty=!0,i.dirtify()})}var r=this;i.hooks.init.tapPromise(Wp.tag,xp(bp().mark(function t(){return bp().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r.renderingContext.root.addEventListener(C.MOUNTED,e),r.renderingContext.root.addEventListener(C.ATTR_MODIFIED,n);case 2:case"end":return t.stop()}},t)}))),i.hooks.destroy.tap(Wp.tag,function(){r.renderingContext.root.removeEventListener(C.MOUNTED,e),r.renderingContext.root.removeEventListener(C.ATTR_MODIFIED,n)})}}]),t}()).tag="LoadImage",Wp=ce),vf=(e([v(Hp),n("design:type",Hp)],yf.prototype,"imagePool",void 0),e([v(ud),n("design:type",Object)],yf.prototype,"renderingContext",void 0),yf=Wp=e([y({contrib:ld})],yf),Dr.register({token:{token:Up,named:m.CIRCLE},useValue:function(t,e){e=e.r,t.arc(e.value,e.value,e.value,0,2*Math.PI,!1)}}),Dr.register({token:{token:Up,named:m.ELLIPSE},useValue:function(t,e){var n,i,r=e.rx,e=e.ry,r=r.value,e=e.value;t.ellipse?t.ellipse(r,e,r,e,0,0,2*Math.PI,!1):(n=e<r?r:e,i=e<r?1:r/e,e=e<r?e/r:1,t.save(),t.scale(i,e),t.arc(0,0,n,0,2*Math.PI))}}),Dr.register({token:{token:Up,named:m.RECT},useValue:function(t,e){var n,i,r,o=e.radius,a=e.width,e=e.height,a=a.value,e=e.value;o&&o.some(function(t){return 0!==t.value})?(n=(o=Ap(o.map(function(t){return t.value}),4))[0],i=o[1],r=o[2],o=o[3],t.moveTo(n,0),t.lineTo(a-i,0),0!==i&&t.arc(a-i,i,i,-Math.PI/2,0),t.lineTo(a,e-r),0!==r&&t.arc(a-r,e-r,r,0,Math.PI/2),t.lineTo(o,e),0!==o&&t.arc(o,e-o,o,Math.PI/2,Math.PI),t.lineTo(0,n),0!==n&&t.arc(n,n,n,Math.PI,1.5*Math.PI)):t.rect(0,0,a,e)}}),Dr.register({token:{token:Up,named:m.LINE},useValue:function(t,e){var n=e.x1,i=e.y1,r=e.x2,o=e.y2,a=void 0===(a=e.defX)?0:a,e=void 0===(e=e.defY)?0:e;t.moveTo(n.value-a,i.value-e),t.lineTo(r.value-a,o.value-e)}}),Dr.register({token:{token:Up,named:m.POLYLINE},useValue:function(t,e){var n=void 0===(a=e.defX)?0:a,i=void 0===(a=e.defY)?0:a,r=e.points.points,o=r.length,a=r[0][0]-n,e=r[0][1]-i,s=r[o-1][0]-n,u=r[o-1][1]-i;t.moveTo(a,e);for(var l=0;l<o-1;l++){var c=r[l];t.lineTo(c[0]-n,c[1]-i)}t.lineTo(s,u)}}),Dr.register({token:{token:Up,named:m.POLYGON},useValue:function(t,e){var n=void 0===(a=e.defX)?0:a,i=void 0===(a=e.defY)?0:a,r=e.points.points,o=r.length,a=r[0][0]-n,e=r[0][1]-i,s=r[o-1][0]-n,u=r[o-1][1]-i;t.moveTo(a,e);for(var l=0;l<o-1;l++){var c=r[l];t.lineTo(c[0]-n,c[1]-i)}t.lineTo(s,u)}}),Dr.register({token:{token:Up,named:m.PATH},useValue:function(t,e){var n=void 0===(r=e.defX)?0:r,i=void 0===(r=e.defY)?0:r,e=(r=e.path).curve,r=r.zCommandIndexes,o=Np(e);r.forEach(function(t,e){o.splice(t+e,1,["Z"])});for(var a=0;a<o.length;a++){var s=o[a];switch(s[0]){case"M":t.moveTo(s[1]-n,s[2]-i);break;case"C":t.bezierCurveTo(s[1]-n,s[2]-i,s[3]-n,s[4]-i,s[5]-n,s[6]-i);break;case"Z":t.closePath()}}}}),Dr.register({token:i,useFactory:function(e){var n={};return function(t){return n[t]||e.container.isBoundNamed(Up,t)&&(n[t]=e.container.getNamed(Up,t)),n[t]}}}),Mr(function(t){t(Hp),t({token:pf,useValue:new op}),t(sf),t(uf),t(af),t(nf),t(rf),t(lf),t(cf),t(hf),t(df),Tp(e={},m.CIRCLE,qp),Tp(e,m.ELLIPSE,Xp),Tp(e,m.RECT,Kp),Tp(e,m.IMAGE,ef),Tp(e,m.TEXT,tf),Tp(e,m.LINE,Zp),Tp(e,m.POLYLINE,$p),Tp(e,m.POLYGON,Jp),Tp(e,m.PATH,Qp);var e,r=e;t({token:Yp,useFactory:function(n){var i={};return function(t){var e=r[t];return e&&!i[t]&&n.container.isBound(e)&&(i[t]=n.container.get(e)),i[t]}}}),t(Vp),t(ff),t(yf)})),gf=function(){function t(){wp(this,t),this.name="canvas-renderer"}return Ep(t,[{key:"init",value:function(t){t.load(vf,!0)}},{key:"destroy",value:function(t){t.unload(vf)}}]),t}();function mf(){mf=function(){return a};var a={},t=Object.prototype,u=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",r=e.toStringTag||"@@toStringTag";function o(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(t){o=function(t,e,n){return t[e]=n}}function s(t,e,n,i){var r,o,a,s,e=e&&e.prototype instanceof h?e:h,e=Object.create(e.prototype),i=new k(i||[]);return e._invoke=(r=t,o=n,a=i,s="suspendedStart",function(t,e){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===t)throw e;return w()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){n=function t(e,n){var i=e.iterator[n.method];if(void 0===i){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=void 0,t(e,n),"throw"===n.method))return c;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}i=l(i,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,c;i=i.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,c):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,c)}(n,a);if(n){if(n===c)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";n=l(r,o,a);if("normal"===n.type){if(s=a.done?"completed":"suspendedYield",n.arg===c)continue;return{value:n.arg,done:a.done}}"throw"===n.type&&(s="completed",a.method="throw",a.arg=n.arg)}}),e}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}a.wrap=s;var c={};function h(){}function d(){}function p(){}var e={},f=(o(e,i,function(){return this}),Object.getPrototypeOf),f=f&&f(f(x([]))),y=(f&&f!==t&&u.call(f,i)&&(e=f),p.prototype=h.prototype=Object.create(e));function v(t){["next","throw","return"].forEach(function(e){o(t,e,function(t){return this._invoke(e,t)})})}function g(a,s){var e;this._invoke=function(n,i){function t(){return new s(function(t,e){!function e(t,n,i,r){var o,t=l(a[t],a,n);if("throw"!==t.type)return(n=(o=t.arg).value)&&"object"==typeof n&&u.call(n,"__await")?s.resolve(n.__await).then(function(t){e("next",t,i,r)},function(t){e("throw",t,i,r)}):s.resolve(n).then(function(t){o.value=t,i(o)},function(t){return e("throw",t,i,r)});r(t.arg)}(n,i,t,e)})}return e=e?e.then(t,t):t()}}function m(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(m,this),this.reset(!0)}function x(e){if(e){var n,t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:w}}function w(){return{value:void 0,done:!0}}return o(y,"constructor",d.prototype=p),o(p,"constructor",d),d.displayName=o(p,r,"GeneratorFunction"),a.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,o(t,r,"GeneratorFunction")),t.prototype=Object.create(y),t},a.awrap=function(t){return{__await:t}},v(g.prototype),o(g.prototype,n,function(){return this}),a.AsyncIterator=g,a.async=function(t,e,n,i,r){void 0===r&&(r=Promise);var o=new g(s(t,e,n,i),r);return a.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},v(y),o(y,r,"Generator"),o(y,i,function(){return this}),o(y,"toString",function(){return"[object Generator]"}),a.keys=function(n){var t,i=[];for(t in n)i.push(t);return i.reverse(),function t(){for(;i.length;){var e=i.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=x,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function t(t,e){return o.type="throw",o.arg=n,i.next=t,e&&(i.method="next",i.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e],o=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var a=u.call(r,"catchLoc"),s=u.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&u.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}var o=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc?null:r)?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,c):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,i,r=this.tryEntries[e];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(i=n.arg,b(r)),i}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},a}function bf(t,e,n,i,r,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,r)}function kf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function wf(t,e,n){e&&xf(t.prototype,e),n&&xf(t,n),Object.defineProperty(t,"prototype",{writable:!1})}function Sf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ef(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ef(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ef(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Tf,_f="undefined"!=typeof Float32Array?Float32Array:Array;function Mf(){var t=new _f(9);return _f!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Pf(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],e=e[8],h=n[0],d=n[1],p=n[2],f=n[3],y=n[4],v=n[5],g=n[6],m=n[7],n=n[8];t[0]=h*i+d*a+p*l,t[1]=h*r+d*s+p*c,t[2]=h*o+d*u+p*e,t[3]=f*i+y*a+v*l,t[4]=f*r+y*s+v*c,t[5]=f*o+y*u+v*e,t[6]=g*i+m*a+n*l,t[7]=g*r+m*s+n*c,t[8]=g*o+m*u+n*e}function Of(){var t=new _f(16);return _f!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Cf(){var t=new _f(3);return _f!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Af(t,e,n){var i=new _f(3);return i[0]=t,i[1]=e,i[2]=n,i}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),Cf(),d=new _f(2),_f!=Float32Array&&(d[0]=0,d[1]=0);var Nf=f.defineToken("PointInPathPicker"),Lf=((kn=function(){function t(){var L=this;kf(this,t),this.displayObjectPool=void 0,this.canvasConfig=void 0,this.offscreenCanvas=void 0,this.rBush=void 0,this.pathGeneratorFactory=void 0,this.pointInPathPickerFactory=void 0,this.isHit=function(t,e,n){var i,r,o,a,s,u,l,c,h,d,p,f,y,v,g,m,b,k,x,w,S,E,T,_,M,P=L.pointInPathPickerFactory(t.nodeName);if(P){i=Of(),r=(n=n)[0],o=n[1],a=n[2],s=n[3],u=n[4],l=n[5],c=n[6],h=n[7],d=n[8],p=n[9],f=n[10],N=n[11],y=n[12],v=n[13],g=n[14],n=n[15];var O=(M=(m=r*l-o*u)*(O=f*n-N*g)-(b=r*c-a*u)*(_=p*n-N*v)+(C=r*h-s*u)*(T=p*g-f*v)+(k=o*c-a*l)*(E=d*n-N*y)-(A=o*h-s*l)*(S=d*g-f*y)+(x=a*h-s*c)*(w=d*v-p*y))?(i[0]=(l*O-c*_+h*T)*(M=1/M),i[1]=(a*_-o*O-s*T)*M,i[2]=(v*x-g*A+n*k)*M,i[3]=(f*A-p*x-N*k)*M,i[4]=(c*E-u*O-h*S)*M,i[5]=(r*O-a*E+s*S)*M,i[6]=(g*C-y*x-n*b)*M,i[7]=(d*x-f*C+N*b)*M,i[8]=(u*_-l*E+h*w)*M,i[9]=(o*E-r*_-s*w)*M,i[10]=(y*A-v*C+n*m)*M,i[11]=(p*C-d*A-N*m)*M,i[12]=(l*S-u*T-c*w)*M,i[13]=(r*T-o*S+a*w)*M,i[14]=(v*b-y*k-g*m)*M,i[15]=(d*k-p*b+f*m)*M,i):null,C=(x=Cf(),h=Af(e[0],e[1],0),E=O,_=h[0],s=h[1],h=h[2],n=E[3]*_+E[7]*s+E[11]*h+E[15],x[0]=(E[0]*_+E[4]*s+E[8]*h+E[12])/(n=n||1),x[1]=(E[1]*_+E[5]*s+E[9]*h+E[13])/n,x[2]=(E[2]*_+E[6]*s+E[10]*h+E[14])/n,x),A=t.getGeometryBounds().halfExtents,N=t.parsedStyle.anchor;if(C[0]+=(N&&N[0].value||0)*A[0]*2,C[1]+=(N&&N[1].value||0)*A[1]*2,P(t,new Ss(C[0],C[1]),L.isPointInPath))return!0}return!1},this.isPointInPath=function(t,e){var n=L.offscreenCanvas.getOrCreateContext(L.canvasConfig.offscreenCanvas),i=L.pathGeneratorFactory(t.nodeName);return i&&i(n,t.parsedStyle),n.isPointInPath(e.x,e.y)}}return wf(t,[{key:"apply",value:function(t){var D=this;t.hooks.pick.tapPromise(Tf.tag,function(){s=mf().mark(function t(S){var E,T,_,M,P,O,C,A,N,L,I;return mf().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:E=S.topmost,P=S.position,T=P.x,P=P.y,T=Af(T,P,0),P=D.rBush.search({minX:T[0],minY:T[1],maxX:T[0],maxY:T[1]}),_=P.map(function(t){return t.id}),M=[],P.forEach(function(t){t=t.id,t=D.displayObjectPool.getByEntity(t);!t.isVisible()||t.isCulled()||!t.isInteractive()||t.parentNode&&-1===_.indexOf(t.parentNode.entity)||M.push(t)}),M.sort(function(t,e){return e.sortable.renderOrder-t.sortable.renderOrder}),P=[],O=0,C=M;case 9:if(!(O<C.length)){t.next=25;break}if(A=C[O],N=A.parsedStyle.clipPath,L=N||A,I=A.getWorldTransform(),N&&(e=Of(),n=I,i=N.getLocalTransform(),w=x=k=b=m=g=v=y=f=p=d=h=c=l=u=s=a=o=r=void 0,r=n[0],o=n[1],a=n[2],s=n[3],u=n[4],l=n[5],c=n[6],h=n[7],d=n[8],p=n[9],f=n[10],y=n[11],v=n[12],g=n[13],m=n[14],n=n[15],b=i[0],k=i[1],x=i[2],w=i[3],e[0]=b*r+k*u+x*d+w*v,e[1]=b*o+k*l+x*p+w*g,e[2]=b*a+k*c+x*f+w*m,e[3]=b*s+k*h+x*y+w*n,b=i[4],k=i[5],x=i[6],w=i[7],e[4]=b*r+k*u+x*d+w*v,e[5]=b*o+k*l+x*p+w*g,e[6]=b*a+k*c+x*f+w*m,e[7]=b*s+k*h+x*y+w*n,b=i[8],k=i[9],x=i[10],w=i[11],e[8]=b*r+k*u+x*d+w*v,e[9]=b*o+k*l+x*p+w*g,e[10]=b*a+k*c+x*f+w*m,e[11]=b*s+k*h+x*y+w*n,b=i[12],k=i[13],x=i[14],w=i[15],e[12]=b*r+k*u+x*d+w*v,e[13]=b*o+k*l+x*p+w*g,e[14]=b*a+k*c+x*f+w*m,e[15]=b*s+k*h+x*y+w*n,I=e),!D.isHit(L,T,I)){t.next=22;break}if(E)return S.picked=[A],t.abrupt("return",S);t.next=21;break;case 21:P.push(A);case 22:O++,t.next=9;break;case 25:return S.picked=P,t.abrupt("return",S);case 27:case"end":return t.stop()}var e,n,i,r,o,a,s,u,l,c,h,d,p,f,y,v,g,m,b,k,x,w},t)});var s,e=function(){var t=this,a=arguments;return new Promise(function(e,n){var i=s.apply(t,a);function r(t){bf(i,e,n,r,o,"next",t)}function o(t){bf(i,e,n,r,o,"throw",t)}r(void 0)})};return function(t){return e.apply(this,arguments)}}())}}]),t}()).tag="CanvasPicker",Tf=kn);function If(t){return function(t){if(Array.isArray(t))return Df(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Df(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Df(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Df(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Rf(t,e,n,i){t-=n,n=e-i;return Math.sqrt(t*t+n*n)}function jf(t,e){return Math.abs(t-e)<.001}function Bf(t,e){var n=Math.min.apply(Math,If(t)),i=Math.min.apply(Math,If(e));return{x:n,y:i,width:Math.max.apply(Math,If(t))-n,height:Math.max.apply(Math,If(e))-i}}function Ff(t){return(t+2*Math.PI)%(2*Math.PI)}e([v(ws),n("design:type",ws)],Lf.prototype,"displayObjectPool",void 0),e([v(xs),n("design:type",Object)],Lf.prototype,"canvasConfig",void 0),e([v(dd),n("design:type",dd)],Lf.prototype,"offscreenCanvas",void 0),e([v(pf),n("design:type",op)],Lf.prototype,"rBush",void 0),e([v(i),n("design:type",Function)],Lf.prototype,"pathGeneratorFactory",void 0),e([v(Nf),n("design:type",Function)],Lf.prototype,"pointInPathPickerFactory",void 0);var Lf=Tf=e([y({contrib:ld})],Lf),zf={box:function(t,e,n,i){return Bf([t,n],[e,i])},length:Rf,pointAt:function(t,e,n,i,r){return{x:(1-r)*t+r*n,y:(1-r)*e+r*i}},pointDistance:function(t,e,n,i,r,o){var a=(n-t)*(r-t)+(i-e)*(o-e);return a<0?Rf(t,e,r,o):(n-t)*(n-t)+(i-e)*(i-e)<a?Rf(n,i,r,o):this.pointToLine(t,e,n,i,r,o)},pointToLine:function(t,e,n,i,r,o){n=[n-t,i-e];if((i=n)[0]===(a=[0,0])[0]&&i[1]===a[1])return Math.sqrt((r-t)*(r-t)+(o-e)*(o-e));var a,s,i=[-n[1],n[0]],u=(s=(n=a=i)[0],u=n[1],0<(s=s*s+u*u)&&(s=1/Math.sqrt(s)),a[0]=n[0]*s,a[1]=n[1]*s,[r-t,o-e]);return Math.abs(u[0]*i[0]+u[1]*i[1])},tangentAngle:function(t,e,n,i){return Math.atan2(i-e,n-t)}};function Vf(t,e,n,i,r,o){for(var a=-1,s=1/0,u=[n,i],l=20,c=1/(l=o&&200<o?o/10:l),h=c/10,d=0;d<=l;d++){var p=d*c,f=[r.apply(void 0,If(t.concat([p]))),r.apply(void 0,If(e.concat([p])))],f=Rf(u[0],u[1],f[0],f[1]);f<s&&(a=p,s=f)}if(0===a)return{x:t[0],y:e[0]};if(1===a)return{x:t[(n=t.length)-1],y:e[n-1]};for(var s=1/0,y=0;y<32&&!(h<1e-4);y++){var v=a-h,g=a+h,m=[r.apply(void 0,If(t.concat([v]))),r.apply(void 0,If(e.concat([v])))],m=Rf(u[0],u[1],m[0],m[1]);0<=v&&m<s?(a=v,s=m):(v=[r.apply(void 0,If(t.concat([g]))),r.apply(void 0,If(e.concat([g])))],m=Rf(u[0],u[1],v[0],v[1]),g<=1&&m<s?(a=g,s=m):h*=.5)}return{x:r.apply(void 0,If(t.concat([a]))),y:r.apply(void 0,If(e.concat([a])))}}function Hf(t,e,n,i){var r=1-i;return r*r*t+2*i*r*e+i*i*n}function Gf(t,e,n){n=t+n-2*e;if(jf(n,0))return[.5];t=(t-e)/n;return t<=1&&0<=t?[t]:[]}function Wf(t,e,n,i){return 2*(1-i)*(e-t)+2*i*(n-e)}function Uf(t,e,n,i,r,o,a){var s=Hf(t,n,r,a),u=Hf(e,i,o,a),l=zf.pointAt(t,e,n,i,a),n=zf.pointAt(n,i,r,o,a);return[[t,e,l.x,l.y,s,u],[s,u,n.x,n.y,r,o]]}function Yf(t,e,n,i,r,o,a){if(0===a)return(Rf(t,e,n,i)+Rf(n,i,r,o)+Rf(t,e,r,o))/2;t=Uf(t,e,n,i,r,o,.5),e=t[0],n=t[1];return e.push(a-1),n.push(a-1),Yf.apply(void 0,If(e))+Yf.apply(void 0,If(n))}var qf={box:function(t,e,n,i,r,o){var a=Gf(t,n,r)[0],s=Gf(e,i,o)[0],u=[t,r],l=[e,o];return void 0!==a&&u.push(Hf(t,n,r,a)),void 0!==s&&l.push(Hf(e,i,o,s)),Bf(u,l)},length:function(t,e,n,i,r,o){return Yf(t,e,n,i,r,o,3)},nearestPoint:function(t,e,n,i,r,o,a,s){return Vf([t,n,r],[e,i,o],a,s,Hf)},pointDistance:function(t,e,n,i,r,o,a,s){t=this.nearestPoint(t,e,n,i,r,o,a,s);return Rf(t.x,t.y,a,s)},interpolationAt:Hf,pointAt:function(t,e,n,i,r,o,a){return{x:Hf(t,n,r,a),y:Hf(e,i,o,a)}},divide:Uf,tangentAngle:function(t,e,n,i,r,o,a){t=Wf(t,n,r,a),n=Wf(e,i,o,a);return Ff(Math.atan2(n,t))}};function Xf(t,e,n,i,r){var o=1-r;return o*o*o*t+3*e*r*o*o+3*n*r*r*o+i*r*r*r}function Kf(t,e,n,i,r){var o=1-r;return 3*(o*o*(e-t)+2*o*r*(n-e)+r*r*(i-n))}function Zf(t,e,n,i){var r,o,i=-3*t+9*e-9*n+3*i,n=6*t-12*e+6*n,e=3*e-3*t,t=[];return jf(i,0)?jf(n,0)||0<=(r=-e/n)&&r<=1&&t.push(r):jf(e=n*n-4*i*e,0)?t.push(-n/(2*i)):0<e&&(o=(-n-(e=Math.sqrt(e)))/(2*i),0<=(r=(-n+e)/(2*i))&&r<=1&&t.push(r),0<=o&&o<=1&&t.push(o)),t}function $f(t,e,n,i,r,o,a,s,u){var l=Xf(t,n,r,a,u),c=Xf(e,i,o,s,u),h=zf.pointAt(t,e,n,i,u),n=zf.pointAt(n,i,r,o,u),i=zf.pointAt(r,o,a,s,u),r=zf.pointAt(h.x,h.y,n.x,n.y,u),o=zf.pointAt(n.x,n.y,i.x,i.y,u);return[[t,e,h.x,h.y,r.x,r.y,l,c],[l,c,o.x,o.y,i.x,i.y,a,s]]}function Jf(t,e,n,i,r,o,a,s,u){if(0===u){for(var l=[t,n,r,a],c=[e,i,o,s],h=0,d=l.length,p=0;p<d;p++)h+=Rf(l[p],c[p],l[(p+1)%d],c[(p+1)%d]);return h/2}t=$f(t,e,n,i,r,o,a,s,.5),e=[].concat(If(t[0]),[u-1]),n=[].concat(If(t[1]),[u-1]);return Jf.apply(void 0,If(e))+Jf.apply(void 0,If(n))}var Qf={extrema:Zf,box:function(t,e,n,i,r,o,a,s){for(var u=[t,a],l=[e,s],c=Zf(t,n,r,a),h=Zf(e,i,o,s),d=0;d<c.length;d++)u.push(Xf(t,n,r,a,c[d]));for(var p=0;p<h.length;p++)l.push(Xf(e,i,o,s,h[p]));return Bf(u,l)},length:function(t,e,n,i,r,o,a,s){return Jf(t,e,n,i,r,o,a,s,3)},nearestPoint:function(t,e,n,i,r,o,a,s,u,l,c){return Vf([t,n,r,a],[e,i,o,s],u,l,Xf,c)},pointDistance:function(t,e,n,i,r,o,a,s,u,l,c){t=this.nearestPoint(t,e,n,i,r,o,a,s,u,l,c);return Rf(t.x,t.y,u,l)},interpolationAt:Xf,pointAt:function(t,e,n,i,r,o,a,s,u){return{x:Xf(t,n,r,a,u),y:Xf(e,i,o,s,u)}},divide:$f,tangentAngle:function(t,e,n,i,r,o,a,s,u){t=Kf(t,n,r,a,u),n=Kf(e,i,o,s,u);return Ff(Math.atan2(n,t))}};function ty(t,e,n,i){t-=n,n=e-i;return Math.sqrt(t*t+n*n)}function ey(t,e,n,i,r,o){return t<=r&&r<=t+n&&e<=o&&o<=e+i}function ny(t,e,n,i,r,o,a,s){var u=(Math.atan2(s-e,a-t)+2*Math.PI)%(2*Math.PI);if(u<i||r<u)return!1;i={x:t+n*Math.cos(u),y:e+n*Math.sin(u)};return ty(i.x,i.y,a,s)<=o/2}function iy(t,e,n,i,r,o,a){var s=Math.min(t,n),u=Math.max(t,n),l=Math.min(e,i),c=Math.max(e,i),h=r/2;return s-h<=o&&o<=u+h&&l-h<=a&&a<=c+h&&zf.pointToLine(t,e,n,i,o,a)<=r/2}function ry(t,e,n,i,r){var o=t.length;if(o<2)return!1;for(var a=0;a<o-1;a++)if(iy(t[a][0],t[a][1],t[a+1][0],t[a+1][1],e,n,i))return!0;if(r){var r=t[0],s=t[o-1];if(iy(r[0],r[1],s[0],s[1],e,n,i))return!0}return!1}var oy=1e-6;function ay(t){return Math.abs(t)<oy?0:t<0?-1:1}function sy(t,e,n){var i=!1,r=t.length;if(r<=2)return!1;for(var o,a,s,u=0;u<r;u++){var l=t[u],c=t[(u+1)%r];if(a=c,((s=[e,n])[0]-(o=l)[0])*(a[1]-o[1])==(a[0]-o[0])*(s[1]-o[1])&&Math.min(o[0],a[0])<=s[0]&&s[0]<=Math.max(o[0],a[0])&&Math.min(o[1],a[1])<=s[1]&&s[1]<=Math.max(o[1],a[1]))return!0;0<ay(l[1]-n)!=0<ay(c[1]-n)&&ay(e-(n-l[1])*(l[0]-c[0])/(l[1]-c[1])-l[0])<0&&(i=!i)}return i}function uy(t,e,n){for(var i=!1,r=0;r<t.length&&!(i=sy(t[r],e,n));r++);return i}function ly(t,e){var t=t.parsedStyle,n=t.r,i=t.fill,r=t.stroke,o=t.lineWidth,a=t.increasedLineWidthForHitTesting,t=t.clipPathTargets,n=n.value,o=(((null==o?void 0:o.value)||0)+a.value)/2,a=ty(n,n,e.x,e.y),e=!(null==t||!t.length),t=i&&!i.isNone,i=r&&!r.isNone;return t&&i||e?a<=n+o:t?a<=n:!!i&&(n-o<=a&&a<=n+o)}function cy(t,e,n,i){return t/(n*n)+e/(i*i)}function hy(t,e){var n=e.x,e=e.y,t=t.parsedStyle,i=t.rx,r=t.ry,o=t.fill,a=t.stroke,s=t.lineWidth,u=t.increasedLineWidthForHitTesting,t=t.clipPathTargets,t=!(null==t||!t.length),o=o&&!o.isNone,a=a&&!a.isNone,i=i.value,r=r.value,s=(((null==s?void 0:s.value)||0)+u.value)/2,u=(n-i)*(n-i),n=(e-r)*(e-r);return o&&a||t?cy(u,n,i+s,r+s)<=1:o?cy(u,n,i,r)<=1:!!a&&(1<=cy(u,n,i-s,r-s)&&cy(u,n,i+s,r+s)<=1)}function dy(t,e){var t=t.parsedStyle,n=t.x1,i=t.y1,r=t.x2,o=t.y2,a=t.lineWidth,s=t.increasedLineWidthForHitTesting,u=t.defX,t=t.defY;return iy(n.value,i.value,r.value,o.value,a.value+s.value,e.x+(void 0===u?0:u),e.y+(void 0===t?0:t))}function py(t,e){var t=t.parsedStyle,n=t.stroke,i=t.lineWidth,r=t.increasedLineWidthForHitTesting,o=t.points,a=t.defX,s=t.defY,t=t.clipPathTargets,t=!(null==t||!t.length);return!(!(n&&!n.isNone||t)||!i)&&ry(o.points,i.value+r.value,e.x+(void 0===a?0:a),e.y+(void 0===s?0:s),!1)}function fy(t,e,n,i,r){for(var o=!1,a=e/2,s=0;s<t.length;s++){var u=t[s],l=u.currentPoint,c=u.params,h=u.prePoint,d=u.box;if(!d||ey(d.x-a,d.y-a,d.width+e,d.height+e,n,i)){switch(u.command){case"L":case"Z":o=iy(h[0],h[1],l[0],l[1],e,n,i);break;case"Q":o=qf.pointDistance(h[0],h[1],c[1],c[2],c[3],c[4],n,i)<=e/2;break;case"C":o=Qf.pointDistance(h[0],h[1],c[1],c[2],c[3],c[4],c[5],c[6],n,i,r)<=e/2;break;case"A":var p=u.arcParams,f=p.cx,y=p.cy,v=p.rx,g=p.ry,m=p.startAngle,b=p.endAngle,p=p.xRotation,k=g<v?v:g,x=g<v?1:v/g,g=g<v?g/v:1,y=(v=Mf(),f=[-f,-y],v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=1,v[5]=0,v[6]=f[0],v[7]=f[1],v[8]=1,v),v=(Pf(y,(f=Mf(),v=-p,p=void 0,p=Math.sin(v),v=Math.cos(v),f[0]=v,f[1]=p,f[2]=0,f[3]=-p,f[4]=v,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f),y),Pf(y,(p=Mf(),v=[1/x,1/g],p[0]=v[0],p[1]=0,p[2]=0,p[3]=0,p[4]=v[1],p[5]=0,p[6]=0,p[7]=0,p[8]=1,p),y),f=n,x=i,g=void 0,(g=new _f(2))[0]=f,g[1]=x,g);p=y,f=void 0,f=(g=x=v)[0],g=g[1],x[0]=p[0]*f+p[3]*g+p[6],x[1]=p[1]*f+p[4]*g+p[7],o=ny(0,0,k,m,b,e,(v=x)[0],v[1])}if(o)break}}return o}function yy(t,e,n){var i=t.parsedStyle,r=i.lineWidth,o=i.increasedLineWidthForHitTesting,a=i.stroke,s=i.fill,u=i.defX,u=void 0===u?0:u,l=i.defY,l=void 0===l?0:l,c=i.clipPathTargets,i=i.path,s=s&&!s.isNone,a=a&&!a.isNone,h=i.segments,d=i.hasArc,p=i.polylines,f=i.polygons,i=i.totalLength,c=!(null==c||!c.length),y=!1;return y=(y=a||c?fy(h,r.value+o.value,e.x+u,e.y+l,i):y)||!s&&!c?y:d?n(t,e):uy(f,e.x+u,e.y+l)||uy(p,e.x+u,e.y+l)}function vy(t,e,n){var i=t.parsedStyle,r=i.radius,o=i.fill,a=i.stroke,s=i.lineWidth,u=i.increasedLineWidthForHitTesting,l=i.width,c=i.height,i=i.clipPathTargets,i=!(null==i||!i.length),o=o&&!o.isNone,a=a&&!a.isNone,h=r&&r.some(function(t){return 0!==t.value}),d=l.unit,l=l.value,p=c.unit,c=c.value,f=0,y=0,d=(d!==N.kNumber&&d!==N.kPixels||(f=l),p!==N.kNumber&&p!==N.kPixels||(y=c),s.value+u.value);if(h)return l=!1,(a||i)&&(c=p=0,s=f,u=y,h=r.map(function(t){return t.value}),r=d,v=e.x,g=e.y,h=Sf(h,4),b=h[0],k=h[1],m=h[2],h=h[3],l=iy(p+b,c,p+s-k,c,r,v,g)||iy(p+s,c+k,p+s,c+u-m,r,v,g)||iy(p+s-m,c+u,p+h,c+u,r,v,g)||iy(p,c+u-h,p,c+b,r,v,g)||ny(p+s-k,c+k,k,1.5*Math.PI,2*Math.PI,r,v,g)||ny(p+s-m,c+u-m,m,0,.5*Math.PI,r,v,g)||ny(p+h,c+u-h,h,.5*Math.PI,Math.PI,r,v,g)||ny(p+b,c+b,b,Math.PI,1.5*Math.PI,r,v,g)),l||!o&&!i?l:n(t,e);var v,g,m,b,k=d/2;return o&&a||i?ey(0-k,0-k,f+k,y+k,e.x,e.y):o?ey(0,0,f,y,e.x,e.y):!!a&&(m=s=0,u=f,h=y,p=d,c=e.x,b=e.y,ey(s-(r=p/2),m-r,u,p,c,b)||ey(s+u-r,m-r,p,h,c,b)||ey(s+r,m+h-r,u,p,c,b)||ey(s-r,m+r,p,h,c,b))}function gy(t,e){var t=t.parsedStyle,n=t.stroke,i=t.fill,r=t.lineWidth,o=t.increasedLineWidthForHitTesting,a=t.points,s=t.defX,s=void 0===s?0:s,u=t.defY,u=void 0===u?0:u,t=t.clipPathTargets,t=!(null==t||!t.length),i=i&&!i.isNone,l=!1;return l=(l=n&&!n.isNone||t?ry(a.points,r.value+o.value,e.x+s,e.y+u,!0):l)||!i&&!t?l:sy(a.points,e.x+s,e.y+u)}var my,by=Mr(function(t){t({token:Nf,useFactory:function(t){return function(t){return t===m.CIRCLE?ly:t===m.ELLIPSE?hy:t===m.RECT?vy:t===m.LINE?dy:t===m.POLYLINE?py:t===m.POLYGON?gy:t===m.PATH?yy:t===m.IMAGE||t===m.TEXT?function(){return!0}:null}}}),t(Lf)}),ky=function(){function t(){kf(this,t),this.name="canvas-picker"}return wf(t,[{key:"init",value:function(t){t.load(by,!0)}},{key:"destroy",value:function(t){t.unload(by)}}]),t}();function xy(){xy=function(){return a};var a={},t=Object.prototype,u=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",r=e.toStringTag||"@@toStringTag";function o(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(t){o=function(t,e,n){return t[e]=n}}function s(t,e,n,i){var r,o,a,s,e=e&&e.prototype instanceof h?e:h,e=Object.create(e.prototype),i=new k(i||[]);return e._invoke=(r=t,o=n,a=i,s="suspendedStart",function(t,e){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===t)throw e;return w()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){n=function t(e,n){var i=e.iterator[n.method];if(void 0===i){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=void 0,t(e,n),"throw"===n.method))return c;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}i=l(i,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,c;i=i.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,c):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,c)}(n,a);if(n){if(n===c)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";n=l(r,o,a);if("normal"===n.type){if(s=a.done?"completed":"suspendedYield",n.arg===c)continue;return{value:n.arg,done:a.done}}"throw"===n.type&&(s="completed",a.method="throw",a.arg=n.arg)}}),e}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}a.wrap=s;var c={};function h(){}function d(){}function p(){}var e={},f=(o(e,i,function(){return this}),Object.getPrototypeOf),f=f&&f(f(x([]))),y=(f&&f!==t&&u.call(f,i)&&(e=f),p.prototype=h.prototype=Object.create(e));function v(t){["next","throw","return"].forEach(function(e){o(t,e,function(t){return this._invoke(e,t)})})}function g(a,s){var e;this._invoke=function(n,i){function t(){return new s(function(t,e){!function e(t,n,i,r){var o,t=l(a[t],a,n);if("throw"!==t.type)return(n=(o=t.arg).value)&&"object"==typeof n&&u.call(n,"__await")?s.resolve(n.__await).then(function(t){e("next",t,i,r)},function(t){e("throw",t,i,r)}):s.resolve(n).then(function(t){o.value=t,i(o)},function(t){return e("throw",t,i,r)});r(t.arg)}(n,i,t,e)})}return e=e?e.then(t,t):t()}}function m(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(m,this),this.reset(!0)}function x(e){if(e){var n,t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:w}}function w(){return{value:void 0,done:!0}}return o(y,"constructor",d.prototype=p),o(p,"constructor",d),d.displayName=o(p,r,"GeneratorFunction"),a.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,o(t,r,"GeneratorFunction")),t.prototype=Object.create(y),t},a.awrap=function(t){return{__await:t}},v(g.prototype),o(g.prototype,n,function(){return this}),a.AsyncIterator=g,a.async=function(t,e,n,i,r){void 0===r&&(r=Promise);var o=new g(s(t,e,n,i),r);return a.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},v(y),o(y,r,"Generator"),o(y,i,function(){return this}),o(y,"toString",function(){return"[object Generator]"}),a.keys=function(n){var t,i=[];for(t in n)i.push(t);return i.reverse(),function t(){for(;i.length;){var e=i.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=x,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function t(t,e){return o.type="throw",o.arg=n,i.next=t,e&&(i.method="next",i.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e],o=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var a=u.call(r,"catchLoc"),s=u.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&u.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}var o=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc?null:r)?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,c):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,i,r=this.tryEntries[e];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(i=n.arg,b(r)),i}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},a}function wy(t,e,n,i,r,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,r)}function Sy(s){return function(){var t=this,a=arguments;return new Promise(function(e,n){var i=s.apply(t,a);function r(t){wy(i,e,n,r,o,"next",t)}function o(t){wy(i,e,n,r,o,"throw",t)}r(void 0)})}}function Ey(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ty(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _y(t,e,n){e&&Ty(t.prototype,e),n&&Ty(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(h=function(){function t(){Ey(this,t),this.contextService=void 0,this.renderingContext=void 0,this.$camera=void 0}return _y(t,[{key:"apply",value:function(t){function e(t){var e,n,i=t.target;i.nodeName===m.HTML&&(e=r.getOrCreateEl(i),n=i.ownerDocument.documentElement.attributes,Object.keys(n).forEach(function(t){e.style[t]=n[t]}),Object.keys(i.attributes).forEach(function(t){r.updateAttribute(t,i)}))}function n(t){var e;(t=t.target).nodeName===m.HTML&&(t=r.getId(t),(e=r.contextService.getDomElement().parentNode)&&(t=e.querySelector("#"+t))&&e.removeChild(t))}function i(t){var e=t.target;e.nodeName===m.HTML&&(t=t.attrName,r.updateAttribute(t,e))}var r=this;t.hooks.init.tapPromise(my.tag,Sy(xy().mark(function t(){return xy().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r.renderingContext.root.addEventListener(C.MOUNTED,e),r.renderingContext.root.addEventListener(C.UNMOUNTED,n),r.renderingContext.root.addEventListener(C.ATTR_MODIFIED,i);case 3:case"end":return t.stop()}},t)}))),t.hooks.destroy.tap(my.tag,function(){r.renderingContext.root.removeEventListener(C.MOUNTED,e),r.renderingContext.root.removeEventListener(C.UNMOUNTED,n),r.renderingContext.root.removeEventListener(C.ATTR_MODIFIED,i)})}},{key:"getId",value:function(t){return t.id||"g-html-"+t.entity}},{key:"getOrCreateEl",value:function(t){var e,n=this.getId(t),i=this.contextService.getDomElement().parentNode;return i?((e=i.querySelector("#"+n))||(e=document.createElement("div"),(t.parsedStyle.$el=e).id=n,t.name&&e.setAttribute("name",t.name),t.className&&(e.className=t.className),i.appendChild(e),e.style.position="absolute",e.style.left="0",e.style.top="0",e.style["will-change"]="transform",n=t.getWorldTransform(),e.style.transform="matrix(".concat([n[0],n[1],n[4],n[5],n[12],n[13]].join(","),")")),e):null}},{key:"updateAttribute",value:function(t,e){var n=this.getOrCreateEl(e);switch(t){case"innerHTML":var i=e.parsedStyle.innerHTML;wc(i)?n.innerHTML=i:(n.innerHTML="",n.appendChild(i));break;case"modelMatrix":case"transformOrigin":i=e.parsedStyle.transformOrigin,i=(n.style["transform-origin"]="".concat(i[0].value," ").concat(i[1].value),e.getWorldTransform());n.style.transform="matrix(".concat([i[0],i[1],i[4],i[5],i[12],i[13]].join(","),")");break;case"width":i=e.computedStyleMap().get("width");n.style.width=i.toString();break;case"height":i=e.computedStyleMap().get("height");n.style.height=i.toString();break;case"zIndex":i=e.parsedStyle.zIndex;n.style["z-index"]="".concat(i.value);break;case"visibility":i=e.parsedStyle.visibility;n.style.visibility=i.value;break;case"pointerEvents":i=e.parsedStyle.pointerEvents;n.style.pointerEvents=i.value;break;case"opacity":i=e.parsedStyle.opacity;n.style.opacity="".concat(i.value);break;case"fill":var i=e.parsedStyle.fill,r="";i instanceof nl?r=i.toString():i instanceof il&&i.type===Xu.LinearGradient&&(i=i.value.steps.map(function(t){return"".concat(t[1]," ").concat(100*Number(t[0]),"%")}).join(","),r="linear-gradient(to right, ".concat(i,");")),n.style.background=r;break;case"stroke":i=e.parsedStyle.stroke;n.style["border-color"]=i.toString(),n.style["border-style"]="solid";break;case"lineWidth":r=e.parsedStyle.lineWidth;n.style["border-width"]="".concat(r.value||0,"px");break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":i=e.parsedStyle.filter;n.style.filter=i}}}]),t}()).tag="HTMLRendering";var My=my=h,Py=(e([v(sd),n("design:type",Object)],My.prototype,"contextService",void 0),e([v(ud),n("design:type",Object)],My.prototype,"renderingContext",void 0),My=my=e([y({contrib:ld})],My),Mr(function(t){t(My)})),Oy=function(){function t(){Ey(this,t),this.name="html-renderer"}return _y(t,[{key:"init",value:function(t){t.load(Py,!0)}},{key:"destroy",value:function(t){t.unload(Py)}}]),t}();function Cy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ay(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ny(t,e,n){return e&&Ay(t.prototype,e),n&&Ay(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ly(t){return(Ly=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Iy(t,e){return(Iy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dy(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");e=t;if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ry(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=Ly(n);return Dy(this,i?(t=Ly(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}var jy=function(){function t(){Cy(this,t),this.$container=void 0,this.$canvas=void 0,this.dpr=void 0,this.context=void 0,this.canvasConfig=void 0}return Ny(t,[{key:"init",value:function(){var t=this.canvasConfig,e=t.container,n=t.canvas,t=t.devicePixelRatio;n?(this.$canvas=n,e&&n.parentElement!==e&&e.appendChild(n),this.$container=n.parentElement,this.canvasConfig.container=this.$container):e&&(this.$container=wc(e)?document.getElementById(e):e,this.$container&&(n=document.createElement("canvas"),this.$container.appendChild(n),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=n)),this.context=this.$canvas.getContext("2d");e=1<=(e=t||Rs&&window.devicePixelRatio||1)?Math.ceil(e):1;this.dpr=e,this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(t,e){var n;this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*e,n=this.$canvas,t=t,e=e,Rs&&n.style&&(n.style.width=t+"px",n.style.height=e+"px"),t=this.getDPR(),this.context.scale(t,t))}},{key:"applyCursorStyle",value:function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)}}]),t}(),By=(e([v(xs),n("design:type",Object)],jy.prototype,"canvasConfig",void 0),jy=e([y({token:sd})],jy),Mr(function(t){t(jy)})),Fy=function(){function t(){Cy(this,t),this.name="canvas-context-register"}return Ny(t,[{key:"init",value:function(t){t.load(By,!0)}},{key:"destroy",value:function(t){t.unload(By)}}]),t}(),zy=function(){var t=i,e=Rd;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Iy(t,e);var n=Ry(i);function i(t){return Cy(this,i),(t=n.call(this,t)).registerPlugin(new Fy),t.registerPlugin(new gf),t.registerPlugin(new ep),t.registerPlugin(new ky),t.registerPlugin(new Oy),t}return Ny(i)}();const Vy=({width:t,height:e,container:n})=>new Ud({container:n,width:t,height:e,renderer:new zy}),Hy=(Vy.props={},()=>[["cartesian"]]),Gy=(Hy.props={},({startAngle:t=0,endAngle:e=2*Math.PI,innerRadius:n=0,outerRadius:i=1})=>[["translate",0,.5],["reflect.y"],["translate",0,-.5],["polar",t,e,n,i]]),Wy=(Gy.props={},()=>[["transpose"],["translate",.5,.5],["reflect.x"],["translate",-.5,-.5]]),Uy=(Wy.props={},()=>[["parallel",0,1,0,1]]),Yy=(Uy.props={},({focusX:t=0,focusY:e=0,distortionX:n=2,distortionY:i=2})=>[["fisheye",t,e,n,i]]),qy=(Yy.props={},({value:e})=>t=>t.map(()=>e)),Xy=(qy.props={},({value:e})=>t=>t.map(e)),Ky=(Xy.props={},({value:e})=>t=>t.map(t=>t[e])),Zy=(Ky.props={},({value:t})=>()=>t);function $y(){return[{name:"color"},{name:"shape"},{name:"enterType"},{name:"enterDelay",scaleName:"enter"},{name:"enterDuration",scaleName:"enter"},{name:"enterEasing"},{name:"key",scale:"identity"}]}function Jy(){return[...$y(),{name:"title",scale:"identity"},{name:"tooltip",scale:"identity",independent:!0}]}function Qy(){return[{type:"maybeArrayField"}]}function tv(){return[{type:"maybeKey"}]}Zy.props={};const ev=()=>(t,e,n,u)=>{const{x:l,y:c,y1:h,series:d}=n,p=e.x,f=e.series;return[t,Array.from(t,t=>{var e=p.getBandWidth(p.invert(+l[t])),n=e*(f?f.getBandWidth(f.invert(+(null===d||void 0===d?void 0:d[t]))):1),e=(+(null===d||void 0===d?void 0:d[t])||0)*e,e=+l[t]+e,n=e+n,i=+c[t],t=+h[t];const r=[e,i],o=[n,i],a=[n,t],s=[e,t];return[r,o,a,s].map(t=>u.map(t))})]};function nv(t,e){return null==t||null==e?NaN:t<e?-1:e<t?1:e<=t?0:NaN}function iv(t,e){return null==t||null==e?NaN:e<t?-1:t<e?1:t<=e?0:NaN}function rv(t,e){t=function(e,n){let i=0,r,o=0,a=0;if(void 0===n)for(var t of e)null!=t&&(t=+t)>=t&&(r=t-o,o+=r/++i,a+=r*(t-o));else{let t=-1;for(var s of e)null!=(s=n(s,++t,e))&&(s=+s)>=s&&(r=s-o,o+=r/++i,a+=r*(s-o))}if(1<i)return a/(i-1)}(t,e);return t&&Math.sqrt(t)}function ov(e,n){let i,r;if(void 0===n)for(const t of e)null!=t&&(void 0===i?t>=t&&(i=r=t):(i>t&&(i=t),r<t&&(r=t)));else{let t=-1;for(var o of e)null!=(o=n(o,++t,e))&&(void 0===i?o>=o&&(i=r=o):(i>o&&(i=o),r<o&&(r=o)))}return[i,r]}ev.props={defaultShape:"rect",channels:[...Jy(),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"}],preInference:[...Qy(),{type:"maybeZeroY1"},{type:"maybeZeroX"},{type:"maybeStackY",series:!0}],postInference:[...tv(),{type:"maybeTitleX"},{type:"maybeTooltipY"}],shapes:["rect","hollowRect"]};class av extends Map{constructor(t,e=function(t){return null!==t&&"object"==typeof t?t.valueOf():t}){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(sv(this,t))}has(t){return super.has(sv(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){e=e(n);return t.has(e)?t.get(e):(t.set(e,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){e=e(n);t.has(e)&&(n=t.get(e),t.delete(e));return n}(this,t))}}function sv({_intern:t,_key:e},n){e=e(n);return t.has(e)?t.get(e):n}function uv(t){return t}function lv(t,...e){return h=c=uv,d=e,function t(e,n){if(n>=d.length)return h(e);const i=new av,r=d[n++];let o=-1;for(const s of e){var a=r(s,++o,e);const u=i.get(a);u?u.push(s):i.set(a,[s])}for(const[l,e]of i)i.set(l,t(e,n));return c(i)}(t,0);var c,h,d}function cv(t,e){return(null==t||!(t<=t))-(null==e||!(e<=e))||(t<e?-1:e<t?1:0)}function hv(e,n){let i;if(void 0===n)for(const t of e)null!=t&&(i<t||void 0===i&&t>=t)&&(i=t);else{let t=-1;for(var r of e)null!=(r=n(r,++t,e))&&(i<r||void 0===i&&r>=r)&&(i=r)}return i}function dv(e,n){let i;if(void 0===n)for(const t of e)null!=t&&(i>t||void 0===i&&t>=t)&&(i=t);else{let t=-1;for(var r of e)null!=(r=n(r,++t,e))&&(i>r||void 0===i&&r>=r)&&(i=r)}return i}function pv(n,i,r=0,o=n.length-1,a){for(a=void 0===a?cv:function(i=nv){if(i===nv)return cv;if("function"!=typeof i)throw new TypeError("compare is not a function");return(t,e)=>{var n=i(t,e);return n||0===n?n:(0===i(e,e))-(0===i(t,t))}}(a);r<o;){600<o-r&&(s=o-r+1,u=i-r+1,c=Math.log(s),l=.5*Math.exp(2*c/3),c=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1),pv(n,i,Math.max(r,Math.floor(i-u*l/s+c)),Math.min(o,Math.floor(i+(s-u)*l/s+c)),a));var s,u,l,c,h=n[i];let t=r,e=o;for(fv(n,r,i),0<a(n[o],h)&&fv(n,r,o);t<e;){for(fv(n,t,e),++t,--e;a(n[t],h)<0;)++t;for(;0<a(n[e],h);)--e}0===a(n[r],h)?fv(n,r,e):fv(n,++e,o),e<=i&&(r=e+1),i<=e&&(o=e-1)}return n}function fv(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function yv(t,e,n){if(n=(t=Float64Array.from(function*(e,n){if(void 0===n)for(var t of e)null!=t&&(t=+t)>=t&&(yield t);else{let t=-1;for(var i of e)null!=(i=n(i,++t,e))&&(i=+i)>=i&&(yield i)}}(t,n))).length){if((e=+e)<=0||n<2)return dv(t);if(1<=e)return hv(t);var n=(n-1)*e,e=Math.floor(n),i=hv(pv(t,e).subarray(0,e+1));return i+(dv(t.subarray(e+1))-i)*(n-e)}}function vv(t,e){let n,i=-1,r=-1;if(void 0===e)for(const a of t)++r,null!=a&&(n<a||void 0===n&&a>=a)&&(n=a,i=r);else for(var o of t)null!=(o=e(o,++r,t))&&(n<o||void 0===n&&o>=o)&&(n=o,i=r);return i}function gv(e,n){let i=0,r=0;if(void 0===n)for(var t of e)null!=t&&(t=+t)>=t&&(++i,r+=t);else{let t=-1;for(var o of e)null!=(o=n(o,++t,e))&&(o=+o)>=o&&(++i,r+=o)}if(i)return r/i}function mv(t,e){return yv(t,.5,e)}function bv(e,n){let i=0;if(void 0===n)for(var t of e)(t=+t)&&(i+=t);else{let t=-1;for(var r of e)(r=+n(r,++t,e))&&(i+=r)}return i}function kv(t){const e=t.getOptions()["transformations"];return e.map(([t])=>t).filter(t=>"transpose"===t).length%2!=0}function xv(t){const e=t.getOptions()["transformations"];return e.some(([t])=>"polar"===t)}function wv(t){const e=t.getOptions()["transformations"];return e.some(([t])=>"parallel"===t)}const Sv=(t,e,n,i)=>{const{series:r,x:o,y:a}=n;if(void 0===o||void 0===a)throw new Error("Missing encode for x or y channel.");const s=r?Array.from(lv(t,t=>r[t]).values()):[t];return[s.map(t=>t[0]),Array.from(s,t=>t.map(t=>i.map([+o[t],+a[t]])))]},Ev=(t,e,n,r)=>{const o=Object.entries(n).filter(([t])=>t.startsWith("position")).map(([,t])=>t);if(0===o.length)throw new Error("Missing encode for position channel.");return[t,Array.from(t,e=>{var t=o.map(t=>+t[e]),n=r.map(t);const i=[];for(let t=0;t<n.length;t+=2)i.push([n[t],n[t+1]]);return i})]},Tv=()=>(t,e,n,i)=>{const r=wv(i)?Ev:Sv;return r(t,e,n,i)},_v=(Tv.props={defaultShape:"line",channels:[...Jy(),{name:"x"},{name:"y"},{name:"position",independent:!0},{name:"size"},{name:"series",scale:"identity"}],preInference:[...Qy(),{type:"maybeSeries"}],postInference:[...tv(),{type:"maybeTitleX"},{type:"maybeTooltipY"},{type:"maybeTooltipPosition"}],shapes:["line","smooth"]},()=>(t,e,n,o)=>{const{x:a,y:s,size:u,dx:l,dy:c}=n,[h,d]=o.getSize();return[t,Array.from(t,t=>{var e=+((null===l||void 0===l?void 0:l[t])||0),n=+((null===c||void 0===c?void 0:c[t])||0),e=+a[t]+e,n=+s[t]+n,t=+u[t],i=t/h,t=t/d,r=[e+i,n+t];return[o.map([e-i,n-t]),o.map(r)]})]}),Mv=(_v.props={defaultShape:"point",channels:[...Jy(),{name:"x",required:!0},{name:"y",required:!0},{name:"size",required:!0},{name:"dx",scale:"identity"},{name:"dy",scale:"identity"}],preInference:[...Qy(),{type:"maybeZeroY"},{type:"maybeZeroX"},{type:"maybeSize"}],postInference:[...tv(),{type:"maybeTitleX"},{type:"maybeTooltipY"}],shapes:["bowtie","cross","diamond","hexagon","hollowBowtie","hollowDiamond","hollowHexagon","hollowPoint","hollowSquare","hollowTriangle","hollowTriangleDown","hyphen","linePoint","plus","point","square","tick","triangle","triangleDown"]},()=>(t,e,n,i)=>{const{x:r,y:o}=n,a=e["x"];return[t,Array.from(t,t=>{var e=+r[t],t=+o[t],n=(null==(n=null===a||void 0===a?void 0:a.getBandWidth)?void 0:n.call(a))||0;return[i.map([e+n/2,t])]})]}),Pv=(Mv.props={defaultShape:"text",channels:[...Jy(),{name:"x",required:!0},{name:"y",required:!0},{name:"text",required:!0,scale:"identity"},{name:"fontSize"},{name:"rotate"}],preInference:[...Qy()],postInference:[...tv(),{type:"maybeTitleX"},{type:"maybeTooltipY"}],shapes:["text"]},()=>(t,e,n,u)=>{const{x:l,y:c}=n,h=e.x,d=e.y;return[t,Array.from(t,t=>{var e=h.getBandWidth(h.invert(+l[t])),n=d.getBandWidth(d.invert(+c[t])),i=+l[t],t=+c[t];const r=[i,t],o=[i+e,t],a=[i+e,t+n],s=[i,t+n];return[r,o,a,s].map(t=>u.map(t))})]}),Ov=(Pv.props={defaultShape:"rect",channels:[...Jy(),{name:"x",required:!0,scale:"band"},{name:"y",required:!0,scale:"band"}],preInference:[...Qy(),{type:"maybeZeroX"},{type:"maybeZeroY"}],postInference:[...tv(),{type:"maybeTitleX"},{type:"maybeTooltipY"}],shapes:["rect","hollowRect"]},()=>(t,e,n,o)=>{const{x:a,y:s,y1:u,series:i}=n,r=i?Array.from(lv(t,t=>i[t]).values()):[t];return[r.map(t=>t[0]),Array.from(r,e=>{var n=e.length;const i=new Array(2*n);for(let t=0;t<e.length;t++){var r=e[t];i[t]=o.map([+a[r],+s[r]]),i[n+t]=o.map([+a[r],+u[r]])}return i})]}),Cv=(Ov.props={defaultShape:"area",channels:[...Jy(),{name:"x",required:!0},{name:"y",required:!0},{name:"size"},{name:"series",scale:"identity"}],preInference:[...Qy(),{type:"maybeSeries"},{type:"maybeZeroY1"}],postInference:[...tv(),{type:"maybeTitleX"},{type:"maybeTooltipY"}],shapes:["area","smooth"]},()=>(t,e,n,i)=>{const{x:r,y:o,x1:a,y1:s}=n,u=(null==(e=null==(n=e.x)?void 0:n.getBandWidth)?void 0:e.call(n))||0;e=t.map(t=>[i.map([+r[t]+u/2,+o[t]]),i.map([+a[t]+u/2,+s[t]])]);return[t,e]}),Av=(Cv.props={defaultShape:"edge",channels:[...Jy(),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Qy()],postInference:[...tv(),{type:"maybeTitleX"},{type:"maybeTooltipY"}],shapes:["edge","arc"]},()=>(t,e,n,i)=>{const{x:r,y:o}=n,a=e["x"];return[t,Array.from(t,t=>{var e=+r[t],t=+o[t],n=(null==(n=null===a||void 0===a?void 0:a.getBandWidth)?void 0:n.call(a))||0;return[i.map([e+n/2,t])]})]}),Nv=(Av.props={defaultShape:"image",channels:[...Jy(),{name:"x",required:!0},{name:"y",required:!0},{name:"src",required:!0,scale:"identity"},{name:"size"}],preInference:[...Qy()],postInference:[...tv(),{type:"maybeTitleX"},{type:"maybeTooltipY"}],shapes:["image"]},()=>(t,e,n,o)=>{const a=Object.entries(n).filter(([t])=>t.startsWith("x")).map(([,t])=>t),s=Object.entries(n).filter(([t])=>t.startsWith("y")).map(([,t])=>t);n=t.map(e=>{const n=[];for(let t=0;t<a.length;t++){var i=a[t][e];if(void 0===i)break;var r=s[t][e];n.push(o.map([+i,+r]))}return n});return[t,n]}),Lv=(Nv.props={defaultShape:"polygon",channels:[...Jy(),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Qy()],postInference:[...tv(),{type:"maybeTitleX"},{type:"maybeTooltipY"}],shapes:["polygon"]},()=>(t,e,n,u)=>{const{x:l,y:c,y1:h,y2:d,y3:p,y4:f,series:y}=n,v=e.x,g=e.series;return[t,Array.from(t,t=>{var e=v.getBandWidth(v.invert(+l[t])),n=e*(g?g.getBandWidth(g.invert(+(null===y||void 0===y?void 0:y[t]))):1),e=(+(null===y||void 0===y?void 0:y[t])||0)*e,e=+l[t]+e+n/2,[t,i,r,o,a]=[+c[t],+h[t],+d[t],+p[t],+f[t]];const s=[[e-n/2,a],[e+n/2,a],[e,a],[e,o],[e-n/2,o],[e+n/2,o],[e+n/2,i],[e-n/2,i],[e-n/2,r],[e+n/2,r],[e,i],[e,t],[e-n/2,t],[e+n/2,t]];return s.map(t=>u.map(t))})]}),Iv=(Lv.props={defaultShape:"box",channels:[...Jy(),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"}],preInference:[...Qy()],postInference:[...tv(),{type:"maybeTitleX"},{type:"maybeTooltipY"}],shapes:["box"]},()=>Mv()),Dv=(Iv.props={defaultShape:"annotation.text",channels:[...$y(),{name:"x",required:!0},{name:"y",required:!0},{name:"text",required:!0,scale:"identity"},{name:"fontSize"},{name:"rotate"}],preInference:[...Qy()],postInference:[...tv()],shapes:["annotation.text","annotation.badge"]},()=>(t,e,n,i)=>{const r=n["y"];return[t,Array.from(t,t=>{const e=[0,r[t]],n=[1,r[t]];return[e,n].map(t=>i.map(t))})]}),Rv=(Dv.props={defaultShape:"annotation.line",channels:[...$y(),{name:"y",required:!0}],preInference:[...Qy()],postInference:[...tv()],shapes:["annotation.line"]},()=>(t,e,n,i)=>{const r=n["x"];return[t,Array.from(t,t=>{const e=[r[t],1],n=[r[t],0];return[e,n].map(t=>i.map(t))})]}),jv=(Rv.props={defaultShape:"annotation.line",channels:[...$y(),{name:"x",required:!0}],preInference:[...Qy()],postInference:[...tv()],shapes:["annotation.line"]},()=>Cv()),Bv=(jv.props={defaultShape:"annotation.connector",channels:[...$y(),{name:"x",required:!0},{name:"y",required:!0}],preInference:[...Qy()],postInference:[...tv()],shapes:["annotation.connector"]},()=>["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"]),Fv=(Bv.props={},()=>["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"]);Fv.props={};class zv{constructor(t){this.options=O({},this.getDefaultOptions()),this.update(t)}getOptions(){return this.options}update(t={}){this.options=O({},this.options,t),this.rescale(t)}rescale(t){}}function Vv(e,n,i){for(let t=0;t<n.length;t+=1)e.has(n[t])||e.set(i(n[t]),t)}function Hv(t){const{value:e,from:n,to:i,mapper:r,notFoundReturn:o}=t;let a=r.get(e);if(void 0===a){if(o)return o;a=n.push(e)-1,r.set(e,a)}return i[a%i.length]}function Gv(t){return t instanceof Date?t=>""+t:"object"==typeof t?t=>JSON.stringify(t):t=>t}class Wv extends zv{constructor(t){super(t)}getDefaultOptions(){return{domain:[],range:[]}}map(t){return 0===this.domainIndexMap.size&&Vv(this.domainIndexMap,this.getDomain(),this.domainKey),Hv({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(t){return 0===this.rangeIndexMap.size&&Vv(this.rangeIndexMap,this.getRange(),this.rangeKey),Hv({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(t){var[e]=this.options.domain,[n]=this.options.range;if(this.domainKey=Gv(e),this.rangeKey=Gv(n),!this.rangeIndexMap)return this.rangeIndexMap=new Map,void(this.domainIndexMap=new Map);t&&!t.range||this.rangeIndexMap.clear(),t&&!t.domain&&!t.compare||(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new Wv(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;var{domain:t,compare:e}=this.options;return this.sortedDomain=e?[...t].sort(e):t,this.sortedDomain}}function Uv(t){const e=t["domain"];var n=e.length;if(0===n)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};const{range:i,paddingOuter:r,paddingInner:o,flex:a=[],round:s,align:u}=t;t=a,c=e.length;var l=0<(l=c-t.length)?[...t,...new Array(l).fill(1)]:l<0?t.slice(0,c):t,[c,t]=i,t=t-c,h=t/(2/n*r+1-1/n*o);const d=h*o/n;h-=n*d;const p=function(t){const e=Math.min(...t);return t.map(t=>t/e)}(l),f=h/p.reduce((t,e)=>t+e);l=new Map(e.map((t,e)=>{e=p[e]*f;return[t,s?Math.floor(e):e]}));const y=new Map(e.map((t,e)=>{e=p[e]*f+d;return[t,s?Math.floor(e):e]}));h=Array.from(y.values()).reduce((t,e)=>t+e),c+=(t-(h-h/n*o))*u;let v=s?Math.round(c):c;const g=new Array(n);for(let t=0;t<n;t+=1){g[t]=(m=v,Math.round(1e12*m)/1e12);var m=e[t];v+=y.get(m)}return{valueBandWidth:l,valueStep:y,adjustedRange:g}}class Yv extends Wv{constructor(t){super(t)}getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:void 0,flex:[]}}clone(){return new Yv(this.options)}getStep(t){return void 0===this.valueStep?1:void 0===t?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}getBandWidth(t){return void 0===this.valueBandWidth?1:void 0===t?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}getRange(){return this.adjustedRange}getPaddingInner(){var{padding:t,paddingInner:e}=this.options;return 0<t?t:e}getPaddingOuter(){var{padding:t,paddingOuter:e}=this.options;return 0<t?t:e}rescale(){super.rescale();var{align:t,domain:e,range:n,round:i,flex:r}=this.options,{adjustedRange:t,valueBandWidth:n,valueStep:i}=Uv({align:t,range:n,round:i,flex:r,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:e});this.valueStep=i,this.valueBandWidth=n,this.adjustedRange=t}}function qv(t,...e){return e.reduce((e,n)=>t=>e(n(t)),t)}function Xv(e,n){return n-e?t=>(t-e)/(n-e):t=>.5}function Kv(t,e,n,i,r){let o=n||0,a=i||t.length;const s=r||(t=>t);for(;o<a;){var u=Math.floor((o+a)/2);s(t[u])>e?a=u:o=u+1}return o}const Zv=Math.sqrt(50),$v=Math.sqrt(10),Jv=Math.sqrt(2);function Qv(t,e,n){e=(e-t)/Math.max(0,n),t=Math.floor(Math.log(e)/Math.LN10),n=e/10**t;return 0<=t?(n>=Zv?10:n>=$v?5:n>=Jv?2:1)*10**t:-(10**-t)/(n>=Zv?10:n>=$v?5:n>=Jv?2:1)}function tg(t,e,n){n=Math.abs(e-t)/Math.max(0,n);let i=10**Math.floor(Math.log(n)/Math.LN10);n/=i;return n>=Zv?i*=10:n>=$v?i*=5:n>=Jv&&(i*=2),e<t?-i:i}const eg=(t,e,n=5)=>{const i=[t,e];let r=0,o=i.length-1,a=i[r],s=i[o],u;return s<a&&([a,s]=[s,a],[r,o]=[o,r]),0<(u=Qv(a,s,n))?(a=Math.floor(a/u)*u,s=Math.ceil(s/u)*u,u=Qv(a,s,n)):u<0&&(a=Math.ceil(a*u)/u,s=Math.floor(s*u)/u,u=Qv(a,s,n)),0<u?(i[r]=Math.floor(a/u)*u,i[o]=Math.ceil(s/u)*u):u<0&&(i[r]=Math.ceil(a*u)/u,i[o]=Math.floor(s*u)/u),i},ng=36e5,ig=864e5,rg=7*ig;ig,ig;function og(t,n,s,i){const r=(t,e)=>{let n=e;for(;n&&i(t)%e!=0;)s(t,-1),--n;return t},u=(t,e)=>{e&&r(t,e),n(t)};const l=(t,e)=>{t=new Date(+t-1);return u(t,e),s(t,e),u(t),t};return{ceil:l,floor:(t,e)=>{t=new Date(+t);return u(t,e),t},range:(t,e,n,i)=>{const r=[];for(var o=Math.floor(n),a=i?l(t,n):l(t);+a<+e;s(a,o),u(a))r.push(new Date(+a));return r},duration:t}}var u=og(1,t=>t,(t,e=1)=>{t.setTime(+t+e)},t=>t.getTime()),o=og(1e3,t=>{t.setMilliseconds(0)},(t,e=1)=>{t.setTime(+t+1e3*e)},t=>t.getSeconds()),b=og(6e4,t=>{t.setSeconds(0,0)},(t,e=1)=>{t.setTime(+t+6e4*e)},t=>t.getMinutes()),r=og(ng,t=>{t.setMinutes(0,0,0)},(t,e=1)=>{t.setTime(+t+ng*e)},t=>t.getHours()),Vt=og(ig,t=>{t.setHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+ig*e)},t=>t.getDate()-1);const ag=og(2592e6,t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e=1)=>{var n=t.getMonth();t.setMonth(n+e)},t=>t.getMonth());re=og(rg,t=>{t.setDate(t.getDate()-t.getDay()%7),t.setHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+rg*e)},t=>{var e=ag.floor(t),t=new Date(+t);return Math.floor((+t-+e)/rg)}),c=og(31536e6,t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e=1)=>{var n=t.getFullYear();t.setFullYear(n+e)},t=>t.getFullYear());const sg={millisecond:u,second:o,minute:b,hour:r,day:Vt,week:re,month:ag,year:c};ve=og(1,t=>t,(t,e=1)=>{t.setTime(+t+e)},t=>t.getTime()),ge=og(1e3,t=>{t.setUTCMilliseconds(0)},(t,e=1)=>{t.setTime(+t+1e3*e)},t=>t.getUTCSeconds()),s=og(6e4,t=>{t.setUTCSeconds(0,0)},(t,e=1)=>{t.setTime(+t+6e4*e)},t=>t.getUTCMinutes()),Ht=og(ng,t=>{t.setUTCMinutes(0,0,0)},(t,e=1)=>{t.setTime(+t+ng*e)},t=>t.getUTCHours()),ne=og(ig,t=>{t.setUTCHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+ig*e)},t=>t.getUTCDate()-1);const ug=og(2592e6,t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e=1)=>{var n=t.getUTCMonth();t.setUTCMonth(n+e)},t=>t.getUTCMonth());p=og(rg,t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7)%7),t.setUTCHours(0,0,0,0)},(t,e=1)=>{t.setTime(+t+rg*e)},t=>{var e=ug.floor(t),t=new Date(+t);return Math.floor((+t-+e)/rg)}),Gt=og(31536e6,t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e=1)=>{var n=t.getUTCFullYear();t.setUTCFullYear(n+e)},t=>t.getUTCFullYear());const lg={millisecond:ve,second:ge,minute:s,hour:Ht,day:ne,week:p,month:ug,year:Gt};function cg(t,e,n,i,r){var t=+t,e=+e,{tickIntervals:r,year:o,millisecond:a}=function(t){var{year:t,month:e,week:n,day:i,hour:r,minute:o,second:a,millisecond:s}=t?lg:sg;return{tickIntervals:[[a,1],[a,5],[a,15],[a,30],[o,1],[o,5],[o,15],[o,30],[r,1],[r,3],[r,6],[r,12],[i,1],[i,2],[n,1],[e,1],[e,3],[t,1]],year:t,millisecond:s}}(r),s=([t,e])=>t.duration*e,n=i?(e-t)/i:n||5,u=i||(e-t)/n,l=r.length,c=Kv(r,u,0,l,s);let h;return h=c===l?[o,tg(t/o.duration,e/o.duration,n)]:c?([l,o]=u/s(r[c-1])<s(r[c])/u?r[c-1]:r[c],[l,i?Math.ceil(i/l.duration):o]):[a,Math.max(tg(t,e,n),1)]}const hg=(t,e,n,i,r)=>{var o=e<t,a=o?e:t,t=o?t:e;const[s,u]=cg(a,t,n,i,r),l=[s.floor(a,u),s.ceil(t,u)];return o?l.reverse():l};function dg(t){return!ut(t)&&!st(t)&&!Number.isNaN(t)}const pg=e=>t=>-e(-t),fg=(t,e)=>{const n=Math.log(t);t=t===Math.E?Math.log:t=>Math.log(t)/n;return e?pg(t):t},yg=(e,t)=>{var n=e===Math.E?Math.exp:t=>e**t;return t?pg(n):n},vg=(t,e,n,i)=>{var r=t<0;const o=fg(i,r),a=yg(i,r);i=e<t,r=i?t:e;const s=[a(Math.floor(o(i?e:t))),a(Math.ceil(o(r)))];return i?s.reverse():s};var gg,ie={exports:{}},me={exports:{}},mg=function(t){return!(!t||"string"==typeof t)&&(t instanceof Array||Array.isArray(t)||0<=t.length&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))},bg=Array.prototype.concat,kg=Array.prototype.slice,xg=me.exports=function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];mg(r)?e=bg.call(e,kg.call(r)):e.push(r)}return e},wg=(xg.wrap=function(t){return function(){return t(xg(arguments))}},{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),Sg=me.exports,Eg=Object.hasOwnProperty,Tg=Object.create(null);for(gg in wg)Eg.call(wg,gg)&&(Tg[wg[gg]]=gg);var _g=ie.exports={to:{},get:{}};function Mg(t,e,n){return Math.min(Math.max(e,t),n)}function Pg(t){t=Math.round(t).toString(16).toUpperCase();return t.length<2?"0"+t:t}_g.get=function(t){var e,n;switch(t.substring(0,3).toLowerCase()){case"hsl":e=_g.get.hsl(t),n="hsl";break;case"hwb":e=_g.get.hwb(t),n="hwb";break;default:e=_g.get.rgb(t),n="rgb"}return e?{model:n,value:e}:null},_g.get.rgb=function(t){if(!t)return null;var e,n,i,r=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=e[2],e=e[1],n=0;n<3;n++){var o=2*n;r[n]=parseInt(e.slice(o,2+o),16)}i&&(r[3]=parseInt(i,16)/255)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(i=(e=e[1])[3],n=0;n<3;n++)r[n]=parseInt(e[n]+e[n],16);i&&(r[3]=parseInt(i+i,16)/255)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)r[n]=parseInt(e[n+1],0);e[4]&&(e[5]?r[3]=.01*parseFloat(e[4]):r[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(e=t.match(/^(\w+)$/))?"transparent"===e[1]?[0,0,0,0]:Eg.call(wg,e[1])?((r=wg[e[1]])[3]=1,r):null:null;for(n=0;n<3;n++)r[n]=Math.round(2.55*parseFloat(e[n+1]));e[4]&&(e[5]?r[3]=.01*parseFloat(e[4]):r[3]=parseFloat(e[4]))}for(n=0;n<3;n++)r[n]=Mg(r[n],0,255);return r[3]=Mg(r[3],0,1),r},_g.get.hsl=function(t){if(!t)return null;var e,t=t.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);return t?(e=parseFloat(t[4]),[(parseFloat(t[1])%360+360)%360,Mg(parseFloat(t[2]),0,100),Mg(parseFloat(t[3]),0,100),Mg(isNaN(e)?1:e,0,1)]):null},_g.get.hwb=function(t){if(!t)return null;var e,t=t.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);return t?(e=parseFloat(t[4]),[(parseFloat(t[1])%360+360)%360,Mg(parseFloat(t[2]),0,100),Mg(parseFloat(t[3]),0,100),Mg(isNaN(e)?1:e,0,1)]):null},_g.to.hex=function(){var t=Sg(arguments);return"#"+Pg(t[0])+Pg(t[1])+Pg(t[2])+(t[3]<1?Pg(Math.round(255*t[3])):"")},_g.to.rgb=function(){var t=Sg(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},_g.to.rgb.percent=function(){var t=Sg(arguments),e=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),i=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+n+"%, "+i+"%)":"rgba("+e+"%, "+n+"%, "+i+"%, "+t[3]+")"},_g.to.hsl=function(){var t=Sg(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},_g.to.hwb=function(){var t=Sg(arguments),e="";return 4<=t.length&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},_g.to.keyword=function(t){return Tg[t.slice(0,3)]};var Og=ie.exports;function Cg(t,e,n){let i=n;return i<0&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function Ag(t){t=Og.get(t);if(!t)return null;var e,n,{model:t,value:i}=t;return"rgb"===t?i:"hsl"===t?(i=(t=i)[0]/360,e=t[1]/100,n=t[2]/100,t=t[3],0==e?[255*n,255*n,255*n,t]:[255*Cg(n=2*n-(e=n<.5?n*(1+e):n+e-n*e),e,i+1/3),255*Cg(n,e,i),255*Cg(n,e,i-1/3),t]):null}const Ng=(e,n)=>t=>e*(1-t)+n*t,Lg=(t,e)=>{{if("number"==typeof t&&"number"==typeof e)return Ng(t,e);if("string"!=typeof t||"string"!=typeof e)return()=>t;{var n=t,i=e;const u=Ag(n),l=Ag(i);return null===u||null===l?u?()=>n:()=>i:e=>{const n=new Array(4);for(let t=0;t<4;t+=1){var i=u[t],r=l[t];n[t]=i*(1-e)+r*e}var[t,o,a,s]=n;return`rgba(${Math.round(t)}, ${Math.round(o)}, ${Math.round(a)}, ${s})`}}}},Ig=(t,e)=>{const n=Ng(t,e);return t=>Math.round(n(t))};const Dg=(t,e,n)=>{let i,r,o=t,a=e;if(o===a&&0<n)return[o];let s=Qv(o,a,n);if(0===s||!Number.isFinite(s))return[];if(0<s){o=Math.ceil(o/s),a=Math.floor(a/s),r=new Array(i=Math.ceil(a-o+1));for(let t=0;t<i;t+=1)r[t]=(o+t)*s}else{s=-s,o=Math.ceil(o*s),a=Math.floor(a*s),r=new Array(i=Math.ceil(a-o+1));for(let t=0;t<i;t+=1)r[t]=(o+t)/s}return r};function Rg(t){return Math.abs(t)<1e-15?t:parseFloat(t.toFixed(15))}const jg=[1,5,2,2.5,4,3],Bg=100*Number.EPSILON;const Fg=(n,i,t=5,r=!0,o=jg,a=[.25,.2,.5,.05])=>{var s,u,l,c,h,d,p,f=t<0?0:Math.round(t);if(Number.isNaN(n)||Number.isNaN(i)||"number"!=typeof n||"number"!=typeof i||!f)return[];if(i-n<1e-15||1===f)return[n];const y={score:-2,lmin:0,lmax:0,lstep:0};let v=1;for(;v<1/0;){for(let t=0;t<o.length;t+=1){var g=o[t],m=(c=g,h=o,d=v,p=void 0,p=Tt(h),1-wt(h,c)/(p-1)-d+1);if(a[0]*m+a[1]+a[2]+a[3]<y.score){v=1/0;break}let e=2;for(;e<1/0;){k=e;var b=(l=f)<=k?2-(k-1)/(l-1):1;if(a[0]*m+a[1]+a[2]*b+a[3]<y.score)break;var k=(i-n)/(e+1)/v/g;let t=Math.ceil(Math.log10(k));for(;t<1/0;){var x=v*g*10**t,w=(E=i,w=x*(e-1),(E-=n)<w?1-((w-E)/2)**2/(.1*E)**2:1);if(a[0]*m+a[1]*w+a[2]*b+a[3]<y.score)break;var S=Math.floor(i/x)*v-(e-1)*v,E=Math.ceil(n/x)*v;if(S<=E){var T=E-S;for(let t=0;t<=T;t+=1){var _=(S+t)*(x/v),M=_+x*(e-1),P=x,O=function(t,e,n,i,r,o){var a=Tt(e),e=wt(e,t);let s=0;return t=(i%o+o)%o,1-e/(a-1)-n+(s=(t<Bg||o-t<Bg)&&i<=0&&0<=r?1:s)}(g,o,v,_,M,P),C=1-.5*((i-M)**2+(n-_)**2)/(.1*(i-n))**2,A=(s=e,A=n,s=(s-1)/(M-(N=_)),u=((u=f)-1)/(Math.max(M,i)-Math.min(A,N)),2-Math.max(s/u,u/s)),N=a[0]*O+a[1]*C+a[2]*A+ +a[3];N>y.score&&(!r||_<=n&&i<=M)&&(y.lmin=_,y.lmax=M,y.lstep=P,y.score=N)}}t+=1}e+=1}}v+=1}var t=Rg(y.lmax),e=Rg(y.lmin),L=Rg(y.lstep),I=Math.floor((t=(t-e)/L,Math.round(1e12*t)/1e12))+1;const D=new Array(I);D[0]=Rg(e);for(let t=1;t<I;t+=1)D[t]=Rg(D[t-1]+L);return D};class zg extends zv{getDefaultOptions(){return{domain:[0,1],range:[0,1],tickCount:5,unknown:void 0,tickMethod:Fg}}map(t){return dg(t)?t:this.options.unknown}invert(t){return this.map(t)}clone(){return new zg(this.options)}getTicks(){const{domain:t,tickCount:e,tickMethod:n}=this.options;var[i,r]=t;return et(i)&&et(r)?n(i,r,e):[]}}const Vg=(t,e,n)=>{var[t,i]=t,[e,r]=e;let o,a;return qv(a=t<i?(o=Xv(t,i),n(e,r)):(o=Xv(i,t),n(r,e)),o)},Hg=(i,t,e)=>{const r=Math.min(i.length,t.length)-1,o=new Array(r),a=new Array(r);var n=i[0]>i[r],s=n?[...i].reverse():i,u=n?[...t].reverse():t;for(let t=0;t<r;t+=1)o[t]=Xv(s[t],s[t+1]),a[t]=e(u[t],u[t+1]);return t=>{var e=Kv(i,t,1,r)-1,n=o[e];return qv(a[e],n)(t)}},Gg=(t,e,n,i)=>{const r=2<Math.min(t.length,e.length)?Hg:Vg;i=i?Ig:n;return r(t,e,i)};class Wg extends zv{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Ng,tickCount:5}}map(t){return dg(t)?this.output(t):this.options.unknown}invert(t){return dg(t)?this.input(t):this.options.unknown}nice(){var t,e,n,i;this.options.nice&&([t,e,n,...i]=this.getTickMethodOptions(),this.options.domain=this.chooseNice()(t,e,n,...i))}getTicks(){const t=this.options["tickMethod"];var[e,n,i,...r]=this.getTickMethodOptions();return t(e,n,i,...r)}getTickMethodOptions(){var{domain:t,tickCount:e}=this.options;return[t[0],t[t.length-1],e]}chooseNice(){return eg}rescale(){this.nice();var[t,e]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t)),this.composeInput(t,e,this.chooseClamp(e))}chooseClamp(t){var{clamp:e,range:n}=this.options,t=this.options.domain.map(t),n=Math.min(t.length,n.length);if(e){e=t[0],t=t[n-1];const i=t<e?t:e,r=t<e?e:t;return t=>Math.min(Math.max(i,t),r)}return kt}composeOutput(t,e){const{domain:n,range:i,round:r,interpolate:o}=this.options;var a=Gg(n.map(t),i,o,r);this.output=qv(a,e,t)}composeInput(t,e,n){const{domain:i,range:r}=this.options;t=Gg(r,i.map(t),Ng);this.input=qv(e,n,t)}}class Ug extends Wg{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:Lg,tickMethod:Dg,tickCount:5}}chooseTransforms(){return[kt,kt]}clone(){return new Ug(this.options)}}class Yg extends Yv{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:void 0,paddingInner:1,paddingOuter:0}}constructor(t){super(t)}getPaddingInner(){return 1}clone(){return new Yg(this.options)}update(t){super.update(t)}getPaddingOuter(){return this.options.padding}}const qg=t=>t<0?-Math.sqrt(-t):Math.sqrt(t);class Xg extends Wg{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,exponent:2,interpolate:Lg,tickMethod:Dg,tickCount:5}}constructor(t){super(t)}chooseTransforms(){var t=this.options["exponent"];if(1===t)return[kt,kt];var e,n,i=.5===t?qg:(e=t,t=>t<0?-((-t)**e):t**e);return n=t,[i,t=>t<0?-((-t)**(1/n)):t**(1/n)]}clone(){return new Xg(this.options)}}class Kg extends zv{constructor(t){super(t)}getDefaultOptions(){return{domain:[.5],range:[0,1]}}map(t){if(!dg(t))return this.options.unknown;t=Kv(this.thresholds,t,0,this.n);return this.options.range[t]}invert(t){const e=this.options["range"];var t=e.indexOf(t),n=this.thresholds;return[n[t-1],n[t]]}clone(){return new Kg(this.options)}rescale(){var{domain:t,range:e}=this.options;this.n=Math.min(t.length,e.length-1),this.thresholds=t}}const Zg=(t,e,n,i=10)=>{var r=t<0;const o=yg(i,r),a=fg(i,r);var s=e<t,u=s?e:t,l=s?t:e;let c=a(u),h=a(l),d=[];if(!(i%1)&&h-c<n){if(c=Math.floor(c),h=Math.ceil(h),r)for(;c<=h;c+=1){var p=o(c);for(let t=i-1;1<=t;--t){var f=p*t;if(l<f)break;u<=f&&d.push(f)}}else for(;c<=h;c+=1){var y=o(c);for(let t=1;t<i;t+=1){var v=y*t;if(l<v)break;u<=v&&d.push(v)}}2*d.length<n&&(d=Dg(u,l,n))}else d=Dg(c,h,Math.min(h-c,n)).map(o);return s?d.reverse():d};class $g extends Wg{getDefaultOptions(){return{domain:[1,10],range:[0,1],base:10,interpolate:Lg,tickMethod:Zg,tickCount:5}}chooseNice(){return vg}getTickMethodOptions(){var{domain:t,tickCount:e,base:n}=this.options;return[t[0],t[t.length-1],e,n]}chooseTransforms(){var{base:t,domain:e}=this.options,e=e[0]<0;return[fg(t,e),yg(t,e)]}clone(){return new $g(this.options)}}class Jg extends Kg{getDefaultOptions(){return{domain:[0,1],range:[.5],nice:!1,tickCount:5,tickMethod:Fg}}constructor(t){super(t)}nice(){var t,e,n=this.options["nice"];n&&([n,t,e]=this.getTickMethodOptions(),this.options.domain=eg(n,t,e))}getTicks(){const t=this.options["tickMethod"];var[e,n,i]=this.getTickMethodOptions();return t(e,n,i)}getTickMethodOptions(){var{domain:t,tickCount:e}=this.options;return[t[0],t[t.length-1],e]}rescale(){this.nice();var{range:t,domain:e}=this.options,[n,i]=e;this.n=t.length-1,this.thresholds=new Array(this.n);for(let t=0;t<this.n;t+=1)this.thresholds[t]=((t+1)*i-(t-this.n)*n)/(this.n+1)}invert(t){var[t,e]=super.invert(t),[n,i]=this.options.domain;return void 0===t&&void 0===e?[t,e]:[t||n,e||i]}getThresholds(){return this.thresholds}clone(){return new Jg(this.options)}}function Qg(t,e,n){const i=t,r=(n||i.sort((t,e)=>t-e),[]);for(let t=1;t<e;t+=1)r.push(function(t,e){if(n=t.length){if(n<2)return t[n-1];var n=(n-1)*e,e=Math.floor(n),i=t[e];return i+(t[e+1]-i)*(n-e)}}(i,t/e));return r}class t0 extends Kg{getDefaultOptions(){return{domain:[],range:[],tickCount:5,unknown:void 0,tickMethod:Fg}}constructor(t){super(t)}rescale(){var{domain:t,range:e}=this.options;this.n=e.length-1,this.thresholds=Qg(t,this.n+1,!1)}invert(t){var[t,e]=super.invert(t),n=this.options["domain"],i=n[0],n=n[n.length-1];return void 0===t&&void 0===e?[t,e]:[t||i,e||n]}getThresholds(){return this.thresholds}clone(){return new t0(this.options)}getTicks(){const{tickCount:t,domain:e,tickMethod:n}=this.options;var i=e.length-1,r=e[0],i=e[i];return n(r,i,t)}}var e0=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,n0=/\[([^]*?)\]/gm;function i0(t,e){for(var n=[],i=0,r=t.length;i<r;i++)n.push(t[i].substr(0,e));return n}function r0(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0,r=e;i<r.length;i++){var o,a=r[i];for(o in a)t[o]=a[o]}return t}function o0(t,e){for(void 0===e&&(e=2),t=String(t);t.length<e;)t="0"+t;return t}var a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=["January","February","March","April","May","June","July","August","September","October","November","December"],ce=i0(l,3),a0=r0({},{dayNamesShort:i0(a,3),dayNames:a,monthNamesShort:ce,monthNames:l,amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][3<t%10?0:(t-t%10!=10?1:0)*t%10]}}),s0={D:function(t){return String(t.getDate())},DD:function(t){return o0(t.getDate())},Do:function(t,e){return e.DoFn(t.getDate())},d:function(t){return String(t.getDay())},dd:function(t){return o0(t.getDay())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return String(t.getMonth()+1)},MM:function(t){return o0(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},YY:function(t){return o0(String(t.getFullYear()),4).substr(2)},YYYY:function(t){return o0(t.getFullYear(),4)},h:function(t){return String(t.getHours()%12||12)},hh:function(t){return o0(t.getHours()%12||12)},H:function(t){return String(t.getHours())},HH:function(t){return o0(t.getHours())},m:function(t){return String(t.getMinutes())},mm:function(t){return o0(t.getMinutes())},s:function(t){return String(t.getSeconds())},ss:function(t){return o0(t.getSeconds())},S:function(t){return String(Math.round(t.getMilliseconds()/100))},SS:function(t){return o0(Math.round(t.getMilliseconds()/10),2)},SSS:function(t){return o0(t.getMilliseconds(),3)},a:function(t,e){return t.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(t,e){return(t.getHours()<12?e.amPm[0]:e.amPm[1]).toUpperCase()},ZZ:function(t){t=t.getTimezoneOffset();return(0<t?"-":"+")+o0(100*Math.floor(Math.abs(t)/60)+Math.abs(t)%60,4)},Z:function(t){t=t.getTimezoneOffset();return(0<t?"-":"+")+o0(Math.floor(Math.abs(t)/60),2)+":"+o0(Math.abs(t)%60,2)}},u0={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"};const l0=(t,e,n,i,r)=>{var o=e<t,a=o?e:t,t=o?t:e;const[s,u]=cg(a,t,n,i,r),l=s.range(a,new Date(+t+1),u,!0);return o?l.reverse():l};function c0(t){var e=t.getTimezoneOffset();const n=new Date(t);return n.setMinutes(n.getMinutes()+e,n.getSeconds(),n.getMilliseconds()),n}class h0 extends Wg{getDefaultOptions(){return{domain:[new Date(2e3,0,1),new Date(2e3,0,2)],range:[0,1],nice:!1,tickCount:5,tickInterval:void 0,unknown:void 0,clamp:!1,tickMethod:l0,interpolate:Ng,mask:void 0,utc:!1}}chooseTransforms(){return[t=>+t,t=>new Date(t)]}chooseNice(){return hg}getTickMethodOptions(){var{domain:t,tickCount:e,tickInterval:n,utc:i}=this.options;return[t[0],t[t.length-1],e,n,i]}getFormatter(){const{mask:o,utc:t}=this.options,a=t?lg:sg,s=t?c0:kt;return t=>{var e=s(t),t=o||function(t,e){const{second:n,minute:i,hour:r,day:o,week:a,month:s,year:u}=e;return n.floor(t)<t?".SSS":i.floor(t)<t?":ss":r.floor(t)<t?"hh:mm":o.floor(t)<t?"hh A":s.floor(t)<t?a.floor(t)<t?"MMM DD":"ddd DD":u.floor(t)<t?"MMMM":"YYYY"}(t,a),n=void 0;if(void 0===t&&(t=u0.default),void 0===n&&(n={}),"number"==typeof e&&(e=new Date(e)),"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))throw new Error("Invalid Date pass to format");var i=[],r=(t=(t=u0[t]||t).replace(n0,function(t,e){return i.push(e),"@@@"}),r0(r0({},a0),n));return(t=t.replace(e0,function(t){return s0[t](e,r)})).replace(/@@@/g,function(){return i.shift()})}}clone(){return new h0(this.options)}}const d0=t=>new Yv(t),p0=(d0.props={},t=>new Ug(t)),f0=(p0.props={},t=>new Wv(t)),y0=(f0.props={},t=>new zg(t)),v0=(y0.props={},t=>new Yg(t)),g0=(v0.props={},t=>new h0(t)),m0=(g0.props={},t=>new $g(t)),b0=(m0.props={},t=>new Xg(t)),k0=(b0.props={},t=>new Kg(t)),x0=(k0.props={},t=>new t0(t)),w0=(x0.props={},t=>new Jg(t)),S0=(w0.props={},Math.PI),E0=2*S0,T0=1e-6,_0=E0-T0;function M0(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function P0(){return new M0}function O0(t){return function(){return t}}M0.prototype=P0.prototype={constructor:M0,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){var o,a,s=this._x1,u=this._y1,l=(n=+n)-(t=+t),c=(i=+i)-(e=+e),h=s-t,d=u-e,p=h*h+d*d;if((r=+r)<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+(this._x1=t)+","+(this._y1=e):p>T0&&(Math.abs(d*l-c*h)>T0&&r?(a=l*l+c*c,i=(n=n-s)*n+(s=i-u)*s,u=Math.sqrt(a),o=Math.sqrt(p),p=(a=r*Math.tan((S0-Math.acos((a+p-i)/(2*u*o)))/2))/o,i=a/u,Math.abs(p-1)>T0&&(this._+="L"+(t+p*h)+","+(e+p*d)),this._+="A"+r+","+r+",0,0,"+ +(h*s<d*n)+","+(this._x1=t+i*l)+","+(this._y1=e+i*c)):this._+="L"+(this._x1=t)+","+(this._y1=e))},arc:function(t,e,n,i,r,o){t=+t,e=+e,o=!!o;var a=(n=+n)*Math.cos(i),s=n*Math.sin(i),u=t+a,l=e+s,c=1^o,o=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>T0||Math.abs(this._y1-l)>T0)&&(this._+="L"+u+","+l),n&&((o=o<0?o%E0+E0:o)>_0?this._+="A"+n+","+n+",0,1,"+c+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):o>T0&&(this._+="A"+n+","+n+",0,"+ +(o>=S0)+","+c+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const C0=Math.abs,A0=Math.atan2,N0=Math.cos,L0=Math.max,I0=Math.min,D0=Math.sin,R0=Math.sqrt,j0=1e-12,B0=Math.PI,F0=B0/2,z0=2*B0;function V0(t){return 1<=t?F0:t<=-1?-F0:Math.asin(t)}function H0(t){return t.innerRadius}function G0(t){return t.outerRadius}function W0(t){return t.startAngle}function U0(t){return t.endAngle}function Y0(t){return t&&t.padAngle}function q0(t,e,n,i,r,o,a){var s=t-n,u=e-i,a=(a?o:-o)/R0(s*s+u*u),u=a*u,a=-a*s,s=t+u,t=e+a,e=n+u,n=i+a,i=(s+e)/2,l=(t+n)/2,c=e-s,h=n-t,d=c*c+h*h,o=r-o,s=s*n-e*t,n=(h<0?-1:1)*R0(L0(0,o*o*d-s*s)),e=(s*h-c*n)/d,t=(-s*c-h*n)/d,p=(s*h+c*n)/d,s=(-s*c+h*n)/d,c=e-i,h=t-l,n=p-i,d=s-l;return n*n+d*d<c*c+h*h&&(e=p,t=s),{cx:e,cy:t,x01:-u,y01:-a,x11:e*(r/o-1),y11:t*(r/o-1)}}function X0(){var P=H0,O=G0,C=O0(0),A=null,N=W0,L=U0,I=Y0,D=null;function e(){var t,e,n,i,r,o,a,s,u,l,c,h,d,p,f,y,v,g,m,b,k,x,w=+P.apply(this,arguments),S=+O.apply(this,arguments),E=N.apply(this,arguments)-F0,T=L.apply(this,arguments)-F0,_=C0(T-E),M=E<T;if(D=D||(t=P0()),S<w&&(e=S,S=w,w=e),S>j0?_>z0-j0?(D.moveTo(S*N0(E),S*D0(E)),D.arc(0,0,S,E,T,!M),w>j0&&(D.moveTo(w*N0(T),w*D0(T)),D.arc(0,0,w,T,E,M))):(i=e=E,r=n=T,a=o=_,d=(c=I.apply(this,arguments)/2)>j0&&(A?+A.apply(this,arguments):R0(w*w+S*S)),x=k=s=I0(C0(S-w)/2,+C.apply(this,arguments)),d>j0&&(h=V0(d/w*D0(c)),d=V0(d/S*D0(c)),(o-=2*h)>j0?(i+=h*=M?1:-1,r-=h):(o=0,i=r=(E+T)/2),(a-=2*d)>j0?(e+=d*=M?1:-1,n-=d):(a=0,e=n=(E+T)/2)),c=S*N0(e),h=S*D0(e),d=w*N0(r),E=w*D0(r),s>j0&&(p=S*N0(n),f=S*D0(n),y=w*N0(i),v=w*D0(i),_<B0&&(T=function(t,e,n,i,r,o,a,s){var u=(s=s-o)*(n=n-t)-(a=a-r)*(i=i-e);if(!(u*u<j0))return[t+(u=(a*(e-o)-s*(t-r))/u)*n,e+u*i]}(c,h,y,v,p,f,d,E))&&(_=c-T[0],m=h-T[1],b=p-T[0],g=f-T[1],m=1/D0((1<(_=(_*b+m*g)/(R0(_*_+m*m)*R0(b*b+g*g)))?0:_<-1?B0:Math.acos(_))/2),b=R0(T[0]*T[0]+T[1]*T[1]),k=I0(s,(w-b)/(m-1)),x=I0(s,(S-b)/(1+m)))),a>j0?x>j0?(u=q0(y,v,c,h,S,x,M),l=q0(p,f,d,E,S,x,M),D.moveTo(u.cx+u.x01,u.cy+u.y01),x<s?D.arc(u.cx,u.cy,x,A0(u.y01,u.x01),A0(l.y01,l.x01),!M):(D.arc(u.cx,u.cy,x,A0(u.y01,u.x01),A0(u.y11,u.x11),!M),D.arc(0,0,S,A0(u.cy+u.y11,u.cx+u.x11),A0(l.cy+l.y11,l.cx+l.x11),!M),D.arc(l.cx,l.cy,x,A0(l.y11,l.x11),A0(l.y01,l.x01),!M))):(D.moveTo(c,h),D.arc(0,0,S,e,n,!M)):D.moveTo(c,h),w>j0&&o>j0?k>j0?(u=q0(d,E,p,f,w,-k,M),l=q0(c,h,y,v,w,-k,M),D.lineTo(u.cx+u.x01,u.cy+u.y01),k<s?D.arc(u.cx,u.cy,k,A0(u.y01,u.x01),A0(l.y01,l.x01),!M):(D.arc(u.cx,u.cy,k,A0(u.y01,u.x01),A0(u.y11,u.x11),!M),D.arc(0,0,w,A0(u.cy+u.y11,u.cx+u.x11),A0(l.cy+l.y11,l.cx+l.x11),M),D.arc(l.cx,l.cy,k,A0(l.y11,l.x11),A0(l.y01,l.x01),!M))):D.arc(0,0,w,r,i,M):D.lineTo(d,E)):D.moveTo(0,0),D.closePath(),t)return D=null,t+""||null}return e.centroid=function(){var t=(+P.apply(this,arguments)+ +O.apply(this,arguments))/2,e=(+N.apply(this,arguments)+ +L.apply(this,arguments))/2-B0/2;return[N0(e)*t,D0(e)*t]},e.innerRadius=function(t){return arguments.length?(P="function"==typeof t?t:O0(+t),e):P},e.outerRadius=function(t){return arguments.length?(O="function"==typeof t?t:O0(+t),e):O},e.cornerRadius=function(t){return arguments.length?(C="function"==typeof t?t:O0(+t),e):C},e.padRadius=function(t){return arguments.length?(A=null==t?null:"function"==typeof t?t:O0(+t),e):A},e.startAngle=function(t){return arguments.length?(N="function"==typeof t?t:O0(+t),e):N},e.endAngle=function(t){return arguments.length?(L="function"==typeof t?t:O0(+t),e):L},e.padAngle=function(t){return arguments.length?(I="function"==typeof t?t:O0(+t),e):I},e.context=function(t){return arguments.length?(D=null==t?null:t,e):D},e}function K0(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Z0(t){this._context=t}function $0(t){return new Z0(t)}function J0(t){return t[0]}function Q0(t){return t[1]}function tm(a,s){var u=O0(!0),l=null,c=$0,h=null;function e(t){var e,n,i,r=(t=K0(t)).length,o=!1;for(null==l&&(h=c(i=P0())),e=0;e<=r;++e)!(e<r&&u(n=t[e],e,t))===o&&((o=!o)?h.lineStart():h.lineEnd()),o&&h.point(+a(n,e,t),+s(n,e,t));if(i)return h=null,i+""||null}return a="function"==typeof a?a:void 0===a?J0:O0(a),s="function"==typeof s?s:void 0===s?Q0:O0(s),e.x=function(t){return arguments.length?(a="function"==typeof t?t:O0(+t),e):a},e.y=function(t){return arguments.length?(s="function"==typeof t?t:O0(+t),e):s},e.defined=function(t){return arguments.length?(u="function"==typeof t?t:O0(!!t),e):u},e.curve=function(t){return arguments.length?(c=t,null!=l&&(h=c(l)),e):c},e.context=function(t){return arguments.length?(null==t?l=h=null:h=c(l=t),e):l},e}function em(c,h,d){var p=null,f=O0(!0),y=null,v=$0,g=null;function e(t){var e,n,i,r,o,a=(t=K0(t)).length,s=!1,u=new Array(a),l=new Array(a);for(null==y&&(g=v(o=P0())),e=0;e<=a;++e){if(!(e<a&&f(r=t[e],e,t))===s)if(s=!s)n=e,g.areaStart(),g.lineStart();else{for(g.lineEnd(),g.lineStart(),i=e-1;n<=i;--i)g.point(u[i],l[i]);g.lineEnd(),g.areaEnd()}s&&(u[e]=+c(r,e,t),l[e]=+h(r,e,t),g.point(p?+p(r,e,t):u[e],d?+d(r,e,t):l[e]))}if(o)return g=null,o+""||null}function t(){return tm().defined(f).curve(v).context(y)}return c="function"==typeof c?c:void 0===c?J0:O0(+c),h="function"==typeof h?h:O0(void 0===h?0:+h),d="function"==typeof d?d:void 0===d?Q0:O0(+d),e.x=function(t){return arguments.length?(c="function"==typeof t?t:O0(+t),p=null,e):c},e.x0=function(t){return arguments.length?(c="function"==typeof t?t:O0(+t),e):c},e.x1=function(t){return arguments.length?(p=null==t?null:"function"==typeof t?t:O0(+t),e):p},e.y=function(t){return arguments.length?(h="function"==typeof t?t:O0(+t),d=null,e):h},e.y0=function(t){return arguments.length?(h="function"==typeof t?t:O0(+t),e):h},e.y1=function(t){return arguments.length?(d=null==t?null:"function"==typeof t?t:O0(+t),e):d},e.lineX0=e.lineY0=function(){return t().x(c).y(h)},e.lineY1=function(){return t().x(c).y(d)},e.lineX1=function(){return t().x(p).y(h)},e.defined=function(t){return arguments.length?(f="function"==typeof t?t:O0(!!t),e):f},e.curve=function(t){return arguments.length?(v=t,null!=y&&(g=v(y)),e):v},e.context=function(t){return arguments.length?(null==t?y=g=null:g=v(y=t),e):y},e}Z0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var nm=rm($0);function im(t){this._curve=t}function rm(e){function t(t){return new im(e(t))}return t._curve=e,t}function om(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(rm(t)):e()._curve},t}function am(){}function sm(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function um(t,e){this._context=t,this._k=(1-e)/6}function lm(t,e){this._context=t,this._k=(1-e)/6}function cm(t,e,n){var i,r,o=t._x1,a=t._y1,s=t._x2,u=t._y2;t._l01_a>j0&&(i=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,r=3*t._l01_a*(t._l01_a+t._l12_a),o=(o*i-t._x0*t._l12_2a+t._x2*t._l01_2a)/r,a=(a*i-t._y0*t._l12_2a+t._y2*t._l01_2a)/r),t._l23_a>j0&&(i=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,r=3*t._l23_a*(t._l23_a+t._l12_a),s=(s*i+t._x1*t._l23_2a-e*t._l12_2a)/r,u=(u*i+t._y1*t._l23_2a-n*t._l12_2a)/r),t._context.bezierCurveTo(o,a,s,u,t._x2,t._y2)}function hm(t,e){this._context=t,this._alpha=e}im.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}},um.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:sm(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:sm(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function e(n){function t(t){return new um(t,n)}return t.tension=function(t){return e(+t)},t}(0),lm.prototype={areaStart:am,areaEnd:am,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:sm(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function e(n){function t(t){return new lm(t,n)}return t.tension=function(t){return e(+t)},t}(0),hm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n,i;switch(t=+t,e=+e,this._point&&(n=this._x2-t,i=this._y2-e,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))),this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:cm(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var dm=function e(n){function t(t){return n?new hm(t,n):new um(t,0)}return t.alpha=function(t){return e(+t)},t}(.5);function pm(t,e){this._context=t,this._alpha=e}pm.prototype={areaStart:am,areaEnd:am,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){var n,i;switch(t=+t,e=+e,this._point&&(n=this._x2-t,i=this._y2-e,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))),this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:cm(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var fm=function e(n){function t(t){return n?new pm(t,n):new lm(t,0)}return t.alpha=function(t){return e(+t)},t}(.5);function ym(t){this._context=t}function vm(t){return new ym(t)}function gm(t,e){this._context=t,this._t=e}function mm(t){return new gm(t,.5)}function bm(t){return new gm(t,0)}function km(t){return new gm(t,1)}function xm([t,e],[n,i]){return[t-n,e-i]}function wm([t,e],[n,i]){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-i,2))}function Sm([t,e]){return Math.atan2(e,t)}function Em(t){let e=1/0,n=-1/0,i=1/0,r=-1/0;for(var[o,a]of t)e=Math.min(o,e),n=Math.max(o,n),i=Math.min(a,i),r=Math.max(a,r);var t=n-e,s=r-i;return[e,i,t,s]}function Tm(t){return t}function _m(t){return t.reduce((n,i)=>e=>F(this,void 0,void 0,function*(){var t=yield n(e);return i(t)}),Tm)}function Mm(t=""){throw new Error(t)}function Pm(t){return null!=t&&!Number.isNaN(t)}function Om(t,e){return t+(e-t)*Math.random()}function Cm(t){return new Am([t],null,t,t.ownerDocument)}ym.prototype={areaStart:am,areaEnd:am,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},gm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:var n;this._t<=0?(this._context.lineTo(this._x,e),this._context.lineTo(t,e)):(n=this._x*(1-this._t)+t*this._t,this._context.lineTo(n,this._y),this._context.lineTo(n,e))}this._x=t,this._y=e}};class Am{constructor(t=null,e=null,n=null,i=null,r=[null,null,null]){this._elements=t,this._data=e,this._parent=n,this._document=i,this._enter=r[0],this._update=r[1],this._exit=r[2]}selectAll(t){t="string"==typeof t?this._parent.querySelectorAll(t):t;return new Am(t,null,this._elements[0],this._document)}select(t){t="string"==typeof t?this._parent.querySelectorAll(t)[0]||null:t;return new Am([t],null,t,this._document)}append(t){const e=t=>{if(this._document)return this._document.createElement(t,{});const e=Am.registry[t];return e?new e:Mm("Unknown node type: "+t)},n="function"==typeof t?t:()=>e(t),i=[];if(null!==this._data){for(let t=0;t<this._data.length;t++){var r=this._data[t];const a=n(r,t);a.__data__=r,this._parent.appendChild(a),i.push(a)}return new Am(i,null,this._parent,this._document)}for(let t=0;t<this._elements.length;t++){const s=this._elements[t];var o=s.__data__,o=n(o,t);s.appendChild(o),i.push(o)}return new Am(i,null,i[0],this._document)}data(e,n=t=>t){const i=[],r=[],o=new Map(this._elements.map((t,e)=>[n(t.__data__,e),t]));for(let t=0;t<e.length;t++){var a=e[t],s=n(a,t);if(o.has(s)){const u=o.get(s);u.__data__=a,r.push(u),o.delete(s)}else i.push(a)}var t=Array.from(o.values()),t=[new Am([],i,this._parent,this._document),new Am(r,null,this._parent,this._document),new Am(t,null,this._parent,this._document)];return new Am(this._elements,null,this._parent,this._document,t)}merge(t){t=[...this._elements,...t._elements];return new Am(t,null,this._parent,this._document)}join(t=t=>t,e=t=>t,n=t=>t.remove()){t=t(this._enter);const i=e(this._update);e=n(this._exit);return i.merge(t).merge(e)}remove(){const t=[...this._elements];for(const n of this._elements){var e;n.parentNode&&(n.parentNode.removeChild(n),e=t.indexOf(n),t.splice(e,1))}return new Am(t,null,this._parent,this._document)}each(e){for(let t=0;t<this._elements.length;t++){var n=this._elements[t],i=n.__data__;e.call(n,i,t)}return this}attr(n,i){const r="function"!=typeof i?()=>i:i;return this.each(function(t,e){void 0!==i&&(this[n]=r.call(this,t,e))}),this}style(n,i){const r="function"!=typeof i?()=>i:i;return this.each(function(t,e){void 0!==i&&(this.style[n]=r.call(this,t,e))}),this}on(t,e){return this.each(function(){this.addEventListener(t,e)}),this}call(t,...e){return t.call(this._parent,this,...e),this}node(){return this._elements[0]}nodes(){return this._elements}}function Nm(t,e){for(var[n,i]of Object.entries(e))t.style(n,i)}Am.registry={g:xh,rect:Lh,circle:gh,path:Mh,text:Dh,ellipse:bh,image:Sh,line:Th,polygon:Oh,polyline:Ah,html:jh};const Lm=t=>{const h=t["colorAttribute"],d=_(t,["colorAttribute"]),p="stroke"===h?2:void 0;return(t,e,n,i)=>{var{radius:r=0}=d,i=i["defaultColor"],{color:e=i}=e,[i,t,o,a]=kv(n)?function(t){var[t,e,n,i]=t;return[i,t,e,n]}(t):t;if(!xv(n))return[s,u]=i,[o,l]=xm(o,i),s=0<o?s:s+o,u=0<l?u:u+l,o=Math.abs(o),l=Math.abs(l),Cm(new Lh({})).style("lineWidth",p).style("x",s).style("y",u).style("width",o).style("height",l).style("stroke",e).style(h,e).call(Nm,d).node();var s=n.getCenter(),u=Sm(xm(i,s)),o=Sm(xm(t,s)),l={startAngle:u,endAngle:0<=o-u?o:2*Math.PI+o,innerRadius:wm(a,s),outerRadius:wm(i,s)};const c=X0().cornerRadius(r);return Cm(new Mh({})).style("path",c(l)).style("transform",`translate(${s[0]}, ${s[1]})`).style("stroke",e).style(h,e).call(Nm,d).node()}},Im=(Lm.props={defaultEnterAnimation:"scaleInY"},t=>Lm(Object.assign({colorAttribute:"fill"},t))),Dm=(Im.props=Object.assign({},Lm.props),t=>Lm(Object.assign({colorAttribute:"stroke"},t))),Rm=(Dm.props=Object.assign({},Lm.props),t=>{const a=t["curve"],s=_(t,["curve"]);return(t,e,n,i)=>{var{defaultColor:i,defaultSize:r}=i,{color:e=i,size:i=r,transform:r}=e,n=xv(n)?[...t,t[0]]:t;const o=tm().x(t=>t[0]).y(t=>t[1]).curve(a);return Cm(new Mh({})).style("d",o(n)).style("stroke",e).style("lineWidth",i).style("transform",r).call(Nm,s).node()}}),jm=(Rm.props={defaultEnterAnimation:"fadeIn"},t=>Rm(Object.assign({curve:$0},t))),Bm=(jm.props=Object.assign({},Rm.props),t=>{var{alpha:e=.5}=t,t=_(t,["alpha"]);return Rm(Object.assign({curve:dm.alpha(e)},t))}),Fm=(Bm.props=Object.assign({},Rm.props),t=>Rm(Object.assign({curve:km},t))),zm=(Fm.props=Object.assign({},Rm.props),t=>Rm(Object.assign({curve:bm},t))),Vm=(zm.props=Object.assign({},Rm.props),t=>Rm(Object.assign({curve:mm},t)));function Hm(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]}Vm.props=Object.assign({},Rm.props);var Gm=Object.freeze({__proto__:null,point:Hm,square:function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]},diamond:function(t,e,n){return[["M",t-n,e],["L",t,e-n],["L",t+n,e],["L",t,e+n],["Z"]]},triangle:function(t,e,n){var i=n*Math.sin(1/3*Math.PI);return[["M",t-n,e+i],["L",t,e-i],["L",t+n,e+i],["Z"]]},triangleDown:function(t,e,n){var i=n*Math.sin(1/3*Math.PI);return[["M",t-n,e-i],["L",t+n,e-i],["L",t,e+i],["Z"]]},hexagon:function(t,e,n){var i=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+i,e-n/2],["L",t+i,e+n/2],["L",t,e+n],["L",t-i,e+n/2],["L",t-i,e-n/2],["Z"]]},bowtie:function(t,e,n){var i=n-1.5;return[["M",t-n,e-i],["L",t+n,e+i],["L",t+n,e-i],["L",t-n,e+i],["Z"]]},line:function(t,e,n){return[["M",t,e+n],["L",t,e-n]]},cross:function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]},tick:function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]},plus:function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]},hyphen:function(t,e,n){return[["M",t-n,e],["L",t+n,e]]}});function Wm(t,e,n,i){var r,n=n["size"];return"fixed"!==t&&("normal"===t||function(t){const e=t.getOptions()["transformations"];return e.some(([t])=>"fisheye"===t)}(i))?([[t,i],[e,r]]=e,e=Math.abs((e-t)/2),t=Math.abs((r-i)/2),Math.max(0,(e+t)/2)):n}const k=t=>{const{colorAttribute:s,symbol:e,mode:u="auto"}=t,l=_(t,["colorAttribute","symbol","mode"]),c="stroke"===s?1:void 0,h=Gm[e]||Hm;return(t,e,n,i)=>{var i=i["defaultColor"],{color:i=i,transform:r}=e,[o,a]=function(t){var[[t,e],[n,i]]=t;return[(t+n)/2,(e+i)/2]}(t),t=Wm(u,t,e,n);return Cm(new Mh({})).style("d",h(o,a,t)).style("lineWidth",c).style("stroke",i).style("transform",r).style(s,i).call(Nm,l).node()}},Um=(k.props={defaultEnterAnimation:"fadeIn"},t=>k(Object.assign({colorAttribute:"fill",symbol:"bowtie"},t))),Ym=(Um.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"cross"},t))),qm=(Ym.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"fill",symbol:"diamond"},t))),Xm=(qm.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"fill",symbol:"hexagon"},t))),Km=(Xm.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"bowtie"},t))),Zm=(Km.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"diamond"},t))),$m=(Zm.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"hexagon"},t))),Jm=($m.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"point"},t))),Qm=(Jm.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"square"},t))),t1=(Qm.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"triangle"},t))),e1=(t1.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"triangle-down"},t))),n1=(e1.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"hyphen"},t))),i1=(n1.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"line"},t))),r1=(i1.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"plus"},t))),o1=(r1.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"fill",symbol:"point"},t))),a1=(o1.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"fill",symbol:"square"},t))),s1=(a1.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"stroke",symbol:"tick"},t))),u1=(s1.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"fill",symbol:"triangle"},t))),l1=(u1.props=Object.assign({},k.props),t=>k(Object.assign({colorAttribute:"fill",symbol:"triangle-down"},t))),c1=(l1.props=Object.assign({},k.props),t=>{const u=_(t,[]);return(t,e,n,i)=>{var i=i["defaultColor"],{color:e=i,text:i="",fontSize:r=14,rotate:o=0,transform:a=""}=e,[[t,s]]=t;return Cm(new Dh).style("x",t).style("y",s).style("text",String(i)).style("stroke",e).style("fill",e).style("fontSize",r).style("transform",a+`rotate(${+o}deg)`).call(Nm,u).node()}});c1.props={defaultEnterAnimation:"fadeIn"};t(p1,h1=yh),p1.prototype.connectedCallback=function(){},p1.prototype.disconnectedCallback=function(){},p1.prototype.init=function(){},p1.prototype.clear=function(){},p1.prototype.destroy=function(){this.removeChildren(!0),this.parentNode&&this.parentNode.removeChild(this)},p1.tag="gui";var h1,d1,d=p1;function p1(){return null!==h1&&h1.apply(this,arguments)||this}function f1(t,e,n,i){this.message=t,this.expected=e,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,f1)}function y1(){this.constructor=d1}d1=f1,kn=Error,y1.prototype=kn.prototype,d1.prototype=new y1,f1.buildMessage=function(t,e){var o={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){for(var e="",n=0;n<t.parts.length;n++)e+=t.parts[n]instanceof Array?r(t.parts[n][0])+"-"+r(t.parts[n][1]):r(t.parts[n]);return"["+(t.inverted?"^":"")+e+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function r(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}return"Expected "+function(t){for(var e,n,i=new Array(t.length),r=0;r<t.length;r++)i[r]=(n=t[r],o[n.type](n));if(i.sort(),0<i.length){for(e=r=1;r<i.length;r++)i[r-1]!==i[r]&&(i[e]=i[r],e++);i.length=e}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+((t=e)?'"'+i(t)+'"':"end of input")+" found."};i=function(s,t){function R(){return D("Z")}function j(t,e){return D(t,e.map(function(t){return{x:t}}))}function B(t,e){return D(t,e.map(function(t){return{y:t}}))}function F(t,e,n){return{x1:t.x,y1:t.y,x2:e.x,y2:e.y,x:n.x,y:n.y}}function z(t,e){return{x2:t.x,y2:t.y,x:e.x,y:e.y}}function V(t,e){return{x1:t.x,y1:t.y,x:e.x,y:e.y}}function H(t,e,n,i,r,o){return{rx:t,ry:e,xAxisRotation:n,largeArc:i,sweep:r,x:o.x,y:o.y}}var u={},e={svg_path:_t},n=_t,G=function(t){if(!t)return[];for(var e=[],n=0;n<t.length;n++)e=e.concat.apply(e,t[n]);var i=e[0];return i&&"m"==i.code&&(delete i.relative,i.code="M"),e},a=function(t,e){var n=e;if(!n)return[t];for(var i=[t],r=0,o=n.length;r<o;r++)i[r+1]=n[r][1];return i},W=/^[Mm]/,U=m(["M","m"],!1,!1),Y=function(t,e,n){e=D(t,[e]);return e=n?e.concat(D("M"==t?"L":"l",n[1])):e},q=/^[Zz]/,X=m(["Z","z"],!1,!1),K=/^[Ll]/,Z=m(["L","l"],!1,!1),r=D,$=/^[Hh]/,J=m(["H","h"],!1,!1),Q=/^[Vv]/,tt=m(["V","v"],!1,!1),et=/^[Cc]/,nt=m(["C","c"],!1,!1),it=/^[Ss]/,rt=m(["S","s"],!1,!1),ot=/^[Qq]/,at=m(["Q","q"],!1,!1),st=/^[Tt]/,ut=m(["T","t"],!1,!1),lt=/^[Aa]/,ct=m(["A","a"],!1,!1),ht=function(t,e){return{x:t,y:e}},dt=function(t){return+t},pt=function(t){return+t.join("")},ft=/^[01]/,yt=m(["0","1"],!1,!1),vt=function(t){return"1"==t},o=function(){return""},gt=",",mt=g(",",!1),l=function(t){return t.join("")},c=".",h=g(".",!1),bt=/^[eE]/,kt=m(["e","E"],!1,!1),xt=/^[+\-]/,wt=m(["+","-"],!1,!1),i=/^[0-9]/,d=m([["0","9"]],!1,!1),St=function(t){return t.join("")},Et=/^[ \t\n\r]/,Tt=m([" ","\t","\n","\r"],!1,!1),p=0,f=[{line:1,column:1}],y=0,v=[];if("startRule"in(t=void 0!==t?t:{})){if(!(t.startRule in e))throw new Error("Can't start parsing from rule \""+t.startRule+'".');n=e[t.startRule]}function g(t,e){return{type:"literal",text:t,ignoreCase:e}}function m(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function b(t){var e,n=f[t];if(n)return n;for(e=t-1;!f[e];)e--;for(n={line:(n=f[e]).line,column:n.column};e<t;)10===s.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return f[t]=n}function k(t,e){var n=b(t),i=b(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:i.line,column:i.column}}}function x(t){p<y||(y<p&&(y=p,v=[]),v.push(t))}function _t(){for(var t,e,n=p,i=[],r=N();r!==u;)i.push(r),r=N();if(i!==u)if((r=(r=function(){var t,e,n,i,r,o;if(t=p,(e=w())!==u){for(n=[],i=p,r=[],o=N();o!==u;)r.push(o),o=N();for(i=r!==u?(o=w())!==u?r=[r,o]:(p=i,u):(p=i,u);i!==u;){for(n.push(i),i=p,r=[],o=N();o!==u;)r.push(o),o=N();i=r!==u?(o=w())!==u?r=[r,o]:(p=i,u):(p=i,u)}t=n!==u?e=a(e,n):(p=t,u)}else p=t,t=u;return t}())===u?null:r)!==u){for(t=[],e=N();e!==u;)t.push(e),e=N();n=t!==u?i=G(r):(p=n,u)}else p=n,n=u;else p=n,n=u;return n}function w(){var t,e,n,i,r=p,o=function(){var t,e,n,i,r,o,a;t=p,W.test(s.charAt(p))?(e=s.charAt(p),p++):(e=u,x(U));if(e!==u){for(n=[],i=N();i!==u;)n.push(i),i=N();t=n!==u?(i=M())!==u?(r=p,o=O(),(r=(r=(o=o===u?null:o)!==u?(a=Pt())!==u?o=[o,a]:(p=r,u):(p=r,u))===u?null:r)!==u?e=Y(e,i,r):(p=t,u)):(p=t,u):(p=t,u)}else p=t,t=u;return t}();if(o!==u){for(t=[],e=p,n=[],i=N();i!==u;)n.push(i),i=N();for(e=n!==u&&(i=Mt())!==u?n=[n,i]:(p=e,u);e!==u;){for(t.push(e),e=p,n=[],i=N();i!==u;)n.push(i),i=N();e=n!==u&&(i=Mt())!==u?n=[n,i]:(p=e,u)}r=t!==u?a(o,t):(p=r,u)}else p=r,r=u;return r}function Mt(){var t=function(){var t;q.test(s.charAt(p))?(t=s.charAt(p),p++):(t=u,x(X));t!==u&&(t=R());return t}();return t=t===u&&(t=function(){var t,e,n,i;t=p,K.test(s.charAt(p))?(e=s.charAt(p),p++):(e=u,x(Z));if(e!==u){for(n=[],i=N();i!==u;)n.push(i),i=N();t=n!==u?(i=Pt())!==u?e=r(e,i):(p=t,u):(p=t,u)}else p=t,t=u;return t}())===u&&(t=function(){var t,e,n,i;t=p,$.test(s.charAt(p))?(e=s.charAt(p),p++):(e=u,x(J));if(e!==u){for(n=[],i=N();i!==u;)n.push(i),i=N();t=n!==u?(i=Ot())!==u?e=j(e,i):(p=t,u):(p=t,u)}else p=t,t=u;return t}())===u&&(t=function(){var t,e,n,i;t=p,Q.test(s.charAt(p))?(e=s.charAt(p),p++):(e=u,x(tt));if(e!==u){for(n=[],i=N();i!==u;)n.push(i),i=N();t=n!==u?(i=Ot())!==u?e=B(e,i):(p=t,u):(p=t,u)}else p=t,t=u;return t}())===u&&(t=function(){var t,e,n,i;t=p,et.test(s.charAt(p))?(e=s.charAt(p),p++):(e=u,x(nt));if(e!==u){for(n=[],i=N();i!==u;)n.push(i),i=N();t=n!==u?(i=function(){var t,e,n,i,r,o;if(t=p,(e=S())!==u){for(n=[],i=p,r=O(),i=(r=r===u?null:r)!==u?(o=S())!==u?r=[r,o]:(p=i,u):(p=i,u);i!==u;)n.push(i),i=p,r=O(),i=(r=r===u?null:r)!==u?(o=S())!==u?r=[r,o]:(p=i,u):(p=i,u);t=n!==u?e=a(e,n):(p=t,u)}else p=t,t=u;return t}())!==u?e=r(e,i):(p=t,u):(p=t,u)}else p=t,t=u;return t}())===u&&(t=function(){var t,e,n,i;t=p,it.test(s.charAt(p))?(e=s.charAt(p),p++):(e=u,x(rt));if(e!==u){for(n=[],i=N();i!==u;)n.push(i),i=N();t=n!==u?(i=function(){var t,e,n,i,r,o;if(t=p,(e=E())!==u){for(n=[],i=p,r=O(),i=(r=r===u?null:r)!==u?(o=E())!==u?r=[r,o]:(p=i,u):(p=i,u);i!==u;)n.push(i),i=p,r=O(),i=(r=r===u?null:r)!==u?(o=E())!==u?r=[r,o]:(p=i,u):(p=i,u);t=n!==u?e=a(e,n):(p=t,u)}else p=t,t=u;return t}())!==u?e=r(e,i):(p=t,u):(p=t,u)}else p=t,t=u;return t}())===u&&(t=function(){var t,e,n,i;t=p,ot.test(s.charAt(p))?(e=s.charAt(p),p++):(e=u,x(at));if(e!==u){for(n=[],i=N();i!==u;)n.push(i),i=N();t=n!==u?(i=function(){var t,e,n,i,r,o;if(t=p,(e=T())!==u){for(n=[],i=p,r=O(),i=(r=r===u?null:r)!==u?(o=T())!==u?r=[r,o]:(p=i,u):(p=i,u);i!==u;)n.push(i),i=p,r=O(),i=(r=r===u?null:r)!==u?(o=T())!==u?r=[r,o]:(p=i,u):(p=i,u);t=n!==u?e=a(e,n):(p=t,u)}else p=t,t=u;return t}())!==u?e=r(e,i):(p=t,u):(p=t,u)}else p=t,t=u;return t}())===u&&(t=function(){var t,e,n,i;t=p,st.test(s.charAt(p))?(e=s.charAt(p),p++):(e=u,x(ut));if(e!==u){for(n=[],i=N();i!==u;)n.push(i),i=N();t=n!==u?(i=function(){var t,e,n,i,r,o;if(t=p,(e=M())!==u){for(n=[],i=p,r=O(),i=(r=r===u?null:r)!==u?(o=M())!==u?r=[r,o]:(p=i,u):(p=i,u);i!==u;)n.push(i),i=p,r=O(),i=(r=r===u?null:r)!==u?(o=M())!==u?r=[r,o]:(p=i,u):(p=i,u);t=n!==u?e=a(e,n):(p=t,u)}else p=t,t=u;return t}())!==u?e=r(e,i):(p=t,u):(p=t,u)}else p=t,t=u;return t}())===u?function(){var t,e,n,i;t=p,lt.test(s.charAt(p))?(e=s.charAt(p),p++):(e=u,x(ct));if(e!==u){for(n=[],i=N();i!==u;)n.push(i),i=N();t=n!==u?(i=function(){var t,e,n,i,r,o;if(t=p,(e=_())!==u){for(n=[],i=p,r=O(),i=(r=r===u?null:r)!==u?(o=_())!==u?r=[r,o]:(p=i,u):(p=i,u);i!==u;)n.push(i),i=p,r=O(),i=(r=r===u?null:r)!==u?(o=_())!==u?r=[r,o]:(p=i,u):(p=i,u);t=n!==u?e=a(e,n):(p=t,u)}else p=t,t=u;return t}())!==u?e=r(e,i):(p=t,u):(p=t,u)}else p=t,t=u;return t}():t}function Pt(){var t,e,n,i,r=p,o=M();if(o!==u){for(t=[],e=p,e=(n=(n=O())===u?null:n)!==u&&(i=M())!==u?n=[n,i]:(p=e,u);e!==u;)t.push(e),e=p,e=(n=(n=O())===u?null:n)!==u&&(i=M())!==u?n=[n,i]:(p=e,u);r=t!==u?a(o,t):(p=r,u)}else p=r,r=u;return r}function Ot(){var t,e,n,i,r=p,o=P();if(o!==u){for(t=[],e=p,e=(n=(n=O())===u?null:n)!==u&&(i=P())!==u?n=[n,i]:(p=e,u);e!==u;)t.push(e),e=p,e=(n=(n=O())===u?null:n)!==u&&(i=P())!==u?n=[n,i]:(p=e,u);r=t!==u?a(o,t):(p=r,u)}else p=r,r=u;return r}function S(){var t,e,n=p,i=M();return n=i!==u&&(t=(t=O())===u?null:t)!==u&&(t=M())!==u&&(e=(e=O())===u?null:e)!==u&&(e=M())!==u?F(i,t,e):(p=n,u)}function E(){var t,e=p,n=M();return e=n!==u&&(t=(t=O())===u?null:t)!==u&&(t=M())!==u?z(n,t):(p=e,u)}function T(){var t,e=p,n=M();return e=n!==u&&(t=(t=O())===u?null:t)!==u&&(t=M())!==u?V(n,t):(p=e,u)}function _(){var t,e,n,i,r,o=p,a=Ct();return o=a!==u&&(t=(t=O())===u?null:t)!==u&&(t=Ct())!==u&&(e=(e=O())===u?null:e)!==u&&(e=P())!==u&&O()!==u&&(n=At())!==u&&(i=(i=O())===u?null:i)!==u&&(i=At())!==u&&(r=(r=O())===u?null:r)!==u&&(r=M())!==u?H(a,t,e,n,i,r):(p=o,u)}function M(){var t,e=p,n=P();return e=n!==u&&(t=(t=O())===u?null:t)!==u&&(t=P())!==u?ht(n,t):(p=e,u)}function Ct(){var t=Lt();return t=(t=t===u?A():t)!==u?dt(t):t}function P(){var t,e=p,n=C();return(e=(n=n===u?null:n)!==u&&(t=Lt())!==u?n=[n,t]:(p=e,u))===u&&(e=p,e=(n=(n=C())===u?null:n)!==u&&(t=A())!==u?n=[n,t]:(p=e,u)),e=e!==u?pt(e):e}function At(){var t;return ft.test(s.charAt(p))?(t=s.charAt(p),p++):(t=u,x(yt)),t=t!==u?vt(t):t}function O(){var t,e,n=p,i=[],r=N();if(r!==u)for(;r!==u;)i.push(r),r=N();else i=u;if(i!==u)if((r=(r=Nt())===u?null:r)!==u){for(t=[],e=N();e!==u;)t.push(e),e=N();n=t!==u?i=[i,r,t]:(p=n,u)}else p=n,n=u;else p=n,n=u;if(n===u){if(i=n=p,(r=Nt())!==u){for(t=[],e=N();e!==u;)t.push(e),e=N();i=t!==u?r=[r,t]:(p=i,u)}else p=i,i=u;n=i=i!==u?o():i}return n}function Nt(){var t;return 44===s.charCodeAt(p)?(t=gt,p++):(t=u,x(mt)),t}function Lt(){var t,e=p,n=function(){var t,e,n,i;t=p,(e=A())===u&&(e=null);t=e!==u?(46===s.charCodeAt(p)?(n=c,p++):(n=u,x(h)),n!==u?(i=A())!==u?e=[e,n,i]:(p=t,u):(p=t,u)):(p=t,u);t===u&&(t=p,e=A(),t=e!==u?(46===s.charCodeAt(p)?(n=c,p++):(n=u,x(h)),n!==u?e=[e,n]:(p=t,u)):(p=t,u));t!==u&&(t=l(t));return t}();return(e=n!==u&&(t=(t=It())===u?null:t)!==u?n=[n,t]:(p=e,u))===u&&(e=p,e=(n=A())!==u&&(t=It())!==u?n=[n,t]:(p=e,u)),e=e!==u?l(e):e}function It(){var t,e,n,i=p;return bt.test(s.charAt(p))?(t=s.charAt(p),p++):(t=u,x(kt)),i=(i=t!==u&&(e=(e=C())===u?null:e)!==u&&(n=A())!==u?t=[t,e,n]:(p=i,u))!==u?l(i):i}function C(){var t;return xt.test(s.charAt(p))?(t=s.charAt(p),p++):(t=u,x(wt)),t}function A(){var t,e=[];if(i.test(s.charAt(p))?(t=s.charAt(p),p++):(t=u,x(d)),t!==u)for(;t!==u;)e.push(t),i.test(s.charAt(p))?(t=s.charAt(p),p++):(t=u,x(d));else e=u;return e=e!==u?St(e):e}function N(){var t;return Et.test(s.charAt(p))?(t=s.charAt(p),p++):(t=u,x(Tt)),t=t!==u?o():t}var L,I={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(L in I)I[L.toUpperCase()]=I[L];function D(t,e){for(var n=(e=e||[{}]).length;n--;){var i,r={code:t,command:I[t]};for(i in t==t.toLowerCase()&&(r.relative=!0),e[n])r[i]=e[n][i];e[n]=r}return e}if((e=n())!==u&&p===s.length)return e;throw e!==u&&p<s.length&&x({type:"end"}),t=v,n=y<s.length?s.charAt(y):null,e=y<s.length?k(y,y+1):k(y,y),new f1(f1.buildMessage(t,n),t,n,e)};(i.parseSVG=i).makeAbsolute=function(t){var n,i={x:0,y:0},r={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return t.forEach(function(t){for(var e in"moveto"===t.command&&(n=t),t.x0=i.x,t.y0=i.y,r)e in t&&(t[e]+=t.relative?t[r[e]]:0);"x"in t||(t.x=i.x),"y"in t||(t.y=i.y),t.relative=!1,t.code=t.code.toUpperCase(),"closepath"==t.command&&(t.x=n.x,t.y=n.y),i=t}),t};m1.prototype.selectAll=function(t){return new m1("string"==typeof t?this._parent.querySelectorAll(t):t,null,this._elements[0],this._document)},m1.prototype.select=function(t){t="string"==typeof t?this._parent.querySelectorAll(t)[0]||null:t;return new m1([t],null,t,this._document)},m1.prototype.append=function(n){var i=this,t="function"==typeof n?n:function(){var t=n;if(i._document)return i._document.createElement(t,{});var e=m1.registry[t];return e?new e:new Error("Unknown node type: ".concat(t))},e=[];if(null!==this._data){for(var r=0;r<this._data.length;r++)(s=t(o=this._data[r],r)).__data__=o,this._parent.appendChild(s),e.push(s);return new m1(e,null,this._parent,this._document)}for(r=0;r<this._elements.length;r++){var o,a=this._elements[r],s=t(o=a.__data__,r);a.appendChild(s),e.push(s)}return new m1(e,null,e[0],this._document)},m1.prototype.data=function(t,n){void 0===n&&(n=function(t){return t});for(var e=[],i=[],r=new Map(this._elements.map(function(t,e){return[n(t.__data__,e),t]})),o=0;o<t.length;o++){var a,s=t[o],u=n(s,o);r.has(u)?((a=r.get(u)).__data__=s,i.push(a),r.delete(u)):e.push(s)}var l=Array.from(r.values()),l=[new m1([],e,this._parent,this._document),new m1(i,null,this._parent,this._document),new m1(l,null,this._parent,this._document)];return new m1(this._elements,null,this._parent,this._document,l)},m1.prototype.merge=function(t){return new m1(z(z([],P(this._elements),!1),P(t._elements),!1),null,this._parent,this._document)},m1.prototype.join=function(t,e,n){void 0===e&&(e=function(t){return t}),void 0===n&&(n=function(t){return t.remove()});t=(t=void 0===t?function(t){return t}:t)(this._enter),e=e(this._update),n=n(this._exit);return e.merge(t).merge(n)},m1.prototype.remove=function(){var n=z([],P(this._elements),!1);return this._elements.forEach(function(t){var e;t.parentNode&&(t.parentNode.removeChild(t),e=n.indexOf(t),n.splice(e,1),t.remove())}),new m1(n,null,this._parent,this._document)},m1.prototype.each=function(t){for(var e=0;e<this._elements.length;e++){var n,i=this._elements[e];i&&(n=i.__data__,t.call(i,n,e))}return this},m1.prototype.attr=function(n,i){var r="function"!=typeof i?function(){return i}:i;return this.each(function(t,e){void 0!==i&&(this[n]=r.call(this,t,e))}),this},m1.prototype.style=function(n,i){var r="function"!=typeof i?function(){return i}:i;return this.each(function(t,e){void 0!==i&&(this.style[n]=r.call(this,t,e))}),this},m1.prototype.on=function(t,e){return this.each(function(){this.addEventListener(t,e)}),this},m1.prototype.call=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.call.apply(t,z([this._parent,this],P(e),!1)),this},m1.prototype.node=function(){return this._elements[0]},m1.prototype.nodes=function(){return this._elements},m1.registry={g:xh,rect:Lh,circle:gh,path:Mh,text:Dh,ellipse:bh,image:Sh,line:Th,polygon:Oh,polyline:Ah,html:jh};var v1,g1=m1;function m1(t,e,n,i,r){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=[null,null,null]),this._elements=t=void 0===t?null:t,this._data=e,this._parent=n,this._document=i,this._enter=r[0],this._update=r[1],this._exit=r[2]}function I(t){return new g1([t],null,t,t.ownerDocument)}function b1(t,n,i,e){return I(t).selectAll(".".concat(n)).data(e||[],function(t,e){return t.id||e}).join(function(t){return t.append(function(t){var e=t.id,t=_(t,["id"]);return new i({id:e,className:n,style:t})})},function(t){return t.each(function(t){this.attr(t)})},function(t){return t.remove()}).nodes()}function k1(t,e){var n,i;if(e)try{for(var r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&i>=t.length?void 0:t)&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(Object.entries(e)),o=r.next();!o.done;o=r.next()){var a=P(o.value,2),s=a[0],u=a[1];t.style(s,u)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}}function x1(t,e,n){return t.querySelector(e)?I(t).select(e):I(t).append(n)}function w1(t,e,n,i){var r,o,a,s=S1(i=void 0===i?"...":i,n),u=Q(t)?t:Y(r=t)?"":r.toString(),l=e,c=[];if(S1(t,n)<=e)return t;for(;;){if(o=u.substr(0,16),l<(a=S1(o,n))+s)break;if(c.push(o),l-=a,!(u=u.substr(16)))return c.join("")}for(;;){if(o=u.substr(0,1),l<(a=S1(o,n))+s)break;if(c.push(o),l-=a,!(u=u.substr(1)))return c.join("")}return"".concat(c.join("")).concat(i)}var S1=dt(function(t,e){var n=(e=void 0===e?{}:e).fontSize,i=e.fontFamily,r=e.fontWeight,o=e.fontStyle,e=e.fontVariant;return(v1=v1||document.createElement("canvas").getContext("2d")).font=[o,e,r,"".concat(n,"px"),i].join(" "),v1.measureText(Q(t)?t:"").width},function(t,e){return z([t],P(at(e=void 0===e?{}:e)),!1).join("")});function E1(t,e){return"string"==typeof t?S1(t,e):t}var T1,_1,M1=function(t){var e=t.style.fontFamily||"sans-serif",n=t.style.fontWeight||"normal",i=t.style.fontStyle||"normal",r=t.style.fontVariant,t=t.style.fontSize;return{fontSize:t="object"==typeof t?t.value:t,fontFamily:e,fontWeight:n,fontStyle:i,fontVariant:r}},P1=(T1=M1,_1=new Map,function(t,e){var n=e.fontSize,i=e.fontFamily,r=e.fontStyle,o=e.fontWeight,a=e.textAlign,s=e.textBaseline,u=e.textTransform,n=JSON.stringify({fontSize:n,fontFamily:i,fontStyle:r,fontWeight:o,textAlign:a,textBaseline:s,textTransform:u});return _1.has(n)||((i=I(t).append("text").node()).attr(E(E({},e),{visibility:"hidden"})),_1.set(n,i)),T1(_1.get(n))});function O1(t,e){return"capitalize"===e?t.toLowerCase().replace(/( |^)[a-z]/g,function(t){return t.toUpperCase()}):"lowercase"===e?t.toLowerCase():"uppercase"===e?t.toUpperCase():t}function C1(t,e){e=Math.pow(10,e);return~~(t*e)/e}function A1(t){return t.toLocaleString()}function N1(t,e){return void 0===e&&(e=0),Math.abs(t)<1e3?String(t):"".concat(C1(t/1e3,e).toLocaleString(),"K")}var L1=function(t,e,n){return t<0&&Number.isFinite(t)?e:n},I1=function(t,e,n){return 0<t&&Number.isFinite(t)?e:n},D1=function(t,e){return t*e},R1=Math.PI/180;function j1(t){if(et(t))return[t,t,t,t];if(q(t)){var e=t.length;if(1===e)return[t[0],t[0],t[0],t[0]];if(2===e)return[t[0],t[1],t[0],t[1]];if(3===e)return[t[0],t[1],t[2],t[1]];if(4===e)return t}return[0,0,0,0]}var B1=["default","active","selected","disabled","inactive"],F1={fontSize:"16px",fontFamily:"sans-serif",fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",textAlign:"start",textBaseline:"alphabetic"};function z1(t){if(t)return null==t?void 0:t.default;var e=pt(t)||{};return B1.forEach(function(t){t in e&&delete e[t]}),e}function V1(t,e,n){if(void 0===n&&(n=!1),!e)return z1(t)||{};e=yt(t,e);return n?O({},z1(t),e):e}function H1(t){var e=t.canvas,n=t.touches,i=t.offsetX,t=t.offsetY;return e?[e.x,e.y]:n?[(e=n[0]).clientX,e.clientY]:i&&t?[i,t]:[0,0]}function G1(t){t=t&&t.getRenderBounds();if(!t)return{width:0,height:0};var e=t.getMax(),t=t.getMin();return{width:e[0]-t[0],height:e[1]-t[1]}}function W1(t){var t=t.getLocalBounds(),t=P([t.min,t.max],2),e=P(t[0],2),n=e[0],e=e[1],t=P(t[1],2),i=t[0],t=t[1];return{x:n,y:e,width:i-n,height:t-e,left:n,bottom:t,top:e,right:i}}function U1(t){return"string"==typeof t?(e=t,(n=document.createElement("div")).innerHTML=e,n.firstChild):t;var e,n}var Y1=["year","month","day","hour","minute","second"],q1=["YYYY","MM","DD","hh","mm","ss"];function X1(t){return t instanceof Date?t:new Date(t)}function K1(t){for(var e,t=P(t,2),n=t[0],t=t[1],n=Y1.indexOf(n),i=Y1.indexOf(t),r="",o=n;o<=i;o+=1)r+=q1[o],o<i&&(e="-",2===o?e=" ":2<o&&(e=":"),r+=e);return r}function Z1(t,e){var n={YYYY:t.getFullYear(),MM:t.getMonth()+1,DD:t.getDate(),hh:t.getHours(),mm:t.getMinutes(),ss:t.getSeconds()},i=e;return Object.keys(n).forEach(function(t){var e=n[t];i=i.replace(t,"YYYY"===t?"".concat(e):"0".concat(e).slice(-2))}),i}function $1(t,e){t=new Date(t);return{year:function(t){t.setMonth(0),t.setHours(0,0,0,0)},month:function(t){t.setDate(1),t.setHours(0,0,0,0)},day:function(t){return t.setHours(0,0,0,0)},hour:function(t){return t.setMinutes(0,0,0)},minute:function(t){return t.setSeconds(0,0)},second:function(t){return t.setMilliseconds(0)}}[e](t),Z1(t,K1(["year",e]))}function J1(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0;i<e.length;i+=1)Q1(t,e[i]);return t}var Q1=function(i,r,o,a){void 0===o&&(o=0),void 0===a&&(a=5),Object.entries(r).forEach(function(t){var t=P(t,2),e=t[0],t=t[1],n=i;Object.prototype.hasOwnProperty.call(r,e)&&(t?J(t)?(J(i[e])||(n[e]={}),o<a?Q1(i[e],t,o+1,a):n[e]=r[e]):q(t)?(n[e]=[],n[e]=n[e].concat(t)):n[e]=t:n[e]=t)})};function tb(t,e,n,i,r,o){return(t===e||Math.min(t,e)<=r&&r<=Math.max(t,e))&&(n===i||Math.min(n,i)<=o&&o<=Math.max(n,i))}function eb(t,e,n){var i=t;(!t.length||e<t[0]||e===t[0]&&n<t[1])&&(i[0]=e,i[1]=n)}function nb(t,e){var t=P(t,2),n=t[0],t=t[1],e=P(e,2),i=e[0],e=e[1];return Math.pow(Math.pow(n-i,2)+Math.pow(t-e,2),.5)}function ib(o){return void 0===o&&(o=0),function(t,e,n){var i,r=n.value;"function"==typeof r&&(n.value=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];i||(t=this,i=window.setTimeout(function(){r.apply(t,e),i=null},o))})}}var rb=function(t){return void 0!==t&&null!=t&&!Number.isNaN(t)};function ob(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]}h=ob;function ab(t,e,n){return[["M",t-n,e],["L",t+n,e]]}function sb(t,e,n){return[["M",t-n,e],["L",t+n,e]]}u=sb;t(lb,ub=d),lb.prototype.connectedCallback=function(){this.update()},lb.prototype.attributeChangedCallback=function(t,e,n){"x"===t||"y"===t||"size"===t||"symbol"===t?this.update():this.markerShape&&(this.markerShape.style[t]=n)},lb.prototype.update=function(t){this.attr(O({},this.attributes,t=void 0===t?{}:t));var t=this.getStyleProps()||{},e=t.Ctor,n=t.name,t=_(t,["Ctor","name"]);this.markerShape&&this.markerShape.name===n?this.markerShape.attr(t):(this.markerShape&&this.clear(),e&&(this.markerShape=new e({name:n,style:t}),this.appendChild(this.markerShape)))},lb.prototype.clear=function(){var t;null!=(t=this.markerShape)&&t.destroy(),this.markerShape=void 0,this.removeChildren()},lb.prototype.getStyleProps=function(){var t,e=this.style.symbol,n=(t="default",H(e=e)&&e instanceof Image?t="image":U(e)?t="symbol":Q(e)&&(n=new RegExp("data:(image|text)"),t=e.match(n)?"base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(e)?"url":"symbol"),t);return["base64","url","image"].includes(n)?E({Ctor:Sh,name:"markerImage"},this.getMarkerImageShapeCfg()):"symbol"===n?E({Ctor:Mh,name:"markerSymbol"},this.getMarkerSymbolShapeCfg()):null},lb.prototype.getMarkerSymbolShapeCfg=function(){var t=this.attributes,e=(t.x,t.y,t.size),e=void 0===e?0:e,n=t.symbol,t=_(t,["x","y","size","symbol"]),e=e/2,n=U(n)?n:lb.MARKER_SYMBOL_MAP.get(n),n=null==n?void 0:n(0,0,e);return E(E({path:n},t),{class:"marker-symbol"})},lb.prototype.getMarkerImageShapeCfg=function(){var t=this.attributes,e=t.size,e=void 0===e?0:e,n=2*e;return{x:-e,y:-e,width:n,height:n,img:t.symbol}},lb.tag="marker",lb.MARKER_SYMBOL_MAP=new Map,lb.registerSymbol=function(t,e){lb.MARKER_SYMBOL_MAP.set(t,e)},lb.getSymbol=function(t){return lb.MARKER_SYMBOL_MAP.get(t)},lb.defaultOptions={type:lb.tag,style:{x:0,y:0,size:16}};var ub,D=lb;function lb(t){return ub.call(this,O({},lb.defaultOptions,t))||this}D.registerSymbol("cross",function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]}),D.registerSymbol("hyphen",function(t,e,n){return[["M",t-n,e],["L",t+n,e]]}),D.registerSymbol("line",ab),D.registerSymbol("plus",function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]}),D.registerSymbol("tick",function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]}),D.registerSymbol("circle",ob),D.registerSymbol("point",h),D.registerSymbol("bowtie",function(t,e,n){var i=n-1.5;return[["M",t-n,e-i],["L",t+n,e+i],["L",t+n,e-i],["L",t-n,e+i],["Z"]]}),D.registerSymbol("hexagon",function(t,e,n){var i=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+i,e-n/2],["L",t+i,e+n/2],["L",t,e+n],["L",t-i,e+n/2],["L",t-i,e-n/2],["Z"]]}),D.registerSymbol("square",function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]}),D.registerSymbol("diamond",function(t,e,n){return[["M",t-n,e],["L",t,e-n],["L",t+n,e],["L",t,e+n],["Z"]]}),D.registerSymbol("triangle",function(t,e,n){var i=n*Math.sin(1/3*Math.PI);return[["M",t-n,e+i],["L",t,e-i],["L",t+n,e+i],["Z"]]}),D.registerSymbol("triangle-down",function(t,e,n){var i=n*Math.sin(1/3*Math.PI);return[["M",t-n,e-i],["L",t+n,e-i],["L",t,e+i],["Z"]]}),D.registerSymbol("line",ab),D.registerSymbol("dot",sb),D.registerSymbol("dash",u),D.registerSymbol("smooth",function(t,e,n){return[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]]}),D.registerSymbol("hv",function(t,e,n){return[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]]}),D.registerSymbol("vh",function(t,e,n){return[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]]}),D.registerSymbol("hvh",function(t,e,n){return[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]]}),D.registerSymbol("vhv",function(t,e){return[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]]});t(db,cb=d),Object.defineProperty(db.prototype,"backgroundShapeCfg",{get:function(){var t=this.attributes,e=t.backgroundStyle,t=t.radius;return E({radius:void 0===t?0:t},e?V1(e):{})},enumerable:!1,configurable:!0}),Object.defineProperty(db.prototype,"markerShapeCfg",{get:function(){return this.attributes.marker},enumerable:!1,configurable:!0}),Object.defineProperty(db.prototype,"textShapeCfg",{get:function(){var t=this.attributes,e=t.text,t=t.textStyle;return E(E({},V1(t)),{x:0,y:0,text:e})},enumerable:!1,configurable:!0}),db.prototype.init=function(){this.initShape(),this.update(),this.bindEvents()},db.prototype.update=function(t){this.attr(O({},this.attributes,t)),this.updateBackground(),this.updateMarker(),this.updateText(),this.layout()},db.prototype.clear=function(){this.markerShape.destroy(),this.textShape.destroy(),this.backgroundShape.destroy()},db.prototype.initShape=function(){this.markerShape=new D({name:"tag-marker",style:this.markerShapeCfg}),this.textShape=new Dh({name:"tag-text",style:this.textShapeCfg}),this.backgroundShape=new Lh({name:"background"}),this.backgroundShape.appendChild(this.markerShape),this.backgroundShape.appendChild(this.textShape),this.appendChild(this.backgroundShape),this.backgroundShape.toBack()},db.prototype.updateBackground=function(){this.backgroundShape.attr(this.backgroundShapeCfg)},db.prototype.updateMarker=function(){this.markerShape.update(this.markerShapeCfg)},db.prototype.updateText=function(){this.textShape.attr(this.textShapeCfg)},db.prototype.layout=function(){var t=this.attributes,e=t.padding,n=t.spacing,i=t.marker,r=t.text,o=t.align,t=t.verticalAlign,e=P(j1(e),4),a=e[0],s=e[1],u=e[2],e=e[3],i=i.size,i=void 0===i?0:i,l=G1(this.markerShape),c=l.width,l=l.height,h=this.textShape.getBoundingClientRect(),d=h.width,h=h.height,s=e+s,p=0,l=(0<i&&(s+=c+n,p=Math.max(p,l)),""!==r&&(s+=d,p=Math.max(p,h)),p+=a+u,0),r=0,d=("center"===o?l=-s/2:"end"===o&&(l=-s),"middle"===t?r=-p/2:"bottom"===t&&(r=-p),this.backgroundShape.attr({x:l,y:r,width:s,height:p}),this.markerShape.attr({x:e+c/2,y:p/2}),e);i&&(d+=c+n),this.textShape.attr({x:d,y:p/2})},db.prototype.bindEvents=function(){var n=this;this.addEventListener("mouseenter",function(){var t=n.attributes,e=t.backgroundStyle,t=t.textStyle;n.textShape.attr(V1(t,"active",!0)),n.backgroundShape.attr(e?V1(e,"active",!0):{}),n.layout()}),this.addEventListener("mouseleave",function(){n.textShape.attr(n.textShapeCfg),n.backgroundShape.attr(n.backgroundShapeCfg),n.layout()})},db.defaultOptions={type:db.tag="tag",style:{text:"",padding:4,align:"start",verticalAlign:"top",textStyle:{default:E(E({},F1),{fontSize:12,textAlign:"start",textBaseline:"middle",fill:"#000"}),active:{}},marker:{symbol:"circle",size:0},spacing:4,radius:2,backgroundStyle:{default:{fill:"#fafafa",stroke:"#d9d9d9",lineWidth:1}}}};var cb,hb=db;function db(t){t=cb.call(this,O({},db.defaultOptions,t))||this;return t.init(),t}var pb,fb,yb={small:{textStyle:{fontSize:10},buttonStyle:{width:40,height:20},markerStyle:{size:8}},middle:{textStyle:{fontSize:12},buttonStyle:{width:60,height:30},markerStyle:{size:12}},large:{textStyle:{fontSize:16},buttonStyle:{width:80,height:40},markerStyle:{size:16}}},vb={primary:{textStyle:{default:{fill:"#fff"},active:{}},buttonStyle:{default:{fill:"#1890ff",lineWidth:0},active:{fill:"#40a9ff"}},markerStyle:{default:{fill:"#1890ff"},active:{fill:"#40a9ff"}}},dashed:{textStyle:{default:{},active:{}},buttonStyle:{default:{stroke:"#bbb",lineDash:[5,5]},active:{}},markerStyle:{}},link:{textStyle:{default:{fill:"#1890ff"},active:{}},buttonStyle:{default:{lineWidth:0},active:{}},markerStyle:{default:{fill:"#1890ff"}}},text:{textStyle:{default:{fill:"#000"},active:{}},buttonStyle:{default:{lineWidth:0},active:{}},markerStyle:{default:{stroke:"#000"}}},default:{textStyle:{default:{fill:"#000"},active:{fill:"#1890ff"}},buttonStyle:{default:{stroke:"#bbb"},active:{stroke:"#1890ff"}},markerStyle:{default:{stroke:"#bbb",lineWidth:1},active:{stroke:"#1890ff"}}}},gb={strict:{textStyle:{fill:"#b8b8b8"},buttonStyle:{},markerStyle:{}},textStyle:{},buttonStyle:{stroke:"#d9d9d9",fill:"#f5f5f5"},markerStyle:{stroke:"#d9d9d9"}},mb=(t(bb,pb=d),Object.defineProperty(bb.prototype,"disabled",{get:function(){return this.style.disabled},enumerable:!1,configurable:!0}),Object.defineProperty(bb.prototype,"markerWidth",{get:function(){return this.markerShape.isVisible()?this.getStyle("markerStyle").size:0},enumerable:!1,configurable:!0}),Object.defineProperty(bb.prototype,"text",{get:function(){var t=this.attributes.text;if(""===t)return t;var e=this.textAvailableWidth;return w1(t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(bb.prototype,"textWidth",{get:function(){return""===this.textShape.attr("text")?0:S1(this.text,M1(this.textShape))},enumerable:!1,configurable:!0}),Object.defineProperty(bb.prototype,"textAvailableWidth",{get:function(){var t=this.attributes,e=t.marker,n=t.padding,i=t.ellipsis,r=t.width,t=t.markerSpacing;if(!i)return 1/0;i=ut(r)?this.getStyle("buttonStyle").width:r;return e?i-2*n-t-this.markerWidth:i-2*n},enumerable:!1,configurable:!0}),Object.defineProperty(bb.prototype,"buttonWidth",{get:function(){var t=this.attributes,e=t.marker,n=t.padding,i=t.width,r=t.ellipsis,t=t.markerSpacing;if(!ut(i))return i;if(r)return this.getStyle("buttonStyle").width;var i=this.textShape.attr("text"),r=this.markerWidth,o=this.textWidth,n=2*n;return e?n+=""!==i?r+o+t:r:""!==i&&(n+=o),n},enumerable:!1,configurable:!0}),Object.defineProperty(bb.prototype,"buttonHeight",{get:function(){var t=this.attributes.height;return t||this.getStyle("buttonStyle").height},enumerable:!1,configurable:!0}),bb.prototype.getStyle=function(e,t){void 0===t&&(t="default");var n=this.attributes,i=n.size,r=n.type,n=n.disabled,o=O({},yt(yb,[i,e]),V1(yt(vb,[r,e]),t),V1(yt(this.attributes,e),t,!0));return n&&(Object.keys(o).forEach(function(t){t in gb[e]&&(o[t]=yt(gb,[e,t]))}),Object.keys(gb.strict[e]).forEach(function(t){o[t]=yt(gb,["strict",e,t])}),O(o,V1(yt(this.attributes,e),"disabled"))),o},bb.prototype.init=function(){this.initShape(),this.updateMarker(),this.updateText(),this.updateButton(),this.adjustLayout(),this.bindEvents()},bb.prototype.update=function(t){this.attr(O({},this.attributes,t)),this.updateMarker(),this.updateText(),this.updateButton(),this.adjustLayout()},bb.prototype.setState=function(t){this.style.disabled="disabled"===t,this.attr("cursor",this.style.disabled?"not-allowed":"pointer"),this.markerShape.attr("cursor",this.style.disabled?"not-allowed":"pointer")},bb.prototype.clear=function(){},bb.prototype.destroy=function(){this.removeChildren(!0),pb.prototype.destroy.call(this)},bb.prototype.hide=function(){this.markerShape.update({visibility:"hidden"}),this.textShape.style.visibility="hidden",this.backgroundShape.style.visibility="hidden"},bb.prototype.show=function(){this.markerShape.update({visibility:"visible"}),this.textShape.style.visibility="visible",this.backgroundShape.style.visibility="visible"},bb.prototype.initShape=function(){this.markerShape=new D({name:"marker",style:E({symbol:"circle"},this.getStyle("markerStyle"))}),this.textShape=new Dh({name:"text",style:{text:""}}),this.backgroundShape=new Lh({name:"background",style:{width:0,height:0}}),this.backgroundShape.appendChild(this.markerShape),this.backgroundShape.appendChild(this.textShape),this.appendChild(this.backgroundShape)},bb.prototype.updateMarker=function(){var t=this.attributes.marker;ut(t)?this.markerShape.hide():(this.markerShape.update(E({symbol:t},this.getStyle("markerStyle"))),this.markerShape.show())},bb.prototype.updateText=function(){var t=this.text;""===t?this.textShape.hide():(this.textShape.attr(E(E({},this.getStyle("textStyle")),{text:t})),this.textShape.show())},bb.prototype.updateButton=function(){var t=this.attributes.disabled,t=(this.attr("cursor",t?"not-allowed":"pointer"),this.buttonHeight),e=this.getStyle("buttonStyle");this.backgroundShape.attr(E(E({},e),{height:t}))},bb.prototype.bindEvents=function(){this.addEventListener("click",this.clickEvents),this.addEventListener("mouseenter",this.mouseenterEvent),this.addEventListener("mouseleave",this.mouseleaveEvent)},bb.prototype.adjustLayout=function(){var t,e=this.attributes,n=e.padding,i=e.marker,r=e.markerAlign,e=e.markerSpacing,o=this.buttonWidth,a=this.buttonHeight,o=o/2,s=this.textWidth/2,u=this.textShape.attr("text"),l=0,c=0,h=a/2;i?(t=(i=this.markerWidth)/2,""===u?c=o:l="left"===r?(c=t+n,n+i+e+s):(c=this.buttonWidth-n-t,n+s)):""!==u&&(l=o),this.markerShape.attr({x:c,y:a/2}),this.textShape.attr({x:l,y:h}),this.backgroundShape.attr({width:this.buttonWidth})},bb.defaultOptions={type:bb.tag="button",style:{disabled:!1,cursor:"pointer",padding:10,size:"middle",type:"default",text:"",markerAlign:"left",markerSpacing:5,textStyle:{default:E(E({},F1),{textAlign:"center",textBaseline:"middle"}),active:{}},buttonStyle:{default:{lineWidth:1,radius:5},active:{}},markerStyle:{default:{}}}},bb);function bb(t){var e=pb.call(this,J1({},bb.defaultOptions,t))||this;return e.clickEvents=function(){var t=e.attributes.onClick;e.disabled||null==t||t.call(e,e)},e.mouseenterEvent=function(){e.attributes.disabled||(e.markerShape.update(e.getStyle("markerStyle","active")),e.textShape.attr(e.getStyle("textStyle","active")),e.backgroundShape.attr(E(E({},e.getStyle("buttonStyle","active")),{width:e.buttonWidth,height:e.buttonHeight})))},e.mouseleaveEvent=function(){e.markerShape.update(e.getStyle("markerStyle")),e.textShape.attr(e.getStyle("textStyle")),e.backgroundShape.attr(E(E({},e.getStyle("buttonStyle")),{width:e.buttonWidth,height:e.buttonHeight}))},e.init(),e}function kb(t){t=fb.call(this,O({},kb.defaultOptions,t))||this;return t.cursorX=0,t.cursorY=0,t.init(),t}t(kb,fb=d),kb.prototype.init=function(){var o=this,t=(this.cursorX=0,this.cursorY=0,this.attributes),e=t.x,n=t.y,a=t.items,s=t.textStyle,t=P(j1(t.padding),3),i=t[0],t=t[2];this.container=new xh({name:"".concat(kb.tag,"-container")}),this.appendChild(this.container),this.container.translate(e+t,n+i),a.forEach(function(t,e){var n=new hb({name:"".concat(kb.tag,"-item"),id:t.id,style:E(E({x:o.cursorX,y:o.cursorY,text:Y(t.text)?t.id:t.text,textStyle:s},vt(t,["marker"])),{padding:0,backgroundStyle:null})}),i=n.getBounds(),r=i.getMax()[0]-i.getMin()[0],i=i.getMax()[1]-i.getMin()[1];o.autoWrap(n,r,i),o.container.appendChild(n),o.bindEvents(n,t),e!==a.length-1&&o.createSeparator(o.container,i,e)})},kb.prototype.update=function(t){this.attr(O({},this.attributes,t)),this.clear(),this.init()},kb.prototype.clear=function(){this.container.destroy()},kb.prototype.createSeparator=function(t,e,n){var i=this.attributes.separator,r=i.spacing,r=void 0===r?0:r,o=i.text,o=void 0===o?"/":o,i=i.style,n=new Dh({name:"".concat(kb.tag,"-separator"),id:"".concat(kb.tag,"-separator-").concat(n),style:E(E(E(E({},F1),{x:this.cursorX+r,y:this.cursorY}),i),{text:o,textBaseline:"bottom"})}),i=n.getBounds(),o=i.getMax()[0]-i.getMin()[0],i=i.getMax()[1]-i.getMin()[1];this.autoWrap(n,o+r,i)||(this.cursorX+=r),n.translate(0,e),t.appendChild(n)},kb.prototype.bindEvents=function(t,e){var n=this.attributes,i=n.items,r=n.onClick;r&&t.addEventListener("click",function(){r.call(t,e.id,e,i)})},kb.prototype.autoWrap=function(t,e,n){var i=this.attributes,r=i.width,i=i.padding;if(this.cursorX+=e,!Y(r)){i=P(j1(i),2)[1];if(this.cursorX>r-i)return t.attr({x:0,y:this.cursorY+n}),this.cursorX=e,this.cursorY+=n,!0}return!1},kb.defaultOptions={type:kb.tag="breadcrumb",style:{separator:{text:"/",style:{fontSize:14,fill:"rgba(0, 0, 0, 0.45)"},spacing:8},textStyle:{default:E(E({},F1),{fontSize:14,fill:"rgba(0, 0, 0, 0.45)"}),active:{fill:"#5468ff",cursor:"pointer"}},padding:[8,8,8,8]}};t(Sb,xb=ph),Sb.prototype.render=function(){var t=this.attributes,e=t.lines,t=t.areas;e&&this.createLines(e),t&&this.createAreas(t)},Sb.prototype.clear=function(){this.linesGroup.removeChildren(!0),this.areasGroup.removeChildren(!0)},Sb.prototype.update=function(t){var e=t.lines,t=t.areas;this.clear(),e&&this.setAttribute("lines",e),t&&this.setAttribute("areas",t),this.render()},Sb.prototype.createLines=function(t){var e=this;t.forEach(function(t){e.linesGroup.appendChild(new Mh({name:"line",style:t}))})},Sb.prototype.createAreas=function(t){var e=this;t.forEach(function(t){e.areasGroup.appendChild(new Mh({name:"area",style:t}))})};var xb,wb=Sb;function Sb(t){var e=this,n=t.style,t=_(t,["style"]);return(e=xb.call(this,O({},{type:"lines",style:{width:0,height:0}},E({style:n},t)))||this).linesGroup=new xh({name:"lines"}),e.appendChild(e.linesGroup),e.areasGroup=new xh({name:"areas"}),e.appendChild(e.areasGroup),e.render(),e}t(_b,Eb=ph),_b.prototype.render=function(){var e=this;this.attributes.columns.forEach(function(t){t.forEach(function(t){e.columnsGroup.appendChild(new Lh({name:"column",style:t}))})})},_b.prototype.update=function(t){this.attr(O({},this.attributes,t)),t.columns&&(this.clear(),this.render())},_b.prototype.clear=function(){this.removeChildren(!0)};var Eb,Tb=_b;function _b(t){var e=this,n=t.style,t=_(t,["style"]);return(e=Eb.call(this,O({},{type:"column",style:{width:0,height:0}},E({style:n},t)))||this).columnsGroup=new xh({name:"columns"}),e.appendChild(e.columnsGroup),e.render(),e}function Mb(t){return 0===t.length?[0,0]:[Z(ot(t,function(t){return Z(t)||0})),K(rt(t,function(t){return K(t)||0}))]}function Pb(t){for(var e=pt(t),n=e[0].length,t=P([Array(n).fill(0),Array(n).fill(0)],2),i=t[0],r=t[1],o=0;o<e.length;o+=1)for(var a=e[o],s=0;s<n;s+=1)0<=a[s]?(a[s]+=i[s],i[s]=a[s]):(a[s]+=r[s],r[s]=a[s]);return e}function Ob(t,e,n){void 0===n&&(n=[[0,0],[1,1]]);for(var e=!!(e=void 0===e?!1:e),i=[],r=0,o=t.length;r<o;r+=2)i.push([t[r],t[r+1]]);for(var a,s,u,l=function(t,e,n,i){var r,o=[],a=!!i;if(a){l=i[0],c=i[1];for(var s=0,u=t.length;s<u;s+=1)var l=Do([0,0],l,k=t[s]),c=Ro([0,0],c,k)}for(var s=0,h=t.length;s<h;s+=1){var d,p,f,y,v,g,m,b,k=t[s];0!==s||n?s!==h-1||n?(d=t[[s?s-1:h-1,s-1][n?0:1]],p=t[n?(s+1)%h:s+1],g=jo(g=zo([0,0],p,d),g,e),0!==(v=(f=Bo(k,d))+(y=Bo(k,p)))&&(f/=v,y/=v),v=jo([0,0],g,-f),g=jo([0,0],g,y),m=Io([0,0],k,v),b=Do([0,0],b=Io([0,0],k,g),Ro([0,0],p,k)),b=Ro([0,0],b,Do([0,0],p,k)),m=Do([0,0],m=Io([0,0],k,v=jo([0,0],v=zo([0,0],b,k),-f/y)),Ro([0,0],d,k)),m=Ro([0,0],m,Do([0,0],d,k)),b=Io([0,0],k,g=jo([0,0],g=zo([0,0],k,m),y/f)),a&&(m=Do([0,0],m=Ro([0,0],m,l),c),b=Do([0,0],b=Ro([0,0],b,l),c)),o.push(r),o.push(m),r=b):(m=k,o.push(r),o.push(m)):r=k}return n&&o.push(o.shift()),o}(i,.4,e,n),c=i.length,h=[],r=0;r<c-1;r+=1)a=l[2*r],s=l[2*r+1],u=i[r+1],h.push(["C",a[0],a[1],s[0],s[1],u[0],u[1]]);return e&&(a=l[c],s=l[c+1],u=i[0],h.push(["C",a[0],a[1],s[0],s[1],u[0],u[1]])),h}function Cb(t,e){var n=(e=void 0===e?!1:e)?t.length-1:0,t=t.map(function(t,e){return z([e===n?"M":"L"],P(t),!1)});return e?t.reverse():t}function Ab(t,e){if(void 0===e&&(e=!1),t.length<=2)return Cb(t);for(var n=[],i=t.length,r=0;r<i;r+=1){var o=e?t[i-r-1]:t[r];St(o,n.slice(-2))||n.push.apply(n,z([],P(o),!1))}var a=Ob(n,!1);return e?a.unshift(z(["M"],P(t[i-1]),!1)):a.unshift(z(["M"],P(t[0]),!1)),a}function Nb(t,e,n){t=pt(t);return t.push(["L",e,n],["L",0,n],["Z"]),t}t(Db,Lb=d),Object.defineProperty(Db.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||0===(null==t?void 0:t.length))return[[]];t=pt(t);return t=et(t[0])?[t]:t},enumerable:!1,configurable:!0}),Object.defineProperty(Db.prototype,"data",{get:function(){return this.attributes.isStack?Pb(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(Db.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(Db.prototype,"baseline",{get:function(){var t=this.scales.y,e=P(t.getOptions().domain||[0,0],2),n=e[0],e=e[1];return e<0?t.map(e):t.map(n<0?0:n)},enumerable:!1,configurable:!0}),Object.defineProperty(Db.prototype,"containerCfg",{get:function(){var t=this.attributes;return{width:t.width,height:t.height}},enumerable:!1,configurable:!0}),Object.defineProperty(Db.prototype,"linesCfg",{get:function(){var n=this,t=this.attributes,i=t.areaStyle,e=t.isStack,r=t.lineStyle,o=t.smooth,t=this.containerCfg.width,a=this.data;if(0===a[0].length)return{lines:[],areas:[]};var s,u,l,c,h,d,p,f=this.scales,y=f.x,f=f.y,f=(a=a,s=(y={type:"line",x:y,y:f}).x,u=y.y,l=(y=P(u.getOptions().range||[0,0],2))[0],c=y[1],l<c&&(y=P([l,c],2),c=y[0],l=y[1]),a.map(function(t){return t.map(function(t,e){return[s.map(e),tt(u.map(t),c,l)]})})),y=[];return i&&(a=this.baseline,y=e?(o?function(t,e,n){for(var i=[],r=t.length-1;0<=r;--r){var o,a=t[r],s=Ab(a),u=void 0,u=0===r?Nb(s,e,n):(o=Ab(t[r-1],!0),a=a[0],o[0][0]="L",z(z(z([],P(s),!1),P(o),!1),[z(["M"],P(a),!1),["Z"]],!1));i.push(u)}return i}:function(t,e,n){for(var i=[],r=t.length-1;0<=r;--r){var o,a=Cb(t[r]),s=void 0,s=0===r?Nb(a,e,n):((o=Cb(t[r-1],!0))[0][0]="L",z(z(z([],P(a),!1),P(o),!1),[["Z"]],!1));i.push(s)}return i})(f,t,a):(h=o,d=t,p=a,f.map(function(t){return Nb((h?Ab:Cb)(t),d,p)}))),{lines:f.map(function(t,e){return E({stroke:n.getColor(e),path:(o?Ab:Cb)(t)},r)}),areas:y.map(function(t,e){return E({path:t,fill:n.getColor(e)},i)})}},enumerable:!1,configurable:!0}),Object.defineProperty(Db.prototype,"columnsCfg",{get:function(){var r=this,t=this.attributes,o=t.isStack,a=t.columnStyle,t=this.containerCfg.height,s=this.rawData;if(!s)return{columns:[]};o&&(s=Pb(s));var e=this.createScales(s),u=e.x,l=e.y,e=P(Mb(s),2),n=e[0],e=e[1],c=new Ug({domain:[0,e-(0<n?0:n)],range:[0,t]}),h=u.getBandWidth(),d=this.rawData;return{columns:s.map(function(t,i){return t.map(function(t,e){var n=h/s.length;return E(E({fill:r.getColor(i)},a),o?{x:u.map(e),y:l.map(t),width:h,height:c.map(d[i][e])}:{x:u.map(e)+n*i,y:0<=t?l.map(t):l.map(0),width:n,height:c.map(Math.abs(t))})})})}},enumerable:!1,configurable:!0}),Db.prototype.init=function(){this.sparkShape=this.createSparkline(),this.appendChild(this.sparkShape)},Db.prototype.update=function(t){var e=this.attributes.type,t=(this.attr(O({},this.attributes,t)),t.type);t&&t!==e&&(this.clear(),this.sparkShape=this.createSparkline(),this.appendChild(this.sparkShape)),this.sparkShape instanceof wb?this.sparkShape.update(this.linesCfg):this.sparkShape.update(this.columnsCfg)},Db.prototype.clear=function(){this.removeChild(this.sparkShape),this.sparkShape.clear(),this.sparkShape.destroy()},Db.prototype.createSparkline=function(){var t={name:"sparkline"};return"line"===this.attributes.type?new wb(E(E({},t),{style:this.linesCfg})):new Tb(E(E({},t),{style:this.columnsCfg}))},Db.prototype.getColor=function(t){var e=this.attributes.color;return q(e)?e[t%e.length]:U(e)?e.call(null,t):e},Db.prototype.createScales=function(t){var e=this.attributes,n=e.type,i=e.isGroup,r=e.barPadding,o=e.nice,o=void 0===o||o,a=e.minValue,e=e.maxValue,s=this.containerCfg,u=s.width,s=s.height,l=P(Mb(t),2),c=l[0],l=l[1];return{type:n,x:"line"===n?new Ug({domain:[0,t[0].length-1],range:[0,u]}):new Yv({domain:t[0].map(function(t,e){return e}),range:[0,u],paddingInner:i?r:0}),y:new Ug({domain:[null!=a?a:c,null!=e?e:l],range:[s,0],nice:o})}},Db.tag="sparkline",Db.defaultOptions={style:{type:"line",width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineStyle:{lineWidth:1},isGroup:!1,columnStyle:{lineWidth:1,stroke:"#fff",padding:.1}}};var Lb,Ib=Db;function Db(t){t=Lb.call(this,O({},Db.defaultOptions,t))||this;return t.containerShape=new Lh({name:"container",style:t.containerCfg}),t.appendChild(t.containerShape),t.init(),t}t(zb,Rb=ph),zb.prototype.setHandle=function(t){var e=t.x,t=t.y;this.attr({x:e,y:t})},zb.prototype.setHandleText=function(t){var e=t.x,n=t.y,t=t.text;this.textShape.attr({x:e,y:n,text:t})},zb.prototype.getIcon=function(){return this.iconShape},zb.prototype.getType=function(){return yt(this.attributes,"handleType")},zb.prototype.update=function(t){this.attr(O({},this.attributes,t));var e=t.iconCfg,t=t.textCfg;e&&this.updateIconShape(),t&&this.textShape.attr(E({},t))},zb.prototype.updateIconShape=function(){this.removeChild(this.iconShape,!0),this.iconShape=this.createHandleIcon(),this.appendChild(this.iconShape),this.setHandleIconRotation()},zb.prototype.createDefaultIcon=function(){function t(t,e,n,i){return new Th({name:"line",style:{x1:t,y1:e,x2:n,y2:i,stroke:o,lineWidth:a}})}var e=this.attributes.iconCfg,n=e.size,i=e.radius,e=_(e,["size","radius"]),r=2.4*n,i=new Lh({name:"icon",style:E({width:n,height:r,x:-n/2,y:-r/2,radius:null!=i?i:n/4},e)}),o=e.stroke,a=e.lineWidth,e=1/3*n,s=2/3*n,u=.25*r,l=.75*r;return i.appendChild(t(e,u,e,l)),i.appendChild(t(s,u,s,l)),i.setOrigin(n/2,r/2),i},zb.prototype.createHandleIcon=function(){var t=yt(this.attributes,["iconCfg"]),e=t.type,t=(t.orient,_(t,["type","orient"]));return"hide"===e?new Lh({style:t,name:"icon"}):"symbol"===e?new D({style:t,name:"icon"}):this.createDefaultIcon()},zb.prototype.createHandleText=function(){var t=this.attributes.textCfg;return new Dh({name:"text",style:E(E({},F1),t)})},zb.prototype.setHandleIconRotation=function(){"vertical"===yt(this.attributes,["iconCfg","orient"])?this.iconShape.setLocalEulerAngles(90):this.iconShape.setLocalEulerAngles(0)};var Rb,jb,Bb,Fb=zb;function zb(t){var e=this,n=t.style,t=_(t,["style"]);return(e=Rb.call(this,E({type:"handle",style:n},t))||this).iconShape=e.createHandleIcon(),e.appendChild(e.iconShape),e.textShape=e.createHandleText(),e.appendChild(e.textShape),e.setHandleIconRotation(),e}function Vb(t){var o=jb.call(this,O({},Vb.defaultOptions,t))||this;return o.onSelectionMouseenter=function(){o.selectionShape.attr(o.getStyle("selectionStyle"))},o.onSelectionMouseleave=function(){o.selectionShape.attr(o.getStyle("selectionStyle"))},o.onDragStart=function(r){return function(t){t.stopPropagation(),o.target=r,o.prevPos=o.getOrientVal(H1(t));var t=o.availableSpace,e=t.x,t=t.y,n=o.attributes,i=n.x,n=n.y;o.selectionStartPos=o.getRatio(o.prevPos-o.getOrientVal([e,t])-o.getOrientVal([i,n])),o.selectionWidth=0,o.addEventListener("mousemove",o.onDragging),o.addEventListener("touchmove",o.onDragging),document.addEventListener("mouseup",o.onDragEnd),document.addEventListener("touchend",o.onDragEnd)}},o.onDragging=function(t){t.stopPropagation();var t=o.getOrientVal(H1(t)),e=t-o.prevPos;if(e){var n=o.getRatio(e);switch(o.target){case"start":o.setValuesOffset(n);break;case"end":o.setValuesOffset(0,n);break;case"selection":o.setValuesOffset(n,n);break;case"background":o.selectionWidth+=n,o.setValues([o.selectionStartPos,o.selectionStartPos+o.selectionWidth].sort())}o.prevPos=t}},o.onDragEnd=function(){o.removeEventListener("mousemove",o.onDragging),o.removeEventListener("mousemove",o.onDragging),document.removeEventListener("mouseup",o.onDragEnd),document.removeEventListener("touchend",o.onDragEnd)},o.onValueChanged=function(t){t=new Ts("valueChanged",{detail:{oldValue:t,value:o.getValues()}});o.dispatchEvent(t)},o.initShape(),o.selectionStartPos=0,o.selectionWidth=0,o.prevPos=0,o.target="",o.init(),o}function Hb(t){var a=Bb.call(this,O({},Hb.defaultOptions,t))||this;return a.onValueChanged=function(t){var e=a.value;t!==e&&(e=new Ts("scroll",t={detail:{oldValue:t,value:e}}),a.dispatchEvent(e),e=new Ts("valueChanged",t),a.dispatchEvent(e))},a.onTrackClick=function(t){var e=a.attributes.thumbLen,n=P(a.getLocalPosition(),2),i=n[0],n=n[1],r=P(a.padding,4),o=r[0],r=r[3],i=a.getOrientVal([i+r,n+o]),r=a.getOrientVal(H1(t))-e/2,n=a.valueOffset(r-i,!0);a.setValue(n)},a.onThumbMouseenter=function(){a.thumbShape.attr(a.getStyle("thumbStyle","active"))},a.onTrackMouseenter=function(){a.trackShape.attr(a.getStyle("trackStyle","active"))},a.onThumbMouseleave=function(){a.thumbShape.attr(a.getStyle("thumbStyle"))},a.onTrackMouseleave=function(){a.trackShape.attr(a.getStyle("trackStyle"))},a.onDragStart=function(t){t.stopPropagation(),a.prevPos=a.getOrientVal(H1(t)),document.addEventListener("mousemove",a.onDragging),document.addEventListener("mouseup",a.onDragEnd),document.addEventListener("touchmove",a.onDragging),document.addEventListener("touchcancel",a.onDragEnd)},a.onDragging=function(t){t.stopPropagation();var t=a.getOrientVal(H1(t)),e=t-a.prevPos;a.setOffset(e),a.prevPos=t},a.onDragEnd=function(t){t.preventDefault(),document.removeEventListener("mousemove",a.onDragging),document.removeEventListener("mouseup",a.onDragEnd),document.removeEventListener("touchmove",a.onDragging),document.removeEventListener("touchcancel",a.onDragEnd)},a.init(),a}t(Vb,jb=d),Object.defineProperty(Vb.prototype,"values",{get:function(){return this.getAttribute("values")},set:function(t){this.setAttribute("values",this.getSafetyValues(t))},enumerable:!1,configurable:!0}),Object.defineProperty(Vb.prototype,"names",{get:function(){return this.getAttribute("names")},set:function(t){this.setAttribute("names",t)},enumerable:!1,configurable:!0}),Object.defineProperty(Vb.prototype,"backgroundShapeCfg",{get:function(){return E(E({cursor:"crosshair",zIndex:0},this.availableSpace),this.getStyle("backgroundStyle"))},enumerable:!1,configurable:!0}),Object.defineProperty(Vb.prototype,"sparklineShapeCfg",{get:function(){var t=this.attributes,t=(t.orient,t.sparkline),e=t.padding,t=_(t,["padding"]),e=P(j1(e),4),n=e[0],i=e[1],r=e[2],e=e[3],o=this.availableSpace,a=o.width,o=o.height,s=this.getStyle("backgroundStyle").lineWidth,s=void 0===s?0:s;return E(E({x:s/2+e,y:s/2+n},t),{zIndex:0,width:a-s-e-i,height:o-s-n-r})},enumerable:!1,configurable:!0}),Object.defineProperty(Vb.prototype,"availableSpace",{get:function(){var t=this.attributes,e=t.padding,n=t.width,t=t.height,e=P(j1(e),4),i=e[0],r=e[1],o=e[2],e=e[3];return{x:e,y:i,width:n-(e+r),height:t-(i+o)}},enumerable:!1,configurable:!0}),Object.defineProperty(Vb.prototype,"selectionShapeCfg",{get:function(){return E(E({cursor:"move",zIndex:2},this.calcMask()),this.getStyle("selectionStyle"))},enumerable:!1,configurable:!0}),Vb.prototype.attributeChangedCallback=function(t,e,n){t in["names","values"]&&this.setHandle()},Vb.prototype.getValues=function(){return this.values},Vb.prototype.setValues=function(t){this.values=t},Vb.prototype.getNames=function(){return this.names},Vb.prototype.setNames=function(t){this.names=t},Vb.prototype.init=function(){this.bindEvents()},Vb.prototype.initShape=function(){this.backgroundShape=new Lh({name:"background",style:this.backgroundShapeCfg}),this.appendChild(this.backgroundShape),this.sparklineShape=new Ib({name:"sparkline",style:this.sparklineShapeCfg}),this.backgroundShape.appendChild(this.sparklineShape),this.foregroundGroup=new xh({name:"foreground"}),this.backgroundShape.appendChild(this.foregroundGroup),this.selectionShape=new Lh({name:"selection",style:this.selectionShapeCfg}),this.foregroundGroup.appendChild(this.selectionShape),this.startHandle=this.createHandle("start"),this.foregroundGroup.appendChild(this.startHandle),this.endHandle=this.createHandle("end"),this.foregroundGroup.appendChild(this.endHandle)},Vb.prototype.update=function(t){this.attr(O({},this.attributes,t)),this.backgroundShape.attr(this.backgroundShapeCfg),this.sparklineShape.update(this.sparklineShapeCfg),this.selectionShape.attr(this.selectionShapeCfg),this.startHandle.update(this.getHandleShapeCfg("start")),this.endHandle.update(this.getHandleShapeCfg("end"))},Vb.prototype.clear=function(){},Vb.prototype.getSafetyValues=function(t,e){void 0===t&&(t=this.getValues()),void 0===e&&(e=4);var n,i=this.attributes,r=i.min,i=i.max,o=P(this.getValues(),2),a=o[0],o=o[1],t=P(t||[a,o],2),s=t[0],t=t[1],u=t-s;return t<s&&(s=(n=P([t,s],2))[0],t=n[1]),i-r<u?[r,i]:s<r?a===r&&o===t?[r,t]:[r,u+r]:i<t?o===i&&a===s?[s,i]:[i-u,i]:[C1(s,e),C1(t,e)]},Vb.prototype.getStyle=function(t,e,n){return void 0===e&&(e="default"),n?this.getHandleCfg(n):V1(yt(this.attributes,t),e,!0)},Vb.prototype.calcMask=function(t){var t=P(this.getSafetyValues(t),2),e=t[0],t=t[1],n=this.availableSpace,i=n.width,n=n.height;return this.getOrientVal([{y:0,height:n,x:e*i,width:(t-e)*i},{x:0,width:i,y:e*n,height:(t-e)*n}])},Vb.prototype.calcHandlePosition=function(t){var e=this.availableSpace,n=e.width,e=e.height,i=P(this.getSafetyValues(),2),r=i[0],i=i[1],t=("start"===t?r:i)*this.getOrientVal([n,e]);return{x:this.getOrientVal([t,n/2]),y:this.getOrientVal([e/2,t])}},Vb.prototype.setHandle=function(){var n=this;this.selectionShape.attr(this.calcMask()),["start","end"].forEach(function(t){var e=n["".concat(t,"Handle")];e.setHandle(n.calcHandlePosition(t)),e.setHandleText(n.calcHandleText(t))})},Vb.prototype.calcHandleText=function(t){var e,n=this.attributes,i=n.orient,n=n.names,r=this.getHandleCfg(t),o=r.spacing,a=r.formatter,r=r.textStyle,s=this.getHandleSize(t),u=this.getSafetyValues(),l=this.availableSpace,c=l.width,l=l.height,h=this.calcMask(),d=h.x,p=h.y,f=h.width,h=h.height,n=P("start"===t?[n[0],u[0]]:[n[1],u[1]],2),u=a(n[0],n[1]),a=new Dh({style:E(E({},r),{text:u})}),n=G1(a),r=n.width,n=n.height,a=(a.destroy(),0),y=0,s=s/2;return"horizontal"===i?(e=(i=o+s)+r/2,a="start"===t?0<d-i-r?-e:e:r<c-d-f-i?e:-e):(r=o+s,y="start"===t?n<p-s?-r:r:n<l-p-h-s?r:-r),{x:a,y:y,text:u}},Vb.prototype.getHandleTextShapeCfg=function(t){var e=this.getHandleCfg(t).textStyle;return E(E({},e),this.calcHandleText(t))},Vb.prototype.getHandleIconShapeCfg=function(t){var e,n,i=this.attributes,r=i.height,i=i.orient,o=this.getHandleCfg(t),a=o.show,s=o.handleIcon,o=o.handleStyle,u=this.getOrientVal(["ew-resize","ns-resize"]),t=this.getHandleSize(t);return a||(n="hide",e={cursor:u,x:-t/2,y:-r/2,height:r,width:t,opacity:0,fill:"red"}),e=s?(n="symbol",E(E({},o),{cursor:u,size:t,symbol:s})):(n="default",E(E({},o),{cursor:u,size:t})),E({orient:i,type:n},e)},Vb.prototype.getHandleShapeCfg=function(t){return E(E({handleType:t,zIndex:3},this.calcHandlePosition(t)),{iconCfg:this.getHandleIconShapeCfg(t),textCfg:this.getHandleTextShapeCfg(t)})},Vb.prototype.createHandle=function(t){return new Fb({name:"handle",style:this.getHandleShapeCfg(t)})},Vb.prototype.getHandleCfg=function(t){var e=yt(this.attributes,"handle"),n=e.start,i=e.end,e=_(e,["start","end"]),r={};return"start"===t?r=n:"end"===t&&(r=i),O({},e,r)},Vb.prototype.getHandleSize=function(t){t=this.getHandleCfg(t).size;if(t)return t;var t=this.attributes,e=t.width,t=t.height;return Math.floor((this.getOrientVal([t,e])+4)/2.4)},Vb.prototype.getOrientVal=function(t){var t=P(t,2),e=t[0],t=t[1];return"horizontal"===this.attributes.orient?e:t},Vb.prototype.setValuesOffset=function(t,e){void 0===e&&(e=0);var n=P(this.getValues(),2),i=n[0],n=n[1],t=[i+t,n+e].sort();this.setValues(t),this.onValueChanged([i,n])},Vb.prototype.getRatio=function(t){var e=this.availableSpace,n=e.width,e=e.height;return t/this.getOrientVal([n,e])},Vb.prototype.bindEvents=function(){function i(t){return t&&"text"!==t.name}var r=this,t=this.selectionShape;t.addEventListener("mousedown",this.onDragStart("selection")),t.addEventListener("touchstart",this.onDragStart("selection")),t.addEventListener("mouseenter",this.onSelectionMouseenter),t.addEventListener("mouseleave",this.onSelectionMouseleave);[this.startHandle,this.endHandle].forEach(function(t){var n=t.getType();t.addEventListener("mousedown",function(t){var e=t.target;i(e)&&r.onDragStart(n)(t)}),t.addEventListener("touchstart",function(t){var e=t.target;i(e)&&r.onDragStart(n)(t)})}),this.backgroundShape.addEventListener("mousedown",this.onDragStart("background")),this.backgroundShape.addEventListener("touchstart",this.onDragStart("background"))},Vb.defaultOptions={type:Vb.tag="slider",style:{orient:"horizontal",values:[0,1],names:["",""],min:0,max:1,width:200,height:20,sparkline:{padding:[1,1,1,1]},padding:[0,0,0,0],backgroundStyle:{default:{fill:"#416180",fillOpacity:.05}},selectionStyle:{default:{fill:"#5B8FF9",opacity:.15},active:{fill:"#ccdaf5"}},handle:{show:!0,formatter:function(t,e){return t},spacing:10,textStyle:E(E({},F1),{fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle"}),handleStyle:{stroke:"#bfbfbf",fill:"#fff",lineWidth:1,radius:2}}}},t(Hb,Bb=d),Object.defineProperty(Hb.prototype,"value",{get:function(){return this.getAttribute("value")},set:function(t){var e=this.attributes,n=e.value,i=e.min,e=e.max;this.setAttribute("value",tt(t,i,e)),this.onValueChanged(n)},enumerable:!1,configurable:!0}),Object.defineProperty(Hb.prototype,"padding",{get:function(){return j1(this.attributes.padding)},enumerable:!1,configurable:!0}),Object.defineProperty(Hb.prototype,"availableSpace",{get:function(){var t=this.attributes,e=t.width,t=t.height,n=P(this.padding,4),i=n[0],r=n[1],o=n[2],n=n[3];return{x:n,y:i,width:e-(n+r),height:t-(i+o)}},enumerable:!1,configurable:!0}),Object.defineProperty(Hb.prototype,"trackLen",{get:function(){var t=this.availableSpace,e=t.width,t=t.height;return this.getOrientVal([e,t])},enumerable:!1,configurable:!0}),Object.defineProperty(Hb.prototype,"thumbRadius",{get:function(){var t=this.attributes.isRound,e=this.availableSpace,n=e.width,e=e.height,i=yt(this.attributes,["thumbStyle","default","radius"]);return t?i||this.getOrientVal([e,n])/2:0},enumerable:!1,configurable:!0}),Object.defineProperty(Hb.prototype,"trackShapeCfg",{get:function(){var t=this.attributes,e=t.width,t=t.height;return E(E({},this.getStyle("trackStyle")),{width:e,height:t,x:0,y:0})},enumerable:!1,configurable:!0}),Object.defineProperty(Hb.prototype,"thumbShapeCfg",{get:function(){var t=this.attributes,e=t.value,t=t.thumbLen,n=this.availableSpace,i=n.x,r=n.y,o=this.thumbRadius,e=this.valueOffset(e);return E(E(E(E({},n),this.getStyle("thumbStyle")),this.getOrientVal([{x:i+e,width:t},{y:r+e,height:t}])),{radius:o})},enumerable:!1,configurable:!0}),Hb.prototype.attributeChangedCallback=function(t,e,n){var i;"value"===t&&(t=this.valueOffset(n),i=(n=P(this.padding,4))[0],n=n[3],this.setThumbOffset(t+this.getOrientVal([n,i])))},Hb.prototype.getValue=function(){return this.getAttribute("value")},Hb.prototype.setValue=function(t){this.value=t},Hb.prototype.setOffset=function(t){var e=this.getValue();this.setValue(this.valueOffset(t,!0)+e)},Hb.prototype.init=function(){this.initShape(),this.trackShape.attr(this.trackShapeCfg),this.thumbShape.attr(this.thumbShapeCfg),this.bindEvents()},Hb.prototype.update=function(t){this.attr(O({},this.attributes,t)),this.trackShape.attr(this.trackShapeCfg),this.thumbShape.attr(this.thumbShapeCfg)},Hb.prototype.clear=function(){},Hb.prototype.destroy=function(){this.removeChildren(!0)},Hb.prototype.initShape=function(){this.trackShape=new Lh({name:"track"}),this.appendChild(this.trackShape),this.thumbShape=new Lh({name:"thumb"}),this.trackShape.appendChild(this.thumbShape)},Hb.prototype.valueOffset=function(t,e){var n=this.attributes,i=n.thumbLen,r=n.min,n=n.max,i=this.trackLen-i;return(e=void 0!==e&&e)?t/i:i*tt(t,r,n)},Hb.prototype.getStyle=function(t,e){return void 0===e&&(e="default"),V1(yt(this.attributes,t),e)},Hb.prototype.setThumbOffset=function(t){this.thumbShape.attr(this.getOrientVal(["x","y"]),t)},Hb.prototype.bindEvents=function(){this.trackShape.addEventListener("click",this.onTrackClick),this.thumbShape.addEventListener("mousedown",this.onDragStart),this.thumbShape.addEventListener("touchstart",this.onDragStart),this.onHover()},Hb.prototype.getOrientVal=function(t){return"horizontal"===this.attributes.orient?t[0]:t[1]},Hb.prototype.onHover=function(){this.thumbShape.addEventListener("mouseenter",this.onThumbMouseenter),this.trackShape.addEventListener("mouseenter",this.onTrackMouseenter),this.thumbShape.addEventListener("mouseleave",this.onThumbMouseleave),this.trackShape.addEventListener("mouseleave",this.onTrackMouseleave)},Hb.defaultOptions={type:Hb.tag="scrollbar",style:{orient:"vertical",width:10,height:200,value:0,min:0,max:1,isRound:!0,thumbLen:20,padding:[2,2,2,2],trackStyle:{default:{fill:"#fafafa",lineWidth:1,stroke:"#e8e8e8"},active:{}},thumbStyle:{default:{fill:"#c1c1c1"},active:{opacity:.8}}}};Object.defineProperty(Wb.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(Wb.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(Wb.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(Wb.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(Wb.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Wb.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),Wb.prototype.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},Wb.prototype.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},Wb.prototype.add=function(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},Wb.prototype.rotate=function(t,e,n){t=this.rotatedPoints(t,e,n);return this.clear().add(t[0],t[1]).add(t[2],t[3]).add(t[4],t[5]).add(t[6],t[7])},Wb.prototype.rotatedPoints=function(t,e,n){var i=this.x1,r=this.y1,o=this.x2,a=this.y2,s=Math.cos(t),t=Math.sin(t),u=e-e*s+n*t,e=n-e*t-n*s;return[[s*i-t*r+u,t*i+s*r+e],[s*i-t*a+u,t*i+s*a+e],[s*o-t*a+u,t*o+s*a+e],[s*o-t*r+u,t*o+s*r+e]].flat(1)},Wb.prototype.set=function(t,e,n,i){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),i<e?(this.y2=e,this.y1=i):(this.y1=e,this.y2=i),this},Wb.prototype.intersects=function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},Wb.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE};var Gb=Wb;function Wb(t){var t=t||{},e=t.left,n=t.top,i=t.right,t=t.bottom;this.x1=null!=e?e:+Number.MAX_VALUE,this.x2=null!=i?i:-Number.MAX_VALUE,this.y1=null!=n?n:+Number.MAX_VALUE,this.y2=null!=t?t:-Number.MAX_VALUE}function Ub(t,c){return[[t[0],t[1],t[2],t[3]],[t[2],t[3],t[4],t[5]],[t[4],t[5],t[6],t[7]],[t[6],t[7],t[0],t[1]]].some(function(t){var e=(r=P(r=c,4))[0],n=r[1],i=r[2],r=r[3],o=(t=P(t,4))[0],a=t[1],i=i-e,r=r-n,s=t[2]-o,t=t[3]-a,u=i*t-s*r;if(0==u)return!1;var l=0<u,e=e-o;return(n=i*(o=n-a)-r*e)<0!=l&&((a=s*o-t*e)<0!=l&&(u<n!=l&&u<a!=l))})}function Yb(t,e,n){void 0===n&&(n=[0,0,0,0]);var i=e.getEulerAngles()||0,r=(e.setEulerAngles(0),e.getLocalBounds()),o=r.min,a=r.max,r=r.halfExtents,s=o[0],u=2*r[0],r=2*r[1],o=o[1],l=a[0],a=a[1],c=0,h=0,d=s,p=o,f=("text"===e.tagName&&(r-=1.5,f=e.style.textAlign,y=e.style.textBaseline,c=+e.style.dx,h=+e.style.dy,"center"===f?d=(s+l)/2:"right"!==f&&"end"!==f||(d=l),"middle"===y?p=(o+a)/2:"bottom"!==y&&"baseline"!==y||(p=a)),P(n,4)),l=f[0],y=void 0===l?0:l,a=f[1],n=void 0===a?0:a,l=f[2],a=f[3];return t.set((c+=s)-(void 0===a?n:a),(h+=o)-y,c+u+n,h+r+(void 0===l?y:l)),e.setEulerAngles(i),t.rotatedPoints(i*R1,d,p)}function qb(t,e,n){var i,t=Yb(new Gb,t,n),e=Yb(new Gb,e,n),n=Ub(e,[t[0],t[1],t[2],t[3]])||Ub(e,[t[0],t[1],t[4],t[5]])||Ub(e,[t[4],t[5],t[6],t[7]])||Ub(e,[t[2],t[3],t[6],t[7]]);return localStorage.getItem("__debug__")&&window.canvas&&((i=function(t,e){return void 0===e&&(e="red"),window.canvas.appendChild(new Mh({style:{lineWidth:1,stroke:e,path:[["M",t[0],t[1]],["L",t[2],t[3]],["L",t[4],t[5]],["L",t[6],t[7]],["Z"]]}}))})(t),i(e,"blue")),n}function Xb(t,i){var r;return z([],P(t.reduce(function(t,e,n){return n&&r&&qb(r,e,i)?(t.add(r),t.add(e)):r=e,t},new Set)),!1)}function Kb(t,e,n){return"top"===t||"bottom"===t?e:n}function Zb(t,e,n){return"left"===t||"right"===t?e:n}function $b(t,e,n){return"outside"===t?e:n}var Jb=function(t,e,n){return"left"===t?e:n},Qb=function(t,e,n){return"right"===t?e:n},tk=function(t,e,n){return"left"===t||"top"===t||"inside"===t?e:n},ek=Math.abs;function nk(t,e){var t=P(t,2),n=t[0],t=t[1];if(void 0===e&&(e=1),0===n&&0===t)return[n,t];function i(t){return t=ek(t),1===e?t:-t}return Fo([0,0],0===n||0===t?[i(t),i(n)]:[1,-n/t])}var o={style:{title:{content:"",style:{fontSize:12,fill:"black"},rotate:void 0,maxLength:260},ticks:[],ticksThreshold:100,axisLine:{style:{stroke:"#416180",lineWidth:.5,strokeOpacity:.85}},tickLine:{len:6,style:{stroke:"#416180",strokeOpacity:.65,lineWidth:.5}},subTickLine:{len:4,count:0,style:{stroke:"#416180",strokeOpacity:.45,lineWidth:.5}},label:{type:"text",style:{fill:"black",fontSize:12},alignTick:!0,tickPadding:2,margin:[0,0,0,0],overlapOrder:["autoRotate","autoEllipsis","autoHide"],autoRotate:!1,autoEllipsis:!1,autoHide:!1,autoHideTickLine:!0,showLast:!0,showFirst:!0,optionalAngles:[0,45,90],minLabel:0,minLength:14,maxLength:160,ellipsisStep:" "},verticalFactor:1}},ik=(O({},o,{style:{type:"arc"}}),O({},o,{style:{}}),{year:[["year","second"],["year","day"],["month","day"],["day","day"]],month:[["month","day"],["day","day"]],day:[["month","day"],["day","day"]],hour:[["hour","second"],["hour","minute"],["hour","hour"]],minute:[["minute","second"],["second","second"]],second:[["second","second"]]});function rk(t,i){for(var r,o=t.map(function(t,e){return[t.id,{text:t.style.text,value:t.style.tip||t.style.text,idx:e}]}),a=new Map(o),e=ot(o,function(t){t=P(t,2),t[0],t=t[1].value;return new Date(t).getTime()}).text,n=rt(o,function(t){t=P(t,2),t[0],t=t[1].value;return new Date(t).getTime()}).text,s=(n=n,e=P([X1(e=e),X1(n)],2),n=e[0],e=e[1],n.getFullYear()!==e.getFullYear()?"year":n.getMonth()!==e.getMonth()?"month":n.getDay()!==e.getDay()?"day":n.getHours()!==e.getHours()?"hour":n.getMinutes()!==e.getMinutes()?"minute":"second"),u=new Date("1970-01-01 00:00:00"),l=M1(t[0]),c=0;c<ik[s].length;c+=1){var h=ik[s][c];if(_t(Z1(u,K1(h)),l)<i){r=h;break}r=h}return function(t,e){var e=a.get(e.id).idx;if(0===e)return t;var e=null==(e=o[e-1])?void 0:e[1].text,t=new Date(t),n=r;return $1(new Date(e),s)!==$1(t,s)&&(n=function(t,e,n,i){for(var r=[],o=P(t,2)[1],a=Y1.indexOf(o),s=0;s<=a;s+=1){var u=[Y1[s],o];if(_t(Z1(e,K1(u)),i)<n){r=u;break}}return r}(r,t,i,l)),Z1(t,K1(n))}}function ok(a,s,t){if(!(s.length<=1))for(var e=t.ellipsisStep,n=t.minLength,i=t.maxLength,r=t.margin,u=void 0===r?[]:r,l=t.labelType,c=M1(s[0]),o=E1(e,c)||1,h=E1(n,c)||1,r=E1(i,c),d=(!Y(r)&&r!==1/0||(r=Math.max.apply(null,s.map(function(t){return t.getBBox().width}))),Date.now()),p=s.slice(),t=P(u,4),e=(t[0],t[1]),f=void 0===e?0:e,n=(t[2],t[3]),y=void 0===n?f:n,v=function(e){if((p=Xb(s,u)).length<1)return{value:void 0};if(300<Date.now()-d)return{value:void 0};var t,n,i,r=function(t,e){return""},o=Kb(a,e-y-f,e),r="time"===l?rk(s,o):"number"===l?(o=o,n=(t=s).map(function(t,e){return{text:t.style.text,value:Number(t.style.tip||t.style.text)}}),n=Number(rt(n,function(t){t=t.text;return(null==t?void 0:t.length)||0}).value),t=M1(t[0]),i=A1(n),_t(i,t)<=o?function(t,e){return A1(Number(t))}:(i=N1(n),_t(i,t)<=o?function(t,e){return N1(Number(t),1)}:function(t,e){return Number(t).toExponential()})):function(t){return w1(t,e,c)};p.forEach(function(t,e){var n=t.style.tip||t.style.text,n=(t.style.tip=n,r.call(null,n,t));t.attr("text",n)})},g=r;h+o<g;g-=o){var m=v(g);if("object"==typeof m)return m.value}}var ak=function(t,e){var e=e.seq,n=void 0===e?2:e;return t.filter(function(t,e){return!(e%n)||!(t.style.visibility="hidden")})};function sk(t,e,n){var i=e.length;if(!(i<=1||2===i&&null!=n&&n.showFirst&&null!=n&&n.showLast)){var r,o,a,s=ak,u=2,l=e.slice(),c=e.slice(),h=Date.now(),d=Math.min.apply(null,e.map(function(t){return t.getBBox().width}))||1;for("top"!==t&&"bottom"!==t||(t=W1(e[0]).left,e=W1(e[i-1]).right,e=Math.abs(e-t)||1,u=Math.max(Math.floor(i*d/e),u)),null!=n&&n.showFirst&&(r=l.splice(0,1)[0]),null!=n&&n.showLast&&(o=l.splice(-1,1)[0],l.reverse());Xb((o?z(z([o],P(c),!1),[r],!1):z([r],P(c),!1)).filter(function(t){return rb(t)}),null==n?void 0:n.margin).length;)if(o&&!r&&u%2==0?l.splice(0,1).forEach(function(t){return t.style.visibility="hidden"}):o&&r&&l.splice(0,1).forEach(function(t){return t.style.visibility="hidden"}),c=s(((a=l).forEach(function(t){return t.style.visibility="visible"}),a),{seq:u}),u++,200<Date.now()-h)return}}function uk(o,t,e){for(var n=e.optionalAngles,a=void 0===n?[0,45,90]:n,i=e.margin,r=function(r){if(t.forEach(function(t){return e=o,t=t,n=a[r],t.setEulerAngles(n),void(n&&(i=tk(e,-1,1),e=Jb(e,"end",Qb(e,"start",I1(D1(i,n),"left",L1(D1(i,n),"right")))),t.style.textAlign=e));var e,n,i}),Xb(t,i).length<1)return"break"},s=0;s<a.length&&"break"!==r(s);s++);}var lk,ck=new Map([["autoHide",{getDefault:function(){return sk},equidistance:sk,greedy:function(t,e,n){var i,r=e.length;r<=1||2===r&&null!=n&&n.showFirst&&null!=n&&n.showLast||e.slice().forEach(function(t,e){e&&i&&qb(i,t,null==n?void 0:n.margin)?e===r-1&&null!=n&&n.showLast?i.style.visibility="hidden":t.style.visibility="hidden":i=t})}}],["autoRotate",{getDefault:function(){return uk}}],["autoEllipsis",{getDefault:function(){return ok},ellipsis:ok}]]),b=(t(hk,lk=d),hk.prototype.init=function(){this.selection=I(this),this.axisLineGroup=this.appendChild(new xh({className:"axis-line-group"})),this.axisTickGroup=this.appendChild(new xh({className:"axis-tick-group"})),this.axisSubTickGroup=this.appendChild(new xh({className:"axis-subtick-group"})),this.axisLabelGroup=this.appendChild(new xh({className:"axis-label-group"}))},hk.prototype.connectedCallback=function(){this.update()},hk.prototype.update=function(t){this.attr(t=void 0===t?{}:t),b1(this.axisLineGroup,"axis-line",Mh,[this.getLinePath()]),b1(this.axisLineGroup,"axis-arrow$$",D,this.getLineArrow()),this.optimizedTicks=this.calcOptimizedTicks(),this.drawTickLines(),this.drawLabels(),this.processOverlap(),this.drawTitle()},hk.prototype.clear=function(){},hk.prototype.calcOptimizedTicks=function(){var t,n,e=this.style.ticksThreshold,i=Array.from(this.style.ticks||[]).map(function(t,e){return E({id:"".concat(e)},t)}),r=i.length,o=i;return"number"==typeof e&&e<(t=i.length)&&(n=Math.ceil(t/e),o=i.filter(function(t,e){return e%n==0||e===r-1})),o},hk.prototype.drawTickLines=function(){var t=this.getTickLineItems(),t=(b1(this.axisTickGroup,"axis-tick",Th,t),this.getSubTickLineItems());b1(this.axisSubTickGroup,"axis-subtick",Th,t)},hk.prototype.drawLabels=function(){var t=this.getLabelAttrs();this.labels=b1(this.axisLabelGroup,"axis-label",Dh,t)},hk.prototype.canProcessOverlap=function(t){var e=this.style.label;return!!e&&("autoRotate"!==t||Y(e.rotate))},hk.prototype.processOverlap=function(){var t,i,r,o=this,a=this.style.label;a&&(t=void 0===(t=a.overlapOrder)?[]:t,i=E({labelType:a.type},vt(a,["optionalAngles","minLength","maxLength","ellipsisStep","showFirst","showLast","margin"])),r=this.labels,t.forEach(function(t){var e=ck.get(t),n=a[t];e&&n&&o.canProcessOverlap(t)&&(t=e.getDefault(),"function"==typeof n?t=n:"object"==typeof n?(t=e[n.type]||bt,i=E(E({},i),n.cfg)):"string"==typeof n&&(t=e[n]||bt),t(o.axisPosition,r,i))}),this.autoHideTickLine())},hk.prototype.autoHideTickLine=function(){var t,n;null!=(t=this.style.label)&&t.autoHideTickLine&&(n=this.axisTickGroup.querySelectorAll(".axis-tick"),this.labels.forEach(function(t,e){e=n[e];e&&("hidden"===t.style.visibility&&e?e.style.visibility="hidden":e.style.visibility="visible")}))},hk.tag="axisBase",hk);function hk(t){t=lk.call(this,t)||this;return t.optimizedTicks=[],t.labels=[],t.init(),t}D.registerSymbol("axis-arrow",function(t,e,n){return[["M",t,e],["L",t-n,e-n],["L",t+n,e],["L",t-n,e+n],["L",t,e]]});var dk=Math.abs,pk=Math.cos,fk=Math.sin;function yk(t,e,n,i,r){void 0===r&&(r=0);var t=P(t,2),o=t[0],t=t[1],n=n*R1,a=e*pk(n),s=e*fk(n),i=tk(i,-1,1);return[[o+a,t+s],[o+(e+D1(i,r))*pk(n),t+(e+D1(i,r))*fk(n)]]}function vk(t,e,n,i){void 0===i&&(i=0);var t=P(t,2),r=P(t[0],2),o=r[0],r=r[1],t=P(t[1],2),a=t[0],t=t[1],e=P([e*(a-o)+o,e*(t-r)+r],2),s=e[0],e=e[1],a=Fo([0,0],[dk(a-o),-dk(t-r)]),o=tk(n,-1,1),n=P(jo([0,0],(t=a,!(r=[])?(r[0]=t[1],r[1]=-1*t[0]):(r[0]=-1*t[1],r[1]=t[0]),r),i),2),a=n[0],t=n[1];return[[s,e],[s+D1(o,a),e+D1(o,t)]]}function gk(t){var e=t.ticks,s=t.endPoints,u=t.orient,n=t.len,l=void 0===n?0:n,c=t.axisType,h=t.style,n=t.center,d=void 0===n?[0,0]:n,n=t.radius,p=void 0===n?0:n,n=t.startAngle,f=void 0===n?0:n,n=t.endAngle,y=void 0===n?0:n;return Array.from(e).map(function(t){var e,n,i=P(vk(s,t.value,u,l),2),r=P(i[0],2),o=r[0],r=r[1],i=P(i[1],2),a=i[0],i=i[1];return"arc"===c&&(e=(y-f)*t.value+f,e=P(yk(d,p,e,u,l),2),o=(n=P(e[0],2))[0],r=n[1],a=(n=P(e[1],2))[0],i=n[1]),E(E({visibility:"visible"},h),{id:"tick-".concat(t.id),x1:o,y1:r,x2:a,y2:i})})}function mk(t){var h=t.ticks,d=t.orient,p=t.endPoints,e=t.len,f=void 0===e?0:e,e=t.count,y=void 0===e?0:e,v=t.axisType,e=t.center,g=void 0===e?[0,0]:e,e=t.radius,m=void 0===e?0:e,e=t.startAngle,b=void 0===e?0:e,e=t.endAngle,k=void 0===e?0:e,x=t.style;return y<=0?[]:Array.from(h).map(function(l,c){return"arc"!==v&&c===h.length-1?[]:Array(y).fill(null).map(function(t,e){var n,i,r=P([[0,0],[0,0]],2),o=P(r[0],2),a=o[0],o=o[1],r=P(r[1],2),s=r[0],r=r[1],u=(((null==(u=h[c+1])?void 0:u.value)||1)-l.value)/(y+1),u=l.value+u*(e+1);return r="arc"===v?(n=P(yk(g,m,(k-b)*u+b,d,f),2),a=(i=P(n[0],2))[0],o=i[1],s=(i=P(n[1],2))[0],i[1]):(n=P(vk(p,u,d,f),2),a=(i=P(n[0],2))[0],o=i[1],s=(u=P(n[1],2))[0],u[1]),E(E({visibility:"visible"},x),{id:"sub-".concat(l.id,"-").concat(e),x1:a,y1:o,x2:s,y2:r})})}).flat()}D.registerSymbol("axis-arrow",function(t,e,n){var i=t+2*n;return[["M",t,e],["L",i,e],["L",i-n,e-n],["L",i+n,e],["L",i-n,e+n],["L",i,e]]});t(xk,bk=b),Object.defineProperty(xk.prototype,"axisPosition",{get:function(){var t,e=this.getAxesVector();return e=e,t=this.style.verticalFactor||1,void 0===e&&(e=[0,0]),void 0===t&&(t=1),Math.abs(e[0])>Math.abs(e[1])?1===t?"bottom":"top":-1===t?"left":"right"},enumerable:!1,configurable:!0}),xk.prototype.connectedCallback=function(){bk.prototype.connectedCallback.call(this),this.bindEvents()},xk.prototype.update=function(t){bk.prototype.update.call(this,J1({},xk.defaultOptions.style,this.attributes,t=void 0===t?{}:t))},xk.prototype.getEndPoints=function(){var t=this.style;return[t.startPos||[0,0],t.endPos||[0,0]]},xk.prototype.getTitleBounds=function(){var t=P(this.getEndPoints(),2),e=P(t[0],2),n=e[0],e=e[1],t=P(t[1],2),i=t[0],t=t[1],r=(i<n&&(i=(r=P([n,i],2))[0],n=r[1]),t<e&&(t=(r=P([e,t],2))[0],e=r[1]),[n,e]),n={min:r,max:[i,t]},e=(this.axisLabelGroup&&(n=this.axisLabelGroup.getLocalBounds()),this.style.title||{}),i=e.positionX,t=e.positionY;return"number"==typeof i&&(n.min[0]=i+r[0],n.max[0]=i+r[0]),"number"==typeof t&&(n.min[1]=t+r[1],n.max[1]=t+r[1]),n},xk.prototype.drawTitle=function(){var t,e,n,i,r,o,a,s=this.style.title,u=this.getTitleBounds(),l=s?(t=s,u=u,l=this.axisPosition,e=void 0===(e=t.content)?"":e,n=t.rotate,i=void 0===(i=t.titleAnchor)?"start":i,r=t.titlePadding,t=void 0===(t=t.style)?{}:t,o=e||"",a=tk(l,-1,1),n=null!=n?n:Kb(l,0,D1(a,90)),a=l,l=i,void 0===(i=r)&&(i=0),u=[((r=u).max[0]-r.min[0])/2,(r.max[1]-r.min[1])/2],c={start:r.min[1],end:r.max[1],center:r.min[1]+u[1]},u={start:r.min[0],end:r.max[0],center:r.min[0]+u[0]},c="left"===a?{x:r.min[0]-+i,y:c[l],textAlign:{start:"end",end:"start",center:"center"}[l],textBaseline:"bottom"}:"right"===a?{x:r.max[0]+ +i,y:c[l],textAlign:{start:"start",end:"end",center:"center"}[l],textBaseline:"bottom"}:"top"===a?{x:u[l],y:r.min[1]-+i,textAlign:l,textBaseline:"bottom"}:{x:u[l],y:r.max[1]+ +i,textAlign:l,textBaseline:"top"},a=c.x,u=c.y,r=c.textAlign,i=c.textBaseline,E(E(E({},F1),{x:a,y:u,tip:e,text:o,transform:"rotate(".concat(n,"deg)"),textAlign:r,textBaseline:i}),t)):{fontSize:0},c=x1(this,".axis-title","text").attr("className","axis-title").call(k1,l).node();c&&null!=s&&s.maxLength&&(a=w1(c.style.text,s.maxLength,M1(c)),c.style.text=a)},xk.prototype.getLinePath=function(){var t=this.style.axisLine,e=P(this.getEndPoints(),2),n=P(e[0],2),i=n[0],n=n[1],e=P(e[1],2),r=e[0],e=e[1],o=null==t?void 0:t.style;return E(E({},o),{visibility:t?"visible":"hidden",animate:null==t?void 0:t.animate,path:[["M",i,n],["L",r,e]]})},xk.prototype.getLineArrow=function(){var t,e,n,i=this.style.axisLine,r=(null==i?void 0:i.arrow)||{},o=r.start,r=r.end,a=P(this.getEndPoints(),2),s=P(a[0],2),u=s[0],s=s[1],a=P(a[1],2),l=a[0],a=a[1],c=[],i=(null==i?void 0:i.style)||{},i=E({symbol:"axis-arrow",size:10,fill:"grey",stroke:"grey",lineWidth:1},i);return o&&(t=Kb(this.axisPosition,-90,-45),n=P([[Math.min(u,l),Math.min(s,a)]],1),e=(n=P(n[0],2))[0],n=n[1],c.push(E(E(E({id:"start-arrow"},i),{transformOrigin:"left",transform:"rotate(".concat(t,"deg)"),x:e,y:n}),o))),r&&(t=Kb(this.axisPosition,0,45),e=P([[Math.max(u,l),Math.max(s,a)]],1),o=(n=P(e[0],2))[0],u=n[1],c.push(E(E(E({id:"end-arrow"},i),{transformOrigin:"left",transform:"rotate(".concat(t,"deg)"),x:o,y:u}),r))),c},xk.prototype.getTickLineItems=function(){var t=this.style.tickLine;return t?gk(E(E({},t),{ticks:this.optimizedTicks,orient:this.axisPosition,endPoints:this.getEndPoints(),axisType:"linear"})):[]},xk.prototype.getSubTickLineItems=function(){var t=this.style.subTickLine;return t?mk(E(E({},t),{ticks:this.optimizedTicks,orient:this.axisPosition,endPoints:this.getEndPoints(),axisType:"linear"})):[]},xk.prototype.getLabelAttrs=function(){var l=this,t=this.style,e=t.label,t=t.tickLine;if(!e)return[];var c=(null==t?void 0:t.len)||0,h=this.optimizedTicks||[],d=this.axisPosition,p=e.formatter,t=e.tickPadding,f=void 0===t?0:t,t=e.offset,y=void 0===t?0:t,t=e.alignTick,v=void 0===t||t,t=e.rotate,g=void 0===t?0:t,m=e.maxLength,t=e.style,b=void 0===t?{}:t,k=tk(d,-1,1);return Array.from(h).map(function(t,e){var n=t.value,i=(v||(n=(((null==(i=h[e+1])?void 0:i.value)||n)+n)/2+(r||0)/2),P(vk(l.getEndPoints(),n,d,c+f),2)),r=P(i[1],2),n=r[0],r=r[1],o=p?p(t,e):t.text,e="function"==typeof b?b.call(null,t,e):b,a=Kb(d,"center",Jb(d,"end","start")),s=(g&&(a=Jb(d,"end",Qb(d,"start",I1(D1(k,g),"left",L1(D1(k,g),"right"))))),P1(l.selection.node(),E(E({},e),{text:o||""}))),u=E1(m,s);return E(E(E({},F1),{id:"label-".concat(t.id),orient:d,visibility:"visible",x:n+Kb(d,y,0),y:r+Zb(d,y,0),tip:o,text:rb(u)?w1(o,u,s,"..."):o,textAlign:a,textBaseline:Zb(d,"middle","top"===d?"bottom":"top"),transform:"rotate(".concat(g||0,"deg)")}),e)})},xk.prototype.getAxesVector=function(){var t=P(this.getEndPoints(),2),e=P(t[0],2),n=e[0],e=e[1],t=P(t[1],2);return Fo([0,0],[t[0]-n,t[1]-e])},xk.prototype.getVerticalVector=function(t){var e=this.attributes.verticalFactor,e=void 0===e?1:e;return jo([0,0],nk(this.getAxesVector()),e)},xk.prototype.bindEvents=function(){var e=this;this.addEventListener(C.BOUNDS_CHANGED,function(t){"axis-label-group"===t.target.className&&e.drawTitle()})},xk.defaultOptions={type:xk.tag="cartesian",style:E({startPos:[0,0],endPos:[0,0]},o.style)};var bk,kk=xk;function xk(t){return bk.call(this,J1({},xk.defaultOptions,t))||this}function wk(t){var e;return it(t[0],0)?e="center":0<t[0]?e="start":t[0]<0&&(e="end"),e}function Sk(c,t){var h=t.orient,e=t.ticks,e=void 0===e?[]:e,d=t.center,p=t.radius,f=t.startAngle,y=t.endAngle,n=t.tickLength,v=void 0===n?0:n,g=t.maxLength,m=t.style,b=tk(h,-1,1),n=t.tickPadding,k=void 0===n?0:n,x=t.formatter,w=t.align,S=t.rotate;return Array.from(e).map(function(t,e){var n=(y-f)*t.value+f,i=270<=(i=n)?(i-360)%360:i,n=P(yk(d,p,n,h,v+k),2),n=P(n[1],2),r=n[0],n=n[1],o=x?x(t,e):t.text,e="function"==typeof m?m.call(null,t,e):m,a="center",s="baseline",u=[D1(b,r-d[0]),D1(b,n-d[1])],u=("radial"===w?(s="middle",(90<=i||i<-90)&&(i+=180),a=wk(u),it(i,-90)&&(a=$b(h,"start","end")),it(i,270)&&(a=$b(h,"end","start"))):s="tangential"===w?(i=90+i,a="center",$b(h,"bottom","top")):(i=null!=S?S:0,a=wk(u),it((u=u)[1],0)?l="middle":0<u[1]?l="top":u[1]<0&&(l="bottom"),l),P1(c.node(),E(E({},e),{text:o||""}))),l=E1(g,u);return E(E(E({},F1),{id:"label-".concat(t.id),orient:h,limitLength:l,visibility:"visible",x:r,y:n,tip:o,text:o&&rb(l)?w1(o,l,u,"..."):o||"",textAlign:a,textBaseline:s,transform:"rotate(".concat((i||0).toFixed(0),"deg)")}),e)})}var Ek,Tk=Math.PI,_k=Math.abs,Mk=Math.cos,Pk=Math.sin,Ok=P([2*Tk],1)[0],Ck=(t(Ak,Ek=b),Object.defineProperty(Ak.prototype,"axisPosition",{get:function(){return-1===this.style.verticalFactor?"inside":"outside"},enumerable:!1,configurable:!0}),Ak.prototype.update=function(t){Ek.prototype.update.call(this,J1({},Ak.defaultOptions.style,this.attributes,t=void 0===t?{}:t))},Ak.prototype.getLinePath=function(){var t=this.style,e=t.radius,n=t.center,n=void 0===n?[0,0]:n,t=t.axisLine,i=this.getRadians(),r=i.startAngle,i=i.endAngle,o=this.getEndPoints(),a=(null==t?void 0:t.style)||{},o=P(o,2),s=P(o[0],2),u=s[0],s=s[1],o=P(o[1],2),l=o[0],o=o[1],n=P(n,2),c=n[0],n=n[1],h=_k(i-r),e=P([null!=e?e:0,null!=e?e:0],2),d=e[0],e=e[1],p=[];return p=h===Ok?[["M",c,n-e],["A",d,e,0,1,1,c,n+e],["A",d,e,0,1,1,c,n-e]]:[["M",c,n],["L",u,s],["A",d,e,0,Tk<h?1:0,i<r?0:1,l,o],["L",c,n]],E(E({},a),{visibility:t?"visible":"hidden",animate:null==t?void 0:t.animate,path:p})},Ak.prototype.getLineArrow=function(){return[]},Ak.prototype.drawTitle=function(){var t,e,n,i,r=this.style.title,o=x1(this,".axis-title","text").attr("className","axis-title");r?(e=(n=P(this.style.center,2))[0],n=n[1],i=r.style||{},t=r.content||"",e=E(E({x:e,y:n,text:t},i),{textAlign:i.textAlign||"center",textBaseline:i.textBaseline||"middle"}),n=P1(this.selection.node(),e),i=rb(r.maxLength)?w1(t,r.maxLength,n):t,o.call(k1,E(E({id:"axis-title"},e),{tip:t,text:i}))):o.style("fontSize",0)},Ak.prototype.getTickLineItems=function(){var t=this.style,e=t.tickLine,n=t.center,i=t.radius,r=t.startAngle,t=t.endAngle;return e?gk(E(E({},e),{ticks:this.optimizedTicks,orient:this.axisPosition,endPoints:this.getEndPoints(),center:n,radius:i,startAngle:r,endAngle:t,axisType:"arc"})):[]},Ak.prototype.getSubTickLineItems=function(){var t=this.style,e=t.subTickLine,n=t.center,i=t.radius,r=t.startAngle,t=t.endAngle;return e?mk(E(E({},e),{ticks:this.optimizedTicks,orient:this.axisPosition,endPoints:this.getEndPoints(),center:n,radius:i,startAngle:r,endAngle:t,axisType:"arc"})):[]},Ak.prototype.getLabelAttrs=function(){var t=this.style,e=t.radius,n=t.center,n=void 0===n?[0,0]:n,i=t.label,r=t.tickLine,o=t.startAngle,o=void 0===o?0:o,t=t.endAngle,t=void 0===t?0:t;return i?Sk(this.selection,E(E({},i),{startAngle:o,endAngle:t,radius:null!=e?e:0,center:n,tickLength:null==r?void 0:r.len,ticks:this.optimizedTicks,orient:this.axisPosition})):[]},Ak.prototype.getVerticalVector=function(t){var e=this.style,n=e.verticalFactor,n=void 0===n?1:n,e=P(e.center,2),i=e[0],e=e[1],t=P(this.getValuePoint(t),2),i=P(Fo([0,0],[t[0]-i,t[1]-e]),2);return jo([0,0],[i[0],i[1]],n)},Ak.prototype.getValuePoint=function(t){var e=this.attributes,n=e.center,e=e.radius,n=P(n,2),i=n[0],n=n[1],r=this.getRadians(),o=r.startAngle,r=(r.endAngle-o)*t+o;return[i+e*Mk(r),n+e*Pk(r)]},Ak.prototype.getEndPoints=function(){var t=this.style,e=t.center,t=t.radius,e=P(e,2),n=e[0],e=e[1],i=this.getRadians(),r=i.startAngle,i=i.endAngle;return[[n+t*Mk(r),e+t*Pk(r)],[n+t*Mk(i),e+t*Pk(i)]]},Ak.prototype.getRadians=function(){var t=this.style,e=t.startAngle,e=void 0===e?0:e,t=t.endAngle,t=void 0===t?0:t;return _k(e)<Ok&&_k(t)<Ok?{startAngle:e,endAngle:t}:{startAngle:e*R1,endAngle:t*R1}},Ak.defaultOptions={type:Ak.tag="arc",style:E({startAngle:-90,endAngle:270,center:[0,0],label:{tickPadding:2,style:{},align:"normal"}},o.style)},Ak);function Ak(t){return Ek.call(this,J1({},Ak.defaultOptions,t))||this}var Nk,Lk=new Map,Ik=(Lk.set("timeline-prev-button",function(t,e,n){return[["M",t+n,e+n],["L",t,e],["L",t+n,e-n],["M",t,e+n],["L",t-n,e],["L",t,e-n]]}),Lk.set("timeline-next-button",function(t,e,n){return[["M",t,e+n],["L",t+n,e],["L",t,e-n],["M",t-n,e+n],["L",t,e],["L",t-n,e-n]]}),Lk.set("timeline-play-button",function(t,e,n){return[["M",t+2,e+3],["L",t+2,e-3],["M",t-2,e+3],["L",t-2,e-3]]}),Lk.set("timeline-stop-button",function(t,e,n){return[["M",t+3,e],["L",t-1.5,e-1.5*Math.sqrt(3)],["L",t-1.5,e+1.5*Math.sqrt(3)],["Z"]]}),t(Dk,Nk=yh),Dk.prototype.connectedCallback=function(){this.render(),this.bindEvents()},Dk.prototype.update=function(t){this.attr(O({},this.attributes,t=void 0===t?{}:t)),this.render()},Dk.prototype.render=function(){var t=this.style,e=t.size,e=void 0===e?8:e,n=t.symbol,i=t.markerStyle,t=t.backgroundStyle,r=P(j1(this.style.margin),4),o=r[0],a=r[1],s=r[2],r=r[3],u=P(j1(this.style.padding),4),l=u[0],c=u[1],h=u[2],u=u[3],c=(e-c-u)/2,h=(e-l-h)/2,a=(x1(this,".container","rect").attr("className","container").style("x",-(c+u+r)).style("y",-(h+l+o)).style("width",e+a+r).style("height",e+o+s).style("fill","transparent").style("cursor","pointer").style("zIndex",1),t||{}),r=a.active,o=_(a,["active"]),s=(x1(this,".background","rect").attr("className","background").style("x",-(c+u)).style("y",-(h+l)).style("width",e).style("height",e).call(k1,o).call(k1,this.active?r:{}),"function"==typeof n?n:Lk.get(n)),t=i||{},a=t.active,u=_(t,["active"]);x1(this,".marker","path").attr("className","marker").style("x",0).style("y",0).style("path",null==s?void 0:s(0,0,Math.min(c,h))).call(k1,u).call(k1,this.active?a:{})},Dk.prototype.bindEvents=function(){var e=this,n=I(this).select(".marker"),i=I(this).select(".background");I(this).on("pointerup",function(){return e.active=!0}),I(this).on("pointermove",function(){var t;e.active=!0,k1(n,null==(t=e.style.markerStyle)?void 0:t.active),k1(i,null==(t=e.style.backgroundStyle)?void 0:t.active)}),I(this).on("pointerout",function(){e.active=!1,k1(n,gt(e.style.markerStyle||{},["active"])),k1(i,gt(e.style.backgroundStyle||{},["active"]))})},Dk);function Dk(t){t=Nk.call(this,t)||this;return t.active=!1,t}var r={margin:[2,4],markerStyle:{stroke:"#bfbfbf",active:{stroke:"#3471F9"}},backgroundStyle:{fill:"transparent"}},Rk={x:0,y:0,data:[],width:500,height:40,selection:[0,0],orient:"horizontal",singleModeControl:{width:56,size:12,labelStyle:{text:"单一时间",fontSize:10,dx:4}},speedControl:{width:32,markerSize:4,speeds:[1,2,3,4,5],labelStyle:{fontFamily:"sans-serif",fill:"rgba(0,0,0,0.45)",fontStyle:"normal",fontWeight:500,fontSize:10,textBaseline:"top"},formatter:function(t){return"".concat(t.toFixed(1),"x")}},controlPosition:"bottom",controlButton:{spacing:14,prevBtn:E(E({},r),{symbol:"timeline-prev-btn",padding:0,size:8}),nextBtn:E(E({},r),{symbol:"timeline-next-btn",padding:0,size:8}),playBtn:{margin:4,padding:0,size:20,symbol:"",markerStyle:{stroke:"#bfbfbf",fill:"#bfbfbf",active:{stroke:"#3471F9",fill:"#3471F9"}},backgroundStyle:{stroke:"#bfbfbf",lineWidth:1,fill:"#F7F7F7",active:{fill:"rgba(52, 113, 249, 0.1)",stroke:"#3471F9"}}}},padding:[0,8],playAxis:{appendPadding:[4,0],handleStyle:{r:3,lineWidth:1},label:{position:1,tickPadding:2,tickLine:{len:4,style:{stroke:"rgba(0,0,0,0.25)",lineWidth:1}},style:{fontSize:10,fillOpacity:1,fill:"rgba(0,0,0,0.45)"}},loop:!1},playInterval:2e3,autoPlay:!1},jk=O({},{x:0,y:0,data:[],length:120,orient:"horizontal",selection:0,selectionStyle:{fill:"#5B8FF9",fillOpacity:.15},loop:!1,playInterval:1e3},Rk.playAxis),Bk={axisLine:null,label:{autoRotate:!1,rotate:0,autoHide:!0,autoHideTickLine:!1,autoEllipsis:!0,minLength:50,alignTick:!0}};function Fk(t,e){void 0===t&&(t=[]);var t=P(Array.of(t).flat(),2),n=t[0],n=void 0===n?0:n,t=t[1];return e?[n,n]:[n,void 0===t?n:t]}t(Vk,zk=yh),Vk.prototype.update=function(t){var e=O({},this.attributes,t=void 0===t?{}:t),t=(t.selection&&(this.selection=Fk(t.selection,e.singleMode)),t.singleMode&&(this.selection=Fk(e.selection,t.singleMode)),this.playTimer);t&&this.stop(),this.attr(e),this.render(),t&&this.play()},Vk.prototype.play=function(){var i=this,t=this.style,e=t.data,r=t.loop,o=t.singleMode,a=t.playMode,s=e.length,t=this.style.playInterval;Y(t)&&(t=jk.playInterval),this.playTimer&&clearInterval(this.playTimer),this.playTimer=setInterval(function(){if(!r&&i.selection[1]>=s-1)i.stop(!0);else{if(o)return t=(i.selection[0]+1)%s,void i.setSelection({start:t,end:t});var t=i.selection[0],e=i.selection[1],n=i.selection[1]-i.selection[0],e=s-1<=e?"increase"===a?t:(t=0,n):("increase"!==a&&(t=(t+1)%s),(e+1)%s);i.setSelection({start:t,end:e})}},t)},Vk.prototype.stop=function(t){clearInterval(this.playTimer),this.playTimer=void 0,t&&this.dispatchEvent(new Ts("timelineStopped",{selection:this.selection}))},Vk.prototype.prev=function(){var t,e=P(this.selection,2),n=e[0],e=e[1],i=this.style.data.length,i=i&&this.style.singleMode?t=(n-1+i)%i:0===n?(t=i-(e-n)-1,i-1):(t=n-1,e-1);this.setSelection({start:null!=t?t:this.selection[0],end:null!=i?i:this.selection[1]})},Vk.prototype.next=function(){var t,e=P(this.selection,2),n=e[0],e=e[1],i=this.style.data.length,i=i&&this.style.singleMode?t=(n+1)%i:e===i-1?(t=0,e-n):(t=n+1,e+1);this.setSelection({start:null!=t?t:this.selection[0],end:null!=i?i:this.selection[1]})},Vk.prototype.getSelection=function(){return this.selection},Object.defineProperty(Vk.prototype,"orient",{get:function(){return this.style.orient||"horizontal"},enumerable:!1,configurable:!0}),Vk.prototype.ifH=function(t,e){return"horizontal"===this.orient?"function"==typeof t?t():t:"function"==typeof e?e():e},Vk.prototype.destroy=function(){zk.prototype.destroy.call(this),this.playTimer&&clearInterval(this.playTimer),this.playTimer=void 0};var zk,Vt=Vk;function Vk(){var t=null!==zk&&zk.apply(this,arguments)||this;return t.selection=[0,0],t}function Hk(t,e){return new Yg({domain:t.map(function(t,e){return e}),range:e,padding:.1})}function Gk(t,e,n){n=Hk(n,[0,e]).getStep(),e=0<t?Math.ceil:Math.floor;return 0<n?e(t/n):0}function Wk(t,e,n){return Hk(n,[0,e]).map(t)}t(qk,Uk=Vt),qk.prototype.connectedCallback=function(){this.render(),this.bindEvents()},Object.defineProperty(qk.prototype,"styles",{get:function(){return O({},qk.defaultOptions.style,this.attributes)},enumerable:!1,configurable:!0}),qk.prototype.setSelection=function(t){var e,n,i=t.start,t=t.end,r=this.styles,o=r.data,o=void 0===o?[]:o,r={duration:r.playInterval/2,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",fill:"both"},a=this.ifH("cx","cy"),s=I(this).select(".slider-start-handle").node();void 0!==i&&(n=Wk(i,this.style.length,o),this.startHandleAnimation=s.animate([((e={})[a]=s.style[a],e),((s={})[a]=n,s)],r)),void 0!==t&&(e=I(this).select(".slider-end-handle").node(),n=Wk(t,this.style.length,o),this.endHandleAnimation=e.animate([((s={})[a]=e.style[a],s),((o={})[a]=n,o)],r)),this.selection=[null!=i?i:this.selection[0],null!=t?t:this.selection[1]],this.dispatchEvent(new Ts("selectionChanged",{detail:{selection:this.selection}}))},qk.prototype.render=function(){var e=this,n=this.styles,t=P(this.ifH([n.length,n.size],[n.size,n.length]),2),i=t[0],r=t[1],t=x1(this,".slider-background","line").attr("className","slider-background").style("x1",0).style("y1",0).style("x2",this.ifH(i,0)).style("y2",this.ifH(0,r)).style("lineWidth",n.size).style("lineCap","round").style("stroke",null==(t=n.backgroundStyle)?void 0:t.fill).style("strokeOpacity",null==(t=n.backgroundStyle)?void 0:t.fillOpacity).node(),o=Hk(n.data,[0,1]),a=P(this.selection.map(function(t){return o.map(t)}),2),s=a[0],s=void 0===s?0:s,a=a[1],a=void 0===a?s:a,u=this.ifH(s*i,0),l=this.ifH(a*i,0),s=this.ifH(0,s*r),a=this.ifH(0,a*r),c=(x1(t,".slider-selection","line").attr("className","slider-selection").style("x1",u).style("y1",s).style("x2",l).style("y2",a).style("lineWidth",n.size).style("lineCap","round").style("stroke",null==(h=n.selectionStyle)?void 0:h.fill).style("strokeOpacity",null==(h=n.selectionStyle)?void 0:h.fillOpacity).style("visibility",n.singleMode?"hidden":"visible").call(k1,n.selectionStyle),"running"===(null==(h=this.startHandleAnimation)?void 0:h.playState)&&this.startHandleAnimation.pause(),x1(t,".slider-start-handle","circle").attr("className","slider-start-handle").style("cx",u).style("cy",s).call(k1,n.handleStyle),"paused"===(null==(h=this.startHandleAnimation)?void 0:h.playState)&&this.startHandleAnimation.play(),"running"===(null==(u=this.endHandleAnimation)?void 0:u.playState)&&this.endHandleAnimation.pause(),x1(t,".slider-end-handle","circle").attr("className","slider-end-handle").style("cx",l).style("cy",a).style("visibility",n.singleMode?"hidden":"visible").call(k1,n.handleStyle),"paused"===(null==(s=this.endHandleAnimation)?void 0:s.playState)&&this.endHandleAnimation.play(),n.data.map(function(t,e){return{value:o.map(e),text:t.date}})),h=n.label||{},u=h.position,d=void 0===u?-1:u,p=h.tickLine,f=_(h,["position","tickLine"]);x1(t,".slider-axis",function(){return new kk({className:"slider-axis"})}).call(function(t){return t.node().update(O({},Bk,{startPos:[d*e.ifH(0,i+2),d*e.ifH(r+2,0)],endPos:[e.ifH(i,0)+d*e.ifH(0,i+2),e.ifH(0,r)+d*e.ifH(r+2,0)],ticks:c,verticalFactor:d,tickLine:null===n.label?null:p,label:null===n.label?null:f}))})},qk.prototype.bindEvents=function(){var t=I(this).select(".slider-background"),i=(this.dragHandle(t,"start"),this.dragHandle(t,"end"),this.dragSelection(t),t.select(".slider-selection").node()),e=t.select(".slider-start-handle").node(),t=t.select(".slider-end-handle").node();e.addEventListener(C.ATTR_MODIFIED,function(t){var e=t.attrName,n=t.newValue;t.prevValue,"cx"!==e&&"cy"!==e||(t=parseFloat(n)||0,i.style["cx"===e?"x1":"y1"]=t)}),t.addEventListener(C.ATTR_MODIFIED,function(t){var e=t.attrName,n=t.newValue;t.prevValue,"cx"!==e&&"cy"!==e||(t=parseFloat(n)||0,i.style["cx"===e?"x2":"y2"]=t)})},qk.prototype.dragHandle=function(n,o){function t(t){var e,n,i,r;l&&(l=!1,t=Gk(s?u.ifH(t.x-s[0],t.y-s[1]):0,u.style.length,u.style.data),s=void 0,e=(n=P(u.selection,2))[0],n=n[1],i=u.style.data.length-1,"start"===o?e===n&&0<t?(r=tt(0,e+t,i),u.setSelection({start:r,end:r})):u.setSelection({start:tt(e+t,0,n)}):e===n&&t<0?(r=tt(0,n+t,i),u.setSelection({start:r,end:r})):u.setSelection({end:tt(n+t,e,i)}),u.playTimer&&u.play())}var a,s,u=this,l=!1;n.on("pointerdown",function(t){u.playTimer&&clearInterval(u.playTimer);var e=n.select(".slider-".concat(o,"-handle")).node();t.target===e&&(l=!0,s=[t.x,t.y],a=[t.x,t.y])}.bind(this)).on("pointerup",t).on("mouseupoutside",t).on("touchendoutside",t).on("pointermove",function(t){var e,n,i,r;l&&(e=u.styles.length,n=I(u).select(".slider-".concat(o,"-handle")).node(),i=u.ifH(t.x-a[0],t.y-a[1]),r=n.getLocalPosition(),"vertical"===u.orient?n.style.cy=tt(r[1]+i,0,e):n.style.cx=tt(r[0]+i,0,e),a=[t.x,t.y])})},qk.prototype.dragSelection=function(t){function e(t){u.playTimer&&clearInterval(u.playTimer),t.target===o&&(h=!0,r=[t.x,t.y],s=[t.x,t.y])}function n(t){var e;h&&(h=!1,t=Gk(r?u.ifH(t.x-r[0],t.y-r[1]):0,u.style.length,u.style.data),r=void 0,e=u.selection[1]-u.selection[0],t=tt(u.selection[1]+t,e,u.style.data.length-1),u.setSelection({start:t-e,end:t}),u.playTimer&&u.play())}function i(t){var e,n,i,r,o,a;h&&(e=u.styles.length,n=u.ifH(t.x-s[0],t.y-s[1]),i=(a=P(l.getLocalPosition(),2))[0],a=a[1],r=(o=P(c.getLocalPosition(),2))[0],o=o[1],"vertical"===u.orient?(l.style.cy=tt(a+n,0,e-(o=o-a)),c.style.cy=l.style.cy+o):(a=r-i,l.style.cx=tt(i+n,0,e),c.style.cx=l.style.cx+a),s=[t.x,t.y])}var s,r,u=this,o=t.select(".slider-selection").node(),l=t.select(".slider-start-handle").node(),c=t.select(".slider-end-handle").node(),h=!1;t.on("mousedown",e.bind(this)).on("touchstart",e.bind(this)).on("mouseup",n.bind(this)).on("mouseupoutside",n.bind(this)).on("touchend",n.bind(this)).on("touchendoutside",n.bind(this)).on("mousemove",i.bind(this)).on("touchmove",i.bind(this))},qk.defaultOptions={style:O({},jk,{tag:"slider-axis",size:3,handleStyle:{r:3,stroke:"#8AADF3",strokeOpacity:.75,lineWidth:1,fill:"#fff",fillOpacity:1},backgroundStyle:{fill:"#416180",fillOpacity:.1},selectionStyle:{cursor:"grabbing"}})};var Uk,Yk=qk;function qk(t){t=Uk.call(this,O({},qk.defaultOptions,t))||this;return t.startHandleAnimation=null,t.endHandleAnimation=null,t.selection=Fk(t.style.selection,t.style.singleMode),t}function Xk(t,e){return new Yv({domain:t.map(function(t,e){return e}),range:e,paddingOuter:0,paddingInner:0})}t($k,Kk=Vt),$k.prototype.connectedCallback=function(){this.render(),this.bindEvents()},Object.defineProperty($k.prototype,"styles",{get:function(){return O({},$k.defaultOptions.style,this.attributes)},enumerable:!1,configurable:!0}),$k.prototype.setSelection=function(t){var e,n=P(this.selection,2),i=n[0],n=n[1];this.selection=Fk([null!=(e=t.start)?e:i,null!=(e=t.end)?e:n],this.style.singleMode),this.dispatchEvent(new Ts("selectionChanged",{detail:{selection:this.selection}})),this.render()},$k.prototype.render=function(){var r=this,i=this.styles,o=i.size,a=i.spacing,t=P(this.ifH(["x","y","width","height"],["y","x","height","width"]),4),s=t[0],u=t[1],l=t[2],c=t[3],t=x1(this,".slider-background","rect").attr("className","slider-background").style("x",0).style("y",0).style(l,i.length).style(c,o+a).call(k1,i.backgroundStyle).node(),h=this.getCellScale(),d=h.getBandWidth(),e=i.data.map(function(t,e){var n;return E(((n={})[s]=h.map(e),n[u]=a/2,n[l]=d-i.cellGap,n[c]=o,n),i.cellStyle)}),e=(I(t).selectAll(".cell").data(e).join(function(t){return t.append("rect").attr("className","cell").each(function(t){this.attr(t)})},function(t){return t.each(function(t){this.attr(t)})},function(t){return t.remove()}),e.filter(function(t,e){var n=P(r.selection,2),i=n[0],n=n[1];return i<=e&&e<=n}).map(function(t){return E(E({},t),i.selectionStyle)})),n={duration:this.style.playInterval/2,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",fill:"both"},p=(I(t).selectAll(".selected-cell").data(e).join(function(t){return t.append("rect").attr("className","selected-cell").each(function(t){this.attr(t)})},function(t){return t.each(function(t){this.animate([t],n)})},function(t){return t.remove()}),i.length-2*i.spacing+i.cellGap),f=Xk(i.data,[0,p]),y=i.data.map(function(t,e){return{value:(f.map(e)+(d-i.cellGap)/2)/p,text:t.date}}),e=i.label||{},v=e.position,g=void 0===v?-1:v,m=e.tickLine,b=_(e,["position","tickLine"]),v=-1===g?-2:i.spacing+o+2,k=[i.spacing,v],x=[a+p,v];"vertical"===this.orient&&(k=[k[1],k[0]],x=[x[1],x[0]]),x1(t,".slider-axis",function(){return new kk({className:"slider-axis",style:Bk})}).call(function(t){return t.node().update({startPos:k,endPos:x,ticks:y,verticalFactor:g,tickLine:null===i.label?null:m,label:null===i.label?null:b})})},$k.prototype.bindEvents=function(){this.dragSelection()},$k.prototype.getCellScale=function(){var t=this.styles.cellGap,e=this.styles.length,n=this.styles.spacing;return Xk(this.style.data,[n,e-n+t])},$k.prototype.dragSelection=function(){function t(){i=!1,r.playTimer&&r.play()}var n,r=this,o=I(this).select(".slider-background"),i=!1,a=this.styles.spacing,s=function(t){var e=P(o.node().getPosition(),2),n=e[0],e=e[1],n=r.ifH(n+4,e+a),e=r.styles.cellGap,i=r.getCellScale().getStep();return Math.floor((t-n+e)/i)};o.on("pointerdown",function(t){r.playTimer&&clearInterval(r.playTimer),i=!0,n=r.ifH(t.x,t.y);t=s(n);r.setSelection({start:t,end:t})}).on("pointerup",t).on("mouseupoutside",t).on("touchendoutside",t).on("pointermove",function(t){var e;i&&(t=s(r.ifH(t.x,t.y)),e=(t=P((e=n?s(n):t)<t?[e,t]:[t,e],2))[0],t=t[1],r.setSelection({start:e,end:t}))})},$k.defaultOptions={style:O({},jk,{tag:"cell-axis",backgroundStyle:{fill:"#416180",fillOpacity:.05},size:16,spacing:4,cellGap:2,cellStyle:{fill:"#416180",fillOpacity:.1},selectionStyle:{fillOpacity:.45},label:{autoHideTickLine:!0}})};var Kk,Zk=$k;function $k(t){t=Kk.call(this,O({},$k.defaultOptions,t))||this;return t.selection=Fk(t.style.selection,t.style.singleMode),t}function Jk(t,e){return[1.43,2.79,4.89,7.57,11.66][t]/11.66*e}var Qk,re=O({},Rk.speedControl,{markerFill:"#8c8c8c",spacing:1,lineStyle:{stroke:"#bfbfbf",lineWidth:1}}),tx=(t(ex,Qk=yh),ex.prototype.connectedCallback=function(){this.render(),this.bindEvents()},ex.prototype.update=function(t){this.attr(O({},this.attributes,t=void 0===t?{}:t)),this.render()},Object.defineProperty(ex.prototype,"styles",{get:function(){return O({},ex.defaultOptions.style,this.attributes)},enumerable:!1,configurable:!0}),ex.prototype.render=function(){var t=this.styles,e=t.initialSpeed,n=t.markerSize,i=t.markerFill,r=t.lineStyle,o=t.speeds,a=t.labelStyle,s=t.spacing,t=t.formatter,t=void 0===t?function(t){return"".concat(t)}:t,e=o.indexOf(e),u=2*n,l=Jk(e=-1===e?0:e,2*u),c=n*Math.tan(Math.PI/6)*2,i=(x1(this,".speed-marker","path").attr("className","speed-marker").style("fill",i).style("path",[["M",0,l-c/2],["L",n,l],["L",0,l+c/2],["Z"]]),n-.5),l=x1(this,".line-group","rect").attr("className","line-group").style("x",i).style("y",0).style("width",u).style("height",2*u).style("cursor","pointer").style("fill","transparent").node(),c=o.reduce(function(t,e,n){n=Jk(n,2*u);return t.push(["M",0,n],["L",u,n]),t},[]);x1(l,".speed-path","path").attr("className","speed-path").style("path",c).call(k1,r),x1(this,".speed-label","text").attr("className","speed-label").style("x",i+u+s).style("y",2).style("text",t(o[e])).call(k1,a)},ex.prototype.bindEvents=function(){var e=this,t=this.querySelector(".line-group");t.addEventListener("pointerdown",function(t){return e.onClick(t)}),t.addEventListener("touchmove",function(t){return e.onClick(t)})},ex.prototype.onClick=function(t){var o,e=this.styles,a=e.speeds,n=e.markerSize,e=e.formatter,e=void 0===e?function(t){return"".concat(t)}:e,s=2*n*2,n=this.querySelector(".line-group"),i=I(this).select(".speed-label").node(),r=I(this).select(".speed-marker").node();t.currentTarget===n&&(o=t.y-n.getBBox().y,-1!==(t=a.findIndex(function(t,e){var n=Jk(e,s),i=Jk(e-1,s),r=Jk(e+1,s);if(0===e)return o<n+(Jk(1,s)-n)/2;if(e===a.length-1)return n-(n-i)/2<o;e=[n-(n-i)/2,n+(r-n)/2];return e[0]<=o&&o<e[1]}))&&(i.setAttribute("text",e(a[t])),r.setLocalPosition(0,Jk(t,s)-s/8),this.dispatchEvent(new Ts("speedChanged",{detail:{speed:a[t]}}))))},ex.defaultOptions={type:ex.tag="speed-control",style:re},ex);function ex(t){return Qk.call(this,O({},ex.defaultOptions,t))||this}t(ox,nx=yh),ox.prototype.connectedCallback=function(){this.render(),this.bindEvents()},Object.defineProperty(ox.prototype,"styles",{get:function(){return O({},ox.defaultOptions.style,this.attributes)},enumerable:!1,configurable:!0}),ox.prototype.update=function(t){this.attr(O({},this.attributes,t=void 0===t?{}:t)),Y(t.active)||(this.active=t.active),this.render()},ox.prototype.render=function(){var t,e=this.styles,n=e.size,i=e.buttonStyle,r=e.labelStyle,e=e.symbol,o=i.active,i=_(i,["active"]),i=x1(this,".button","rect").attr("className","button").style("x",0).style("y",0).style("width",n).style("height",n).call(k1,i).call(k1,this.active?o:{}).node();x1(i,".symbol","path").attr("className","symbol").style("x",n/2).style("y",n/2).style("path",[["M",(o=n/2)-(t=i=n/2)/7*4,i-t/14],["L",o-t/7,i+t/7*3],["L",o+t/7*4,i-t/7*3]]).style("lineWidth",1).style("lineCap","round").style("stroke","transparent").style("cursor","pointer").call(k1,this.active?null==e?void 0:e.active:{}),x1(this,".label","text").attr("className","label").style("x",n).style("y",n/2).call(k1,r)},ox.prototype.bindEvents=function(){var t=this;I(this).select(".button").on("pointerdown",function(){t.dispatchEvent(new Ts("singleModeChanged",{detail:{active:!t.active}}))})},ox.defaultOptions={style:{size:12,buttonStyle:{fill:"transparent",stroke:"#000",strokeOpacity:.15,cursor:"pointer",lineWidth:1,radius:2,active:{stroke:"#3471F9",fill:"#3471F9",strokeOpacity:1}},symbol:{active:{stroke:"#fff"}},labelStyle:{text:"",textAlign:"left",textBaseline:"middle",fill:"#000",fillOpacity:.65},cursor:"pointer"}};var nx,ix,rx=ox;function ox(t){t=nx.call(this,O({},ox.defaultOptions,t))||this;return t.active=!1,t.active=t.style.active||!1,t}function ax(t,e,n){var n=O({},Rk,n),i=n.type,r=n.playAxis,o=n.controlButton,a=n.speedControl,s=n.singleModeControl,u=(null==(u=null==r?void 0:r.label)?void 0:u.position)||-1,l=null!=(l=null==r?void 0:r.spacing)?l:(null==(l=null==(l=Zk.defaultOptions)?void 0:l.style)?void 0:l.spacing)||0,c=(null==r?void 0:r.size)||("cell"===i?null==(c=null==(c=Zk.defaultOptions)?void 0:c.style)?void 0:c.size:null==(c=null==(c=Yk.defaultOptions)?void 0:c.style)?void 0:c.size)||4,l=(c+="cell"===i?l:0,P(j1(null==r?void 0:r.appendPadding),4)),h=l[0],d=l[1],p=l[2],l=l[3],f=(null==o?void 0:o.spacing)||0,y=st(o)||st(null==o?void 0:o.playBtn)?0:null==(y=null==o?void 0:o.playBtn)?void 0:y.size,v=st(o)||st(null==o?void 0:o.prevBtn)?0:null==(v=null==o?void 0:o.prevBtn)?void 0:v.size,o=st(o)||st(null==o?void 0:o.nextBtn)?0:null==(o=null==o?void 0:o.nextBtn)?void 0:o.size,g=y/2+v/2+f,m=y/2+o/2+f,b=null===a?0:null==a?void 0:a.markerSize,k=2*b,a=null===a?0:null==a?void 0:a.width,x=2*k+b/2,w=null===s?0:null==s?void 0:s.width,s=null===s?0:(null==s?void 0:s.size)+2;if("vertical"===n.orient)return{axis:{x:(n=l+(-1===u?30:0))+("cell"===i?0:c/2),y:T=(E=v+f+y/2)+y/2+f+h,length:(S=(_=(M=e-s)-4-x)-f-o/2)-f-o/2-p-T},prevBtn:{x:T=n+c/2,y:v/2,size:v},playBtn:{x:T,y:E,size:y},nextBtn:{x:T,y:S,size:o},speedControl:{x:n-a/2,y:_,size:a},singleModeControl:{x:0,y:M}};var S,E=e-w,T=E-8-a,_=(S=r,(S=O({},Rk.playAxis,S).label)?((null==(n=S.tickLine)?void 0:n.len)||0)+(S.tickPadding||0)+(Number(S.style.fontSize)||0)+2:0),M=(-1===u?_:0)+("cell"===i?0:c/2)+h;if("bottom"===t)return{axis:{x:l,y:M,length:e-(l+d)},playBtn:{x:w=e/2,y:r=M+(1===u?_:0)+c+y/2+p,size:y},prevBtn:{x:w-g,y:r,size:v},nextBtn:{x:w+m,y:r,size:o},speedControl:{x:T,y:n=M+(1===u?_:0)+c+p,size:a},singleModeControl:{x:E,y:n+k-s/2}};h="cell"===i?M+c/2:M,e="cell"===i&&-1===u?_+c-x:1===u?M+b/2:M-x;if("left"===t)return{axis:{x:n=(p=(r=(w=v/2)+g)+m)+o/2+l,y:M,length:T-d-n},prevBtn:{x:w,y:h,size:v},playBtn:{x:r,y:h,size:y},nextBtn:{x:p,y:h,size:o},speedControl:{x:T,y:e,size:a},singleModeControl:{x:E,y:e+k-s/2}};i=T-(o/2+f),_=i-m,c=_-g;return{axis:{x:l,y:M,length:c-v/2-d-l},playBtn:{x:_,y:h,size:y},prevBtn:{x:c,y:h,size:v},nextBtn:{x:i,y:h,size:o},speedControl:{x:T,y:e,size:a},singleModeControl:{x:E,y:e+k-s/2}}}function sx(t){t=ix.call(this,O({},{style:Rk},t))||this;return t.speed=1,t.singleMode=!1,t.playing=!1,t.selection=[0,0],t.singleMode=t.style.singleMode||!1,t.selection=Fk(t.style.selection,t.singleMode),t}t(sx,ix=yh),sx.prototype.connectedCallback=function(){this.render(),this.bindEvents()},sx.prototype.update=function(t){this.attr(O({},this.attributes,t=void 0===t?{}:t)),void 0!==t.singleMode&&(this.singleMode=t.singleMode),t.selection&&(this.selection=Fk(t.selection,this.singleMode)),this.render()},Object.defineProperty(sx.prototype,"styles",{get:function(){return O({},Rk,this.attributes)},enumerable:!1,configurable:!0}),sx.prototype.render=function(){var e=this,t=this.styles,n=t.width,i=t.height,r=t.controlPosition,o=t.speedControl,a=t.singleModeControl,t=P(j1(this.styles.padding),4),s=t[0],s=void 0===s?0:s,u=t[1],u=void 0===u?0:u,l=t[2],t=t[3],t=void 0===t?u:t,c=x1(this,".container","g").attr("className","container").style("x",t).style("y",s).node(),h=ax(r,"vertical"===this.style.orient?i-(s+l):n-(t+u),this.styles);this.renderAxis(c,h),this.renderControlButton(c,h),x1(c,".timeline-speed-control",function(){return new tx({})}).attr("className","timeline-speed-control").call(function(t){null===o?t.remove():t.node().update(E(E({x:h.speedControl.x,y:h.speedControl.y},o),{initialSpeed:e.speed}))}),x1(c,".timeline-single-control",function(){return new rx({})}).attr("className","timeline-single-control").call(function(t){null===a?t.remove():t.node().update(E(E({x:h.singleModeControl.x,y:h.singleModeControl.y},a),{active:e.singleMode}))})},sx.prototype.renderAxis=function(t,e){var n=this,i=this.styles.data,r=this.styles.type||"slider",o=I(t).select(".timeline-axis").node(),a="cell"===r?Zk:Yk;o&&o.style.tag!=="".concat(r,"-axis")&&(o.remove(),this.removeChild(o)),x1(t,".timeline-axis",function(){return new a({})}).attr("className","timeline-axis").call(function(t){t.node().update(E({x:e.axis.x,y:e.axis.y,length:e.axis.length,data:i,selection:n.selection,orient:n.style.orient,playInterval:n.style.playInterval/n.speed,singleMode:n.singleMode},n.style.playAxis||{})),t.node().update({handleStyle:{cursor:"vertical"===n.style.orient?"ns-resize":"ew-resize"}})}).node()},sx.prototype.renderControlButton=function(t,n){var e,i=this,r=n.playBtn.size||0,o=n.prevBtn.size||0,a=(null==(e=n.nextBtn)?void 0:e.size)||0;x1(t,".timeline-prev-btn",function(){return new Ik({})}).attr("className","timeline-prev-btn").call(function(t){var e;o?(t.node().update(E(E({},(null==(e=i.style.controlButton)?void 0:e.prevBtn)||{}),{x:n.prevBtn.x,y:n.prevBtn.y,size:o,symbol:"timeline-prev-button"})),t.node().update({markerStyle:{transformOrigin:"center",transform:"vertical"===i.style.orient?"rotate(90deg)":""}})):t.remove()}),x1(t,".timeline-play-btn",function(){return new Ik({})}).attr("className","timeline-play-btn").call(function(t){var e;r?(t.node().update({backgroundStyle:{radius:(n.playBtn.size||0)/2}}),t.node().update(E(E({},(null==(e=i.style.controlButton)?void 0:e.playBtn)||{}),{x:n.playBtn.x,y:n.playBtn.y,size:r,symbol:i.playing?"timeline-play-button":"timeline-stop-button"}))):t.remove()}),x1(t,".timeline-next-btn",function(){return new Ik({})}).attr("className","timeline-next-btn").call(function(t){var e;a?(t.node().update(E(E({},(null==(e=i.style.controlButton)?void 0:e.nextBtn)||{}),{x:n.nextBtn.x,y:n.nextBtn.y,size:a,symbol:"timeline-next-button"})),t.node().update({markerStyle:{transformOrigin:"center",transform:"vertical"===i.style.orient?"rotate(90deg)":""}})):t.remove()}),this.style.autoPlay&&!this.playing&&(this.playing=!0,I(this).select(".timeline-axis").call(function(t){return null==(t=t.node())?void 0:t.play()}),I(this).select(".timeline-play-btn").call(function(t){return null==(t=t.node())?void 0:t.update({symbol:"timeline-play-button"})})),!this.style.autoPlay&&this.playing&&(this.playing=!1,I(this).select(".timeline-axis").call(function(t){return null==(t=t.node())?void 0:t.stop()}),I(this).select(".timeline-play-btn").call(function(t){return null==(t=t.node())?void 0:t.update({symbol:"timeline-stop-button"})}))};var ux,c={style:{x:0,y:0,padding:0,orient:"horizontal",backgroundStyle:{fill:"transparent",lineWidth:0},title:{content:"",spacing:4,align:"left",style:{fontWeight:"bold",fontFamily:"sans-serif",fontSize:12,textAlign:"top",textBaseline:"top",fill:"#2C3542"},formatter:function(t){return t}},label:{style:{fill:"#2C3542",fillOpacity:.65,fontSize:12}}}},lx={symbol:"circle",size:8,style:{default:{fill:"#d3d2d3",fillOpacity:1,lineWidth:0},selected:{},active:{cursor:"pointer"}}},cx={spacing:4,style:{default:{fill:"#646464",fontSize:12,opacity:1,fontWeight:"normal"},selected:{fontSize:12},active:{fontSize:12,cursor:"pointer"},inactive:{fill:"#d3d2d3",opacity:.5}}},hx={spacing:4,style:{default:{fill:"#646464",fontSize:12,opacity:1,fontWeight:"normal"},selected:{fontSize:12},active:{fontSize:12,cursor:"pointer"},inactive:{fill:"#d3d2d3",opacity:.5}}},ve=O({},c,{style:{type:"category",items:[],maxWidth:void 0,maxHeight:void 0,maxCols:void 0,maxRows:void 0,spacing:[8,2],itemBackground:{padding:0,style:{default:{fill:"transparent"},active:{cursor:"pointer"}}},reverse:!(sx.prototype.bindEvents=function(){var e=this,n=I(this).select(".timeline-axis").node(),i=I(this).select(".timeline-play-btn").node();i&&I(i).on("pointerdown",function(t){e.playing?(e.playing=!1,n.stop(),i.update({symbol:"timeline-stop-button"})):(e.playing=!0,n.play(),i.update({symbol:"timeline-play-button"}))}),I(this).on("timelineStopped",function(){e.playing=!1,null!=i&&i.update({symbol:"timeline-stop-button"})}),I(this).on("speedChanged",function(t){e.speed=t.detail.speed,n.update({playInterval:e.style.playInterval/e.speed})}),I(this).select(".timeline-prev-btn").on("pointerdown",function(){return n.prev()}),I(this).select(".timeline-next-btn").on("pointerdown",function(){return n.next()}),I(this).on("singleModeChanged",function(t){e.singleMode=t.detail.active,e.selection=Fk(e.selection,e.singleMode),e.render()}),I(this).on("selectionChanged",function(t){e.selection=t.detail.selection})}),pageNavigator:{loop:!1}}}),dx={width:100,height:20,type:"color",chunked:!1,ticks:[],isGradient:"auto",backgroundColor:"#c5c5c5"},px={style:{fontFamily:"sans-serif",fill:"#2C3542",fillOpacity:.65,fontSize:12},spacing:4,formatter:function(t){return String(t)},align:"rail",flush:!0,maxWidth:30},fx={size:25,stroke:"#c5c5c5",fill:"#fff",lineWidth:1},ge=O({},c,{style:{type:"continuous",color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],label:px,rail:dx,slidable:!0,indicator:{size:8,spacing:10,padding:5,backgroundStyle:{fill:"#262626","background-color":"#262626","border-radius":"5px"},text:{style:{color:"white","font-size":"12px"}}}}}),s=(t(yx,ux=d),yx.prototype.init=function(){this.backgroundShape=this.appendChild(new Lh({className:"legend-background",zIndex:-1})),this.container=this.appendChild(new xh({className:"legend-container"})),this.titleShape=this.container.appendChild(new Dh({className:"legend-title"})),this.innerGroup=this.container.appendChild(new xh({className:"legend-inner-group"}))},yx.prototype.connectedCallback=function(){var t=this;this.init(),this.titleShape.addEventListener(C.BOUNDS_CHANGED,function(){return t.adjustInnerGroup()}),this.container.addEventListener(C.BOUNDS_CHANGED,function(){return t.adjustBackground()}),this.update(),this.bindEvents()},yx.prototype.update=function(t){this.attr(t=void 0===t?{}:t),this.drawTitle(),this.drawInner(),this.applyBackgroundStyle();var t=P(this.padding,4),e=t[0],t=t[3];this.container.setLocalPosition(t,e)},yx.prototype.attributeChangedCallback=function(t){"inset"===t&&this.adjustInnerGroup(),"maxWidth"!==t&&"maxHeight"!==t&&"padding"!==t||this.adjustBackground()},yx.prototype.destroy=function(){this.removeChildren(!0),this.remove()},Object.defineProperty(yx.prototype,"orient",{get:function(){return this.style.orient||"horizontal"},enumerable:!1,configurable:!0}),Object.defineProperty(yx.prototype,"padding",{get:function(){return j1(this.style.padding)},enumerable:!1,configurable:!0}),Object.defineProperty(yx.prototype,"titleStyleProps",{get:function(){var t,e=this.style.title;return null!=e&&e.useHTML?{type:"html",width:null!=(t=null==e?void 0:e.width)?t:80,height:null!=(t=null==e?void 0:e.height)?t:20,innerHTML:"<span>".concat((null==e?void 0:e.content)||"","</span>")}:E(E(E(E({type:"text"},F1),{textBaseline:"top"}),(null==e?void 0:e.style)||{}),{text:(null==e?void 0:e.content)||""})},enumerable:!1,configurable:!0}),Object.defineProperty(yx.prototype,"titleShapeBBox",{get:function(){var t,e,n={left:0,top:0,width:0,height:0};return{left:0,top:0,right:(n="html"===this.titleStyleProps.type?{left:0,top:0,width:(e=this.titleStyleProps).width,height:e.height}:(t=(e=this.titleShape.getLocalBounds()).min,e=e.halfExtents,{left:t[0],top:t[1],width:2*e[0],height:2*e[1]})).width,bottom:n.height}},enumerable:!1,configurable:!0}),yx.prototype.bindEvents=function(){},yx.prototype.drawTitle=function(){var t=this.titleStyleProps,e=t.type,n=_(t,["type"]);(null==(t=this.titleShape)?void 0:t.tagName)!==e?(null!=(t=this.titleShape)&&t.remove(),this.innerGroup.removeChild(this.titleShape),this.titleShape=("html"===e?I(this.innerGroup).append(function(){return new jh({style:n})}):I(this.innerGroup).append(function(){return new Dh({style:n})})).node(),this.titleShape.className="legend-title"):this.titleShape.attr(n)},yx.prototype.applyBackgroundStyle=function(){var t=this.style.backgroundStyle;this.backgroundShape.attr(void 0===t?{}:t)},yx.prototype.adjustBackground=function(){var t=this.backgroundShape,e=P(this.padding,4),n=e[0],i=e[1],r=e[2],e=e[3],o=this.style,a=o.maxWidth,o=o.maxHeight,s=this.container.getLocalBounds(),u=s.min,s=s.max,l=s[0]-u[0],s=s[1]-u[1];t.style.width=Math.min(l+i+e,a||Number.MAX_VALUE),t.style.height=Math.min(s+n+r,o||Number.MAX_VALUE)},yx.prototype.adjustInnerGroup=function(){var t=P(j1(this.style.inset),4),e=t[0],t=t[3],n=this.titleShapeBBox,i=n.left,n=n.bottom;this.innerGroup.setLocalPosition(i+t,n+e)},yx.defaultOptions=E({type:yx.tag="legend-base"},c),yx);function yx(t){return ux.call(this,O({},yx.defaultOptions,t))||this}t(mx,vx=d),mx.prototype.getState=function(){return(yt(this.style,["state"])||"").split("-")[0]||"default"},mx.prototype.setState=function(t){this.update({state:t})},mx.prototype.getID=function(){return this.id},mx.prototype.onHover=function(){var t=this.getState();this.setState("".concat(t,"-active"))},mx.prototype.offHover=function(){var t=this.getState();this.setState(t.split("-")[0])},mx.prototype.connectedCallback=function(){this.update({}),this.bindEvents()},mx.prototype.attributeChangedCallback=function(t,e,n){"state"===t&&this.update(),"backgroundStyle"===t&&this.applyBackground(),"itemValue"===t&&this.applyItemValue(),"itemName"===t&&this.applyItemName(),"itemMarker"===t&&this.applyMarker(),"padding"!==t&&"itemHeight"!==t||this.adjust(),"itemWidth"===t&&(this.adjust(),this.adjustLayout()),"maxItemWidth"===t&&this.adjustLayout()},mx.prototype.update=function(t){void 0===t&&(t={});var e=this.getState(),n=t.state;"state"in t&&e!==n&&(this.prevState=e),this.attr(O({},this.attributes,t)),this.applyMarker(),this.applyItemName(),this.applyItemValue(),this.applyBackground(),this.adjustLayout()},mx.prototype.onClick=function(){var t=this.getState(),t=(["selected","selected-active"].includes(t)?this.setState("default-active"):this.setState("selected-active"),new Ts("stateChange",{detail:{value:{id:this.getID(),state:this.getState()}}}));this.dispatchEvent(t)},mx.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseleave",this.offHover.bind(this)),this.addEventListener("mousemove",this.onHover.bind(this)),this.addEventListener("click",this.onClick.bind(this)),this.container.addEventListener(C.BOUNDS_CHANGED,function(){return t.adjust()}),this.nameShape.addEventListener(C.BOUNDS_CHANGED,function(){return t.adjustLayout()}),this.valueShape.addEventListener(C.BOUNDS_CHANGED,function(){return t.adjustLayout()})},mx.prototype.adjust=function(){var t=this.style,e=t.padding,n=t.itemWidth,t=t.itemHeight,t=void 0===t?0:t,i=P(this.container.getLocalBounds().halfExtents,2),r=i[0],i=i[1],e=P(j1(e),4),o=e[0],o=void 0===o?0:o,a=e[1],a=void 0===a?0:a,s=e[2],s=void 0===s?o:s,e=e[3],e=void 0===e?a:e,t=Math.max(t,2*i);this.container.setLocalPosition(e,o+t/2),this.background.style.width=(null!=n?n:2*r)+e+a,this.background.style.height=t+o+s},mx.prototype.getStyle=function(t,e){void 0===e&&(e=this.style.state);var n=yt(this.style,t),t=e?e.split("-"):[];return O.apply(void 0,z([{},V1(n,"default")],P(t.map(function(t){return V1(n,t)})),!1))},mx.prototype.adjustLayout=function(){function t(t){return t||0}var e,n,i=this.style,r=i.itemWidth,o=i.maxItemWidth,a=i.itemMarker,s=i.itemName,i=i.itemValue,a=t(null==a?void 0:a.size),o=null!=(o=null!=r?r:o)?o:Number.MAX_VALUE,u=a/2,l=!(null!=s&&s.content),c=!(null!=i&&i.content),h=l?0:t(null==i?void 0:i.spacing),o=o-a-t(null==s?void 0:s.spacing)-t(null==i?void 0:i.spacing),d=M1(this.nameShape),p=M1(this.valueShape),f=l?0:S1(s.content,d),y=c?0:S1(i.content,p),v=P([f,y],2),g=v[0],v=v[1],y=(o<f+y&&(g=(e=P([.5*o,.5*o],2))[0],v=e[1],y<f?g=o-(v=Math.min(y,v)):v=o-(g=Math.min(f,g)),e=l?"":w1(s.content,g,d),n=c?"":w1(i.content,v,p)),u+=a/2+((null==s?void 0:s.spacing)||0),this.nameShape.attr({text:e,x:u,visibility:l?"hidden":"visible"}),l?0:G1(this.nameShape).width),o=(u+=(r?g:y)+h,(null==i?void 0:i.align)||"left");this.valueShape.attr({text:n,x:r&&"right"===o?r:u,textAlign:r&&"right"===o?"end":"start",visibility:c?"hidden":"visible"})},mx.prototype.applyMarker=function(){var t,e=this.style.itemMarker;e?(t=e.symbol,e=e.size,this.markerShape.attr(E({x:(e=void 0===e?0:e)/2,symbol:t,size:e},this.getStyle(["itemMarker","style"])))):this.markerShape.style.size=0},mx.prototype.applyItemName=function(){var t,e=this.style.itemName;e?(t=this.getStyle(["itemName","style"]),this.nameShape.attr(E(E(E(E({},F1),{text:e.content||""}),t),{textBaseline:"middle"}))):this.nameShape.style.fontSize=0},mx.prototype.applyItemValue=function(){var t,e=this.style.itemValue;e?(t=this.getStyle(["itemValue","style"]),this.valueShape.attr(E(E(E(E({},F1),{text:e.content||""}),t),{textBaseline:"middle"}))):this.valueShape.style.fontSize=0},mx.prototype.applyBackground=function(){this.background.attr(this.getStyle("backgroundStyle"))},mx.defaultOptions={style:{itemName:{style:{default:{fontSize:12}}},itemValue:{style:{default:{fontSize:12}}}}};var vx,gx=mx;function mx(t){t=vx.call(this,O({},mx.defaultOptions,t))||this;return t.pageIndex=0,t.background=t.appendChild(new Lh({className:"legend-item-background",zIndex:-1})),t.container=t.appendChild(new xh),t.markerShape=t.container.appendChild(new D({className:"legend-item-marker"})),t.nameShape=t.container.appendChild(new Dh({className:"legend-item-name"})),t.valueShape=t.container.appendChild(new Dh({className:"legend-item-value"})),t}t(xx,bx=yh),xx.prototype.connectedCallback=function(){this.applyMarkerStyle(),this.applyBackground(),this.bindEvents()},xx.prototype.attributeChangedCallback=function(t,e,n){"symbol"!==t&&"size"!==t&&"disabled"!==t&&"markerStyle"!==t||this.applyMarkerStyle(),"disabled"!==t&&"backgroundStyle"!==t||this.applyBackground(),"padding"===t&&this.adjustLayout()},xx.prototype.bindEvents=function(){var t=this;this.markerShape.addEventListener(C.BOUNDS_CHANGED,function(){return t.adjustLayout()})},xx.prototype.adjustLayout=function(){var t=P(j1(this.style.padding),4),e=t[0],e=void 0===e?0:e,n=t[1],n=void 0===n?0:n,i=t[2],i=void 0===i?e:i,t=t[3],t=void 0===t?n:t,r=P(this.markerShape.getLocalBounds().halfExtents,2),o=r[0],r=r[1],a=t+o,s=e+r;this.backgroundShape.attr({x:-a,y:-s,width:t+n+2*o,height:e+i+2*r}),this.setLocalPosition(a,s)},xx.prototype.getStyle=function(t,e){return O({},yt(t=void 0===t?{}:t,"default"),e?yt(t,"disabled"):{})},xx.prototype.applyMarkerStyle=function(){var t=this.style,e=t.size,n=t.symbol,i=t.disabled,t=t.markerStyle;this.markerShape.attr({size:e,symbol:n}),this.markerShape.attr(this.getStyle(t,i))},xx.prototype.applyBackground=function(){var t=this.style,e=t.disabled,t=t.backgroundStyle;this.backgroundShape.attr(this.getStyle(t,e))},xx.defaultOptions={style:{size:10,padding:[2,4],markerStyle:{default:{fill:"black",cursor:"pointer"},disabled:{fill:"#d9d9d9",cursor:"not-allowed"}},backgroundStyle:{default:{cursor:"pointer",fill:"transparent"},disabled:{cursor:"not-allowed"}}}};var bx,kx=xx;function xx(t){t=bx.call(this,O({},xx.defaultOptions,t))||this;return t.backgroundShape=t.appendChild(new Lh({className:"page-btn-background"})),t.markerShape=t.appendChild(new D({className:"page-btn-marker"})),t}D.registerSymbol("left",function(t,e,n){return[["M",t-n*Math.sin(Math.PI/3),e],["L",t+n,e-n],["L",t+n,e+n],["Z"]]}),D.registerSymbol("right",function(t,e,n){return[["M",t-n,e-n],["L",t+n*Math.sin(Math.PI/3),e],["L",t-n,e+n],["Z"]]}),D.registerSymbol("up",function(t,e,n){return[["M",t-n,e+n],["L",t,e-n*Math.sin(Math.PI/3)],["L",t+n,e+n],["Z"]]}),D.registerSymbol("down",function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t,e+n*Math.sin(Math.PI/3)],["Z"]]});t(Ex,wx=yh),Ex.prototype.connectedCallback=function(){this.initPageNavigator(),this.drawItems(),this.bindEvents()},Ex.prototype.attributeChangedCallback=function(t,e,n){"items"===t&&(this.drawItems(),this.adjustLayout()),"pageButtonSize"===t&&(this.prevButton.style.size=n,this.nextButton.style.size=n,this.adjustLayout()),"pageInfoWidth"!==t&&"pageSpacing"!==t||this.adjustLayout(),"orient"!==t&&"autoWrap"!==t&&"maxWidth"!==t&&"maxHeight"!==t||(this.updatePageButtonSymbol(),this.adjustLayout()),"maxRows"===t&&this.style.autoWrap&&this.adjustLayout(),"pageFormatter"===t&&this.updatePageInfo(),"pageTextStyle"===t&&this.applyPageInfoStyle(),"pageButtonStyle"===t&&this.applyPageButtonStyle()},Ex.prototype.bindEvents=function(){var t=this;this.container.addEventListener(C.MOUNTED,function(){return t.adjustLayout()},{capture:!0}),this.prevButton.addEventListener("click",this.prev.bind(this)),this.nextButton.addEventListener("click",this.next.bind(this))},Ex.prototype.drawItems=function(){var t=this.style.items;this.items=b1(this.container,"legend-item",gx,void 0===t?[]:t)},Ex.prototype.ifHorizontal=function(t,e){return"vertical"===this.style.orient?"function"==typeof e?e():e:"function"==typeof t?t():t},Ex.prototype.initPageNavigator=function(){var t={className:"page-button",zIndex:2};this.prevButton=this.appendChild(new kx(t)),this.nextButton=this.appendChild(new kx(t)),this.pageInfo=this.appendChild(new Dh({className:"page-info"})),this.updatePageButtonSymbol(),this.applyPageButtonStyle(),this.applyPageInfoStyle()},Ex.prototype.applyPageButtonStyle=function(){var t=O({},Ex.defaultOptions.style.pageButtonStyle,this.style.pageButtonStyle);this.prevButton.attr({markerStyle:t}),this.nextButton.attr({markerStyle:t})},Ex.prototype.applyPageInfoStyle=function(){var t=O({},Ex.defaultOptions.style.pageTextStyle,this.style.pageTextStyle);this.pageInfo.attr(t)},Ex.prototype.showPageNavigator=function(){this.prevButton.style.visibility="visible",this.nextButton.style.visibility="visible",this.pageInfo.style.visibility="visible"},Ex.prototype.resetPageCfg=function(){this.prevButton.style.visibility="hidden",this.nextButton.style.visibility="hidden",this.pageInfo.style.visibility="hidden",this.container.style.clipPath=null,this.currPage=void 0,this.maxPages=void 0,this.pageOffsets=[]},Ex.prototype.adjustLayout=function(){var t,e,o,a,s,u,n,l=this;this.resetPageCfg(),this.items.length<=1||(t=this.items,n=(e=P(j1(this.style.spacing),2))[0],e=e[1],s=a=o=0,u=this.ifHorizontal(n,e),t.reduce(function(t,e){var n=P(e.getLocalBounds().halfExtents,2),i=n[0],n=n[1],r=l.ifHorizontal([t,0],[0,t]);return e.setLocalPosition(r[0],r[1]),a=Math.max(a,2*n),s=Math.max(s,2*i),(o=l.ifHorizontal(t+2*i,t+2*n))+u},0),n=this.ifHorizontal(this.style.maxWidth,this.style.maxHeight),!Y(n)&&n!==1/0&&n<o&&(this.style.autoWrap&&"vertical"!==this.style.orient?this.adjustHorizontalWrap(s,a,n):this.adjustFlip(s,a,n)))},Ex.prototype.adjustFlip=function(t,e,n){this.showPageNavigator();var i=this.style.pageSpacing,r=this.prevButton.style.size||Ex.defaultOptions.style.pageButtonSize,o=this.style.pageInfoWidth||Ex.defaultOptions.style.pageInfoWidth,t=P(this.ifHorizontal([n-(2*r+o+i),e],[t,n-(r+i)]),2),a=t[0],s=t[1],n=(this.clipView.style.path="M0,0 L".concat(a,",0 L").concat(a,",").concat(s," L0,").concat(s," Z"),this.container.style.clipPath=this.clipView,this.ifHorizontal(a+i,0)),t=n+r/2,n=n+r/2*3+o,o=this.ifHorizontal(e/2,s+r/2+i);null!=(e=this.prevButton)&&e.setLocalPosition(t,o),null!=(r=this.nextButton)&&r.setLocalPosition(n,o),this.pageInfo.setLocalPosition((t+n)/2,o);for(var u="x"===this.ifHorizontal("x","y")?0:1,l=[0],c=1,h=0;h<this.items.length;h++){var d=this.items[h].getLocalBounds(),p=d.min;d.max[u]-function(t){if(V(t))return t[t.length-1]}(l)>this.ifHorizontal(a,s)+4&&(0!==p[u]&&l.push(p[u]),c+=1)}this.maxPages=c,this.currPage=1,this.pageOffsets=l,this.updatePageNavigatorState()},Ex.prototype.adjustHorizontalWrap=function(t,e,n){this.showPageNavigator();for(var i=this.style.pageSpacing,r=this.prevButton.style.size||Ex.defaultOptions.style.pageButtonSize,o=this.style.pageInfoWidth||Ex.defaultOptions.style.pageInfoWidth,a=this.style.pageInfoHeight||Ex.defaultOptions.style.pageInfoHeight,s=this.style.maxRows||1,n=P([n-(o+i),e*s],2),o=n[0],n=n[1],u=(this.clipView.style.path="M0,0 L".concat(o,",0 L").concat(o,",").concat(n," L0,").concat(n," Z"),this.container.style.clipPath=this.clipView,o),l=1,c=0,h=[0],d=0;d<this.items.length;d++){var p=this.items[d],f=p.getLocalBounds(),y=f.min;f.max[0]-c>u&&(l+=1,c=y[0],l%s==1&&h.push((l-1)*e)),p.setLocalPosition(y[0]-c,(l-1)*e)}this.maxPages=h.length,this.currPage=1,this.pageOffsets=h;o=o+i+r/2,i=n/2,n=(a+r)/2;null!=(a=this.prevButton)&&a.setLocalPosition(o,i-n),null!=(r=this.nextButton)&&r.setLocalPosition(o,i+n),null!=(a=this.pageInfo)&&a.setLocalPosition(o,i),this.updatePageNavigatorState()},Ex.prototype.updatePageNavigatorState=function(){this.updatePageInfo(),this.currPage===this.maxPages?this.nextButton.style.disabled=!0:this.nextButton.style.disabled=!1,1===this.currPage?this.prevButton.style.disabled=!0:this.prevButton.style.disabled=!1},Ex.prototype.updatePageButtonSymbol=function(){var t=this.style.autoWrap,t=this.ifHorizontal(t?1:0,1);this.prevButton.attr({symbol:["left","up"][t]}),this.nextButton.attr({symbol:["right","down"][t]})},Ex.prototype.updatePageInfo=function(){var t=this.style.pageFormatter||Ex.defaultOptions.style.pageFormatter;this.pageInfo.style.text=this.currPage&&this.maxPages?t(this.currPage,this.maxPages):""},Ex.prototype.finished=function(){var e=this;return this.finishedPromise||(this.finishedPromise=new Promise(function(t){e.resolveFinishedPromise=function(){e.finishedPromise=null,t(e.currPage)}})),"idle"===this.playState&&this.resolveFinishedPromise(),this.finishedPromise},Ex.prototype.prev=function(){var t,e;this.maxPages&&this.currPage&&(t=this.style.loop,(e=this.currPage-1)<1&&(e=t?this.maxPages:1),this.goTo(e))},Ex.prototype.next=function(){var t,e,n;this.maxPages&&this.currPage&&(t=this.style.loop,e=this.maxPages,n=this.currPage+1,this.goTo(n=e<n?t?1:e:n))},Ex.prototype.goTo=function(t){var e,n,i,r,o=this;t!==this.currPage&&"idle"===this.playState&&(e=(r=this.style).effect,n=r.duration,r=r.autoWrap,i=(r=P(this.ifHorizontal(r?[0,-this.pageOffsets[t-1]]:[-this.pageOffsets[t-1],0],[0,-this.pageOffsets[t-1]]),2))[0],r=r[1],this.playState="running",this.clipView.animate([{transform:this.clipView.style.transform},{transform:"translate(".concat(-i,"px,").concat(-r,"px)")}],{duration:n,easing:e,fill:"both"}),this.container.animate([{transform:this.container.style.transform},{transform:"translate(".concat(i,"px,").concat(r,"px)")}],{duration:n,easing:e,fill:"both"}),Promise.all(this.clipView.getAnimations().map(function(t){return t.finished})).then(function(){o.currPage=t,o.updatePageNavigatorState(),o.resolveFinishedPromise(),o.playState="idle"}),this.finished())},Ex.defaultOptions={style:{spacing:[4,0],effect:"easeQuadInOut",duration:320,maxRows:2,maxCols:2,pageInfoWidth:32,pageInfoHeight:14,pageButtonSize:10,pageFormatter:function(t,e){return"".concat(t," / ").concat(e)},pageButtonStyle:{default:{fill:"black"},disabled:{fill:"rgb(131,131,131)"}},pageTextStyle:{fontSize:12,textBaseline:"middle",textAlign:"center"}}};var wx,Sx=Ex;function Ex(t){t=wx.call(this,O({},Ex.defaultOptions,t))||this;return t.items=[],t.maxPages=void 0,t.currPage=void 0,t.pageOffsets=[],t.playState="idle",t.container=t.appendChild(new xh),t.clipView=new Mh({style:{path:[]}}),t}t(Mx,Tx=s),Mx.prototype.update=function(t){Tx.prototype.update.call(this,J1({},Mx.defaultOptions.style,this.attributes,t=void 0===t?{}:t))},Mx.prototype.drawInner=function(){this.drawItems()},Mx.prototype.bindEvents=function(){var t=this;Tx.prototype.bindEvents.call(this),this.innerGroup.addEventListener("stateChange",function(){return t.dispatchItemsChange()})},Mx.prototype.drawItems=function(){this.labelsGroup=x1(this.innerGroup,".category-items",function(){return new Sx({})}).attr("className","category-items").call(k1,E({orient:this.orient,items:this.itemsShapeCfg,spacing:this.style.spacing,autoWrap:this.style.autoWrap,maxRows:this.style.maxRows,maxWidth:this.style.maxWidth,maxHeight:this.style.maxHeight},this.style.pageNavigator||{})).node()},Object.defineProperty(Mx.prototype,"idItem",{get:function(){var t=null==(t=this.labelsGroup)?void 0:t.querySelectorAll(".legend-item");return new Map((t||[]).map(function(t){return[t.getID(),t]}))},enumerable:!1,configurable:!0}),Mx.prototype.getItem=function(t){return this.idItem.get(t)},Mx.prototype.setItemState=function(t,e){null!=(t=this.getItem(t))&&t.setState(e)},Mx.prototype.getItemsStates=function(){return Array.from(this.idItem.entries()).map(function(t){t=P(t,2);return{id:t[0],state:t[1].getState()}})},Object.defineProperty(Mx.prototype,"itemsShapeCfg",{get:function(){var r=this,t=this.style,e=t.items,o=t.maxWidth,a=t.maxItemWidth,s=t.itemMarker,u=t.itemName,l=t.itemValue,t=t.reverse,c=e.slice();return t&&c.reverse(),c.map(function(t,e){return{id:t.id||"legend-item-".concat(e),state:t.state||"default",maxItemWidth:Z([null!=a?a:Number.MAX_VALUE,null!=o?o:Number.MAX_VALUE]),itemMarker:(i=U(s)?s(t,e,c):s,O({},lx,{symbol:t.symbol,style:{default:{fill:t.color,stroke:t.color}}},i)),itemName:(i=O({},{formatter:function(){return t.name}},u),n=i.formatter,i=_(i,["formatter"]),O({},cx,{content:n(t,e,c)},i)),itemValue:(n=O({},{formatter:function(){return t.value}},l),i=n.formatter,n=_(n,["formatter"]),O({},hx,{content:i(t,e,c)},n)),itemWidth:r.style.itemWidth,itemHeight:r.style.itemHeight,padding:r.style.itemPadding,backgroundStyle:r.style.itemBackgroundStyle};var n,i})},enumerable:!1,configurable:!0}),Mx.prototype.dispatchItemsChange=function(){var t=new Ts("valueChanged",{detail:{value:this.getItemsStates()}});this.dispatchEvent(t)},Mx.defaultOptions=E({type:Mx.tag},ve);var Tx,_x=Mx;function Mx(t){return Tx.call(this,J1({},Mx.defaultOptions,t))||this}function Px(t,e,n){return"horizontal"===(t=void 0===t?"horizontal":t)?e:n}D.registerSymbol("hiddenHandle",function(t,e,n){var i=1.4*n;return[["M",t-n,e-i],["L",t+n,e-i],["L",t+n,e+i],["L",t-n,e+i],["Z"]]}),D.registerSymbol("verticalHandle",function(t,e,n){var i=1.4*n,r=n/2,o=t+.4*i;return[["M",t,e],["L",o,e+r],["L",t+i,e+r],["L",t+i,e-r],["L",o,e-r],["Z"],["M",o,e+(n=n/6)],["L",t+i-2,e+n],["M",o,e-n],["L",t+i-2,e-n]]}),D.registerSymbol("horizontalHandle",function(t,e,n){var i=1.4*n,r=n/2,o=e+.4*i;return[["M",t,e],["L",t-r,o],["L",t-r,e+i],["L",t+r,e+i],["L",t+r,o],["Z"],["M",t-(n=n/6),o],["L",t-n,e+i-2],["M",t+n,o],["L",t+n,e+i-2]]});t(Ax,Ox=yh),Ax.prototype.connectedCallback=function(){this.draw()},Ax.prototype.attributeChangedCallback=function(){this.draw()},Ax.prototype.draw=function(){this.updateBackground(),this.updateTrack()},Ax.prototype.updateBackground=function(){var t=this.style.backgroundColor;this.path.style.path=this.getRailPath(),this.path.attr({fill:t,fillOpacity:.45})},Ax.prototype.updateTrack=function(){var t=this.style.fill;this.track.style.path=this.getRailPath(),this.track.style.clipPath=this.getClipPath(),this.track.style.fill=t},Object.defineProperty(Ax.prototype,"box",{get:function(){var t=this.style,e=t.orient,n=t.size,t=t.length;return Px(e,[t,n],[n,t])},enumerable:!1,configurable:!0}),Ax.prototype.getRailPath=function(){var t=this.style.type,e=P(this.box,2),n=e[0],e=e[1];return"size"===t?[["M",0,e],["L",0+n,0],["L",0+n,e]]:[["M",0,e],["L",0,0],["L",0+n,0],["L",0+n,e]]},Ax.prototype.getClipPath=function(){var t=this.style,e=t.orient,t=t.selection;if(!t)return null;var n=P(this.box,2),i=n[0],n=n[1],t=P(t,2),r=t[0],t=t[1],o=Px(e,r*i,0),r=Px(e,0,r*n),i=Px(e,t*i,i),e=Px(e,n,t*n);return new Mh({style:{path:[["M",o,r],["L",o,e],["L",i,e],["L",i,r]]}})};var Ox,Cx=Ax;function Ax(t){t=Ox.call(this,J1({},{style:dx},t=void 0===t?{}:t))||this;return t.path=t.appendChild(new Mh({className:"rail-path"})),t.track=t.appendChild(new Mh({className:"rail-path"})),t}t(Ix,Nx=yh),Ix.prototype.connectedCallback=function(){this.draw()},Ix.prototype.attributeChangedCallback=function(){this.draw()},Ix.prototype.draw=function(){var t=this.style,e=t.symbol,n=t.fill,i=t.lineWidth,r=t.stroke,o=t.size,a=t.textStyle,t=t.visibility;this.marker.attr({symbol:e,size:"hidden"===t?0:void 0===o?8:o,fill:n,lineWidth:i||1,stroke:r}),"visible"===t?(this.textShape=this.textShape||this.appendChild(new Dh({})),this.textShape.attr(a||{})):(null!=(e=this.textShape)&&e.remove(),this.textShape=null)};var Nx,Lx=Ix;function Ix(t){t=Nx.call(this,t=void 0===t?{}:t)||this;return t.textShape=null,t.marker=t.appendChild(new D({})),t}t(jx,Dx=yh),jx.prototype.connectedCallback=function(){this.init(),this.bindEvents()},jx.prototype.attributeChangedCallback=function(t,e,n){"textStyle"!==t&&"padding"!==t&&"position"!==t||this.init()},jx.prototype.hide=function(){this.style.visibility="hidden"},jx.prototype.show=function(){this.style.visibility="visible"},jx.prototype.init=function(){var t=this.style,e=t.textStyle;"top"===t.position?this.text.attr(E({textAlign:"center"},e)):this.text.attr(E({textAlign:"left"},e))},jx.prototype.updateBackground=function(){var t=this.text.getLocalBounds(),e=t.min,t=t.max,n=Math.min(t[0]-e[0],40),e=[e[0]-4,e[1]-2,e[0]+n+4,t[1]+2],n=function(t,e){var n=(e=P(e,4))[0],i=e[1],r=e[2],e=e[3];if("top"===t)return[["M",n,e],["L",n,i],["L",r,i],["L",r,e],["L",n+(t=r-n)/2+(o=tt(10,t/3,t/2))/2,e],["L",n+t/2,e+4],["L",n+t/2-o/2,e],["L",n,e]];var o=tt(6,(t=e-i)/3,t/2);return[["M",n,i],["L",r,i],["L",r,e],["L",n,e],["L",n,i+t/2+o/2],["L",n-4,i+t/2],["L",n,i+t/2-o/2],["L",n,i]]}(this.style.position,e);this.background.style.path=n},jx.prototype.bindEvents=function(){var t=this;this.text.addEventListener(C.GEOMETRY_BOUNDS_CHANGED,function(){t.updateBackground()})};var Dx,Rx=jx;function jx(t){t=Dx.call(this,J1({},{style:{visibility:"hidden"}},t=void 0===t?{}:t))||this;return t.background=t.appendChild(new Mh({style:{lineCap:"round",fill:"#262626",lineWidth:1,stroke:"#333"}})),t.text=t.appendChild(new Dh({style:{text:"",fill:"#fff",fontSize:10,textBaseline:"middle"}})),t}function Bx(t,e){var t=P(function(t,e){for(var n=1;n<t.length;n+=1){var i=t[n-1],r=t[n];if(i<=e&&e<=r)return[i,r]}return[e,e]}(t,e),2),n=t[0],t=t[1];return{tick:(n+t)/2<e?t:n,range:[n,t]}}function Fx(t,e,n,i,r){var o=P(Px(t,["dx","dy"],["dy","dx"]),2),a=o[0],o=o[1],s={};return s[a]=e,s[o]="start"===n?-r:i+r,s.textAlign=Px(t,"center","start"===n?"right":"left"),s.textBaseline=Px(t,"start"===n?"bottom":"top","middle"),s}var zx,Vx=dt(function(t){return t.sort(function(t,e){return t-e})},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return JSON.stringify(t)}),Hx=(t(Gx,zx=s),Gx.prototype.attributeChangedCallback=function(t,e,n){var i;null!=(i=zx.prototype.attributeChangedCallback)&&i.call(this,t,e,n),"orient"===t&&(this.indicator.style.position=this.ifHorizontal("top","right"))},Gx.prototype.drawInner=function(){this.drawLabels(),this.drawRail(),this.drawHandles(),this.createIndicator()},Object.defineProperty(Gx.prototype,"selection",{get:function(){var t=this.style,e=t.min,n=t.max;return[t.start||e,t.end||n]},enumerable:!1,configurable:!0}),Object.defineProperty(Gx.prototype,"labelsCfg",{get:function(){var t=this.style.label;return J1({},px,t||{})},enumerable:!1,configurable:!0}),Object.defineProperty(Gx.prototype,"railCfg",{get:function(){var t=this.style.rail;return J1({size:24,length:200},dx,t||{})},enumerable:!1,configurable:!0}),Object.defineProperty(Gx.prototype,"handleCfg",{get:function(){var t=this.style.handle;return J1({},fx,t||{},{textStyle:this.labelsCfg.style,spacing:this.labelsCfg.spacing,visibility:t?"visible":"hidden"})},enumerable:!1,configurable:!0}),Gx.prototype.ifHorizontal=function(t,e){return Px(this.orient,"function"==typeof t?t():t,"function"==typeof e?e():e)},Object.defineProperty(Gx.prototype,"color",{get:function(){var t,e,r,o,a,n=this.style.color,n=Array.from(void 0===n?[]:n),i=n.length;return i?this.railCfg.chunked?(t=this.ticks,e=this.orient,r=Array.from(n),o=r.length,a=t.length,t.reduce(function(t,e,n){var i=r[n%o];return t+" ".concat(n/(a-1),":").concat(i).concat(n<a-1?" ".concat((n+1)/(a-1),":").concat(i):"")},"l(".concat("horizontal"===e?"0":"270",")"))):n.reduce(function(t,e,n){return t+" ".concat(n/(i-1),":").concat(e)},"l(".concat(this.ifHorizontal("0","270"),")")):""},enumerable:!1,configurable:!0}),Object.defineProperty(Gx.prototype,"slidable",{get:function(){return!!this.style.handle},enumerable:!1,configurable:!0}),Object.defineProperty(Gx.prototype,"ticks",{get:function(){var t=this.style,e=t.min,t=t.max;return Vx(z(z([e],P(this.railCfg.ticks||[]),!1),[t],!1))},enumerable:!1,configurable:!0}),Gx.prototype.drawRail=function(){var t=this.style,e=t.orient,n=t.min,t=t.max,i=P(this.selection,2),r=i[0],i=i[1];this.rail=I(this.rail||this.innerGroup.appendChild(new Cx)).attr("className","legend-rail").call(k1,E(E({},this.railCfg),{fill:this.color,orient:e})).style("selection",this.slidable?[(r-n)/(t-n),(i-n)/(t-n)]:void 0).node()},Gx.prototype.drawLabels=function(){var i,r,o,a,s,t,e,n,u,l,c,h,d,p,f=this,y=[],v=this.style,g=v.min,v=v.max;this.style.handle||(t=this.labelsCfg,i=t.align,r=t.spacing,o=t.style,a=this.railCfg.size,s=function(t){return"legend-label-".concat(t)},y="rail"===i?(t=this.orient,e=this.railCfg,n=r,l=(c=P(Px(t,["dx","dy"],["dy","dx"]),2))[0],c=c[1],h=(d=P(Px(t,["right","left"],["center","center"]),2))[0],d=d[1],p=(t=P(Px(t,["middle","middle"],["bottom","top"]),2))[0],t=t[1],p=[((u={})[l]=-n,u[c]=e.size/2,u.textAlign=h,u.textBaseline=p,u),((h={})[l]=e.length+n,h[c]=e.size/2,h.textAlign=d,h.textBaseline=t,h)],[E(E({id:s(0),text:"".concat(g)},o),p[0]),E(E({id:s(1),text:"".concat(v)},o),p[1])]):this.ticks.map(function(t,e){var n=Fx(f.orient,f.getOffset(t),i,a,r);return E(E({id:s(e),text:"".concat(t)},n),o)})),b1(this.innerGroup,"legend-label",Dh,y)},Gx.prototype.drawHandles=function(){var t=P(this.selection,2),e=t[0],t=t[1];this.startHandle=this.drawHandle("start",e),this.endHandle=this.drawHandle("end",t)},Gx.prototype.drawHandle=function(t,e){var n=this.labelsCfg,i=n.align,n=n.spacing,r=this.railCfg.size,o=this.handleCfg.size,a=this.getOffset(e),s=Fx(this.orient,a,i,r,-o/3),u=s.dx,s=s.dy,a=Fx(this.orient,a,i,r,"start"===i?n:o/3+n);return I(("start"===t?this.startHandle:this.endHandle)||this.innerGroup.appendChild(new Lx({}))).attr("className","legend-handle-".concat(t)).call(k1,E(E({},this.handleCfg),{x:u,y:s,symbol:this.ifHorizontal("horizontalHandle","verticalHandle"),textStyle:E({text:"".concat(null!=e?e:""),x:+a.dx-+u,y:+a.dy-+s,textAlign:a.textAlign,textBaseline:a.textBaseline},this.handleCfg.textStyle)})).node()},Gx.prototype.createIndicator=function(){this.indicator=this.appendChild(new Rx({zIndex:2,className:"legend-indicator",style:{position:this.ifHorizontal("top","right")}}))},Gx.prototype.bindEvents=function(){var n=this,t=(zx.prototype.bindEvents.call(this),new Map);t.set("rail",this.rail),t.set("start",this.startHandle),t.set("end",this.endHandle),t.forEach(function(t,e){t.addEventListener("mousedown",n.onDragStart(e)),t.addEventListener("touchstart",n.onDragStart(e))}),this.startHandle.addEventListener("mouseover",function(){return n.updateMouse()}),this.endHandle.addEventListener("mouseover",function(){return n.updateMouse()}),this.rail.addEventListener("mousemove",this.onHovering),this.addEventListener("mouseout",this.hideIndicator)},Gx.prototype.showIndicator=function(t,e){var n,i,r,o,a,s,u;void 0===e&&(e="".concat(t)),"number"!=typeof t?this.hideIndicator():(this.indicator.show(),t=Ys(t,(t=this.style).min,t.max),n=this.ifHorizontal(this.getOffset(t),this.railCfg.size+12),t=this.ifHorizontal(-14,this.getOffset(t)),i=(r=this.rail.getBBox()).x,r=r.y,o=(a=this.container.getBBox()).x,a=a.y,s=(u=P(this.container.getLocalPosition(),2))[0],u=u[1],this.indicator.style.x=i-o+s+n,this.indicator.style.y=r-a+u+t,this.indicator.style.textStyle={text:e})},Gx.prototype.hideIndicator=function(){var t;null!=(t=this.indicator)&&t.hide()},Gx.prototype.onDragEnd=function(){this.style.cursor="default",this.removeEventListener("mousemove",this.onDragging),this.removeEventListener("touchmove",this.onDragging),document.removeEventListener("mouseup",this.onDragEnd),document.removeEventListener("touchend",this.onDragEnd)},Gx.prototype.updateMouse=function(){this.style.slidable&&(this.style.cursor="grabbing")},Gx.prototype.setSelection=function(t,e){this.updateSelection(t,e)},Gx.prototype.updateSelection=function(t,e,n){void 0===n&&(n=!1);var i,r,o,a,s,u=P(this.selection,2),l=u[0],u=u[1],t=P([t,e],2),e=t[0],t=t[1],n=(n&&(e+=l,t+=u),this.style),l=n.min,u=n.max,c=P((n=[l,u],l=[e,t],u=this.selection,void 0===i&&(i=4),r=(n=P(n,2))[0],n=n[1],o=(l=P(l,2))[0],l=l[1],a=(u=P(u,2))[0],u=u[1],l=(o=P([o,l],2))[0],s=(o=o[1])-l,o<l&&(l=(c=P([o,l],2))[0],o=c[1]),n-r<s?[r,n]:l<r?a===r&&u===o?[r,o]:[r,s+r]:n<o?u===n&&a===l?[l,n]:[n-s,n]:[C1(l,i),C1(o,i)]),2),e=c[0],t=c[1];this.update({start:e,end:t}),this.dispatchSelection()},Object.defineProperty(Gx.prototype,"step",{get:function(){var t=this.attributes,e=t.step,n=t.min,t=t.max;return ut(e)?C1(.01*(t-n),0):e},enumerable:!1,configurable:!0}),Gx.prototype.getTickValue=function(t){return this.railCfg.chunked?Bx(this.ticks,t).tick:(e=this.step,(n=this.style.min)+Math.round((t-n)/e)*e);var e,n},Gx.prototype.getValueByCanvasPoint=function(t,e){void 0===e&&(e=!1);var e=this.style,n=e.min,e=e.max,i=P(this.rail.getPosition(),2),r=i[0],i=i[1],r=this.ifHorizontal(r,i),i=this.ifHorizontal.apply(this,z([],P(H1(t)),!1));return Ys(this.getOffset(i-r,!0)+n,n,e)},Gx.prototype.getOffset=function(t,e){var n=this.style,i=n.min,n=n.max;return(e=void 0!==e&&e)?t*(n-i)/this.railCfg.length:C1((t-i)*(i<n?this.railCfg.length/(n-i):0),2)},Gx.prototype.dispatchSelection=function(){var t=new Ts("valueChanged",{detail:{value:this.selection}});this.dispatchEvent(t)},Gx.prototype.dispatchIndicated=function(t,e){t=new Ts("onIndicated",{detail:{value:t,range:e}});this.dispatchEvent(t)},Gx.defaultOptions=E({type:Gx.tag="continuous-legend"},ge),e([ib(20)],Gx.prototype,"dispatchSelection",null),e([ib(20)],Gx.prototype,"dispatchIndicated",null),Gx);function Gx(t){var o=zx.call(this,J1({},Gx.defaultOptions,t))||this;return o.onHovering=function(t){t.stopPropagation();var e,t=o.getValueByCanvasPoint(t);yt(o.attributes,["rail","chunked"])?(e=Bx(o.ticks,t).range,o.showIndicator((e[0]+e[1])/2,"".concat(e[0],"-").concat(e[1])),o.dispatchIndicated(t,e)):(e=o.getTickValue(t),o.showIndicator(e),o.dispatchIndicated(e))},o.onDragStart=function(e){return function(t){t.stopPropagation(),o.slidable&&(o.target=e,o.prevValue=o.getTickValue(o.getValueByCanvasPoint(t)),o.addEventListener("mousemove",o.onDragging),o.addEventListener("touchmove",o.onDragging),o.addEventListener("mouseleave",o.onDragEnd),o.addEventListener("mouseup",o.onDragEnd),document.addEventListener("mouseup",o.onDragEnd),document.addEventListener("touchend",o.onDragEnd))}},o.onDragging=function(t){var e=o.target,n=(o.updateMouse(),P(o.selection,2)),i=n[0],n=n[1],t=o.getTickValue(o.getValueByCanvasPoint(t)),r=t-o.prevValue;"start"===e?i!==t&&o.updateSelection(t,n):"end"===e?n!==t&&o.updateSelection(i,t):"rail"===e&&0!=r&&(o.prevValue=t,o.updateSelection(r,r,!0))},o}t(Ux,Wx=d),Ux.prototype.init=function(){this.initShape(),this.update({})},Ux.prototype.update=function(t){this.attr(O({},this.attributes,t)),this.backgroundShape.attr(this.getBackgroundShapeCfg()),this.titleShape.update(this.getTitleShapeCfg()),this.valueShape.update(this.getValueShapeCfg())},Ux.prototype.initShape=function(){this.titleShape=new hb({name:"title",style:this.getTitleShapeCfg()}),this.valueShape=new hb({name:"value",style:this.getValueShapeCfg()}),this.backgroundShape=new Lh({name:"background"}),this.backgroundShape.appendChild(this.titleShape),this.backgroundShape.appendChild(this.valueShape),this.appendChild(this.backgroundShape),this.backgroundShape.toBack()},Ux.prototype.getBackgroundShapeCfg=function(){return V1(this.attributes.backgroundStyle)},Ux.prototype.getTitleShapeCfg=function(){var t=this.attributes.title;return E(E({text:""},t),{textStyle:r0({},{default:null==t?void 0:t.textStyle}),backgroundStyle:{default:{fill:"transparent",lineWidth:0}},padding:0,x:0,y:0})},Ux.prototype.getValueShapeCfg=function(){var t=this.attributes,e=t.value,n=0,t=t.spacing+(n=this.titleShape?(t=this.titleShape.getBounds()).getMax()[1]-t.getMin()[1]:n);return E(E({text:""},e),{textStyle:r0({},{default:null==e?void 0:e.textStyle}),backgroundStyle:{default:{fill:"transparent",lineWidth:0}},padding:0,x:0,y:t})},Ux.prototype.clear=function(){this.valueShape.destroy(),this.titleShape.destroy(),this.backgroundShape.destroy()},Ux.defaultOptions={type:Ux.tag="statistic",style:{x:0,y:0,title:{text:"",textStyle:{fontSize:14,fill:"rgba(0, 0, 0, 0.45)"}},value:{text:"",textStyle:{fontSize:24,fill:"rgba(0, 0, 0, 0.85)"}},spacing:5}};var Wx,Ht=Ux;function Ux(t){t=Wx.call(this,O({},Ux.defaultOptions,t))||this;return t.init(),t}var Yx=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];var qx,Xx,Kx,Zx;function $x(t){t=qx.call(this,O({},$x.defaultOptions,t))||this;return t.init(),t}function Jx(t){Xx||(Xx=document.createElement("table"),Zx=document.createElement("tr"),Kx=/^\s*<(\w+|!)[^>]*>/,Zx={tr:document.createElement("tbody"),tbody:Xx,thead:Xx,tfoot:Xx,td:Zx,th:Zx,"*":document.createElement("div")});var e=Kx.test(t)&&RegExp.$1,e=(e&&e in Zx||(e="*"),Zx[e]),t=(t="string"==typeof t?t.replace(/(^\s*)|(\s*$)/g,""):t,e.innerHTML=""+t,e.childNodes[0]);return t&&e.contains(t)&&e.removeChild(t),t}t($x,qx=Ht),$x.prototype.init=function(){qx.prototype.init.call(this),this.timestamp=this.attributes.value.timestamp,this.startTimer()},$x.prototype.update=function(t){qx.prototype.update.call(this,t)},$x.prototype.formatCountdown=function(t){var r,e,n,i=null==(i=this.attributes.value)?void 0:i.format,o=(null!=(o=null==t?void 0:t.value)&&o.format&&(i=t.value.format),new Date(this.timestamp).getTime()),t=Date.now(),o=Math.max(o-t,0),t=Y(o)?"":"".concat(o);return i&&(r=o=o,o=/\[[^\]]*]/g,e=((i=i).match(o)||[]).map(function(t){return t.slice(1,-1)}),i=i.replace(o,"[]"),i=Yx.reduce(function(t,e){var n,e=P(e,2),i=e[0],e=e[1];return-1!==t.indexOf(i)?(n=Math.floor(r/e),r-=n*e,t.replace(new RegExp("".concat(i,"+"),"g"),function(t){var e=n.toString();return e.length<2?"0".concat(e):e})):t},i),n=0,t=i.replace(o,function(){var t=e[n];return n+=1,t})),t},$x.prototype.startTimer=function(){var e=this;this.countdownId||(this.countdownId=window.setInterval(function(){var t=e.formatCountdown();e.valueShape.update({text:t}),e.timestamp<=Date.now()&&e.stopTimer()},1e3/30))},$x.prototype.stopTimer=function(){var t;this.countdownId&&(clearInterval(this.countdownId),this.countdownId=void 0,(t=this.attributes.onFinish)&&t())},$x.tag="countdown",$x.defaultOptions=O({},Ht.defaultOptions,{style:{value:{timestamp:Date.now()+3e4}}});var Qx,ne="tooltip",tw="tooltip-title",ew="tooltip-list",p="tooltip-list-item",Gt="tooltip-list-item-marker",me="tooltip-list-item-name",ie="tooltip-list-item-value",a="tooltip-crosshair-x",ce="tooltip-crosshair-y",kn=((l={})[".".concat(ne)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.9)","box-shadow":"0 1px 4px 0 rgba(0, 0, 0, 0.2)","border-radius":"2px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"10px 10px 10px 10px"},l[".".concat(tw)]={"margin-bottom":"4px"},l[".".concat(ew)]={margin:"0px","list-style-type":"none",padding:"0px"},l[".".concat(p)]={"list-style-type":"none","margin-bottom":"4px"},l[".".concat(Gt)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"8px"},l[".".concat(me)]={color:"rgba(0, 0, 0, 0.45)"},l[".".concat(ie)]={display:"inline-block",float:"right","margin-left":"30px",color:"rgba(0, 0, 0, 0.65)"},l[".".concat(a)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},l[".".concat(ce)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},l),nw=(t(iw,Qx=d),Object.defineProperty(iw.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),Object.defineProperty(iw.prototype,"position",{set:function(t){var t=P(t,2),e=t[0],t=t[1];this.attr({x:e,y:t}),this.updatePosition()},enumerable:!1,configurable:!0}),Object.defineProperty(iw.prototype,"elementSize",{get:function(){return{width:this.element.offsetWidth,height:this.element.offsetHeight}},enumerable:!1,configurable:!0}),Object.defineProperty(iw.prototype,"items",{get:function(){var t=this.attributes.items;return this.sort(this.filter(t.map(function(t,e){var n=t.name,n=void 0===n?"":n,i=t.value,r=t.color,r=void 0===r?"black":r,o=t.index,t=_(t,["name","value","color","index"]);return E({name:n,value:i,color:r,index:void 0===o?e:o},t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(iw.prototype,"HTMLTooltipItemsElements",{get:function(){var e=this.attributes.template.item,i=[];return this.items.forEach(function(t){var n;i.push(Jx((n=t,(t=e)&&n?t.replace(/\\?\{([^{}]+)\}/g,function(t,e){return"\\"===t.charAt(0)?t.slice(1):void 0===n[e]?"":n[e]}):t)))}),i},enumerable:!1,configurable:!0}),Object.defineProperty(iw.prototype,"customContent",{get:function(){var t=this.attributes.customContent;return Q(t)?U1(t):lt(t)?t:U(t)?U1(t(this.attributes.items)):void 0},enumerable:!1,configurable:!0}),iw.prototype.init=function(){this.updateHTMLTooltipElement(),this.updatePosition()},iw.prototype.update=function(t){this.attr(O({},this.attributes,t)),this.updateHTMLTooltipElement(),this.updatePosition()},iw.prototype.clear=function(){this.element.innerHTML=""},iw.prototype.destroy=function(){var t;null!=(t=this.element)&&t.remove(),null!=(t=this.customContent)&&t.remove()},iw.prototype.show=function(){this.visibility="visible",this.element.style.visibility="visible"},iw.prototype.hide=function(){this.visibility="hidden",this.element.style.visibility="hidden"},iw.prototype.initShape=function(){var t=this.attributes.template.container;this.element=Jx(t),!this.id&&""===this.id||this.element.setAttribute("id",this.id)},iw.prototype.updateHTMLTooltipElement=function(){var e,i,t=this.attributes.title,n=this.element,r=this.customContent,t=(this.clear(),r?n.appendChild(r):(r=this.attributes.template.title,n.innerHTML=r,n.getElementsByClassName(tw)[0].innerHTML=t,r=this.HTMLTooltipItemsElements,(e=document.createElement("ul")).className=ew,r.forEach(function(t){e.appendChild(t)}),this.element.appendChild(e)),this.attributes.style);i=n,Object.entries(t).forEach(function(t){var t=P(t,2),e=t[0],n=t[1];z([i],P(i.querySelectorAll(e)),!1).filter(function(t){return t.matches(e)}).forEach(function(t){t&&(t.style.cssText+=Object.entries(n).reduce(function(t,e){return"".concat(t).concat(e.join(":"),";")},""))})}),this.element.style.visibility=this.visibility},iw.prototype.getRelativeOffsetFromCursor=function(t){var e=this.attributes,n=e.position,e=P(e.offset,2),r=e[0],o=e[1],e=(t||n).split("-"),a={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},t=this.elementSize,s=t.width,u=t.height,l=[-s/2,-u/2];return e.forEach(function(t){var e=P(l,2),n=e[0],e=e[1],t=P(a[t],2),i=t[0],t=t[1];l=[n+(s/2+r)*i,e+(u/2+o)*t]}),l},iw.prototype.setOffsetPosition=function(t){var t=P(t,2),e=t[0],t=t[1],n=this.attributes,i=n.x,r=n.y,n=n.container,o=n.x,n=n.y;this.element.style.left="".concat(i+o+e,"px"),this.element.style.top="".concat(r+n+t,"px")},iw.prototype.updatePosition=function(){this.throttleUpdatePosition()},iw.prototype.autoPosition=function(t){var t=P(t,2),e=t[0],t=t[1],n=this.attributes,i=n.x,r=n.y,o=n.autoPosition,n=n.bounding;if(!o)return[e,t];var o=this.element,a=o.offsetWidth,o=o.offsetHeight,i=P([i+e,r+t],2),e=i[0],r=i[1],t=this.attributes.position,s={left:"right",right:"left",top:"bottom",bottom:"top"},i=n.x,u=n.y,l={left:e<i,right:i+n.width<e+a,top:r<u,bottom:u+n.height<r+o},c=[],i=(t.split("-").forEach(function(t){l[t]?c.push(s[t]):c.push(t)}),c.join("-"));return this.getRelativeOffsetFromCursor(i)},iw.prototype.filter=function(t){var e=this.attributes.filterBy;return e?t.filter(e):t},iw.prototype.sort=function(t){var e=this.attributes.sortBy;return e?t.sort(e):t},iw.tag="tooltip",iw.defaultOptions={style:{x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],follow:!0,enterable:!1,autoPosition:!0,items:[],throttleFrequency:50,container:{x:0,y:0},bounding:{x:0,y:0,width:0,height:0},template:{container:'<div class="'.concat(ne,'"></div>'),title:'<div class="'.concat(tw,'"></div>'),item:'<li class="'.concat(p,'" data-index={index}>\n        <span class="').concat(Gt,'" style="background:{color}"></span>\n        <span class="').concat(me,'">{name}</span>\n        <span class="').concat(ie,'">{value}</span>\n      </li>')},style:kn}},iw);function iw(t){var e=Qx.call(this,O({},iw.defaultOptions,t))||this;return e.visibility="visible",e.throttleUpdatePosition=mt(function(){e.setOffsetPosition(e.autoPosition(e.getRelativeOffsetFromCursor()))},e.attributes.throttleFrequency,{}),e.visibility=e.attributes.visibility,e.initShape(),e.init(),e}var rw,ow={default:{sizeStyle:{width:44,height:22},textStyle:{fontSize:12,lineHeight:12},markerStyle:{size:11}},small:{sizeStyle:{width:28,height:16},textStyle:{fontSize:10,lineHeight:10},markerStyle:{size:8}},mini:{sizeStyle:{width:20,height:14},textStyle:{fontSize:7,lineHeight:7},markerStyle:{size:7}}},i="#1890FF",h="#00000040",aw={backgroundStyle:!1,textStyle:{default:{fill:"#fff"}}};function sw(t){t=rw.call(this,O({},sw.defaultOptions,t))||this;return t.childrenShape=[],t.nowFocus=!1,t.otherOnClick=!0,t.init(),t}t(sw,rw=d),sw.prototype.init=function(){this.initChecked(),this.initShape(),this.update({}),this.bindEvents()},sw.prototype.getChecked=function(){return this.checked},sw.prototype.update=function(t){this.attr(O({},this.attributes,t)),this.updateChecked(),this.updateShape(),this.animateFlag&&this.animateSiwtch()},sw.prototype.blur=function(){this.nowFocus=!1,this.clearBackgroundLineWidth()},sw.prototype.focus=function(){this.nowFocus=!0,this.addBackgroundLineWidth()},sw.prototype.clear=function(){},sw.prototype.destroy=function(){var t;this.handleShape.destroy(),this.backgroundShape.destroy(),this.rectStrokeShape.destroy(),this.pathLineShape.destroy(),null!=(t=this.childrenShape[0])&&t.destroy(),null!=(t=this.childrenShape[1])&&t.destroy(),this.removeChildren(!0),rw.prototype.destroy.call(this)},sw.prototype.initShape=function(){this.backgroundShape=this.createBackgroundShape(),this.rectStrokeShape=this.createRectStrokeShape(),this.handleShape=this.createHandleShape(),this.backgroundShape.appendChild(this.handleShape),this.appendChild(this.rectStrokeShape),this.appendChild(this.backgroundShape)},sw.prototype.initChecked=function(){var t=this.attributes,e=t.defaultChecked,t=t.checked;this.defaultChecked=!(!t&&!e),this.checked=!!(Y(t)?e:t)},sw.prototype.createBackgroundShape=function(){return new Lh({name:"background",style:E(E(E({},sw.defaultOptions.style),this.sizeStyle),{strokeOpacity:.2})})},sw.prototype.createRectStrokeShape=function(){return new Lh({name:"rectStroke",style:E(E(E({},sw.defaultOptions.style),this.sizeStyle),{lineWidth:0,fill:"#efefef",strokeOpacity:.4})})},sw.prototype.createHandleShape=function(){return this.pathLineShape=new Th({name:"pathLine"}),new Lh({name:"handle",style:{width:0,height:0,fill:"#fff",offsetPath:this.pathLineShape}})},sw.prototype.updateSizeStyle=function(){var t=this.attributes.size,e=yt(this.attributes,["style",this.checked?"selected":"default"]),n=e.width,e=e.height,t=yt(ow,[t,"sizeStyle"]);this.sizeStyle={width:n||t.width,height:e||t.height,radius:e?e/2:t.height/2}},sw.prototype.updateShape=function(){this.updateSizeStyle(),this.updateCheckedChildrenShape(),this.updateBackgroundShape(),this.updateHandleShape()},sw.prototype.updateCheckedChildrenShape=function(){var o=this;["checkedChildren","unCheckedChildren"].forEach(function(t,e){var n,i,r=yt(o.attributes,t);r&&(i=yt(ow,[o.attributes.size,"textStyle"]),n=yt(ow,[o.attributes.size,"markerStyle"]),n=E(E({},r),{marker:r.marker&&ht({},n,r.marker),textStyle:{default:ht({},i,r.textStyle)}}),o.childrenShape[e]||(o.childrenShape[e]=new hb({name:t,style:aw})),i=o.childrenShape[e],r=o.getTextSpacing(),J(n)?(i.update(E(E({},gt(n,["backgroundStyle","x"])),{x:0})),(0===e?o.checked:!o.checked)?o.backgroundShape.appendChild(i):o.backgroundShape.removeChild(i,!1),i.update({x:e?o.getShapeWidth()-(null==(t=G1(i))?void 0:t.width)-r:r})):(o.backgroundShape.removeChild(i),null!=i&&i.clear()))})},sw.prototype.updateBackgroundShape=function(){var t=this.attributes,e=t.style,t=t.disabled,n=this.getShapeWidth(),n=ht({},this.sizeStyle,{width:n},yt(e,this.checked?"selected":"default"));this.backgroundShape.attr(E(E({},n),{fillOpacity:t?.4:1,cursor:t?"no-drop":"pointer"})),this.rectStrokeShape.attr(gt(n,["fill"]))},sw.prototype.updateHandleShape=function(){var t=Number(this.attributes.spacing)||sw.defaultOptions.style.spacing,e=this.sizeStyle,n=e.height,e=e.radius,i=this.getShapeWidth(),e=Number(e)-t,e={y:t,radius:e,width:2*e,height:2*e};this.animateFlag||(e=E(E({},e),{x:this.defaultChecked?i-n+t:t})),this.handleShape.attr(e),this.pathLineShape.attr({x1:i-n+t,y1:t,x2:t,y2:t})},sw.prototype.getTextSpacing=function(){return Math.floor(this.sizeStyle.height/3)},sw.prototype.getShapeWidth=function(){var t=Number(yt(this.attributes.style,[this.checked?"selected":"default","width"]));if(t)return t;var t=this.getTextSpacing(),e=yt(this.attributes,[this.checked?"checkedChildren":"unCheckedChildren"]),n=this.childrenShape[this.checked?0:1];return(e?(null==(e=G1(n))?void 0:e.width)+t-this.sizeStyle.height:0)+this.sizeStyle.width},sw.prototype.updateChecked=function(){var t=this.attributes.checked;this.animateFlag=!(Y(t)||this.checked===!!t),this.animateFlag&&(this.checked=!!t)},sw.prototype.bindEvents=function(){this.addSwitchMouseenter(),this.addSwitchMouseleave(),this.addSwitchClick(),this.addWindowClick()},sw.prototype.banEvent=function(t){var e=this.attributes,n=e.disabled,e=e.checked;!n&&Y(e)&&t()},sw.prototype.addSwitchMouseenter=function(){var t=this;this.addEventListener("mouseenter",function(){t.otherOnClick=!1,t.banEvent(function(){t.clearBackgroundLineWidth()})})},sw.prototype.addSwitchMouseleave=function(){var t=this;this.addEventListener("mouseleave",function(){t.otherOnClick=!0,t.banEvent(function(){t.nowFocus&&t.addBackgroundLineWidth()})})},sw.prototype.addSwitchClick=function(){var o=this;this.addEventListener("click",function(t){var e=o.attributes,n=e.onClick,i=e.onChange,r=e.checked;o.banEvent(function(){o.checked=r||!o.checked,o.animateFlag=Y(r),o.nowFocus=!0,U(i)&&i(o.checked,t),o.updateShape(),o.animateSiwtch()}),U(n)&&n(o.checked,t)})},sw.prototype.addWindowClick=function(){var t=this;window.addEventListener("click",function(){t.otherOnClick&&(t.nowFocus=!1),t.banEvent(function(){t.clearBackgroundLineWidth()})})},sw.prototype.clearBackgroundLineWidth=function(){this.backgroundShape.attr({lineWidth:0})},sw.prototype.addBackgroundLineWidth=function(){this.backgroundShape.attr({lineWidth:5})},sw.prototype.animateSiwtch=function(){this.rectStrokeShape.animate([{lineWidth:0,strokeOpacity:.5},{lineWidth:14,strokeOpacity:0}],{duration:400,easing:"ease-on"}),this.handleShape.animate([{offsetDistance:this.checked?1:0},{offsetDistance:this.checked?0:1}],{duration:100,fill:"forwards"})},sw.defaultOptions={type:sw.tag="switch",style:{x:0,y:0,size:"default",spacing:2,defaultChecked:!0,style:{default:{stroke:h,fill:h},selected:{stroke:i,fill:i}}}};var uw,u={text:"",type:"primary",height:20,width:20,buttonStyle:{default:{lineWidth:0,fill:"#fff"},active:{fill:"#fff"},disabled:{fill:"#fff"}},markerStyle:{default:{fill:"black",size:10},disabled:{fill:"#8c8c8c"}}};function lw(t){var t=uw.call(this,O({},lw.defaultOptions,t))||this,e=(t.playState="idle",t.attributes),n=e.view,e=e.initPageNum;return t.currPage=e,t.view=n,t.init(),t}t(lw,uw=d),Object.defineProperty(lw.prototype,"finished",{get:function(){var e=this;return this.finishedPromise||(this.finishedPromise=new Promise(function(t){e.resolveFinishedPromise=function(){e.finishedPromise=null,t(e.currPage)}})),"idle"===this.playState&&this.resolveFinishedPromise(),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(lw.prototype,"maxPages",{get:function(){var t=this.attributes,e=t.pageWidth,n=t.pageHeight,i=t.orient,r=t.pageLimit;if(t.pageCallback||r!==1/0)return r;return"horizontal"===i?Math.ceil(this.width/e):Math.ceil(this.height/n)},enumerable:!1,configurable:!0}),Object.defineProperty(lw.prototype,"view",{get:function(){return this.fullView},set:function(t){var e=this.attributes,n=e.width,e=e.height;t.setLocalPosition(0,0),this.fullView=t,n&&e||(e=(n=G1(t)).width,t=n.height,this.width=e,this.height=t)},enumerable:!1,configurable:!0}),Object.defineProperty(lw.prototype,"width",{get:function(){var t=this.attributes.width;return t||this.viewWidth},set:function(t){this.viewWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(lw.prototype,"height",{get:function(){var t=this.attributes.height;return t||this.viewHeight},set:function(t){this.viewHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(lw.prototype,"btnPosition",{get:function(){var t;return null!=(t=this.style.button)&&t.position?this.style.button.position:"horizontal"===this.style.orient?"right":"bottom"},enumerable:!1,configurable:!0}),Object.defineProperty(lw.prototype,"defaultShape",{get:function(){return["left","right","left-right"].includes(this.btnPosition)?["left","right"]:["up","down"]},enumerable:!1,configurable:!0}),Object.defineProperty(lw.prototype,"buttonCfg",{get:function(){var t=P(this.defaultShape,2),e=t[0],t=t[1],n=this.attributes.button,i=n.prev,n=n.next;return{prev:E({marker:e},i),next:E({marker:t},n)}},enumerable:!1,configurable:!0}),lw.prototype.init=function(){this.initShape(),this.updateView(),this.updateButton(),this.updateButtonState(),this.adjustLayout()},lw.prototype.update=function(t){var e=t.view;e&&(this.view&&(this.view.style.clipPath=null,this.removeChild(this.view,!1)),this.currPage=this.attributes.initPageNum,this.view=e,this.view.style.clipPath=this.clipView,this.appendChild(this.view),this.view.toBack()),this.attr(O({},this.attributes,t)),this.updateView(),this.updateButton(),this.updateButtonState(),this.adjustLayout()},lw.prototype.clear=function(){this.view&&(this.view.style.clipPath=null,this.removeChild(this.view,!1)),this.fullView=void 0,this.removeChildren(!0)},lw.prototype.destroy=function(){this.removeChildren(!0),uw.prototype.destroy.call(this)},lw.prototype.goTo=function(t){var e,n,i,r,o,a,s,u,l,c,h=this;return"idle"===this.playState&&(e=(n=this.attributes).effect,n=n.duration,i=(l=this.calcRelativePagingOffset(t)).viewFromX,r=l.viewFromY,o=l.viewToX,a=l.viewToY,c=l.clipFromX,s=l.clipFromY,u=l.clipToX,l=l.clipToY,this.playState="running",this.clipView.animate([{transform:"translate(".concat(c,"px, ").concat(s,"px)")},{transform:"translate(".concat(u,"px, ").concat(l,"px)")}],{duration:n,easing:e,fill:"both"}),null!=(c=this.view.animate([{transform:"translate(".concat(i,"px, ").concat(r,"px)")},{transform:"translate(".concat(o,"px, ").concat(a,"px)")}],{duration:n,easing:e,fill:"both"}))&&c.finished.then(function(){h.currPage=t,h.updateButtonState(),h.resolveFinishedPromise(),h.playState="idle"})),this.finished},lw.prototype.prev=function(){var t=this.attributes.loop,e=this.currPage-1;return e<1&&(e=t?this.maxPages:1),this.goTo(e)},lw.prototype.next=function(){var t=this.attributes.loop,e=this.maxPages,n=this.currPage+1;return this.goTo(n=e<n?t?1:e:n)},lw.prototype.initShape=function(){this.clipView=new Lh({name:"clipView",style:{x:0,y:0,width:0,height:0}}),this.view.style.clipPath=this.clipView,this.appendChild(this.view),this.view.toBack();var t=P(this.defaultShape,2),e=t[0],t=t[1];this.prevButton=new mb({name:"prevButton",style:E(E({},lw.defaultOptions.style.button.prev),{marker:e,onClick:this.prev.bind(this)})}),this.appendChild(this.prevButton),this.nextButton=new mb({name:"nextButton",style:E(E({},lw.defaultOptions.style.button.next),{marker:t,onClick:this.next.bind(this)})}),this.appendChild(this.nextButton),this.paginationGroup=new xh({name:"paginationGroup"}),this.appendChild(this.paginationGroup)},lw.prototype.updateView=function(){var t=this.getClipViewSpace(this.currPage),e=t.width,t=t.height;this.clipView.attr({width:e,height:t}),this.view.setLocalPosition(0,0),this.clipView.setLocalPosition(0,0)},lw.prototype.updateButton=function(){var t=this.buttonCfg,e=t.prev,t=t.next;e&&this.prevButton.update(e),t&&this.nextButton.update(t)},lw.prototype.updateButtonState=function(){this.attributes.loop?(this.nextButton.setState("enabled"),this.prevButton.setState("enabled")):(this.nextButton.setState(this.currPage===this.maxPages?"disabled":"enabled"),this.prevButton.setState(1===this.currPage?"disabled":"enabled"))},lw.prototype.getClipViewSpace=function(t){var e=this.attributes,n=e.orient,i=e.pageWidth,r=e.pageHeight,e=e.pageCallback,o={x:0,y:0,width:i,height:r},a=this.maxPages;return e?E(E({},o),e(t)):(a<t||t<1||("vertical"===n?o.y=(t-1)*r:"horizontal"===n&&(o.x=(t-1)*i)),o)},lw.prototype.absolute2Relative=function(t,e){var n=this.currPage,n=this.getClipViewSpace(n);return[t+n.x,e+n.y]},lw.prototype.getViewPosition=function(t){var e=this.getClipViewSpace(1),n=e.x,e=e.y,t=this.getClipViewSpace(t),n=P([-t.x+n,-t.y+e],2);return{x:n[0],y:n[1]}},lw.prototype.getRelativeViewPosition=function(t){var t=this.getViewPosition(t),e=t.x,t=t.y,e=P(this.absolute2Relative(e,t),2);return{x:e[0],y:e[1]}},lw.prototype.calcRelativePagingOffset=function(t){var e=P(this.absolute2Relative.apply(this,z([],P(this.view.getLocalPosition().slice(0,2)),!1)),2),n=e[0],e=e[1],t=this.getRelativeViewPosition(t),i=t.x,t=t.y,r=P([-n,-e],2),o=r[0],r=r[1],a=P([-i,-t],2);return{viewFromX:n,viewFromY:e,viewToX:i,viewToY:t,clipFromX:o,clipFromY:r,clipToX:a[0],clipToY:a[1]}},lw.prototype.adjustLayout=function(){this.adjustButton()},lw.prototype.adjustButton=function(){var t,e=this.attributes,n=e.button,i=e.pageWidth,e=e.pageHeight,r=this.btnPosition,n=(null==n?void 0:n.spacing)||0,o=G1(this.prevButton),a=o.width,o=o.height,s=G1(this.nextButton),u=s.width,s=s.height,l=0,c=0,h=0,d=0;"left-right"===r?(l=-(n+a),c=(e-o)/2,h=n+i,d=(e-s)/2):"top-bottom"===r?(l=(i-a)/2,c=-(n+o),h=(i-u)/2,d=n+e):"top"===r?(l=(i-n)/2-a,c=-(n+(t=K([o,s]))),h=(i+n)/2,d=-(n+t)):"bottom"===r?(l=(i-n)/2-a,h=(i+n)/2,d=c=n+e):"left"===r?(l=(h=-(n+u))-(n+a),d=c=(e-(t=K([o,s])))/2):"right"===r&&(h=(l=n+i)+a,d=c=(e-(t=K([o,s])))/2),this.prevButton.setLocalPosition(l,c),this.nextButton.setLocalPosition(h,d)},lw.defaultOptions={type:lw.tag="page-navigator",style:{x:0,y:0,effect:"linear",duration:200,orient:"horizontal",initPageNum:1,pageLimit:1/0,loop:!1,button:{prev:E({spacing:0},u),next:E({spacing:0},u),style:{default:{},active:{},disabled:{}},spacing:5},pagination:{type:"currTotal",style:{default:{},active:{}},separator:"/",spacing:5}}},D.registerSymbol("left",function(t,e,n){return[["M",t-n,e],["L",t+n,e-n],["L",t+n,e+n],["Z"]]}),D.registerSymbol("right",function(t,e,n){return[["M",t-n,e-n],["L",t+n,e],["L",t-n,e+n],["Z"]]}),D.registerSymbol("up",function(t,e,n){return[["M",t-n,e+n],["L",t,e-n],["L",t+n,e+n],["Z"]]}),D.registerSymbol("down",function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t,e+n],["Z"]]});var cw,hw,dw,pw,b={text:{text:""},lineStyle:{stroke:"#416180",strokeOpacity:.45,lineWidth:1,lineDash:[5,5]}},o=J1({},b,{type:"line",text:{position:"start"}}),r=J1({},b,{type:"circle",defaultRadius:0}),Vt=J1({},b,{type:"polygon",defaultRadius:0,startAngle:0}),re=(t(fw,cw=d),Object.defineProperty(fw.prototype,"localPointer",{get:function(){var t=P(this.getPosition(),2),e=t[0],t=t[1],n=P(this.pointer,2);return[n[0]-e,n[1]-t]},enumerable:!1,configurable:!0}),Object.defineProperty(fw.prototype,"tagCfg",{get:function(){var t=this.attributes.text;return t.position,_(t,["position"])},enumerable:!1,configurable:!0}),Object.defineProperty(fw.prototype,"crosshairCfg",{get:function(){var t=this.attributes.lineStyle;return E(E({},t),{path:this.crosshairPath})},enumerable:!1,configurable:!0}),fw.prototype.init=function(){this.initShape(),this.adjustLayout()},fw.prototype.update=function(t){this.attr(O({},this.attributes,t)),this.tagShape.update(this.tagCfg),this.crosshairShape.attr(this.crosshairCfg),this.adjustLayout()},fw.prototype.clear=function(){},fw.prototype.destroy=function(){},fw.prototype.setPointer=function(t){this.pointer=t},fw.prototype.initShape=function(){this.shapesGroup=new xh({name:"crosshairGroup"}),this.appendChild(this.shapesGroup),this.tagShape=new hb({name:"tag",style:this.tagCfg}),this.shapesGroup.appendChild(this.tagShape),this.crosshairShape=new Mh({name:"crosshair",style:this.crosshairCfg}),this.shapesGroup.appendChild(this.crosshairShape)},fw.defaultOptions={type:fw.tag="crosshair-base",style:b},fw);function fw(t){t=cw.call(this,O({},fw.defaultOptions,t))||this;return t.init(),t}function yw(t){return hw.call(this,J1({},yw.defaultOptions,t))||this}function vw(t){return dw.call(this,J1({},vw.defaultOptions,t))||this}function gw(t){return pw.call(this,J1({},gw.defaultOptions,t))||this}t(yw,hw=re),Object.defineProperty(yw.prototype,"crosshairPath",{get:function(){var t=this.attributes,e=P(t.startPos,2),n=e[0],e=e[1],t=P(t.endPos,2);return[["M",0,0],["L",t[0]-n,t[1]-e],["Z"]]},enumerable:!1,configurable:!0}),Object.defineProperty(yw.prototype,"localPointer",{get:function(){if(!this.pointer)return this.attributes.startPos;var t=P(this.getPosition(),2),e=t[0],t=t[1],n=P(this.pointer,2);return[n[0]-e,n[1]-t]},enumerable:!1,configurable:!0}),Object.defineProperty(yw.prototype,"isVertical",{get:function(){var t=this.attributes,e=P(t.startPos,2),n=e[0],e=e[1],t=P(t.endPos,2),i=t[0],t=t[1];return n===i&&e!==t},enumerable:!1,configurable:!0}),Object.defineProperty(yw.prototype,"tagShapeSpace",{get:function(){var t=G1(this.tagShape);return{width:t.width,height:t.height}},enumerable:!1,configurable:!0}),yw.prototype.update=function(t){hw.prototype.update.call(this,t)},yw.prototype.setPointer=function(t){hw.prototype.setPointer.call(this,t),this.adjustPosition()},yw.prototype.setText=function(t){this.tagShape.update({text:t}),this.adjustTag()},yw.prototype.adjustLayout=function(){this.adjustPosition(),this.adjustTag()},yw.prototype.adjustPosition=function(){var t=P(this.localPointer,2),e=t[0],t=t[1],n=P(this.attributes.startPos,2),i=n[0],n=n[1],i=this.getOrientVal([i,t],[e,n]);this.shapesGroup.setLocalPosition(i)},yw.prototype.adjustTag=function(){var t,e,n=this.attributes,i=n.text,r=P(n.startPos,2),o=r[0],r=r[1],n=P(n.endPos,2),a=n[0],n=n[1];i&&""!==i?(this.tagShape.show(),i=i.position,t=(e=this.tagShapeSpace).width,e=e.height,o=(a=P(this.getOrientVal({start:[-t,-e/2],end:[a-o,-e/2]},{start:[-t/2,-e],end:[-t/2,n-r]})[i],2))[0],e=a[1],this.tagShape.setLocalPosition(o,e)):this.tagShape.hide()},yw.prototype.getOrientVal=function(t,e){return this.isVertical?e:t},yw.defaultOptions={type:yw.tag="line-crosshair",style:o},e([ib(20)],yw.prototype,"setPointer",null),t(vw,dw=re),Object.defineProperty(vw.prototype,"crosshairPath",{get:function(){return this.createCirclePath()},enumerable:!1,configurable:!0}),vw.prototype.update=function(t){dw.prototype.update.call(this,t)},vw.prototype.setPointer=function(t){var t=P(t,2),e=t[0],t=t[1],e=(dw.prototype.setPointer.call(this,[e,t]),P(this.localPointer,2)),t=e[0],e=e[1],n=P(this.attributes.center,2),i=n[0],n=n[1],t=this.createCirclePath(Math.pow(Math.pow(t-i,2)+Math.pow(e-n,2),.5));this.crosshairShape.attr({path:t})},vw.prototype.adjustLayout=function(){this.tagShape.hide()},vw.prototype.createCirclePath=function(t){var e=this.attributes,n=P(e.center,2),i=n[0],n=n[1],e=e.defaultRadius;return ob(i,n,t||e)},vw.defaultOptions={type:vw.tag="circle-crosshair",style:r},e([ib(20)],vw.prototype,"setPointer",null),t(gw,pw=re),Object.defineProperty(gw.prototype,"crosshairPath",{get:function(){return this.createPolygonPath()},enumerable:!1,configurable:!0}),gw.prototype.update=function(t){pw.prototype.update.call(this,t)},Object.defineProperty(gw.prototype,"points",{get:function(){for(var t,e,n,i,r,o,a=this.attributes,s=a.startAngle,u=a.sides,l=2*Math.PI/u,c=[1,0],h=[],d=0;d<u;d+=1)h.push((t=[0,0],e=c,n=[0,0],i=s/180*Math.PI+l*d,o=r=void 0,r=e[0]-n[0],e=e[1]-n[1],o=Math.sin(i),i=Math.cos(i),t[0]=r*i-e*o+n[0],t[1]=r*o+e*i+n[1],t));return h},enumerable:!1,configurable:!0}),gw.prototype.setPointer=function(t){var t=P(t,2),e=t[0],t=t[1],e=(pw.prototype.setPointer.call(this,[e,t]),P(this.localPointer,2)),t=e[0],e=e[1],n=this.attributes.center,i=P(this.intersection([t,e]),2),r=i[0],i=i[1];r&&i&&(t=nb(n,[t,e])/nb(n,[r,i]),e=this.createPolygonPath(t),this.crosshairShape.attr({path:e}))},gw.prototype.adjustLayout=function(){this.tagShape.hide()},gw.prototype.createPolygonPath=function(i){var t=this.attributes,r=t.defaultRadius,t=P(t.center,2),o=t[0],a=t[1],t=this.points.map(function(t,e){var t=P(t,2),t=P(jo([0,0],[t[0],t[1]],i||r),2),n=t[0],t=t[1];return[0===e?"M":"L",o+n,a+t]});return t.push(["Z"]),t},gw.prototype.intersection=function(t){for(var e,n,i,r,o,a,s,u,t=P(t,2),l=t[0],c=t[1],h=this.points,t=P(this.attributes.center,2),d=t[0],p=t[1],f=1;f<=h.length;f+=1){var y=P(h[f-1],2),v=y[0],y=y[1],g=P(h[f%h.length],2),m=g[0],g=g[1],v=(r=[d,p],v=[v+d,y+p],y=[m+d,g+p],u=s=a=o=g=m=void 0,g=(i=P(i=[l,c],2))[0],i=i[1],o=(r=P(r,2))[0],r=r[1],a=(v=P(v,2))[0],v=v[1],s=(y=P(y,2))[0],y=y[1],u=[],(y-v)*(o-g)==(r-i)*(s-a)?(r-i)*(a-g)==(v-i)*(o-g)&&(tb(g,o,i,r,a,v)&&eb(u,a,v),tb(g,o,i,r,s,y)&&eb(u,s,y),tb(a,s,v,y,g,i)&&eb(u,g,i),tb(a,s,v,y,o,r)&&eb(u,o,r)):(m=(g*(r-i)+v*(o-g)-i*(o-g)-a*(r-i))/((s-a)*(r-i)-(o-g)*(y-v)),0<=(y=(a*(y-v)+i*(s-a)-v*(s-a)-g*(y-v))/((o-g)*(y-v)-(s-a)*(r-i)))&&y<=1&&0<=m&&m<=1&&(u[0]=g+y*(o-g),u[1]=i+y*(r-i))),u);0!==v.length&&(e=(s=P(v,2))[0],n=s[1])}return[e,n]},gw.defaultOptions={type:gw.tag="polygon-crosshair",style:Vt},e([ib(20)],gw.prototype,"setPointer",null);t(kw,mw=ph),Object.defineProperty(kw.prototype,"decorationType",{get:function(){var t=this.attributes.type;return t&&"none"!==t&&q(t)?t.map(function(t){return q(t)?t:[t,"solid"]}):"none"},enumerable:!1,configurable:!0}),Object.defineProperty(kw.prototype,"doubleSpacing",{get:function(){return 2*this.attributes.style.lineWidth},enumerable:!1,configurable:!0}),Object.defineProperty(kw.prototype,"hangingRate",{get:function(){return this.attributes.hangingRate},enumerable:!1,configurable:!0}),Object.defineProperty(kw.prototype,"dashedCfg",{get:function(){var t=this.attributes.style.lineWidth;return{lineDash:[2*t,t]}},enumerable:!1,configurable:!0}),Object.defineProperty(kw.prototype,"dottedCfg",{get:function(){var t=this.attributes.style.lineWidth;return{lineDash:[t,t]}},enumerable:!1,configurable:!0}),Object.defineProperty(kw.prototype,"solidCfg",{get:function(){return{lineDash:[0,0]}},enumerable:!1,configurable:!0}),Object.defineProperty(kw.prototype,"decorationCfg",{get:function(){var i=this,r=this.attributes.style,t=this.decorationType;return"none"===t?[]:t.map(function(t){var t=P(t,2),e=t[0],t=t[1];if("wavy"===t)return E({path:i.getWavyPath(e)},r);if("double"===t)return E({path:i.getDoubleLinePath(e)},r);var n={solid:i.solidCfg,dashed:i.dashedCfg,dotted:i.dottedCfg};return E(E({path:i.getLinePath(e)},r),n[t])})},enumerable:!1,configurable:!0}),kw.prototype.update=function(t){var e=this;this.attr(J1({},this.attributes,t)),this.clear(),this.decorationCfg.forEach(function(t){e.appendChild(new Mh({style:t}))})},kw.prototype.clear=function(){this.removeChildren(!0)},kw.prototype.getLinePos=function(t){var e=P(this.hangingRate,3),n=e[0],i=e[1],e=e[2],r=this.attributes,o=r.height,r=r.fontSize,a=P([0,0],2),s=a[0],a=a[1],a="overline"===t?(s=(n=P([0,o*n-r/2],2))[0],n[1]):"line-through"===t?(s=(n=P([0,o*i],2))[0],n[1]):(s=(t=P([0,o*e+r/2],2))[0],t[1]);return[s,a]},kw.prototype.getLinePath=function(t){var e=this.attributes.width,t=P(this.getLinePos(t),2),n=t[0],t=t[1];return[["M",n,t],["L",n+e,t]]},kw.prototype.getDoubleLinePath=function(t){var e,n=this.doubleSpacing,i=this.attributes.width,r=P(this.getLinePos(t),2),o=r[0],r=r[1],a=P([0,0],2),s=a[0],a=a[1];return"line-through"===t&&(s=(e=P([-.5,.5],2))[0],a=e[1]),"underline"===t?(s=(e=P([0,1],2))[0],a=e[1]):"overline"===t&&(s=(e=P([1,0],2))[0],a=e[1]),[["M",o,r+n*s],["L",o+i,r+n*s],["M",o,r+n*a],["L",o+i,r+n*a]]},kw.prototype.getWavyPath=function(t){return[]},kw.tag="decoration",kw.defaultOptions={style:{width:0,height:0,type:"none",hangingRate:[.5,.55,.5],style:{lineWidth:1,stroke:"#000"}}};var mw,bw=kw;function kw(t){t=mw.call(this,J1({},kw.defaultOptions,t))||this;return t.update({}),t}t(Sw,xw=d),Object.defineProperty(Sw.prototype,"textWidth",{get:function(){var e=this;return K(this.renderText.split("\n").map(function(t){return S1(t,e.font)}))||0},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"textHeight",{get:function(){return G1(this.textShape).height},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"width",{get:function(){var t=this.attributes.width;return"auto"===t||void 0===t||0===t?this.textWidth:t},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"height",{get:function(){var t=this.attributes.height;return et(t)&&0!==t?t:G1(this.textShape).height},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"lineHeight",{get:function(){var t=this.attributes,e=t.lineHeight,t=t.fontSize;return e&&0!==e?e:t},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"capitalizeWord",{get:function(){return this.attributes.text.split("\n").map(function(t){return t.split(" ").map(function(t){return O1(t,"capitalize")}).join(" ")}).join("\n")},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"text",{get:function(){var t=this.attributes,e=t.transform,t=t.text;return"capitalize"===e?this.capitalizeWord:O1(t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"ellipsisText",{get:function(){var e=this,t=this.text,n=this.attributes,i=n.width,n=n.overflow,r="ellipsis"===n?"...":n;return t.split("\n").map(function(t){return w1(t,et(i)?i:1/0,e.font,r)}).join("\n")},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"renderText",{get:function(){var t=this.attributes.width,e=this.attributes.overflow;return e&&!["none","clip","wrap"].includes(e)&&et(t)?this.ellipsisText:this.text},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"verticalAlign",{get:function(){return this.attributes.verticalAlign},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"font",{get:function(){return vt(this.attributes,["fontSize","fontFamily","fontWeight","fontStyle","fontVariant","letterSpacing","leading"])},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"fontColor",{get:function(){return this.attributes.fontColor},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"wordWrap",{get:function(){return"wrap"===this.attributes.overflow},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"wordWrapWidth",{get:function(){var t=this.width;return this.wordWrap?t:1/0},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"textCfg",{get:function(){var t=this.renderText,e=this.lineHeight,n=this.wordWrap,i=this.wordWrapWidth,r=this.fontColor;return E(E(E({},F1),this.font),{fill:r,wordWrap:n,lineHeight:e,wordWrapWidth:i,text:t,textAlign:"start",textBaseline:"middle"})},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"backgroundCfg",{get:function(){var t=this.width,e=this.height,n=this.attributes.backgroundStyle;return E({x:0,y:0,width:t,height:e},n)},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"decorationLineWidth",{get:function(){var t=this.attributes.fontSize;return Math.floor(2*Math.log10(t))},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"decorationCfg",{get:function(){var t=this.attributes,e=t.decoration,n=t.fontSize,i=this.decorationLineWidth,r=this.fontColor;return this.textShape.getLineBoundingRects().map(function(t){return J1({},{fontSize:n,style:{stroke:r,lineWidth:i}},e,t)})},enumerable:!1,configurable:!0}),Object.defineProperty(Sw.prototype,"clipRectCfg",{get:function(){var t=this.height;return{width:this.attributes.width,height:t}},enumerable:!1,configurable:!0}),Sw.prototype.init=function(){this.initShape(),this.update({})},Sw.prototype.update=function(t){var e=this;this.attr(J1({},this.attributes,t)),this.clear(),this.backgroundShape.attr(this.backgroundCfg),this.textShape.attr(this.textCfg),this.layout(),this.decorationGroup.removeChildren(!0),this.decorationCfg.forEach(function(t){e.decorationGroup.appendChild(new bw({style:t}))})},Sw.prototype.clear=function(){var t;(this.backgroundShape.style.clipPath=null)!=(t=this.clipRect)&&t.destroy()},Sw.prototype.initShape=function(){this.backgroundShape=new Lh({name:"background",style:{width:0,height:0}}),this.decorationGroup=new xh({name:"decoration-group"}),this.textShape=new Dh({name:"text",style:this.textCfg}),this.textShape.appendChild(this.decorationGroup),this.backgroundShape.appendChild(this.textShape),this.appendChild(this.backgroundShape)},Sw.prototype.overflow=function(){var t=this.wordWrap,e=this.attributes,n=e.width,e=e.overflow;e&&"none"!==e&&!t&&et(n)&&"clip"===e&&(this.clipRect=new Lh({name:"clip-rect",style:this.clipRectCfg}),this.backgroundShape.style.clipPath=this.clipRect)},Sw.prototype.adjustTextAlign=function(){var t=this.textWidth,e=this.attributes,n=e.width,e=e.textAlign;et(n)&&(n=0,n="start"===e?0:"center"===e?(this.width-t)/2:this.width-t,this.textShape.attr({x:n}))},Sw.prototype.adjustVerticalAlign=function(){var t=this.verticalAlign,e=this.textHeight,n=0,n="top"===t?e/2:"middle"===t?this.height/2:this.height-e/2;this.textShape.attr({y:n})},Sw.prototype.layout=function(){this.adjustTextAlign(),this.adjustVerticalAlign(),this.overflow()},Sw.defaultOptions={type:Sw.tag="paragraph",style:{text:"",fontColor:"#000",fontFamily:"sans-serif",fontSize:12,fontWeight:"normal",fontVariant:"normal",letterSpacing:0,leading:0,fontStyle:"normal",decoration:{type:"none",style:{}},overflow:"none",backgroundStyle:{},transform:"none",tooltip:!1,tooltipWait:300}};var xw,ww=Sw;function Sw(t){t=xw.call(this,J1({},Sw.defaultOptions,t))||this;return t.init(),t}var Ew,c=E(E({},F1),{stroke:"rgba(0,0,0,0.45)",fontSize:10,lineHeight:16,textAlign:"start",overflow:"clip"}),ve={default:{width:12,height:12,radius:2,stroke:"#dadada",lineWidth:1,fill:"#ffffff",cursor:"pointer"},active:{width:12,height:12,radius:2,stroke:"#3471F9",lineWidth:1,fill:"#ffffff",cursor:"pointer"},selected:{width:12,height:12,radius:2,stroke:"#3471F9",lineWidth:1,fill:"#3471F9",cursor:"pointer"},disabled:{width:12,height:12,radius:2,stroke:"#d9d9d9",lineWidth:1,fill:"#f5f5f5",cursor:"no-drop"}};function Tw(t){t=Ew.call(this,O({},Tw.defaultOptions,t))||this;return t.init(),t}t(Tw,Ew=d),Tw.prototype.init=function(){this.initChecked(),this.initShape(),this.bindEvents(),this.labelShape&&this.verticalCenter()},Tw.prototype.update=function(t){this.attr(O({},this.attributes,t)),this.updateShape(),this.labelShape&&this.verticalCenter()},Tw.prototype.clear=function(){},Tw.prototype.destroy=function(){this.checkedShape.destroy(),this.checkboxBackgroundShape.destroy(),this.labelShape&&this.labelShape.destroy(),Ew.prototype.destroy.call(this)},Object.defineProperty(Tw.prototype,"label",{get:function(){return this.labelShape},enumerable:!1,configurable:!0}),Object.defineProperty(Tw.prototype,"checkbox",{get:function(){return this.checkboxBackgroundShape},enumerable:!1,configurable:!0}),Tw.prototype.initShape=function(){this.checkboxBackgroundShape=this.createCheckboxBackgroundShape(),this.checkedShape=this.createCheckedShape(),Y(this.getAttribute("label"))||ut(this.getAttribute("label"))||(this.labelShape=this.createLabelShape()),this.checkboxBackgroundShape.appendChild(this.checkedShape),this.labelShape&&this.checkboxBackgroundShape.appendChild(this.labelShape),this.appendChild(this.checkboxBackgroundShape)},Tw.prototype.createCheckboxBackgroundShape=function(){var t=this.attributes,e=t.x,n=t.y,i=t.style,r=t.checked,t=t.disabled,o=i.default;return t?o=i.disabled:r&&(o=i.selected),new Lh({style:E(E({},o),{x:e,y:n})})},Tw.prototype.createLabelShape=function(){var t=this.attributes,e=t.disabled,t=t.label,n=t.text,i=t.spacing,t=t.textStyle,r=this.checkboxBackgroundShape.attributes.width;return new ww({name:"label",style:E(E({},t),{text:n,x:r+i,fontColor:e?"rgba(0,0,0,0.25)":null==t?void 0:t.stroke})})},Tw.prototype.createCheckedShape=function(){var t=this.attributes,e=t.disabled,t=t.checked,e=new Mh({style:{path:[["M",3,6],["L","5","8.5"],["L","8.5","4"]],stroke:e?"rgba(0,0,0,0.25)":"#ffffff"}});return t||e.setAttribute("visibility","hidden"),e},Tw.prototype.initChecked=function(){var t=this.attributes,e=t.defaultChecked,t=t.checked;this.checked=!!(Y(t)?e:t),this.setAttribute("checked",this.checked)},Tw.prototype.updateShape=function(){this.updateCheckboxShape(),this.updateCheckedShape(),ut(this.getAttribute("label"))||Y(this.getAttribute("label"))?(this.labelShape&&this.labelShape.destroy(),this.labelShape=void 0):this.labelShape?this.updateLabelShape():this.createLabelShape(),this.getAttribute("disabled")&&this.removeEvents()},Tw.prototype.updateCheckedShape=function(){var t=this.attributes,e=t.disabled,t=t.checked;this.checkedShape.setAttribute("stroke",e?"rgba(0,0,0,0.25)":"#ffffff"),this.checkedShape.setAttribute("visibility",t?"visible":"hidden")},Tw.prototype.updateLabelShape=function(){var n=this,t=this.attributes,e=t.disabled,t=t.label,i=t.text,r=t.spacing,t=t.textStyle,o=this.checkboxBackgroundShape.attributes.width;this.labelShape.setAttribute("text",i),this.labelShape.setAttribute("x",o+r),Object.entries(t||{}).forEach(function(t){var t=P(t,2),e=t[0],t=t[1];return n.labelShape.setAttribute(e,t)}),e&&this.labelShape.update({fontColor:"rgba(0,0,0,0.25)"})},Tw.prototype.updateCheckboxShape=function(){var n=this,t=this.attributes,e=t.style,i=t.checked,t=t.disabled,r=(this.checked=i,e.selected),o=e.default,e=e.disabled;t?Object.entries(e||{}).forEach(function(t){var t=P(t,2),e=t[0],t=t[1];n.checkboxBackgroundShape.setAttribute(e,t)}):i?(Object.entries(r||{}).forEach(function(t){var t=P(t,2),e=t[0],t=t[1];n.checkboxBackgroundShape.setAttribute(e,t)}),this.checkedShape.setAttribute("visibility","visible")):(Object.entries(o||{}).forEach(function(t){var t=P(t,2),e=t[0],t=t[1];n.checkboxBackgroundShape.setAttribute(e,t)}),this.checkedShape.setAttribute("visibility","hidden"))},Tw.prototype.bindEvents=function(){this.attributes.disabled||(this.addClick(),this.addHover())},Tw.prototype.removeEvents=function(){this.checkboxBackgroundShape.removeAllEventListeners()},Tw.prototype.addHover=function(){var n=this;this.checkboxBackgroundShape.addEventListener("mouseenter",function(){var t;n.checked||(t=n.attributes.style.active,Object.entries(t||{}).forEach(function(t){var t=P(t,2),e=t[0],t=t[1];n.checkboxBackgroundShape.setAttribute(e,t)}))}),this.checkboxBackgroundShape.addEventListener("mouseleave",function(){var t;n.checked||(t=n.attributes.style.default,Object.entries(t||{}).forEach(function(t){var t=P(t,2),e=t[0],t=t[1];n.checkboxBackgroundShape.setAttribute(e,t)}))})},Tw.prototype.addClick=function(){var e=this;this.checkboxBackgroundShape.addEventListener("click",function(){var t=e.attributes.onChange;e.checked=!e.checked,e.setAttribute("checked",e.checked),e.updateShape(),U(t)&&t(e.checked)})},Tw.prototype.verticalCenter=function(){var t=this.checkboxBackgroundShape.attributes.height,e=this.labelShape.attributes.lineHeight;this.labelShape.setAttribute("y",(t-e)/2)},Object.defineProperty(Tw.prototype,"labelBounds",{get:function(){var t;return null==(t=this.labelShape)?void 0:t.getBounds()},enumerable:!1,configurable:!0}),Object.defineProperty(Tw.prototype,"checkboxBounds",{get:function(){return this.checkboxBackgroundShape.getBounds()},enumerable:!1,configurable:!0}),Tw.defaultOptions={type:Tw.tag="checkbox",style:{x:0,y:0,label:{text:"",textStyle:c,spacing:4},defaultChecked:!1,style:{default:ve.default,selected:ve.selected,active:ve.active,disabled:ve.disabled},disabled:!1}};var _w="gui-poptip",Mw="gui-poptip-arrow",Pw="gui-poptip-text",Ow=((s={})[".".concat(_w)]={visibility:"visible",position:"absolute","background-color":"rgba(0, 0, 0)","box-shadow":"0px 0px 10px #aeaeae","border-radius":"3px",color:"#fff",opacity:.8,"font-size":"12px",padding:"4px 6px",display:"flex","justify-content":"center","align-items":"center","z-index":8,transition:"visibility 50ms"},s[".".concat(Pw)]={"text-align":"center"},s[".".concat(_w,"[data-position='top']")]={transform:"translate(-50%, -100%)"},s[".".concat(_w,"[data-position='left']")]={transform:"translate(-100%, -50%)"},s[".".concat(_w,"[data-position='right']")]={transform:"translate(0, -50%)"},s[".".concat(_w,"[data-position='bottom']")]={transform:"translate(-50%, 0)"},s[".".concat(_w,"[data-position='top-left']")]={transform:"translate(0,-100%)"},s[".".concat(_w,"[data-position='top-right']")]={transform:"translate(-100%,-100%)"},s[".".concat(_w,"[data-position='left-top']")]={transform:"translate(-100%, 0)"},s[".".concat(_w,"[data-position='left-bottom']")]={transform:"translate(-100%, -100%)"},s[".".concat(_w,"[data-position='right-top']")]={transform:"translate(0, 0)"},s[".".concat(_w,"[data-position='right-bottom']")]={transform:"translate(0, -100%)"},s[".".concat(_w,"[data-position='bottom-left']")]={transform:"translate(0, 0)"},s[".".concat(_w,"[data-position='bottom-right']")]={transform:"translate(-100%, 0)"},s[".".concat(Mw)]={width:"4px",height:"4px",transform:"rotate(45deg)","background-color":"rgba(0, 0, 0)",position:"absolute","z-index":-1},s[".".concat(_w,"[data-position='top']")]={transform:"translate(-50%, calc(-100% - 5px))"},s["[data-position='top'] .".concat(Mw)]={bottom:"-2px"},s[".".concat(_w,"[data-position='left']")]={transform:"translate(calc(-100% - 5px), -50%)"},s["[data-position='left'] .".concat(Mw)]={right:"-2px"},s[".".concat(_w,"[data-position='right']")]={transform:"translate(5px, -50%)"},s["[data-position='right'] .".concat(Mw)]={left:"-2px"},s[".".concat(_w,"[data-position='bottom']")]={transform:"translate(-50%, 5px)"},s["[data-position='bottom'] .".concat(Mw)]={top:"-2px"},s[".".concat(_w,"[data-position='top-left']")]={transform:"translate(0, calc(-100% - 5px))"},s["[data-position='top-left'] .".concat(Mw)]={left:"10px",bottom:"-2px"},s[".".concat(_w,"[data-position='top-right']")]={transform:"translate(-100%, calc(-100% - 5px))"},s["[data-position='top-right'] .".concat(Mw)]={right:"10px",bottom:"-2px"},s[".".concat(_w,"[data-position='left-top']")]={transform:"translate(calc(-100% - 5px), 0)"},s["[data-position='left-top'] .".concat(Mw)]={right:"-2px",top:"8px"},s[".".concat(_w,"[data-position='left-bottom']")]={transform:"translate(calc(-100% - 5px), -100%)"},s["[data-position='left-bottom'] .".concat(Mw)]={right:"-2px",bottom:"8px"},s[".".concat(_w,"[data-position='right-top']")]={transform:"translate(5px, 0)"},s["[data-position='right-top'] .".concat(Mw)]={left:"-2px",top:"8px"},s[".".concat(_w,"[data-position='right-bottom']")]={transform:"translate(5px, -100%)"},s["[data-position='right-bottom'] .".concat(Mw)]={left:"-2px",bottom:"8px"},s[".".concat(_w,"[data-position='bottom-left']")]={transform:"translate(0, 5px)"},s["[data-position='bottom-left'] .".concat(Mw)]={top:"-2px",left:"8px"},s[".".concat(_w,"[data-position='bottom-right']")]={transform:"translate(-100%, 5px)"},s["[data-position='bottom-right'] .".concat(Mw)]={top:"-2px",right:"8px"},s),Cw=void 0;var Aw;function Nw(t){var e=t&&document.getElementById(t);return e||((e=document.createElement("div")).setAttribute("id",t),document.body.appendChild(e)),e}function Lw(t){var n,i;return n=Nw,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return i=i||n.apply(Cw,t)}(t)}function Iw(t){t=Aw.call(this,O({style:{id:"gui-poptip"}},Iw.defaultOptions,t))||this;return t.visibility="visible",t.map=new Map,t.domStyles="",t.init(),t}t(Iw,Aw=d),Object.defineProperty(Iw.prototype,"visible",{get:function(){return"visible"===this.visibility},enumerable:!1,configurable:!0}),Iw.prototype.init=function(){this.initShape(),this.update()},Iw.prototype.update=function(t){this.attr(O({},this.style,t)),this.visibility=this.style.visibility,this.updatePoptipElement()},Iw.prototype.bind=function(s,u){var l,t,e,c=this;s&&(l=this.style.text,e=function(){c.hideTip()},s.addEventListener("mousemove",t=function(t){var e=s,n=c.style,i=l,r=(u&&(a=(r="function"==typeof u?u.call(null,t):u).html,o=r.target,r=_(r,["html","target"]),n=ht({},c.style,r),!o&&!1!==o||(e=o),"string"==typeof a&&(i=a)),n.position),o=n.arrowPointAtCenter,a=n.follow,n=n.offset;e?(e=(t=P(function(t,e,n,i,r,o){if(void 0===r&&(r=!1),o=void 0===o?!1:o)return[t,e];var a=(o=n.getBoundingClientRect()).x,s=o.y,u=o.width,l=o.height;switch(i){case"top":return r?[a+u/2,s]:[t,s];case"left":return r?[a,s+l/2]:[a,e];case"bottom":return r?[a+u/2,s+l]:[t,s+l];case"right":return r?[a+u,s+l/2]:[a+u,e];case"top-right":case"right-top":return[a+u,s];case"left-bottom":case"bottom-left":return[a,s+l];case"right-bottom":case"bottom-right":return[a+u,s+l];default:return[a,s]}}(t.clientX,t.clientY,e,r,o,a),2))[0],o=t[1],c.showTip(e,o,{text:i,position:r,offset:n})):c.hideTip()}),s.addEventListener("mouseleave",e),this.map.set(s,[t,e]))},Iw.prototype.unbind=function(t){var e,n;this.map.has(t)&&(e=(n=P(this.map.get(t)||[],2))[0],n=n[1],e&&t.removeEventListener("mousemove",e),n&&t.removeEventListener("mouseleave",n),this.map.delete(t))},Iw.prototype.clear=function(){this.container.innerHTML=""},Iw.prototype.destroy=function(){var t,e=this;z([],P(this.map.keys()),!1).forEach(function(t){return e.unbind(t)}),null!=(t=this.container)&&t.remove()},Iw.prototype.showTip=function(t,e,n){var i,r=yt(n,"text");r&&"string"!=typeof r||(this.applyStyles(),t&&e&&n&&(i=n.offset,(n=n.position)&&this.container.setAttribute("data-position",n),this.setOffsetPosition(t,e,i),"string"==typeof r&&(n=this.container.querySelector(".".concat(Pw)))&&(n.innerHTML=r),this.visibility="visible",this.container.style.visibility="visible"))},Iw.prototype.hideTip=function(){this.visibility="hidden",this.container.style.visibility="hidden"},Iw.prototype.getContainer=function(){return this.container},Iw.prototype.getClassName=function(){var t=this.style.containerClassName;return"".concat(_w).concat(t?" ".concat(t):"")},Iw.prototype.initShape=function(){var t=this,e=this.style.id;this.container=Lw(e),this.container.setAttribute("class",this.getClassName()),this.container.addEventListener("mousemove",function(){return t.showTip()}),this.container.addEventListener("mouseleave",function(){return t.hideTip()})},Iw.prototype.updatePoptipElement=function(){var t=this.container,e=(this.clear(),this.style),n=e.id,i=e.template,e=e.text,n=(this.container.setAttribute("id",n),this.container.setAttribute("class",this.getClassName()),'<span class="'.concat(Mw,'"></span>'));t.innerHTML=n,Q(i)?t.innerHTML+=i:i&&lt(i)&&t.appendChild(i),e&&(t.getElementsByClassName(Pw)[0].textContent=e),this.applyStyles(),this.container.style.visibility=this.visibility},Iw.prototype.applyStyles=function(){var t,e=J1({},Ow,this.style.domStyles),e=Object.entries(e).reduce(function(t,e){var e=P(e,2),n=e[0],e=e[1],e=Object.entries(e).reduce(function(t,e){var e=P(e,2),n=e[0],e=e[1];return"".concat(t).concat(n,": ").concat(e,";")},"");return"".concat(t).concat(n,"{").concat(e,"}")},"");this.domStyles!==e&&(this.domStyles=e,(t=this.container.querySelector("style"))&&this.container.removeChild(t),(t=document.createElement("style")).innerHTML=e,this.container.appendChild(t))},Iw.prototype.setOffsetPosition=function(t,e,n){var n=P(n=void 0===n?this.style.offset:n,2),i=n[0],n=n[1],n=void 0===n?0:n;this.container.style.left="".concat(t+(void 0===i?0:i),"px"),this.container.style.top="".concat(e+n,"px")},Iw.tag="poptip",Iw.defaultOptions={style:{x:0,y:0,width:0,height:0,target:null,visibility:"hidden",text:"",position:"top",follow:!1,offset:[0,0],domStyles:Ow,template:'<div class="'.concat(Pw,'"></div>')}};t(Rw,Dw=d),Rw.registerFeatures=function(t,e){Rw.features.set(t,e)},Rw.prototype.init=function(){var r=this,t=this.attributes,e=t.x,e=void 0===e?0:e,n=t.y,n=void 0===n?0:n,i=t.width,o=t.height,a=t.features,s=t.markerStyle,u=t.textStyle,l=void 0===u?{}:u,u=t.markerSize,c=void 0===u?24:u,t=null,h=((i||o)&&(t=new Lh({style:{x:e,y:n,width:null!=i?i:Number.MAX_SAFE_INTEGER,height:null!=o?o:Number.MAX_SAFE_INTEGER}})),new xh({id:"container",style:{x:e,y:n,clipPath:t}}));a.forEach(function(t){var n,e,i=Rw.features.get(t);i&&((n=i({size:c})).className="feature-item",i=new Lh({style:{x:0,y:0,width:c,height:c}}),e=new Dh({style:E(E({x:0,y:0,text:t},l),{fillOpacity:0})}),i.appendChild(n),i.appendChild(e),Object.entries((null==s?void 0:s.default)||{}).forEach(function(t){var t=P(t,2),e=t[0],t=t[1];return n.setAttribute(e,t)}),r.bindEvent(i,e,t),h.appendChild(i))}),this.appendChild(h)},Rw.prototype.layout=function(){var t=this.attributes.spacing,i=void 0===t?0:t;this.getElementById("container").children.reduce(function(t,e){var n=e.getBoundingClientRect();return e.setLocalPosition(t,0),e.getElementsByTagName("text")[0].translateLocal(n.width/2,n.height),t+n.width+i},0)},Rw.prototype.update=function(){},Rw.prototype.clear=function(){},Rw.prototype.bindEvent=function(e,n,r){var o=this,t=this.attributes,a=t.markerStyle,i=t.textStyle,s=t.onClick,u=e.firstChild;u&&(e.addEventListener("mouseenter",function(){var t;e.setAttribute("cursor","pointer"),n.setAttribute("fillOpacity",null!=(t=null==i?void 0:i.fillOpacity)?t:1)}),e.addEventListener("mouseleave",function(){e.setAttribute("cursor","default"),n.setAttribute("fillOpacity",0)}),"function"==typeof s&&e.addEventListener("click",function(t){var e=o.activeFeatures,n=(null==a?void 0:a.default)||{},i=(null==a?void 0:a.active)||{};e.has(u.name)?(Object.entries(n).forEach(function(t){var t=P(t,2),e=t[0],t=t[1];return u.setAttribute(e,t)}),e.delete(u.name)):(Object.entries(i).forEach(function(t){var t=P(t,2),e=t[0],t=t[1];return u.setAttribute(e,t)}),e.add(u.name)),s.call(o,r,t)}))},Rw.defaultOptions={type:Rw.tag="toolbox",style:{spacing:8,features:[],textStyle:E(E({},F1),{fill:"rgba(0,0,0,0.65)",textBaseline:"top",textAlign:"center"}),markerSize:24,markerStyle:{default:{stroke:"#666"},active:{stroke:"#3471F9"}}}},Rw.features=new Map;var Dw,ge=Rw;function Rw(t){t=Dw.call(this,J1({},Rw.defaultOptions,t))||this;return t.activeFeatures=new Set,t.init(),t.layout(),t}ge.registerFeatures("reset",function(t){var e=t.size,e=void 0===e?24:e,t=t.stroke,t=void 0===t?"#363636":t,n=new Lh({style:{x:0,y:0,width:e,height:e}}),i=Math.sqrt(9),t=new Mh({style:{lineWidth:1,stroke:t,transformOrigin:"center",path:[["M",3,3],["L",21,3],["L",21,21],["L",3,21],["L",3,12],["M",3+i,3-i],["L",3,3],["L",3+i,3+i]]}});return t.scale(e/24),n.appendChild(t),n}),ge.registerFeatures("reload",function(t){var e=t.size,e=void 0===e?24:e,t=t.stroke,t=void 0===t?"#363636":t,n=new Lh({style:{x:0,y:0,width:e,height:e}}),t=new Mh({style:{lineWidth:1,stroke:t,transformOrigin:"center",path:[["M",3,10.5],["A",8,7,0,0,1,21,9.5],["M",22,7],["L",21,9.5],["L",19,8],["M",4,13.5],["A",8,7,0,0,0,21,13.5],["M",2.5,15],["L",4,13.5],["L",5.5,15.5]]}});return t.scale(e/24),n.appendChild(t),n}),ge.registerFeatures("download",function(t){var e=t.size,e=void 0===e?24:e,t=t.stroke,t=void 0===t?"#363636":t,n=new Lh({style:{x:0,y:0,width:e,height:e}}),i=new Mh({style:{lineWidth:1,stroke:t,transformOrigin:"center",path:[["M",11.5,2],["L",11.5,17],["M",3,9],["L",11.5,17],["L",20,9],["M",3,17],["L",3,20.5],["L",20,20.5],["L",20,17]]}});return i.scale(e/24),n.appendChild(i),n.setAttribute=function(t,e){return i.setAttribute(t,e)},n});class jw extends yh{constructor(t){super(t)}connectedCallback(){this.draw()}attributeChangedCallback(){this.draw()}draw(){this.drawText(),this.drawBackground(),this.drawConnector(),this.drawPoints()}get endPoint(){const t=this.style["connector"];var e,n;return Array.isArray(null===t||void 0===t?void 0:t.path)&&t.path.length?([[,e,n]]=t.path.slice(-1),{x:e,y:n}):{x:0,y:0}}drawText(){var t=this.attributes,e=t["textAlign"],t=_(t,["connector","startMarker","endMarker","background","transform","textAlign"]),{x:n,y:i}=this.endPoint;this.textShape=Cm(this.textShape||this.appendChild(new Dh({}))).call(Nm,t).style("x",+n).style("y",+i).style("textAlign",e||(n<0?"right":0<n?"left":"center")).node()}drawBackground(){var t=this.style["background"];if(!t)return this.background&&this.removeChild(this.background,!0),void(this.background=void 0);var e=t["padding"],t=_(t,["padding"]),[e=0,n=0,i=e,r=n]=e||[],o=this.getEulerAngles(),{min:[a,s],halfExtents:[u,l]}=(this.setEulerAngles(0),this.textShape.getLocalBounds());this.setEulerAngles(o),this.background=Cm(this.background||this.appendChild(new Lh({}))).style("zIndex",-1).style("x",a-r).style("y",s-e).style("width",2*u+r+n).style("height",2*l+e+i).call(Nm,t).node()}drawConnector(){var t=this.style["connector"];if(!t)return this.connector&&this.removeChild(this.connector,!0),void(this.connector=void 0);var e=t.path||function(t){var{min:[t,e],max:[n,i]}=t.getLocalBounds();let r=0,o=0;return 0<t&&(r=t),n<0&&(r=n),0<e&&(o=e),i<0&&(o=i),[["M",0,0],["L",r,o]]}(this.background||this.textShape);this.connector=Cm(this.connector||this.appendChild(new Mh({}))).style("zIndex",-1).style("stroke","black").style("lineWidth",1).call(Nm,t).style("path",e).node()}drawPoints(){var{startMarker:t,endMarker:e}=this.style;this.drawStartMarker(t),this.drawEndMarker(e&&Object.assign(Object.assign({},e),this.endPoint))}drawStartMarker(t){var e=this.startMarkerPoint;if(!t)return e&&this.removeChild(e,!0),void(this.startMarkerPoint=void 0);e||(this.startMarkerPoint=this.appendChild(new D({style:{symbol:"circle",size:4}}))),this.startMarkerPoint.update(t)}drawEndMarker(t){var e=this.endMarkerPoint;if(!t)return e&&this.removeChild(e,!0),void(this.endMarkerPoint=void 0);e||(this.endMarkerPoint=this.appendChild(new D({style:{symbol:"circle",size:4}}))),this.endMarkerPoint.update(t)}}const Bw=t=>{const u=_(t,[]);return(t,e,n,i)=>{var i=i["defaultColor"],{color:e=i,text:i="",fontSize:r=12,rotate:o=0,transform:a=""}=e,[[t,s]]=t;return Cm(new jw({})).style("x",t).style("y",s).style("text",String(i)).style("stroke",e).style("fill",e).style("fontSize",r).style("transform",a+`rotate(${+o}deg)`).call(Nm,u).node()}};Bw.props={defaultEnterAnimation:"fadeIn"};class Fw extends yh{constructor(t){super(t)}connectedCallback(){this.draw()}attributeChangedCallback(){this.draw()}draw(){this.drawMarker(),this.drawText()}drawMarker(){const t=this.attributes,{size:s=24}=t,e=_(t,["size"]);this.badgeMarker=this.badgeMarker||this.appendChild(new D({})),this.badgeMarker.className="badge-marker",this.badgeMarker.update(Object.assign(Object.assign({symbol:()=>{var t=s/2,e=t/Math.sqrt(2),n=t*Math.sqrt(2),[i,r]=[-e,e-n],[o,a]=[0,0],[e,n]=[e,e-n];return[["M",i,r],["A",t,t,0,1,1,e,n],["L",o,a],["Z"]]},size:s},e),{x:0,y:0}))}drawText(){var t=function(t){var{min:t,max:e}=t.getLocalBounds();return{x:(t[0]+e[0])/2,y:(t[1]+e[1])/2}}(this.badgeMarker),{content:e="",textStyle:n}=this.style,{fontSize:n=10,fill:i="#333"}=n||{};this.badgeText=this.badgeText||this.appendChild(new Dh({})),Cm(this.badgeText).attr("className","badge-text").style("x",t.x).style("y",t.y).style("textAlign","center").style("textBaseline","middle").call(Nm,{fill:i,fontSize:n,text:e}).node()}}const zw=t=>{const o=_(t,[]);return(t,e,n,i)=>{var i=i["defaultColor"],{color:e=i,text:i=""}=e,[[t,r]]=t;return Cm(new Fw({})).style("x",t).style("y",r).style("text",String(i)).style("stroke",e).style("fill",e).call(Nm,o).node()}},Vw=(zw.props={defaultEnterAnimation:"fadeIn"},t=>{const f=t["curve"],y=_(t,["curve"]);return(t,e,n,i)=>{var r,o,a,s,u,i=i["defaultColor"],{color:i=i}=e;let l=e["transform"];const c=t.slice(0,t.length/2),h=t.slice(t.length/2);let d;if(xv(n)){const p=n.getCenter();d=(e=em().curve(nm),r=e.curve,o=e.lineX0,a=e.lineX1,s=e.lineY0,u=e.lineY1,e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return om(o())},delete e.lineX0,e.lineEndAngle=function(){return om(a())},delete e.lineX1,e.lineInnerRadius=function(){return om(s())},delete e.lineY0,e.lineOuterRadius=function(){return om(u())},delete e.lineY1,e.curve=function(t){return arguments.length?r(rm(t)):r()._curve},e.angle((t,e)=>Sm(xm(c[e],p))).outerRadius((t,e)=>wm(c[e],p)).innerRadius((t,e)=>wm(h[e],p)).curve(f)(h)),l=`translate(${p[0]}, ${p[1]}) `+(l||"")}else d=em().x((t,e)=>c[e][0]).y1((t,e)=>c[e][1]).y0((t,e)=>h[e][1]).curve(f)(c);return Cm(new Mh({})).style("d",d).style("fill",i).style("stroke",i).style("transform",l).call(Nm,y).node()}}),Hw=(Vw.props={defaultEnterAnimation:"fadeIn"},o=>(t,e,n,i)=>{var r=xv(n)?vm:$0;return Vw(Object.assign({curve:r},o))(t,e,n,i)}),Gw=(Hw.props=Object.assign({},Vw.props),t=>{const{alpha:o=.5}=t,a=_(t,["alpha"]);return(t,e,n,i)=>{const r=xv(n)?fm:dm;return Vw(Object.assign({curve:r.alpha(o)},a))(t,e,n,i)}}),Ww=(Gw.props=Object.assign({},Vw.props),t=>{const o=_(t,[]);return(t,e,n,i)=>{var i=i["defaultColor"],{color:e=i,transform:i}=e,[t,r]=t;return Cm(new Th).style("x1",t[0]).style("y1",t[1]).style("x2",r[0]).style("y2",r[1]).style("stroke",e).style("transform",i).call(Nm,o).node()}}),Uw=(Ww.props={defaultEnterAnimation:"fadeIn"},t=>{const a=_(t,[]);return(t,e,n,i)=>{var i=i["defaultColor"],{color:e=i,transform:i}=e,[t,r]=t;const o=P0();return o.moveTo(t[0],t[1]),o.bezierCurveTo(t[0]/2+r[0]/2,t[1],t[0]/2+r[0]/2,r[1],r[0],r[1]),Cm(new Mh).style("d",o.toString()).style("stroke",e).style("transform",i).call(Nm,a).node()}}),Yw=(Uw.props={defaultEnterAnimation:"fadeIn"},t=>{const s=_(t,[]);return(t,e,n,i)=>{var i=i["defaultColor"],{color:e=i,src:i="",size:r=32,transform:o=""}=e,[[t,a]]=t,t=t-Number(r)/2,a=a-Number(r)/2;return Cm(new Sh).style("x",t).style("y",a).style("width",r).style("height",r).style("img",i).style("stroke",e).style("transform",o).call(Nm,s).node()}}),qw=(Yw.props={defaultEnterAnimation:"fadeIn"},t=>{const o=_(t,[]);return(t,e,n,i)=>{var i=i["defaultColor"],{color:e=i,transform:i}=e;const r=P0();return t.forEach((t,e)=>0===e?r.moveTo(t[0],t[1]):r.lineTo(t[0],t[1])),r.closePath(),Cm(new Mh).style("d",r.toString()).style("stroke",e).style("fill",e).style("transform",i).call(Nm,o).node()}});qw.props={defaultEnterAnimation:"fadeIn"};const Xw=t=>{const o=_(t,[]);return(t,e,n,i)=>{var i=i["defaultColor"],{color:e=i,transform:i}=e;const r=function(t,e){const n=P0();var i,r,o,a,s,u,l,c;return xv(e)?([i,r]=e=e.getCenter(),o=Sm(xm(t[0],e)),a=Sm(xm(t[1],e)),s=wm(e,t[2]),u=wm(e,t[3]),l=wm(e,t[8]),c=wm(e,t[10]),e=wm(e,t[11]),n.moveTo(...t[0]),n.arc(i,r,s,o,a),n.arc(i,r,s,a,o,!0),n.moveTo(...t[2]),n.lineTo(...t[3]),n.moveTo(...t[4]),n.arc(i,r,u,o,a),n.lineTo(...t[6]),n.arc(i,r,c,a,o,!0),n.closePath(),n.moveTo(...t[8]),n.arc(i,r,l,o,a),n.arc(i,r,l,a,o,!0),n.moveTo(...t[10]),n.lineTo(...t[11]),n.moveTo(...t[12]),n.arc(i,r,e,o,a),n.arc(i,r,e,a,o,!0)):(n.moveTo(...t[0]),n.lineTo(...t[1]),n.moveTo(...t[2]),n.lineTo(...t[3]),n.moveTo(...t[4]),n.lineTo(...t[5]),n.lineTo(...t[6]),n.lineTo(...t[7]),n.closePath(),n.moveTo(...t[8]),n.lineTo(...t[9]),n.moveTo(...t[10]),n.lineTo(...t[11]),n.moveTo(...t[12]),n.lineTo(...t[13])),n}(t,n);return Cm(new Mh).style("d",r.toString()).style("stroke",e).style("fill",e).style("transform",i).call(Nm,o).node()}};Xw.props={defaultEnterAnimation:"fadeIn"};const Kw=t=>{const a=_(t,[]);return(t,e,n,i)=>{var{defaultColor:i,defaultSize:r}=i,{color:i=i,size:r=r}=e,o=(t=t,xv(o=n)?(o=o.getCenter(),X0()({startAngle:0,endAngle:2*Math.PI,outerRadius:wm(t[0],o),innerRadius:wm(t[1],o)})):tm().x(t=>t[0]).y(t=>t[1])(t)),t=function(t,e){if(!xv(t))return e;var[t,n]=t.getCenter();return`translate(${t}, ${n}) `+(e||"")}(n,e.transform);return Cm(new Mh({})).style("d",o).style("stroke",i).style("lineWidth",r).style("transform",t).call(Nm,a).node()}};Kw.props={defaultEnterAnimation:"fadeIn"};class Zw extends yh{constructor(t){super(t)}connectedCallback(){this.draw()}attributeChangedCallback(){this.draw()}draw(){this.drawPath(),this.drawEndMarker()}drawPath(){var t=this.attributes,e=t["connectorPath"],t=_(t,["connectorPath"]);this.connector=Cm(this.connector||this.appendChild(new Mh({}))).style("path",e).call(Nm,t).node()}drawEndMarker(){var{stroke:t,endMarker:e}=this.style;this.endMarker=this.endMarker||this.appendChild(new D({})),this.endMarker.update(Object.assign({size:8,fill:t},e))}}function $w(t,e,n){return[["M",t-n,e+2*n],["L",t,e],["L",t+n,e+2*n],["Z"]]}function Jw(t,e,n){return[["M",t,e],["L",t-n,e-2*n],["L",t+n,e-2*n],["Z"]]}function Qw(t,e,n){return[["M",t,e],["L",t+2*n,e-n],["L",t+2*n,e+n],["Z"]]}const tS=t=>{const{direction:o="upward",offset:a=12,endMarker:s}=t,u=_(t,["direction","offset","endMarker"]);return(t,e,n,i)=>{var i=i["defaultColor"],{color:e=i,transform:i}=e,n=function(t,e,n,i){var[e,r]=e;return kv(t)?[e,[t="downward"===n?Math.min(e[0],r[0])-i:Math.max(e[0],r[0])+i,e[1]],[t,r[1]],r]:(t="downward"===n?Math.max(e[1],r[1])+i:Math.min(e[1],r[1])-i,[e,[e[0],t],[r[0],t],r])}(n,t,o,a),t=(t=n,tm().x(t=>t[0]).y(t=>t[1])(t)),[,,,r]=n;return Cm(new Zw({})).style("connectorPath",t).style("stroke",e).style("transform",i).style("endMarker",Object.assign({x:r[0],y:r[1],symbol:function(t){var[,,t,e]=t;return e[0]<t[0]?Qw:t[1]>e[1]?$w:Jw}(n)},s)).call(Nm,u).node()}},eS=(tS.props={defaultEnterAnimation:"fadeIn"},t=>{return Object.assign({},{defaultColor:"#5B8FF9",defaultCategory10:"category10",defaultCategory20:"category20",defaultSize:1,elementActiveStroke:"black",enter:{duration:300,fill:"both",delay:0}},t)});function nS(i,t,e,r,o){var n;const a=(null==(n=i.getTicks)?void 0:n.call(i))||t,s=(null==(n=i.getFormatter)?void 0:n.call(i))||e;if(xv(o)){const u=a.map(t=>{var e,n=(null==(n=i.getBandWidth)?void 0:n.call(i,t))/2||0,n=i.map(t)+n;return{value:kv(o)&&null!=(e=i.getTicks)&&e.call(i)?1-n:n,text:s(t)}});return"arc"===r?u.slice(1):u}return a.map(t=>{var e=(null==(e=i.getBandWidth)?void 0:e.call(i,t))/2||0,e=i.map(t)+e;n=e;var n=function(t,e,n){var{width:n,height:i}=n.getOptions();if("bottom"===e){const r=t[0],o=new Ug({domain:[0,n],range:[0,1]});return o.map(r)}const r=t[1],o=new Ug({domain:[0,i],range:[0,1]});return o.map(r)}(o.map("bottom"===r?[n,1]:[0,n]),r,o);return{value:wv(o)?e:n,text:s(t)}})}eS.props={};const iS=d=>{const{position:p,title:f=!0,formatter:y=t=>""+t}=d;return(t,e,n,i)=>{if("arc"===p)return(t=>{const{position:s,formatter:u=t=>""+t}=t;return(t,e,n,i)=>{var[r,o]=n.getCenter(),{domain:e,bbox:a}=e,e=nS(t,e,u,s,n),n=Math.min(a.width,a.height)/2;return new Ck({style:O({},{center:[r+a.x,o+a.y],radius:n,startAngle:-90,endAngle:270,ticks:e,axisLine:{style:{lineWidth:0,strokeOpacity:0}},tickLine:{len:4,style:{lineWidth:1}},label:{align:"tangential",style:{dy:-2}}},t.getOptions().guide)})}})(d)(t,e,n,i);var{domain:i,field:e,bbox:r}=e,{startPos:r,endPos:o,labelOffset:a,titlePosition:s,titlePadding:u,titleRotate:l,verticalFactor:c,titleOffsetY:h}=function(t,e,n){var i,{x:r,y:o,width:a,height:s}=e;return"bottom"===t?{startPos:[r,o],endPos:[r+a,o],labelOffset:8,titlePosition:"end",titlePadding:2,titleRotate:0,verticalFactor:1}:"left"===t||"centerHorizontal"===t?{startPos:[r+a,o],endPos:[r+a,o+s],titlePosition:"center",titlePadding:6,titleRotate:-90,labelAlign:"end",labelOffset:4,verticalFactor:-1}:"right"===t?{startPos:[r,o],endPos:[r,o+s],titlePosition:"center",titlePadding:16,titleRotate:-90,labelAlign:"start",labelOffset:4,verticalFactor:1}:"arcY"===t?([t,n]=n.getCenter(),i=Math.min(e.width,e.height)/2,{startPos:[t+e.x,n+e.y-i],endPos:[t+e.x,n+e.y],titlePosition:"start",titlePadding:-16,titleOffsetY:-8,titleRotate:0,labelOffset:4,verticalFactor:-1}):{startPos:[r,o+s],endPos:[r+a,o+s],titlePosition:"end",titlePadding:2,titleRotate:0,labelOffset:4,verticalFactor:-1}}(p,r,n),i=nS(t,i,y,p,n);return new kk({style:O(Object.assign({startPos:r,endPos:o,verticalFactor:c,ticks:i,label:{tickPadding:a,autoHide:!1,style:{}},axisLine:{style:{lineWidth:0,strokeOpacity:0}},tickLine:{len:4,style:{lineWidth:1}}},e&&f&&{title:{content:Array.isArray(e)?e[0]:e,titleAnchor:t.getTicks?s:"center",style:{fontWeight:"bold",fillOpacity:1,dy:h},titlePadding:u,rotate:l}}),t.getOptions().guide||{})})}},rS=(iS.props={defaultPosition:"left",defaultSize:45,defaultOrder:0},t=>iS(t)),oS=(rS.props=Object.assign(Object.assign({},iS.props),{defaultPosition:"bottom"}),t=>iS(t)),aS=(oS.props=Object.assign(Object.assign({},iS.props),{defaultPosition:"left"}),t=>{const{formatter:f=t=>""+t}=t;return(e,t,n,i)=>{const{domain:r,field:o,bbox:a}=t;var{x:t,y:s,width:u,height:l}=a,c=r.map(t=>({id:t,name:f(t),color:e.map(t)})),h=e.getOptions().guide||{},{cols:d,autoWrap:p}=h,h=_(h,["cols","autoWrap"]),d=p&&d?u/d:void 0,c=O({},Object.assign(Object.assign({items:c,x:t,y:s,maxWidth:u,maxHeight:l,autoWrap:p,maxItemWidth:d,itemWidth:d,spacing:[8,0],itemName:{style:{fontSize:12}}},o&&{title:{content:Array.isArray(o)?o[0]:o,style:{fontSize:12,fontWeight:"bold",fillOpacity:1}}}),{itemMarker:{size:8,symbol:"circle"}}),h);return new _x({style:c})}}),sS=(aS.props={defaultPosition:"top",defaultOrder:1,defaultSize:40},t=>(e,t,n,i)=>{const{field:r,domain:o,bbox:a}=t;var{x:t,y:s}=a,u=(null==(u=e.getTicks)?void 0:u.call(e))||[],[l,c]=o;return new Hx({style:Object.assign(Object.assign({x:t,y:s,rail:{ticks:u},min:l,max:c,indicator:null,handle:null},r&&{title:{content:Array.isArray(r)?r[0]:r,style:{fontSize:12}}}),{color:o.map(t=>e.map(t))})})});sS.props={defaultPosition:"top",defaultOrder:1,defaultSize:40};class uS{constructor(t){this.$value=t}static of(t){return new uS(t)}call(t,...e){return this.$value=t(this.$value,...e),this}value(){return this.$value}}function lS(t,e,n){var{enter:t={}}=t;return uS.of({}).call(cS,t).call(cS,e).call(cS,n).value()}function cS(t,e){for(var[n,i]of Object.entries(e))void 0!==i&&(t[n]=e[n]);return t}const hS=s=>{return(t,e,n,i)=>{var r=t.getBoundingClientRect()["height"],o=t.style["transform"],[n,r]=kv(n)?[[0,0],"scale(0.0001, 1)"]:[[0,r],"scale(1, 0.0001)"],r=[{transform:o+" "+r,fillOpacity:0,strokeOpacity:0,opacity:0},{transform:o+" "+r,fillOpacity:1,strokeOpacity:1,opacity:1,offset:.01},{transform:o+" scale(1, 1)"}];t.setOrigin(n);const a=t.animate(r,lS(i,e,s));return a.onfinish=()=>t.setOrigin(0,0),a}},dS=s=>(t,e,n,i)=>{var{fillOpacity:r=1,strokeOpacity:o=1,opacity:a=1}=t.style;return t.animate([{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:r,strokeOpacity:o,opacity:a}],lS(i,e,s))},pS=(dS.props={},t=>({interactors:[{type:"mousePosition"},{type:"touchPosition"}],start:[{trigger:"hover",action:[{type:"surfacePointSelection"},Object.assign({type:"highlightSelection"},t)]}],end:[{trigger:"leave",action:[{type:"surfacePointSelection"},Object.assign({type:"highlightSelection"},t)]}]})),fS=(pS.props={},t=>({interactors:[{type:"mousePosition"},{type:"touchPosition"}],start:[{trigger:"hover",action:[{type:"surfacePointSelection"},Object.assign({type:"tooltip"},t)],throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"leave",action:[{type:"surfacePointSelection"},Object.assign({type:"tooltip"},t)]}]})),yS=(fS.props={},t=>({interactors:[{type:"mousePosition"},{type:"touchPosition"}],start:[{trigger:"hover",throttle:{wait:50,leading:!0,trailing:!1},action:[Object.assign({type:"fisheyeFocus"},t),{type:"plot"}]}],end:[{trigger:"leave",action:[Object.assign({type:"fisheyeFocus"},t),{type:"plot"}]}]})),vS=(yS.props={},()=>t=>{const{event:e,shared:n}=t;var{target:i,offsetX:r,offsetY:o}=e;const a=(i||{})["className"];return a&&a.includes("element")&&(n.selectedElements=[i],n.mouseX=r,n.mouseY=o),t}),gS=(vS.props={},u=>t=>{const{shared:e,selection:n,theme:i}=t,{selectedElements:r=[]}=e;var o=i["elementActiveStroke"];const{color:a=o}=u;o=r.map(t=>t.__data__);const s=n.select(".selection");return s.selectAll(".highlight-element").remove(),s.selectAll(".highlight-element").data(o,t=>t.key).join(t=>t.append((t,e)=>r[e].cloneNode()).style("lineWidth",function(){return+this.style.lineWidth||1}).style("stroke",a).attr("className","highlight-element")),t});function mS(t,e,n,i,r,o){o=o.defaultColor;const{title:a,color:s=o}=t;o=Object.entries(t).filter(([t])=>t.startsWith("tooltip")).map(([t,e])=>{t=r[t].getOptions().field,e="object"==typeof e&&!(e instanceof Date)?e:{value:void 0===e?e:""+e};return Object.assign({name:t,color:s},e)}).filter(({value:t})=>void 0!==t);i.update({x:e,y:n,title:a,position:"bottom-right",offset:[10,10],items:o}),i.show()}gS.props={};const bS=()=>t=>{const{scale:e,coordinate:u,theme:n,selection:l,shared:i}=t,{mouseX:r,mouseY:o,selectedElements:a=[]}=i;var s=a.map(t=>t.__data__),c=e["tooltip"];if(void 0!==c)return l.select(".selection").selectAll(".tooltip").data(s,(t,e)=>e).join(t=>t.append(()=>{const t=l.select(".main").node(),e=t.getRootNode().defaultView.getConfig().container;var{x:n,y:i,width:r,height:o}=u.getOptions(),[a,s]=t.getBounds().min,a=new nw({style:{container:{x:0,y:0},items:[],bounding:{x:a+n,y:s+i,width:r,height:o}}});return e.appendChild(a.HTMLTooltipElement),a}).attr("className","tooltip").each(function(t){mS(t,r,o,this,e,n)}),t=>t.each(function(t){mS(t,r,o,this,e,n)}),t=>t.each(function(){this.hide()})),t},kS=(bS.props={},()=>t=>{const{shared:e,update:n}=t;var i=e["updater"];return n(i),t}),xS=(kS.props={},f=>t=>{const{event:e,selection:n,shared:i}=t,{updater:o=t=>t}=i;var{offsetX:r,offsetY:a}=e;const s=n.select(".main").node();var{min:[u,l],max:[c,h]}=s.getBounds();if(r<u||c<r||(a<l||h<a))return t;const d=r-u,p=a-l;return i.updater=t=>{var e=o(t);const{coordinate:n=[]}=t;t=n.findIndex(t=>"fisheye"===t.type);if(-1===t)return Object.assign(Object.assign({},e),{coordinate:[...n,{type:"cartesian"},Object.assign(Object.assign({type:"fisheye"},f),{focusX:d,focusY:p})]});{var i=n[t],i=Object.assign(Object.assign(Object.assign({},i),f),{focusX:d,focusY:p});const r=[...n];return r.splice(t,1,i),Object.assign(Object.assign({},e),{coordinate:r})}},t}),wS=(xS.props={},()=>({actions:[{action:"enter",events:["plot:mouseenter"]},{action:"hover",events:["plot:mousemove"]},{action:"leave",events:["plot:mouseleave"]}]})),SS=()=>({actions:[{action:"enter",events:["plot:touchstart"]},{action:"hover",events:["plot:touchmove"]},{action:"leave",events:["plot:touchend"]}]}),ES=()=>t=>{const e=t["children"];if(!Array.isArray(e))return[];const{x:n=0,y:i=0,width:r,height:o,data:a}=t;return e.map(t=>{var{data:e=a}=t,t=_(t,["data"]);return Object.assign(Object.assign({},t),{data:e,x:n,y:i,width:r,height:o})})},TS=(ES.props={},()=>e=>{const n=e["children"];if(!Array.isArray(n))return[];const{direction:t="row",flex:i=n.map(()=>1),padding:r=0,data:o}=e;var[a,s,u,l]="col"===t?["y","height","width","x"]:["x","width","height","y"];const c=i.reduce((t,e)=>t+e),h=e[s]-r*(n.length-1);var d=i.map(t=>h*(t/c));const p=[];let f=e[a]||0;for(let t=0;t<d.length;t+=1){var y=n[t],{data:v=o}=y,y=_(y,["data"]);p.push(Object.assign({[a]:f,[s]:d[t],[l]:e[l]||0,[u]:e[u],data:v},y)),f+=d[t]+r}return p}),_S=(TS.props={},()=>t=>{const e=t["children"],n=_(t,["children"]);if(!Array.isArray(e))return[];const{data:i,scale:r={}}=n,o=_(n,["data","scale"]);t=e.map(t=>{var{data:e=i,scale:n}=t,t=_(t,["data","scale"]);return Object.assign({data:e,scale:O({},r,n)},t)});return[Object.assign(Object.assign({},o),{marks:t,type:"standardView"})]}),MS=(_S.props={},()=>t=>{var{width:e,height:n,paddingLeft:i,paddingRight:r,paddingTop:o,paddingBottom:a,data:s,coordinate:u,theme:l,component:c,interaction:h,x:d,y:p,key:f,adjust:y,frame:v}=t,t=_(t,["width","height","paddingLeft","paddingRight","paddingTop","paddingBottom","data","coordinate","theme","component","interaction","x","y","key","adjust","frame"]);return[{type:"standardView",x:d,y:p,key:f,width:e,height:n,paddingLeft:i,paddingRight:r,paddingTop:o,paddingBottom:a,theme:l,coordinate:u,component:c,interaction:h,adjust:y,frame:v,marks:[Object.assign(Object.assign({},t),{key:f+"-0",data:s})]}]});function PS(t){return t.map((t,e)=>e)}function OS(e){return t=>O({},e(t),t)}function CS(e){return t=>O({},t,e(t))}MS.props={};const AS=OS(t=>{const{encode:e,data:r,scale:o,shareSize:a=!1}=t;var{x:t,y:n}=e,i=(e,t)=>{if(void 0===e||!a)return{};const n=lv(r,t=>t[e]),i=(null==(t=null===o||void 0===o?void 0:o[t])?void 0:t.domain)||Array.from(n.keys());t=i.map(t=>n.has(t)?n.get(t).length:1);return{domain:i,flex:t}};return{scale:{x:Object.assign(Object.assign({paddingOuter:0,guide:void 0===t?null:{position:"top"}},void 0===t&&{paddingInner:0}),i(t,"x")),y:Object.assign(Object.assign({range:[0,1],paddingOuter:0,guide:void 0===n?null:{position:"right"}},void 0===n&&{paddingInner:0}),i(n,"y"))}}}),NS=OS(t=>{const{data:e,scale:n}=t,i=[t];let r,o;for(;i.length;){const{children:u,encode:l={},scale:n={}}=i.shift();var a=l["color"],s=n["color"];void 0!==a&&(r=a),void 0!==s&&(o=s),Array.isArray(u)&&i.push(...u)}return{encode:{color:r},scale:{color:O({},o,{domain:void 0!==(t=null==(t=null===n||void 0===n?void 0:n.color)?void 0:t.domain)?t:void 0!==r?Array.from(new Set(e.map(t=>t[r]))):void 0})}}}),LS=OS(()=>({animate:{enter:{type:"fadeIn"}}})),IS=CS(()=>({frame:!1,encode:{shape:"hollowRect"},style:{lineWidth:0}})),DS=CS(t=>{const{data:e,filter:n}=t;return{data:n?e.filter((t,e)=>n(e)):e,filter:null}}),RS=CS(()=>({type:"grid"})),jS=CS(t=>{var{transform:t=[]}=t,e=()=>t=>{const{data:e,columnOf:n,encode:i}=t;var{x:r,y:o}=i;const a=n(e,r),s=n(e,o),u=new Set;r=e.filter((t,e)=>{e=`(${null===a||void 0===a?void 0:a[e]}, ${null===s||void 0===s?void 0:s[e]})`;return!u.has(e)&&(u.add(e),!0)});return Object.assign(Object.assign({},t),{data:r,I:new Array(r.length).fill(0).map((t,e)=>e)})};return e.props={category:"preprocessor"},{transform:[...t,{type:e}]}}),BS=CS(t=>{const{data:x,encode:e,children:h,scale:n,x:w=0,y:S=0,shareData:d=!1}=t,{x:p,y:E}=e;t=n.color;const T=t["domain"];return{children:(t,e,n)=>{const{x:i,y:r}=e,{paddingLeft:f,paddingTop:y}=n,{domain:o,field:a}=i.getOptions(),{domain:s,field:u}=r.getOptions(),l=PS(t),v=t.map(({points:t})=>Em(t)),c=t.map(({x:t,y:e})=>[i.invert(t),r.invert(e)]),g=c.map(([n,i])=>t=>{var{[a]:t,[u]:e}=t,t=void 0===p||t===n,e=void 0===E||e===i;return t&&e}),m=d?g.reduce((t,e)=>Math.max(t,x.filter(e).length),-1/0):void 0,b=c.map(([t,e])=>({columnField:a,columnIndex:o.indexOf(t),columnValue:t,columnValuesLength:o.length,rowField:u,rowIndex:s.indexOf(e),rowValue:e,rowValuesLength:s.length})),k=b.map(t=>Array.isArray(h)?h:[h(t)].flat(1));return l.flatMap(s=>{const[u,l,c,h]=v[s],d=g[s],p=b[s],t=k[s];return t.map(t=>{var n,r,{scale:e,key:i}=t,t=_(t,["scale","key"]),o=null==(o=null==e?void 0:e.y)?void 0:o.guide,a=null==(a=null==e?void 0:e.x)?void 0:a.guide,a={x:{guide:("function"==typeof(r=a)?r:null===r?()=>null:t=>{var{rowIndex:t,rowValuesLength:e,columnIndex:n,columnValuesLength:i}=t;return t!==e-1?null:n!==i-1?O({title:!1},r):void 0})(p)},y:{guide:("function"==typeof(n=o)?n:null===n?()=>null:t=>{var{rowIndex:t,columnIndex:e}=t;return 0!==e?null:0!==t?O({title:!1},n):void 0})(p)},color:{guide:null,domain:T}};return Object.assign({key:i+"-"+s,data:x,filter:t=>d(x[t]),x:u+f+w,y:l+y+S,width:c,height:h,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!0,dataDomain:m,scale:O({x:{tickCount:5},y:{tickCount:5}},e,a)},t)})})}}});const FS=()=>t=>{return[uS.of(t).call(RS).call(DS).call(NS).call(LS).call(AS).call(IS).call(jS).call(BS).value()]},zS=(FS.props={},()=>(t,e,n)=>{var i=t.length;if(0===i)return[];var{innerWidth:r,innerHeight:o}=n;let u=Math.ceil(Math.sqrt(e/(o/r))),l=r/u,c=Math.ceil(e/u),a=c*l;for(;a>o;)u+=1,l=r/u,c=Math.ceil(e/u),a=c*l;const h=o-c*l,d=c<=1?0:h/(c-1),[p,f]=c<=1?[(r-i*l)/(i-1),(o-l)/2]:[0,0];return t.map((t,e)=>{var[t,n,i,r]=Em(t),t=t+i/2,n=n+r/2,o=e%u,e=Math.floor(e/u),a=o*l+l/2,s=(c-e-1)*l+h+l/2,i=l/i,r=l/r;return`translate(${a-t+p*o}, ${s-n-d*e-f}) scale(${i}, ${r})`})});function VS(t,e){var n,i,r;const o=Object.assign({},t);for([i,r]of Object.entries(e))o[i]=null!=(n=o[i])?n:r;return o}function HS(r){return i=>F(this,void 0,void 0,function*(){var t=yield r(i),{encode:e={}}=t,{encode:n={}}=i;return Object.assign(Object.assign(Object.assign({},i),t),{encode:Object.assign(Object.assign({},n),e)})})}function GS(t){if(null!==t)return{type:"column",value:t}}function WS(t){return{type:"constant",value:t}}function US(t,e){return e&&(t.field=e.field),t}zS.props={};const YS=()=>HS(({encode:t})=>({encode:VS(t,{y1:WS(0)})}));function qS(t,e){const{columnOf:n,encode:i,data:r,I:o}=e,a=(e=t,(Array.isArray(e)?e:[e]).map(t=>[t,n(r,i[t])]).filter(([,t])=>null!==t));return Array.from(lv(o,e=>a.map(([,t])=>t[e]).join("-")).values())}function XS(t){return Array.isArray(t)?(o=t,(r,t,e)=>(n,i)=>o.reduce((t,e)=>0!==t?t:nv(r[n][e],r[i][e]),0)):"function"==typeof t?(i=t,(e,t,n)=>e2(t=>i(e[t]))):"series"===t?$S:"value"===t?JS:"sum"===t?QS:"maxIndex"===t?t2:()=>null;var o,i}function KS(t,e){for(const n of t)n.sort(e)}function ZS(t,e){return(null==e?void 0:e.domain)||Array.from(new Set(t))}function $S(t,e,n){return e2(t=>n[t])}function JS(t,e,n){return e2(t=>e[t])}function QS(t,n,e){t=PS(t);const i=Array.from(lv(t,t=>e[+t]).entries()),r=new Map(i.map(([t,e])=>[t,e.reduce((t,e)=>t+ +n[e])]));return e2(t=>r.get(e[t]))}function t2(t,n,e){t=PS(t);const i=Array.from(lv(t,t=>e[+t]).entries()),r=new Map(i.map(([t,e])=>[t,vv(e,t=>n[t])]));return e2(t=>r.get(e[t]))}function e2(n){return(t,e)=>nv(n(t),n(e))}YS.props={category:"inference"};const n2=(t={})=>{const{groupBy:m="x",orderBy:b,reverse:k=!1,y:x="y"}=t;return HS(t=>{const{data:e,I:n,columnOf:i,encode:r}=t,{y:o,y1:a,series:s,color:u}=r;var l=i(e,o),c=i(e,a),h=i(e,s||u),t=qS(m,t);const d=XS(b);h=d(e,l,h);h&&KS(t,h);const p=new Array(n.length),f=new Array(n.length);for(const v of t){k&&v.reverse();var y=c?+c[v[0]]:0;let t=y,e=y;for(const g of v){const o=+l[g]-y;o<0?e=p[g]=(f[g]=e)+o:0<o?t=p[g]=(f[g]=t)+o:p[g]=f[g]=t}}return{encode:{y:GS(US("y"===x?p:f,l)),y1:GS(f)}}})},i2=(n2.props={category:"statistic"},o=>HS(t=>{const{encode:e,transform:n}=t;var{x:i,y:r}=e;if(n.find(({type:t})=>"stackY"===t||"dodgeX"===t))return{};if(void 0===i||void 0===r)return{};i=o.series,r=i?["x","series"]:"x";return n2({groupBy:r})(t)})),r2=(i2.props={category:"inference"},()=>HS(({encode:t,columnOf:e,data:n})=>{var{x:t,title:i}=t;if(void 0!==i)return{};i=e(n,t);return{encode:{x:GS(i),title:GS(i)}}})),o2=(r2.props={category:"inference"},t=>{const a=t["channel"];return HS(({encode:t,data:r,columnOf:o})=>{var e=t["tooltip"];if(void 0!==e)return{};e=Object.entries(t).filter(([t])=>t.startsWith(a)).flatMap(([t,e])=>{var n=new RegExp(a+"(\\d*)").exec(t)[1],e=o(r,e);const i=[[t,GS(e)]];return e&&null!==e.field&&i.push(["tooltip"+n,GS(e)]),i});return{encode:Object.fromEntries(e)}})}),a2=(o2.props={category:"inference"},()=>o2({channel:"position"})),s2=(a2.props={category:"inference"},()=>o2({channel:"y"})),u2=(s2.props={category:"inference"},()=>HS(({encode:t})=>({encode:VS(t,{x:WS(0)})}))),l2=(u2.props={category:"inference"},()=>HS(({encode:t})=>({encode:VS(t,{y:WS(0)})}))),c2=(l2.props={category:"inference"},()=>HS(({encode:t})=>({encode:VS(t,{size:WS(3)})}))),h2=(c2.props={category:"inference"},()=>HS(({encode:t,columnOf:n,data:i,I:a})=>{const e=Object.entries(t).filter(([t])=>t.startsWith("x")||t.startsWith("y")||t.startsWith("position")).map(([t,e])=>[t,GS(n(i,e))]);t=e.filter(([,t])=>{t=t.value;return Array.isArray(t[0])}).flatMap(([n,t])=>{const i=[[n,new Array(a.length).fill(void 0)]],r=t["value"];for(let e=0;e<r.length;e++){var o=r[e];if(Array.isArray(o))for(let t=0;t<o.length;t++){const GS=i[t]||[""+n+t,new Array(a).fill(void 0)];GS[1][e]=o[t],i[t]=GS}}return i.map(([t,e])=>[t,GS(US(e,r))])});return{encode:Object.fromEntries([...e,...t])}})),d2=(h2.props={category:"inference"},()=>HS(({encode:t,data:e,I:n,columnOf:i})=>{var r=t["key"],t=_(t,["key"]);if(void 0!==r)return{};const o=Object.values(t).map(t=>i(e,t));return{encode:{key:GS(n.map(e=>o.filter(t=>null!==t).map(t=>t[e]).join("-")))}}})),p2=(d2.props={category:"inference"},()=>HS(({encode:t,data:e,columnOf:n})=>{var{series:t,color:i}=t;if(void 0!==t)return{};t=n(e,i);return{encode:{color:GS(t),series:GS(t)}}})),f2=(p2.props={category:"inference"},(t={})=>{const{groupBy:f="x",reverse:y=!1,orderBy:v}=t,g=_(t,["groupBy","reverse","orderBy"]);return HS(t=>{const{data:e,encode:n,columnOf:i,I:r,scale:o}=t;var{series:a,color:s,y:u}=n,l=o["series"],u=i(e,u),a=i(e,a||s),c=ZS(a,l),s=qS(f,t);const h=XS(v);l=h(e,u,a);l&&KS(s,l);const d=new Array(r.length);for(const p of s){y&&p.reverse();for(let t=0;t<p.length;t++)d[p[t]]=c[t]}return{scale:O({},o,{series:Object.assign({domain:c},g)}),encode:{series:GS(d)}}})}),y2=(f2.props={category:"statistic"},t=>{const{by:v=["x"]}=t;return HS(({encode:e,I:n,data:i,columnOf:r})=>{var{enterDuration:t,enterDelay:o}=e;if(void 0===t)return{};var a=v.map(t=>[t,r(i,e[t])]);if(0===a.length)return{};let s=[n];for(const[,p]of a){const f=[];for(const n of s){var u=Array.from(lv(n,t=>p[t]).values());f.push(...u)}s=f}const l=r(i,t);var c=r(i,o)||new Array(n.length).fill(0);const h=new Array(n.length);for(let t=0,e=0;t<s.length;t++){const n=s[t];var d=hv(n,t=>+l[t]);for(const y of n)h[y]=c[y]+e;e+=d}return{encode:{enterDuration:GS(l),enterDelay:GS(h)}}})});y2.props={category:"statistic"};const v2=(t={})=>{const{groupBy:f="x",basis:y="max"}=t;return HS(t=>{const{data:n,encode:e,columnOf:i,I:r}=t;var o=_(e,["x"]);const a=Object.entries(o).filter(([t])=>t.startsWith("y")).map(([t,e])=>[t,i(n,e)]),s=a.map(([t,e])=>{return[t,US(new Array(r.length),e)]});o=qS(f,t);const u={min:dv,max:hv,first:t=>t[0],last:t=>t[t.length-1],mean:gv,extent:ov,median:mv,sum:bv,deviation:rv}[y]||hv;for(const r of o){var l=r.flatMap(e=>a.map(([,t])=>+t[e])),c=u(l);for(const d of r)for(let t=0;t<a.length;t++){var[,h]=a[t];const[,p]=s[t];p[d]=+h[d]/c}}return{encode:Object.fromEntries(s.map(([t,e])=>[t,GS(e)]))}})};function g2(t,e,n){if(null===t)return[-.5,.5];t=ZS(t,e);const i=new Yv({domain:t,range:[0,1],padding:n});e=i.getBandWidth();return[-e/2,e/2]}v2.props={category:"statistic"};const m2=(t={})=>{const{paddingX:h=0,paddingY:d=0}=t;return HS(t=>{const{data:e,I:n,columnOf:i,encode:r,scale:o}=t;var{x:t,y:a}=r,{x:s,y:u}=o,t=i(e,t),a=i(e,a);const l=g2(t,s,h),c=g2(a,u,d);t=n.map(()=>Om(...c)),s=n.map(()=>Om(...l));return{encode:{dy:GS(t),dx:GS(s)}}})},b2=(m2.props={category:"statistic"},(t={})=>{const{padding:u=0}=t;return HS(t=>{const{data:e,I:n,columnOf:i,encode:r,scale:o}=t;var t=r["y"],a=o["y"];const s=g2(i(e,t),a,u);return{encode:{dy:GS(n.map(()=>Om(...s)))}}})}),k2=(b2.props={category:"statistic"},(t={})=>{const{groupBy:g="x"}=t;return HS(t=>{const{I:n,data:i,encode:e,columnOf:r}=t;var o=_(e,["x"]);const a=Object.entries(o).filter(([t])=>t.startsWith("y")).map(([t,e])=>[t,r(i,e)]),s=a.map(([t,e])=>{return[t,US(new Array(n.length),e)]});var u=qS(g,t);const l=new Array(u.length);for(let t=0;t<u.length;t++){const n=u[t];var[c,h]=ov(n.flatMap(e=>a.map(([,t])=>+t[e])));l[t]=(c+h)/2}var d=Math.max(...l);for(let t=0;t<u.length;t++){var p=d-l[t];const n=u[t];for(const y of n)for(let t=0;t<a.length;t++){var[,f]=a[t];const[,v]=s[t];v[y]=+f[y]+p}}return{encode:Object.fromEntries(s.map(([t,e])=>[t,GS(e)]))}})});function x2(t,e){return[0]}function w2(t,e){return[t[t.length-1]]}function S2(t,e){return[t[vv(t,t=>e[t])]]}function E2(t,e){return[t[function(t,e){let n,i=-1,r=-1;if(void 0===e)for(const a of t)++r,null!=a&&(n>a||void 0===n&&a>=a)&&(n=a,i=r);else for(var o of t)null!=(o=e(o,++r,t))&&(n>o||void 0===n&&o>=o)&&(n=o,i=r);return i}(t,t=>e[t])]]}k2.props={category:"statistic"};const T2=(t={})=>{const{groupBy:u="series"}=t,l=_(t,["groupBy"]);return HS(t=>{const{data:e,columnOf:n,encode:i}=t,r=qS(u,t);var[t,o]=Object.entries(l)[0],{[t]:t}=i;const a=n(e,t),s="function"==typeof(t=o)?t:{first:x2,last:w2,max:S2,min:E2}[t]||x2;return{I:r.flatMap(t=>s(t,a))}})},_2=(T2.props={category:"statistic"},(t={})=>{var e=t["selector"],t=_(t,["selector"]);return T2(Object.assign({x:e},t))}),M2=(_2.props={category:"statistic"},(t={})=>{var e=t["selector"],t=_(t,["selector"]);return T2(Object.assign({y:e},t))}),P2=(M2.props={category:"statistic"},t=>{const{url:n,callback:i=Tm}=t;return HS(()=>F(void 0,void 0,void 0,function*(){const t=yield fetch(n),e=yield t.json();return{data:e.map(i)}}))}),O2=(P2.props={category:"preprocessor"},Math.PI/180),C2=64,A2=2048;function N2(t){return t.text}function L2(){return"serif"}function I2(){return"normal"}function D2(t){return t.value}function R2(){return 90*~~(2*Math.random())}function j2(){return 1}function B2(){}function F2(t,a,i,s){if(!a.sprite){const v=t.context,g=t.ratio;v.clearRect(0,0,(C2<<5)/g,A2/g);let r=0,o=0,n=0;var u,l,c,h,e=i.length;for(--s;++s<e;){a=i[s],v.save(),v.font=a.style+" "+a.weight+" "+~~((a.size+1)/g)+"px "+a.font;let t=v.measureText(a.text+"m").width*g,e=a.size<<1;if(a.rotate?(h=Math.sin(a.rotate*O2),c=Math.cos(a.rotate*O2),u=t*c,l=t*h,c=e*c,h=e*h,t=Math.max(Math.abs(u+h),Math.abs(u-h))+31>>5<<5,e=~~Math.max(Math.abs(l+c),Math.abs(l-c))):t=t+31>>5<<5,e>n&&(n=e),r+t>=C2<<5&&(r=0,o+=n,n=0),o+e>=A2)break;v.translate((r+(t>>1))/g,(o+(e>>1))/g),a.rotate&&v.rotate(a.rotate*O2),v.fillText(a.text,0,0),a.padding&&(v.lineWidth=2*a.padding,v.strokeText(a.text,0,0)),v.restore(),a.width=t,a.height=e,a.xoff=r,a.yoff=o,a.x1=t>>1,a.y1=e>>1,a.x0=-a.x1,a.y0=-a.y1,a.hasText=!0,r+=t}const m=v.getImageData(0,0,(C2<<5)/g,A2/g).data,b=[];for(;0<=--s;)if((a=i[s]).hasText){var d=a.width,p=d>>5;let n=a.y1-a.y0;for(let t=0;t<n*p;t++)b[t]=0;if(null==(r=a.xoff))return;o=a.yoff;let i=0,t=-1;for(let e=0;e<n;e++){for(let t=0;t<d;t++){var f=p*e+(t>>5),y=m[(o+e)*(C2<<5)+(r+t)<<2]?1<<31-t%32:0;b[f]|=y,i|=y}i?t=e:(a.y0++,n--,e--,o++)}a.y1=a.y0+t,a.sprite=b.slice(0,(a.y1-a.y0)*p)}}}function z2(t){const e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function V2(t){const e=[];let n=-1;for(;++n<t;)e[n]=0;return e}function H2(){return document.createElement("canvas")}function G2(t){return"function"==typeof t?t:function(){return t}}const W2={archimedean:z2,rectangular:function(t){const n=4*t[0]/t[1];let i=0,r=0;return function(t){var e=t<0?-1:1;switch(Math.sqrt(1+4*e*t)-e&3){case 0:i+=n;break;case 1:r+=4;break;case 2:i-=n;break;default:r-=4}return[i,r]}}};function U2(){let b=[256,256],i=N2,r=L2,o=D2,y=I2,v=R2,g=j2,k=z2,x=Math.random,m=B2,e=[],n=null,w=1/0;const S=I2,E=H2,T={};return T.start=function(){const[a,s]=b,u=function(t){t.width=t.height=1;const e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2),n=(t.width=(C2<<5)/e,t.height=A2/e,t.getContext("2d"));return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(E()),l=T.board||V2((b[0]>>5)*b[1]),c=e.length,h=[],d=e.map(function(t,e,n){return t.text=i.call(this,t,e,n),t.font=r.call(this,t,e,n),t.style=S.call(this,t,e,n),t.weight=y.call(this,t,e,n),t.rotate=v.call(this,t,e,n),t.size=~~o.call(this,t,e,n),t.padding=g.call(this,t,e,n),t}).sort(function(t,e){return e.size-t.size});let p=-1,f=T.board?[{x:0,y:0},{x:a,y:s}]:void 0;function t(){for(var t=Date.now();Date.now()-t<w&&++p<c;){const i=d[p];if(i.x=a*(x()+.5)>>1,i.y=s*(x()+.5)>>1,F2(u,i,d,p),i.hasText&&function(r,t,e){const n=t.x,i=t.y,o=Math.sqrt(b[0]*b[0]+b[1]*b[1]),a=k(b),s=x()<.5?1:-1;let u,l=-s,c,h;for(;(u=a(l+=s))&&(c=~~u[0],h=~~u[1],!(Math.min(Math.abs(c),Math.abs(h))>=o));)if(t.x=n+c,t.y=i+h,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>b[0]||t.y+t.y1>b[1])&&(!e||!function(t,n,i){var r=t.sprite,o=t.width>>5,e=t.x-(o<<4),a=127&e,s=32-a,u=t.y1-t.y0;let l=(t.y+t.y0)*(i>>=5)+(e>>5),c;for(let e=0;e<u;e++){for(let t=c=0;t<=o;t++)if((c<<s|(t<o?(c=r[e*o+t])>>>a:0))&n[l+t])return 1;l+=i}}(t,r,b[0]))&&(!e||function(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}(t,e))){var d=t.sprite,p=t.width>>5,f=b[0]>>5,y=t.x-(p<<4),v=127&y,g=32-v,m=t.y1-t.y0;let n,i=(t.y+t.y0)*f+(y>>5);for(let e=0;e<m;e++){for(let t=n=0;t<=p;t++)r[i+t]|=n<<g|(t<p?(n=d[e*p+t])>>>v:0);i+=f}return delete t.sprite,1}return}(l,i,f)){if(m.call(null,"word",{cloud:T,word:i}),h.push(i),f){if(!T.hasImage){e=void 0;n=void 0;var e=f;var n=i;const r=e[0],o=e[1];n.x+n.x0<r.x&&(r.x=n.x+n.x0),n.y+n.y0<r.y&&(r.y=n.y+n.y0),n.x+n.x1>o.x&&(o.x=n.x+n.x1),n.y+n.y1>o.y&&(o.y=n.y+n.y1)}}else f=[{x:i.x+i.x0,y:i.y+i.y0},{x:i.x+i.x1,y:i.y+i.y1}];i.x-=b[0]>>1,i.y-=b[1]>>1}}T._tags=h,T._bounds=f,p>=c&&(T.stop(),m.call(null,"end",{cloud:T,words:h,bounds:f}))}return n&&clearInterval(n),n=setInterval(t,0),t(),T},T.stop=function(){return n&&(clearInterval(n),n=null),T},T.createMask=t=>{const e=document.createElement("canvas");var[n,i]=b;if(n&&i){var r=n>>5;const u=V2((n>>5)*i),l=(e.width=n,e.height=i,e.getContext("2d"));l.drawImage(t,0,0,t.width,t.height,0,0,n,i);var o=l.getImageData(0,0,n,i).data;for(let e=0;e<i;e++)for(let t=0;t<n;t++){var a=r*e+(t>>5),s=e*n+t<<2,s=250<=o[s]&&250<=o[1+s]&&250<=o[2+s]?1<<31-t%32:0;u[a]|=s}T.board=u,T.hasImage=!0}},T.timeInterval=function(t){w=null==t?1/0:t},T.words=function(t){e=t},T.size=function(t=[]){b=[+t[0],+t[1]]},T.text=function(t){i=G2(t)},T.font=function(t){r=G2(t)},T.fontWeight=function(t){y=G2(t)},T.rotate=function(t){v=G2(t)},T.spiral=function(t){k=W2[t]||t},T.fontSize=function(t){o=G2(t)},T.padding=function(t){g=G2(t)},T.random=function(t){x=G2(t)},T.on=function(t){m=G2(t)},T}const Y2={size:[500,500],fontSize:[14,28]};function q2(i){return new Promise((t,e)=>{if(i instanceof HTMLImageElement)t(i);else{if("string"==typeof i){const n=new Image;return n.crossOrigin="anonymous",n.src=i,n.onload=()=>t(n),void(n.onerror=()=>{console.error(`'image ${i} load failed !!!'`),e()})}e()}})}const X2=y=>HS(({data:f})=>F(void 0,void 0,void 0,function*(){var r,o,t=Object.assign({},Y2,y);const e=U2();r=e,o=t,yield{set(t,e,n){if(void 0===o[t])return this;e=e?e.call(null,o[t]):o[t];return n?n.call(null,e):"function"==typeof r[t]?r[t](e):r[t]=e,this},setAsync(e,n,i){return F(this,void 0,void 0,function*(){if(void 0===o[e])return this;var t=n?yield n.call(null,o[e]):o[e];return i?i.call(null,t):"function"==typeof r[e]?r[e](t):r[e]=t,this})}}.set("fontSize",t=>{var e=f.map(t=>t.value),n=t,t=[dv(e),hv(e)];if("function"==typeof n)return n;if(Array.isArray(n)){const[i,r]=n;if(!t)return()=>(r+i)/2;const[o,a]=t;return a===o?()=>(r+i)/2:({value:t})=>(r-i)/(a-o)*(t-o)+i}return()=>n}).set("font").set("fontStyle").set("fontWeight").set("padding").set("rotate").set("size").set("spiral").set("timeInterval").set("random").set("text").set("on").setAsync("imageMask",q2,e.createMask),e.words([...f]);var n=e.start();const[i,a]=t.size;t=[{x:0,y:0},{x:i,y:a}];const{_bounds:s=t,_tags:u,hasImage:l}=n,c=u.map(t=>{var{x:e,y:n}=t,t=_(t,["x","y"]);return Object.assign(Object.assign({},t),{x:e+i/2,y:n+a/2})});var[{x:n,y:t},{x:h,y:d}]=s,p={text:"",value:0,opacity:0,fontSize:0};return c.push(Object.assign(Object.assign({},p),{x:l?0:n,y:l?0:t}),Object.assign(Object.assign({},p),{x:l?i:h,y:l?a:d})),{data:c,I:PS(c)}}));X2.props={category:"preprocessor"};const K2=t=>{const{fields:n=[],callback:i=function(t){return null!=t&&!Number.isNaN(t)}}=t;return HS(({data:t})=>({data:t.filter(e=>n.every(t=>i(e[t])))}))};function Z2(t,e,n){return Math.min(n,Math.max(e,t))}K2.props={category:"preprocessor"};const $2=r=>HS(({data:t})=>{const{fields:e=[]}=r;let{start:n=0,end:i=t.length}=r;n=Z2(n,0,t.length-1),i=Z2(i,1,t.length),n>i&&([n,i]=[i,n]);return{data:t.filter((t,e)=>e>=n&&e<i).map(n=>e.reduce((t,e)=>(e in n&&(t[e]=n[e]),t),{}))}}),J2=($2.props={category:"preprocessor"},t=>{t=t.fields;return $2({fields:t})});J2.props={category:"preprocessor"};const Q2=t=>{const i=t["map"];return HS(({data:t})=>{if(!i||(e=i,0===Object.keys(e).length))return t;var e;return{data:t.map(t=>Object.entries(t).reduce((t,[e,n])=>(t[i[e]||e]=n,t),{}))}})},tE=(Q2.props={category:"preprocessor"},t=>{const{fields:r=[],order:i="ASC"}=t;return HS(({data:t})=>{const n=(n,i)=>r.reduce((t,e)=>0!==t?t:n[e]<i[e]?-1:+(n[e]!==i[e]),0);var e="ASC"===i?n:(t,e)=>n(e,t);return{data:[...t].sort(e)}})});function eE(t){return function(){return t}}function nE(t){return t[0]}function iE(t){return t[1]}function rE(){this._=null}function oE(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function aE(t,e){var n=e,e=e.R,i=n.U;i?i.L===n?i.L=e:i.R=e:t._=e,e.U=i,n.U=e,n.R=e.L,n.R&&(n.R.U=n),e.L=n}function sE(t,e){var n=e,e=e.L,i=n.U;i?i.L===n?i.L=e:i.R=e:t._=e,e.U=i,n.U=e,n.L=e.R,n.L&&(n.L.U=n),e.R=n}function uE(t){for(;t.L;)t=t.L;return t}function lE(t,e,n,i){var r=[null,null],o=OE.push(r)-1;return r.left=t,r.right=e,n&&hE(r,t,e,n),i&&hE(r,e,t,i),ME[t.index].halfedges.push(o),ME[e.index].halfedges.push(o),r}function cE(t,e,n){e=[e,n];return e.left=t,e}function hE(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function dE(t,e,n,i){for(var r,o=OE.length;o--;)(function(t,e,n,i,r){var o=t[1];if(o)return 1;var a,s=t[0],u=t.left,l=t.right,c=u[0],u=u[1],h=l[0],l=l[1],d=(c+h)/2;if(l===u){if(d<e||i<=d)return;if(h<c){if(s){if(s[1]>=r)return}else s=[d,n];o=[d,r]}else{if(s){if(s[1]<n)return}else s=[d,r];o=[d,n]}}else if(d=(u+l)/2-(a=(c-h)/(l-u))*d,a<-1||1<a)if(h<c){if(s){if(s[1]>=r)return}else s=[(n-d)/a,n];o=[(r-d)/a,r]}else{if(s){if(s[1]<n)return}else s=[(r-d)/a,r];o=[(n-d)/a,n]}else if(u<l){if(s){if(s[0]>=i)return}else s=[e,a*e+d];o=[i,a*i+d]}else{if(s){if(s[0]<e)return}else s=[i,a*i+d];o=[e,a*e+d]}return t[0]=s,t[1]=o,1})(r=OE[o],t,e,n,i)&&function(t,e,n,i,r){var o=t[0],a=t[1],s=o[0],o=o[1],u=0,l=1,c=a[0]-s,a=a[1]-o,e=e-s;if(c||!(0<e)){if(e/=c,c<0){if(e<u)return;e<l&&(l=e)}else if(0<c){if(l<e)return;u<e&&(u=e)}if(e=i-s,c||!(e<0)){if(e/=c,c<0){if(l<e)return;u<e&&(u=e)}else if(0<c){if(e<u)return;e<l&&(l=e)}if(e=n-o,a||!(0<e)){if(e/=a,a<0){if(e<u)return;e<l&&(l=e)}else if(0<a){if(l<e)return;u<e&&(u=e)}if(e=r-o,a||!(e<0)){if(e/=a,a<0){if(l<e)return;u<e&&(u=e)}else if(0<a){if(e<u)return;e<l&&(l=e)}return 0<u||l<1?(0<u&&(t[0]=[s+u*c,o+u*a]),l<1&&(t[1]=[s+l*c,o+l*a]),1):1}}}}}(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>CE||Math.abs(r[0][1]-r[1][1])>CE)||delete OE[o]}function pE(t,e){return e[+(e.left!==t.site)]}function fE(){for(var t,e,n,i,r,o,a,s=0,u=ME.length;s<u;++s)if((t=ME[s])&&(n=(e=t.halfedges).length)){for(var l=new Array(n),c=new Array(n),h=0;h<n;++h)l[h]=h,c[h]=(i=t,r=OE[e[h]],a=o=void 0,i=i.site,o=r.left,a=r.right,i===a&&(a=o,o=i),a?Math.atan2(a[1]-o[1],a[0]-o[0]):(a=i===o?(o=r[1],r[0]):(o=r[0],r[1]),Math.atan2(o[0]-a[0],a[1]-o[1])));for(l.sort(function(t,e){return c[e]-c[t]}),h=0;h<n;++h)c[h]=e[l[h]];for(h=0;h<n;++h)e[h]=c[h]}}tE.props={category:"preprocessor"},rE.prototype={constructor:rE,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else n=this._?(t=uE(this._),e.P=null,(e.N=t).P=t.L=e,t):(e.P=e.N=null,this._=e,null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(aE(this,n),n=(t=n).U),n.C=!1,i.C=!0,sE(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(sE(this,n),n=(t=n).U),n.C=!1,i.C=!0,aE(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i=t.U,r=t.L,o=t.R,a=r?o?uE(o):r:o;if(i?i.L===t?i.L=a:i.R=a:this._=a,r&&o?(n=a.C,a.C=t.C,((a.L=r).U=a)!==o?(i=a.U,a.U=t.U,t=a.R,i.L=t,(a.R=o).U=a):(a.U=i,t=(i=a).R)):(n=t.C,t=a),t&&(t.U=i),!n)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,aE(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,sE(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,aE(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,sE(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,aE(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,sE(this,i),t=this._;break}}while(e.C=!0,i=(t=i).U,!t.C);t&&(t.C=!1)}}};var yE,vE=[];function gE(){oE(this),this.x=this.y=this.arc=this.site=this.cy=null}function mE(t){var e=t.P,n=t.N;if(e&&n){var e=e.site,i=t.site,n=n.site;if(e!==n){var r=i[0],o=i[1],a=e[0]-r,e=e[1]-o,s=n[0]-r,n=n[1]-o,u=2*(a*n-e*s);if(!(-AE<=u)){for(var l=a*a+e*e,c=s*s+n*n,n=(n*l-e*c)/u,e=(a*c-s*l)/u,h=vE.pop()||new gE,d=(h.arc=t,h.site=i,h.x=n+r,h.y=(h.cy=e+o)+Math.sqrt(n*n+e*e),t.circle=h,null),p=PE._;p;)if(h.y<p.y||h.y===p.y&&h.x<=p.x){if(!p.L){d=p.P;break}p=p.L}else{if(!p.R){d=p;break}p=p.R}PE.insert(d,h),d||(yE=h)}}}}function bE(t){var e=t.circle;e&&(e.P||(yE=e.N),PE.remove(e),vE.push(e),oE(e),t.circle=null)}var kE=[];function xE(){oE(this),this.edge=this.site=this.circle=null}function wE(t){var e=kE.pop()||new xE;return e.site=t,e}function SE(t){bE(t),_E.remove(t),kE.push(t),oE(t)}function EE(t){for(var e,n,i,r,o=t[0],a=t[1],s=_E._;s;)if(i=TE(s,a)-o,CE<i)s=s.L;else{if(r=o-function(t,e){var n=t.N;if(n)return TE(n,e);n=t.site;return n[1]===e?n[0]:1/0}(s,a),!(CE<r)){-CE<i?(e=s.P,n=s):-CE<r?n=(e=s).N:e=n=s;break}if(!s.R){e=s;break}s=s.R}ME[t.index]={site:t,halfedges:[]};var u,l,c,h,d,p,f,y,v,g,m=wE(t);if(_E.insert(e,m),e||n){if(e===n)return bE(e),n=wE(e.site),_E.insert(m,n),m.edge=n.edge=lE(e.site,m.site),mE(e),void mE(n);n?(bE(e),bE(n),l=(u=e.site)[0],c=u[1],h=t[0]-l,g=t[1]-c,p=(d=n.site)[0]-l,f=d[1]-c,hE(n.edge,u,d,g=[(f*(y=h*h+g*g)-g*(v=p*p+f*f))/(f=2*(h*f-g*p))+l,(h*v-p*y)/f+c]),m.edge=lE(u,t,null,g),n.edge=lE(t,d,null,g),mE(e),mE(n)):m.edge=lE(e.site,m.site)}}function TE(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;t=t.P;if(!t)return-1/0;t=(n=t.site)[0],n=n[1],e=n-e;if(!e)return t;var a=t-i,s=1/o-1/e,u=a/e;return s?(-u+Math.sqrt(u*u-2*s*(a*a/(-2*e)-n+e/2+r-o/2)))/s+i:(i+t)/2}var _E,ME,PE,OE,CE=1e-6,AE=1e-12;function NE(t,e){return e[1]-t[1]||e[0]-t[0]}function LE(t,e){var R,j,n,i=t.sort(NE).pop();for(OE=[],ME=new Array(t.length),_E=new rE,PE=new rE;;)if(n=yE,i&&(!n||i[1]<n.y||i[1]===n.y&&i[0]<n.x))i[0]===R&&i[1]===j||(EE(i),R=i[0],j=i[1]),i=t.pop();else{if(!n)break;y=f=p=d=h=c=l=u=s=a=o=r=void 0;for(var r=n.arc,o=r.circle,a=o.x,s=o.cy,u=[a,s],l=r.P,c=r.N,h=[r],d=(SE(r),l);d.circle&&Math.abs(a-d.circle.x)<CE&&Math.abs(s-d.circle.cy)<CE;)l=d.P,h.unshift(d),SE(d),d=l;h.unshift(d),bE(d);for(var p=c;p.circle&&Math.abs(a-p.circle.x)<CE&&Math.abs(s-p.circle.cy)<CE;)c=p.N,h.push(p),SE(p),p=c;h.push(p),bE(p);for(var f=h.length,y=1;y<f;++y)p=h[y],d=h[y-1],hE(p.edge,d.site,p.site,u);d=h[0],(p=h[f-1]).edge=lE(d.site,p.site,null,u),mE(d),mE(p)}if(fE(),e){var v,g,m,b,k,x,w,S,E,T,_=+e[0][0],M=+e[0][1],P=+e[1][0],e=+e[1][1],O=(dE(_,M,P,e),_),C=M,A=P,N=e,B=ME.length,L=!0;for(D=0;D<B;++D)if(v=ME[D]){for(g=v.site,m=(b=v.halfedges).length;m--;)OE[b[m]]||b.splice(m,1);for(m=0,k=b.length;m<k;)E=v,E=(T=(T=OE[b[m]])[+(T.left===E.site)])[0],S=T[1],x=(w=pE(v,OE[b[++m%k]]))[0],w=w[1],(Math.abs(E-x)>CE||Math.abs(S-w)>CE)&&(b.splice(m,0,OE.push(cE(g,T,Math.abs(E-O)<CE&&CE<N-S?[O,Math.abs(x-O)<CE?w:N]:Math.abs(S-N)<CE&&CE<A-E?[Math.abs(w-N)<CE?x:A,N]:Math.abs(E-A)<CE&&CE<S-C?[A,Math.abs(x-A)<CE?w:C]:Math.abs(S-C)<CE&&CE<E-O?[Math.abs(w-C)<CE?x:O,C]:null))-1),++k);k&&(L=!1)}if(L){for(var I,F=1/0,D=0,L=null;D<B;++D)(v=ME[D])&&(I=(I=(g=v.site)[0]-O)*I+(I=g[1]-C)*I)<F&&(F=I,L=v);L&&(_=[A,N],M=[A,C],L.halfedges.push(OE.push(cE(g=L.site,P=[O,C],e=[O,N]))-1,OE.push(cE(g,e,_))-1,OE.push(cE(g,_,M))-1,OE.push(cE(g,M,P))-1))}for(D=0;D<B;++D)!(v=ME[D])||v.halfedges.length||delete ME[D]}this.edges=OE,this.cells=ME,_E=PE=OE=ME=null}LE.prototype={constructor:LE,polygons:function(){var n=this.edges;return this.cells.map(function(e){var t=e.halfedges.map(function(t){return pE(e,n[t])});return t.data=e.site.data,t})},triangles:function(){var c=[],h=this.edges;return this.cells.forEach(function(t,e){if(i=(n=t.halfedges).length)for(var n,i,r,o,a=t.site,s=-1,u=h[n[i-1]],l=u.left===a?u.right:u.left;++s<i;)r=l,l=(u=h[n[s]]).left===a?u.right:u.left,r&&l&&e<r.index&&e<l.index&&(o=l,(a[0]-o[0])*(r[1]-a[1])-(a[0]-r[0])*(o[1]-a[1])<0)&&c.push([a.data,r.data,l.data])}),c},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(n,i,t){for(var e,r,o=this,a=o._found||0,s=o.cells.length;!(r=o.cells[a]);)if(++a>=s)return null;for(var u=n-r.site[0],l=i-r.site[1],c=u*u+l*l;r=o.cells[e=a],a=null,r.halfedges.forEach(function(t){var t=o.edges[t],e=t.left;!(e!==r.site&&e||(e=t.right))||(t=(t=n-e[0])*t+(t=i-e[1])*t)<c&&(c=t,a=e.index)}),null!==a;);return o._found=e,null==t||c<=t*t?r.site:null}};const IE=t=>{const{fields:e,as:n,extend:i}=t,[a,s]=e,[u,l]=n;return HS(({data:t})=>{var r,o,e;function n(i){return new LE(i.map(function(t,e){var n=[Math.round(r(t,e,i)/CE)*CE,Math.round(o(t,e,i)/CE)*CE];return n.index=e,n.data=t,n}),e)}return r=nE,o=iE,e=null,n.polygons=function(t){return n(t).polygons()},n.links=function(t){return n(t).links()},n.triangles=function(t){return n(t).triangles()},n.x=function(t){return arguments.length?(r="function"==typeof t?t:eE(+t),n):r},n.y=function(t){return arguments.length?(o="function"==typeof t?t:eE(+t),n):o},n.extent=function(t){return arguments.length?(e=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],n):e&&[[e[0][0],e[0][1]],[e[1][0],e[1][1]]]},n.size=function(t){return arguments.length?(e=null==t?null:[[0,0],[+t[0],+t[1]]],n):e&&[e[1][0]-e[0][0],e[1][1]-e[0][1]]},{data:n.x(t=>t[a]).y(t=>t[s]).extent(i).polygons(t).map(t=>Object.assign(Object.assign({},t.data),{[u]:t.map(t=>t[0]),[l]:t.map(t=>t[1])}))}})};function DE(t){return t.target.depth}function RE(t,e){return t.sourceLinks.length?t.depth:e-1}function jE(t){return function(){return t}}function BE(t,e){return zE(t.source,e.source)||t.index-e.index}function FE(t,e){return zE(t.target,e.target)||t.index-e.index}function zE(t,e){return t.y0-e.y0}function VE(t){return t.value}function HE(t){return t.index}function GE(t){return t.nodes}function WE(t){return t.links}function UE(t,e){t=t.get(e);if(t)return t;throw new Error("missing: "+e)}function YE({nodes:t}){for(const n of t){let t=n.y0,e=t;for(const i of n.sourceLinks)i.y0=t+i.width/2,t+=i.width;for(const r of n.targetLinks)r.y1=e+r.width/2,e+=r.width}}function qE(){let b=0,k=0,x=1,w=1,S=24,E=8,T,_=HE,M=RE,P,O,C,A=GE,N=WE,L=6;function e(e){e={nodes:A(e),links:N(e)};{var{nodes:r,links:t}=e;r.forEach((t,e)=>{t.index=e,t.sourceLinks=[],t.targetLinks=[]});const p=new Map(r.map(t=>[_(t),t]));if(t.forEach((t,e)=>{t.index=e;let{source:n,target:i}=t;"object"!=typeof n&&(n=t.source=UE(p,n)),"object"!=typeof i&&(i=t.target=UE(p,i)),n.sourceLinks.push(t),i.targetLinks.push(t)}),null!=C)for(var{sourceLinks:n,targetLinks:i}of r)n.sort(C),i.sort(C)}t=e.nodes;for(const f of t)f.value=void 0===f.fixedValue?Math.max(bv(f.sourceLinks,VE),bv(f.targetLinks,VE)):f.fixedValue;{var o=e.nodes,a=o.length;let t=new Set(o),n=new Set,i=0;for(;t.size;){if(t.forEach(t=>{t.depth=i;for(var{target:e}of t.sourceLinks)n.add(e)}),++i>a)throw new Error("circular link");t=n,n=new Set}if(P){var s=Math.max(hv(o,t=>t.depth)+1,0);let e;for(let t=0;t<o.length;t++)(e=o[t]).depth=P.call(null,e,s)}}{var u=(r=e.nodes).length;let t=new Set(r),n=new Set,i=0;for(;t.size;){if(t.forEach(t=>{t.height=i;for(var{source:e}of t.targetLinks)n.add(e)}),++i>u)throw new Error("circular link");t=n,n=new Set}}var l=function({nodes:t}){const e=Math.max(hv(t,t=>t.depth)+1,0),n=(x-b-S)/(e-1),i=new Array(e).fill(0).map(()=>[]);for(const o of t){var r=Math.max(0,Math.min(e-1,Math.floor(M.call(null,o,e))));o.layer=r,o.x0=b+r*n,o.x1=o.x0+S,i[r]?i[r].push(o):i[r]=[o]}if(O)for(const a of i)a.sort(O);return i}(e),t=(T=Math.min(E,(w-k)/(hv(l,t=>t.length)-1)),l),c=dv(t,t=>(w-k-(t.length-1)*T)/bv(t,VE));for(const y of t){let e=k;for(const v of y){v.y0=e,v.y1=e+v.value*c,e=v.y1+T;for(const g of v.sourceLinks)g.width=g.value*c}e=(w-e+T)/(y.length+1);for(let t=0;t<y.length;++t){const m=y[t];m.y0+=e*(t+1),m.y1+=e*(t+1)}!function(t){if(void 0===C)for(var{sourceLinks:e,targetLinks:n}of t)e.sort(FE),n.sort(BE)}(y)}for(let t=0;t<L;++t){var h=Math.pow(.99,t),d=Math.max(1-h,(t+1)/L);!function(n,i,r){for(let t=n.length,e=t-2;0<=e;--e){const u=n[e];for(const l of u){let t=0,e=0;for(var{target:o,value:a}of l.sourceLinks){a=a*(o.layer-l.layer);t+=function(t,e){let n=e.y0-(e.targetLinks.length-1)*T/2;for(var{source:i,width:r}of e.targetLinks){if(i===t)break;n+=r+T}for(var{target:o,width:a}of t.sourceLinks){if(o===e)break;n-=a}return n}(l,o)*a,e+=a}var s;0<e&&(s=(t/e-l.y0)*i,l.y0+=s,l.y1+=s,D(l))}void 0===O&&u.sort(zE),u.length&&I(u,r)}}(l,h,d),!function(n,i,r){for(let t=1,e=n.length;t<e;++t){const u=n[t];for(const l of u){let t=0,e=0;for(var{source:o,value:a}of l.targetLinks){a=a*(l.layer-o.layer);t+=function(t,e){let n=t.y0-(t.sourceLinks.length-1)*T/2;for(var{target:i,width:r}of t.sourceLinks){if(i===e)break;n+=r+T}for(var{source:o,width:a}of e.targetLinks){if(o===t)break;n-=a}return n}(o,l)*a,e+=a}var s;0<e&&(s=(t/e-l.y0)*i,l.y0+=s,l.y1+=s,D(l))}void 0===O&&u.sort(zE),u.length&&I(u,r)}}(l,h,d)}return YE(e),e}function I(t,e){var n=t.length>>1,i=t[n];o(t,i.y0-T,n-1,e),r(t,i.y1+T,1+n,e),o(t,w,t.length-1,e),r(t,k,0,e)}function r(t,e,n,i){for(;n<t.length;++n){const o=t[n];var r=(e-o.y0)*i;1e-6<r&&(o.y0+=r,o.y1+=r),e=o.y1+T}}function o(t,e,n,i){for(;0<=n;--n){const o=t[n];var r=(o.y1-e)*i;1e-6<r&&(o.y0-=r,o.y1-=r),e=o.y0-T}}function D({sourceLinks:t,targetLinks:e}){if(void 0===C){for(const{source:{sourceLinks:t}}of e)t.sort(FE);for(const{target:{targetLinks:e}}of t)e.sort(BE)}}return e.update=function(t){return YE(t),t},e.nodeId=function(t){return arguments.length?(_="function"==typeof t?t:jE(t),e):_},e.nodeAlign=function(t){return arguments.length?(M="function"==typeof t?t:jE(t),e):M},e.nodeDepth=function(t){return arguments.length?(P=t,e):P},e.nodeSort=function(t){return arguments.length?(O=t,e):O},e.nodeWidth=function(t){return arguments.length?(S=+t,e):S},e.nodePadding=function(t){return arguments.length?(E=T=+t,e):E},e.nodes=function(t){return arguments.length?(A="function"==typeof t?t:jE(t),e):A},e.links=function(t){return arguments.length?(N="function"==typeof t?t:jE(t),e):N},e.linkSort=function(t){return arguments.length?(C=t,e):C},e.size=function(t){return arguments.length?(b=k=0,x=+t[0],w=+t[1],e):[x-b,w-k]},e.extent=function(t){return arguments.length?(b=+t[0][0],x=+t[1][0],k=+t[0][1],w=+t[1][1],e):[[b,k],[x,w]]},e.iterations=function(t){return arguments.length?(L=+t,e):L},e}IE.props={category:"preprocessor"};const XE={nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodes:t=>t.nodes,links:t=>t.links,nodeSort:void 0,linkSort:void 0,iterations:6},KE={left:function(t){return t.depth},right:function(t,e){return e-1-t.height},center:function(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?dv(t.sourceLinks,DE)-1:0},justify:RE};const ZE=f=>HS(({data:t})=>{var{nodeId:e,nodeSort:n,nodeAlign:i,nodeWidth:r,nodePadding:o,nodeDepth:a,nodes:s,links:u,linkSort:l,iterations:c}=Object.assign({},XE,f);const h=qE().nodeSort(n).linkSort(l).links(u).nodes(s).nodeWidth(r).nodePadding(o).nodeDepth(a).nodeAlign("string"==(l=typeof(n=i))?KE[n]||RE:"function"==l?n:RE).iterations(c).extent([[0,0],[1,1]]),{nodes:d,links:p}=("function"==typeof e&&h.nodeId(e),h(t));return{data:{nodes:d.map(t=>{var{x0:e,x1:n,y0:i,y1:r}=t;return Object.assign(Object.assign({},t),{x:[e,n,n,e],y:[i,i,r,r]})}),links:p.map(t=>{var{source:e,target:n}=t,e=e.x1,n=n.x0,i=t.width/2;return Object.assign(Object.assign({},t),{x:[e,e,n,n],y:[t.y0+i,t.y0-i,t.y1+i,t.y1-i]})})}}});function $E(){return{"transform.fetch":P2,"transform.sortBy":tE,"transform.filterBy":K2,"transform.pick":J2,"transform.rename":Q2,"transform.subset":$2,"transform.wordCloud":X2,"transform.voronoi":IE,"transform.Sankey":ZE,"transform.maybeZeroY1":YS,"transform.maybeZeroX":u2,"transform.maybeStackY":i2,"transform.maybeTitleX":r2,"transform.maybeTooltipY":s2,"transform.maybeTooltipPosition":a2,"transform.maybeArrayField":h2,"transform.maybeSeries":p2,"transform.stackY":n2,"transform.dodgeX":f2,"transform.jitter":m2,"transform.jitterY":b2,"transform.symmetryY":k2,"transform.stackEnter":y2,"transform.normalizeY":v2,"transform.select":T2,"transform.selectX":_2,"transform.selectY":M2,"transform.maybeSize":c2,"transform.maybeZeroY":l2,"transform.maybeKey":d2,"renderer.canvas":Vy,"coordinate.cartesian":Hy,"coordinate.polar":Gy,"coordinate.transpose":Wy,"coordinate.parallel":Uy,"coordinate.fisheye":Yy,"encode.constant":qy,"encode.field":Ky,"encode.transform":Xy,"encode.column":Zy,"mark.interval":ev,"mark.line":Tv,"mark.point":_v,"mark.text":Mv,"mark.grid":Pv,"mark.area":Ov,"mark.edge":Cv,"mark.image":Av,"mark.polygon":Nv,"mark.schema":Lv,"mark.annotation.text":Iv,"mark.annotation.lineX":Rv,"mark.annotation.lineY":Dv,"mark.annotation.connector":jv,"palette.category10":Bv,"palette.category20":Fv,"scale.linear":p0,"scale.ordinal":f0,"scale.band":d0,"scale.identity":y0,"scale.point":v0,"scale.time":g0,"scale.log":m0,"scale.pow":b0,"scale.threshold":k0,"scale.quantile":x0,"scale.quantize":w0,"shape.rect":Im,"shape.hollowRect":Dm,"shape.line":jm,"shape.hv":Fm,"shape.vh":zm,"shape.hvh":Vm,"shape.smooth":Bm,"shape.bowtie":Um,"shape.cross":Ym,"shape.diamond":qm,"shape.hexagon":Xm,"shape.hollowBowtie":Km,"shape.hollowDiamond":Zm,"shape.hollowHexagon":$m,"shape.hollowPoint":Jm,"shape.hollowSquare":Qm,"shape.hollowTriangle":t1,"shape.hollowTriangleDown":e1,"shape.hyphen":n1,"shape.linePoint":i1,"shape.plus":r1,"shape.point":o1,"shape.square":a1,"shape.tick":s1,"shape.triangle":u1,"shape.triangleDown":l1,"shape.text":c1,"shape.area":Hw,"shape.smoothArea":Gw,"shape.edge":Ww,"shape.arc":Uw,"shape.image":Yw,"shape.polygon":qw,"shape.box":Xw,"shape.annotation.text":Bw,"shape.annotation.badge":zw,"shape.annotation.line":Kw,"shape.annotation.connector":tS,"theme.light":eS,"component.axisX":rS,"component.axisY":oS,"component.legendCategory":aS,"component.legendContinuous":sS,"animation.scaleInY":hS,"animation.fadeIn":dS,"interaction.elementActive":pS,"interaction.tooltip":fS,"interaction.fisheye":yS,"action.surfacePointSelection":vS,"action.highlightSelection":gS,"action.tooltip":bS,"action.fisheyeFocus":xS,"action.plot":kS,"interactor.mousePosition":wS,"interactor.touchPosition":SS,"composition.layer":ES,"composition.flex":TS,"composition.mark":MS,"composition.view":_S,"composition.rect":FS,"adjust.pack":zS}}function JE(e,n){const i=t=>{if("string"!=typeof t)return t;t=e+"."+t;return n[t]||Mm("Unknown Component: "+t)};return[t=>{var e=t["type"],t=_(t,["type"]);return i(e)(Object.assign({},t))},i]}function QE(t,e,n){for(;t<e;)t+=2*Math.PI;for(;n<t;)t-=2*Math.PI;return t}ZE.props={category:"preprocessor"};function tT(t,e,n,i,r){var o=t[0],t=t[1],a=Wr();return o=[o,t],(t=a)[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=o[0],t[7]=o[1],t[8]=1,t}function eT(t,e,n,i,r){var o=new Ug({range:[e,e+i]}),a=new Ug({range:[n,n+r]});return{transform:function(t){var e=t[0],t=t[1];return[o.map(e),a.map(t)]},untransform:function(t){var e=t[0],t=t[1];return[o.invert(e),a.invert(t)]}}}function nT(t,e,n,i,r){return(0,t[0])(e,n,i,r)}function iT(t,e,n,i,r){return t[0]}function rT(t,e,n,i,r){var o=t[0],a=t[1],s=t[2],t=t[3],u=new Ug({range:[s,t]}),l=new Ug({range:[o,a]}),c=1<(s=r/i)?1:s,h=1<s?1/s:1;return{transform:function(t){var e=t[0],t=t[1],e=l.map(e),t=u.map(t);return[.5*(t*Math.cos(e)*c)+.5,.5*(t*Math.sin(e)*h)+.5]},untransform:function(t){var e=t[0],t=t[1],e=2*(e-.5)/c,t=2*(t-.5)/h,n=Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),t=QE(Math.atan2(t,e),o,a);return[l.invert(t),u.invert(n)]}}}function oT(t,e,n,i,r){return{transform:function(t){var e=t[0];return[t[1],e]},untransform:function(t){var e=t[0];return[t[1],e]}}}function aT(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return dT.apply(void 0,pT([[-1,-1]],e,!1))}function sT(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return dT.apply(void 0,pT([[-1,1]],e,!1))}function uT(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return dT.apply(void 0,pT([[1,-1]],e,!1))}function lT(t,e,n,i,r){var o,t=t[0],a=Wr();return a=a,t=t,o=Math.sin(t),t=Math.cos(t),a[0]=t,a[1]=o,a[2]=0,a[3]=-o,a[4]=t,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}function cT(t,e,n,i,r){var o=t[0],a=t[1],s=t[2],u=(t[3]-s)/(+a/(2*Math.PI)+1),l=u/(2*Math.PI),c=new Ug({range:[s,s+.99*u]}),h=new Ug({range:[o,a]}),d=1<(t=r/i)?1:t,p=1<t?1/t:1;return{transform:function(t){var e=t[0],t=t[1],e=h.map(e),t=c.map(t);return[.5*(Math.cos(e)*(l*e+t)*d)+.5,.5*(Math.sin(e)*(l*e+t)*p)+.5]},untransform:function(t){var e=t[0],t=t[1],e=2*(e-.5)/d,t=2*(t-.5)/p,n=Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),t=QE(Math.atan2(t,e)+Math.floor(n/u)*Math.PI*2,o,a),e=n-l*t;return[h.invert(t),c.invert(e)]}}}function hT(t,e,n,i,r){var s=t[0],u=t[1],o=t[2],t=t[3],l=new Ug({range:[o,t]});return{transform:function(t){for(var e=[],n=t.length,i=new Yg({domain:new Array(n).fill(0).map(function(t,e){return e}),range:[s,u]}),r=0;r<n;r++){var o=t[r],a=i.map(r),o=l.map(o);e.push(a,o)}return e},untransform:function(t){for(var e=[],n=0;n<t.length;n+=2){var i=t[n+1];e.push(l.invert(i))}return e}}}var dT=function(t,e,n,i,r){var o=t[0],t=t[1],a=Wr();return o=[o,t],(t=a)[0]=o[0],t[1]=0,t[2]=0,t[3]=0,t[4]=o[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},pT=function(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||((i=i||Array.prototype.slice.call(e,0,r))[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))};function fT(t){return 1/Math.tan(t)}function yT(t,e,n,i,r){var o=fT(t[0]);return{transform:function(t){var e=t[0],t=t[1];return[e+t*o,t]},untransform:function(t){var e=t[0],t=t[1];return[e-t*o,t]}}}function vT(t,e,n,i,r){var o=fT(t[0]);return{transform:function(t){var e=t[0];return[e,t[1]+e*o]},untransform:function(t){var e=t[0];return[e,t[1]-e*o]}}}function gT(t,e,n,i,r){var o=t<e,r=(o?e-i:r-e)||r-i,i=o?-1:1;return i*r*(n+1)/(n+r/((t-e)*i))+e}function mT(t,e,n,i,r){var o=t<e,r=(o?e-i:r-e)||r-i;return r/(r*(n+1)/(t-e)-n*(o?-1:1))+e}function bT(t,n,e,i,r){var o=t[0],a=t[1];return{transform:function(t){var e=t[0],t=t[1];return[gT(e,o,a,n,n+i),t]},untransform:function(t){var e=t[0],t=t[1];return[mT(e,o,a,n,n+i),t]}}}function kT(t,e,n,i,r){var o=t[0],a=t[1];return{transform:function(t){return[t[0],gT(t[1],o,a,n,n+r)]},untransform:function(t){return[t[0],mT(t[1],o,a,n,n+r)]}}}function xT(t,n,i,r,o){var a=t[0],s=t[1],u=t[2],l=t[3];return{transform:function(t){var e=t[0],t=t[1];return[gT(e,a,u,n,n+r),gT(t,s,l,i,i+o)]},untransform:function(t){var e=t[0],t=t[1];return[mT(e,a,u,n,n+r),mT(t,s,l,i,i+o)]}}}function wT(t,e,n,i,r){var o=t[0],a=t[1],s=t[2],u=t[3];return{transform:function(t){var e=t[0],t=t[1],n=e-o,i=t-a,r=Math.sqrt(n*n+i*i);if(s<r)return[e,t];e=gT(r,0,u,0,s),t=Math.atan2(i,n);return[o+e*Math.cos(t),a+e*Math.sin(t)]},untransform:function(t){var e=t[0],t=t[1],n=e-o,i=t-a,r=Math.sqrt(n*n+i*i);if(s<r)return[e,t];e=mT(r,0,u,0,s),t=Math.atan2(i,n);return[o+e*Math.cos(t),a+e*Math.sin(t)]}}}var ST=function(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||((i=i||Array.prototype.slice.call(e,0,r))[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))},ET=(TT.prototype.update=function(t){this.options=O({},this.options,t),this.recoordinate()},TT.prototype.clone=function(){return new TT(this.options)},TT.prototype.getOptions=function(){return this.options},TT.prototype.clear=function(){this.update({transformations:[]})},TT.prototype.getSize=function(){var t=this.options;return[t.width,t.height]},TT.prototype.getCenter=function(){var t=this.options,e=t.x,n=t.y;return[(2*e+t.width)/2,(2*n+t.height)/2]},TT.prototype.transform=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.options.transformations;return this.update({transformations:ST(ST([],n,!0),[ST([],t,!0)],!1)}),this},TT.prototype.map=function(t){return this.output(t)},TT.prototype.invert=function(t){return this.input(t)},TT.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},TT.prototype.compose=function(t){for(var e=(t=void 0===t?!1:t)?ST([],this.options.transformations,!0).reverse():this.options.transformations,n=t?function(t){return t.untransform}:function(t){return t.transform},i=[],o=[],r=function(t,e){return o.push((e=void 0===e?!0:e)?(r=t,function(t){for(var e=[],n=0;n<t.length-1;n+=2){var i=[t[n],t[n+1]],i=r(i);e.push.apply(e,i)}return e}):t);var r},a=0,s=e;a<s.length;a++){var u,l,c,h,d=s[a],p=d[0],d=d.slice(1),f=this.transformers[p];f&&(u=(h=this.options).x,l=h.y,c=h.width,h=h.height,f=f(ST([],d,!0),u,l,c,h),(d=f)instanceof Float32Array||d instanceof Array?i.push(f):(i.length&&(r(this.createMatrixTransform(i,t)),i.splice(0,i.length)),r(n(f)||kt,"parallel"!==p)))}return i.length&&r(this.createMatrixTransform(i,t)),function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t?e.reduce(function(e,n){return function(t){return n(e(t))}},t):kt}.apply(void 0,o)},TT.prototype.createMatrixTransform=function(t,e){var n,i,r,o,a,s,u,l,c,h,d,p,f=Wr();return e&&t.reverse(),t.forEach(function(t){return Ur(f,f,t)}),e&&(e=t=f,(p=new Gr(9))[0]=e[0],p[1]=e[1],p[2]=e[2],p[3]=e[3],p[4]=e[4],p[5]=e[5],p[6]=e[6],p[7]=e[7],p[8]=e[8],p=(e=p)[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],u=e[7],l=(e=e[8])*o-a*u,(d=p*l+n*(c=-e*r+a*s)+i*(h=u*r-o*s))&&(t[0]=l*(d=1/d),t[1]=(-e*n+i*u)*d,t[2]=(a*n-i*o)*d,t[3]=c*d,t[4]=(e*p-i*s)*d,t[5]=(-a*p+i*r)*d,t[6]=h*d,t[7]=(-u*p+n*s)*d,t[8]=(o*p-n*r)*d)),function(t){t=[t[0],t[1],1];return mo(t,t,f),[t[0],t[1]]}},TT);function TT(t){this.options={x:0,y:0,width:300,height:150,transformations:[]},this.transformers={cartesian:eT,translate:tT,custom:nT,matrix:iT,polar:rT,transpose:oT,scale:dT,"shear.x":yT,"shear.y":vT,reflect:aT,"reflect.x":sT,"reflect.y":uT,rotate:lT,helix:cT,parallel:hT,fisheye:xT,"fisheye.x":bT,"fisheye.y":kT,"fisheye.circular":wT},this.update(t)}function _T(t){return void 0!==t.find(t=>"polar"===t.type)}function MT(t){return t.filter(({type:t})=>"transpose"===t).length%2==1}function PT(t,e,n,i,r,o,a){var s=t["scaleName"],t=function(t,e,n,i,r,o){var{name:a,field:s}=t,{field:s=s,guide:u={}}=e,l=function(t,e){var{scale:t,name:n,value:i,type:r}=t,{type:e,domain:o,range:a}=e;return void 0!==t?t:void 0!==e?e:"constant"===r&&!LT(n)||function(t){return t.some(t=>"object"==typeof t&&!(t instanceof Date)&&null!==t)}(i)?"identity":2<(o||a||[]).length?CT(n):void 0===o?NT(i)?CT(n):function(t){return t.some(t=>t instanceof Date)}(i)?"time":"linear":NT(o)?CT(n):"linear"}(t,e);return"string"!=typeof l?e:Object.assign(Object.assign(Object.assign({},e),function(t,e,n,i){var r=e["name"];switch(t){case"linear":case"time":case"log":case"pow":return function(t){var{interpolate:e=Lg,nice:n=!1,tickCount:i=10}=t;return Object.assign(Object.assign({},t),{interpolate:e,nice:n,tickCount:i})}(n);case"band":case"point":return function(t,e,n,i){if(void 0!==i.padding)return i;var t=function(t,e,n){return"enterDelay"===e||"enterDuration"===e?0:"band"===t?_T(n)?0:.1:"point"===t&&_T(n)?.5:0}(t,e,n),{paddingInner:e=t,paddingOuter:n=t}=i;return Object.assign(Object.assign({},i),{paddingInner:e,paddingOuter:n})}(t,r,i,n);default:return n}}(l,t,e,n)),{domain:function(t,e,n){var i=e["value"],e=n["domain"];if(void 0!==e)return e;switch(t){case"linear":case"time":case"log":case"pow":case"threshold":return function(t,e){var{zero:e=!1}=e;let n=1/0,i=-1/0;for(const r of t)Pm(r)&&(n=Math.min(n,+r),i=Math.max(i,+r));return e?[Math.min(0,n),i]:[n,i]}(i,n);case"band":case"ordinal":case"point":return AT(i);case"quantile":return function(t){return AT(t).sort()}(i);default:return[]}}(l,t,e),range:function(t,e,n,i,r,o){var a=n["range"];if(void 0!==a)return a;const[s]=JE("palette",o),{name:u,value:l}=e,{defaultCategory10:c,defaultCategory20:h}=r,d={type:function(t){return Array.from(new Set(t))}(l).length<=10?c:h},{palette:p=d}=n,f=s(p);switch(t){case"linear":case"band":case"point":case"time":case"log":return function(t,e){return"enterDelay"===t?[0,1e3]:"enterDuration"==t?[300,1e3]:t.startsWith("y")||t.startsWith("position")?[1,0]:"color"===t?[e[0],function(t){return t[t.length-1]}(e)]:"size"===t?[1,10]:[0,1]}(u,f);case"ordinal":return"color"===u?f:i;default:return[]}}(l,t,e,i,r,o),guide:u,name:a,field:s,type:l})}(t,e,n,i,r,a),e=t["independent"];if(e)return t;if(!o.has(s))return o.set(s,t),t;var n=o.get(s),i=s,r=n,a=t,{type:e,domain:o,range:s}=r,{type:a,domain:t,range:u}=a;return"string"==typeof e&&"string"==typeof a&&(r.type=function(t,e,n){{if(IT(t,e,"linear","identity"))return"identity";if(IT(t,e,"band","point"))return"band";if(t!==e)throw new Error(`Incompatible scale type: ${t} !== ${e} for channel: `+n);return t}}(e,a,i),r.domain=function(t,e,n){switch(t){case"linear":case"pow":case"log":return DT(e,n);case"band":case"ordinal":return RT(e,n);default:return e}}(e,o,t),r.range=function(t,e,n){switch(t){case"linear":case"band":case"pow":case"log":return DT(e,n);case"ordinal":return RT(e,n);default:return e}}(e,s,u)),n}function OT(t,e){const n={};for(var{scaleName:i,value:r,name:o}of t){const a=e[i];n[o]=r.map(t=>a.map(t))}return n}function CT(t){return(t=t).startsWith("x")||t.startsWith("y")||t.startsWith("position")||t.startsWith("size")?"point":"ordinal"}function AT(t){return Array.from(new Set(t))}function NT(t){return t.some(t=>{t=typeof t;return"string"==t||"boolean"==t})}function LT(t){return t.startsWith("x")||t.startsWith("y")||t.startsWith("position")}function IT(t,e,n,i){return t===n&&e===i||t===i&&e===n}function DT(t,e){var[t,n]=t,[e,i]=e;return[Math.min(+t,+e),Math.max(+n,+i)]}function RT(t,e){return Array.from(new Set([...t,...e]))}function jT(y,v,g,m,b,k){return F(this,void 0,void 0,function*(){const{data:c,encode:t,I:e,columnOf:h,scale:n={}}=yield function(d,p,f){return F(this,void 0,void 0,function*(){const[t,e]=JE("transform",f);var n=BT(d,f),{transform:i=[]}=d,{preInference:r=[],postInference:o=[]}=p;const a=[],s=[];for(const h of i){var u=h["type"],{category:u="preprocessor"}=e(u).props||{};("preprocessor"===u?a:s).push(h)}var i=yield _m(a.map(t))(n),l=i["data"],l=l?PS(l):[];const c=[...r,...s,...o];return _m(c.map(t))(Object.assign(Object.assign(Object.assign({},n),i),{I:l}))})}(y,v,k);if(!1===Array.isArray(c)||0===c.length)return null;const i=v["channels"],r=lv(Object.entries(t).filter(([,t])=>Pm(t)),([t])=>{return/([^\d]+)\d*$/.exec(t)[1]}),o=i.filter(t=>{var{name:t,required:e}=t;if(r.has(t))return!0;if(e)throw new Error(`Missing encoding for channel: ${t}.`);return!1}).flatMap(l=>{var t=l["name"];const e=r.get(t);return e.map(t=>{var e=l,n=c,i=h,{independent:r=!1,name:o,scaleName:a}=e,e=_(e,["independent","name","scaleName"]),[t,s]=t,u=(s=FT(n,s)).type;return Object.assign(Object.assign({},e),{type:u,name:t,scaleName:null!=a?a:r?t:o,value:i(n,s),field:zT(s)})})}),a={};var{coordinate:s=[]}=b;const u=lv(o,t=>t.scaleName);for(const[f,o]of u.entries()){var l=v["shapes"],d=function(t){const e={};for(const a of t){var{value:n=[],field:i}=e,{value:r=[],field:o}=a;Object.assign(e,a),e.value=[...n,...r],e.field=null==o?i:o}return e}(o),{[f]:p={}}=n;a[f]=PT(d,p,s,l,m,g,k)}return[Object.assign(Object.assign({},y),{encode:t,scale:a,data:c}),Object.assign(Object.assign({},v),{channels:o,index:e})]})}function BT(t,e){var{data:t,encode:n={},transform:i=[],scale:r={}}=t;return{data:t,encode:function(t){const e={};for(var[n,i]of Object.entries(t))if(Array.isArray(i))for(let t=0;t<i.length;t++){var r=""+n+(0===t?"":t);e[r]=i[t]}else e[n]=i;return e}(n),columnOf:function(t){const[i]=JE("encode",t);return(t,e)=>{if(void 0===e)return null;if(void 0===t)return null;e=FT(t,e);const n=i(e)(t);t=zT(e);return n.field=t,n}}(e),transform:i,I:t?PS(t):[],scale:r}}function FT(t,e){return"object"!=typeof e||e instanceof Date?(t=t,{type:"function"==typeof(n=e)?"transform":"string"==typeof n&&void 0!==(null==(t=null==t?void 0:t[0])?void 0:t[n])?"field":"constant",value:e}):e;var n}function zT(t){var{type:t,value:e}=t;return"field"===t&&"string"==typeof e?e:e&&e.field?e.field:null}function VT(t,e,n){const{component:i=[],coordinate:r=[],adjust:o}=e,[,a]=JE("component",n);e=t.filter(({guide:t,name:e})=>null!==t&&(!o||!LT(e)));const s=[...i];for(const f of e){var u,l,c,h,d,p=function(t,e){const{name:n,guide:i,type:r}=t,o=i["type"];if(void 0!==o)return o;if(MT(e))return null;if(_T(e))return null;if(n.startsWith("x"))return"axisX";if(n.startsWith("y"))return"axisY";if(n.startsWith("position"))return"axisY";if("color"===n)switch(r){case"ordinal":return"legendCategory";case"linear":return"legendContinuous";default:return null}return null}(f,r);null!==p&&(h=a(p)["props"],{defaultPosition:h,defaultSize:d,defaultOrder:u}=h,{guide:l,name:c}=f,{position:c=function(t,e,n,i,r){i=["left","right","top","bottom","centerHorizontal"].includes(i.position)?i.position:n;{if("axisY"===e&&function(t){return void 0!==t.find(t=>"parallel"===t.type)}(r))return null===(n=/position(\d*)/g.exec(t))||0==+n[1]?i:"centerHorizontal";if("axisX"===e&&_T(r)&&!MT(r)||"axisY"===e&&_T(r)&&MT(r))return"arc";if(_T(r)&&("axisX"===e||"axisY"===e))return"arcY"}return i}(c,p,h,l,r),size:h=d,order:d=u}=l,s.push(Object.assign(Object.assign({},l),{position:c,order:d,size:h,type:p,scale:f})))}return s}function HT(t,e,n,i){const[r]=JE("scale",i),[o]=JE("component",i);var{scale:i,bbox:a}=t,t=_(t,["scale","bbox"]),s=i?r(i):null,{field:i,domain:u}=i,i={field:i,domain:u,bbox:a};const l=o(t);return l(s,i,e,n)}function GT(t,e){var t=function(t,e){const n=lv(t,t=>t.position),{paddingLeft:i,paddingRight:r,paddingBottom:o,paddingTop:a}=e,s={paddingBottom:o,paddingLeft:i,paddingTop:a,paddingRight:r};for(const c of["left","right","top","bottom"]){var u="padding"+function(t){return t.replace(/( |^)[a-z]/g,t=>t.toUpperCase())}(c);if(void 0===s[u])if(n.has(c)){const t=n.get(c);var l=t.reduce((t,{size:e})=>t+e,0);s[u]=l}else s[u]=30}return s}(t,e),{paddingLeft:n,paddingRight:i,paddingTop:r,paddingBottom:o}=t,{width:e,height:a,x:s=0,y:u=0}=e;return Object.assign(Object.assign({},t),{width:e,height:a,innerWidth:e-n-i,innerHeight:a-r-o,x:s,y:u})}function WT(t,e,n){const i=lv(t,t=>t.position);var{paddingLeft:t,paddingRight:r,paddingTop:o,paddingBottom:a,innerHeight:s,innerWidth:u,height:l,width:c}=n,h={top:[t,0,u,o,0,!0,nv],right:[c-r,o,r,s,1,!1,iv],bottom:[t,l-a,u,a,0,!1,iv],left:[0,o,t,s,1,!0,nv],centerHorizontal:[t,o,u,s,-1,null,null],arc:[t,o,c-t-r,l-o-a,-1,null,null],arcY:[t,o,c-t-r,l-o-a,-1,null,null]};for(const[b,t]of i.entries()){var d=h[b];if("centerHorizontal"===b)!function(e,t,n,i){const[,r,,o]=i,a=t["paddingLeft"],s=new Array(e.length+1).fill(0),u=n.map(s),l=u.filter((t,e)=>e%2==0).map(t=>t+a);for(let t=0;t<e.length;t++){const d=e[t];var c=l[t],h=l[t+1]-c;d.bbox={x:c,y:r,width:h,height:o}}}(t,n,e,d);else if("arc"===b||"arcY"===b){m=g=v=y=f=p=void 0;var p=t,f=d,[y,v,g,m]=f;for(let t=0;t<p.length;t++){const k=p[t];k.bbox={x:y,y:v,width:g,height:m}}}else!function(n,t){const[e,i,r,o,a,s,u]=t,[l,c,h,d,p,f,y,v]=0===a?["y",i,"x",e,"height",o,"width",r]:["x",e,"y",i,"width",r,"height",o],g=(n.sort((t,e)=>u(t.order,e.order)),s?c+f:c);for(let t=0,e=g;t<n.length;t++){const b=n[t];var m=b["size"];b.bbox={[l]:s?e-m:e,[h]:d,[p]:m,[y]:v},e+=m*(s?-1:1)}}(t,d)}}function UT(c,P,O){return F(this,void 0,void 0,function*(){const[t]=JE("composition",O),e=new Set(Object.keys(O).filter(t=>t.startsWith("mark")).map(t=>t.split(".").pop())),n=[],M=new Map,i=[c];for(;i.length;){var r=i.shift(),o=r["type"],o="string"==typeof o&&e.has(o)?"mark":o;if("standardView"===o){var[a,s]=yield YT(r,O);M.set(a,r),n.push(a),i.push(...s)}else if("mark"===o){const u=t({type:o});i.push(...u(r))}else{const l=t({type:o});a=yield function(o,a){return F(this,void 0,void 0,function*(){var[t]=JE("transform",a);const{transform:e=[]}=o,n=_(o,["transform","data"]);var i=BT(o,a),{data:t,encode:i,scale:r}=yield _m(e.map(t))(i);return Object.assign(Object.assign({},n),{data:t,encode:i,scale:r})})}(r,O),s=l(a);i.push(...s)}}P.selectAll(".view").data(n,t=>t.key).join(t=>t.append("g").attr("className","view").attr("id",t=>t.id).style("transform",t=>`translate(${t.layout.x}, ${t.layout.y})`).each(function(t){qT(t,Cm(this),O);const r=M.get(t);{var e=r,n=Cm(this),i=(i=t=>t)=>F(this,void 0,void 0,function*(){var[t,e]=yield YT(i(r),O);qT(t,Cm(this),O);for(const n of e)UT(n,P,O)}),o;const[p]=JE("interaction",o=O);var[a]=JE("action",o),[s]=JE("interactor",o),{interaction:o=[]}=e,o=([e=[]]=[o],[...e,{type:"tooltip"}]);const{scale:f,coordinate:y,theme:v}=t;for(const e of o){const{start:g=[],end:m=[],interactors:b=[]}=p(e);var u=[...g,...m];const k=b.map(s),x=lv(k.flatMap(({actions:t})=>t.flatMap(({action:e,events:t})=>t.map(t=>[t,e]))),t=>t[1]);for(const{trigger:w,action:S,throttle:E}of u){var l,c=[S].flat(1).map(t=>"object"==typeof t?t:{type:t}).map(a);const T=E?t=>mt(t,E.wait,E):t=>t,_=T(_m(c));for([l]of x.get(w)||[[w]]){var[h,d]=l.split(":");n.selectAll("."+h).on(d,t=>{_({event:t,scale:f,coordinate:y,theme:v,selection:n,shared:{},update:i})})}}}return}}),t=>t.style("transform",t=>`translate(${t.layout.x}, ${t.layout.y})`).each(function(t){qT(t,Cm(this),O)}),t=>t.remove())})}function YT(U,Y){return F(this,void 0,void 0,function*(){const[t]=JE("theme",Y),[e,R]=JE("mark",Y);var[j]=JE("scale",Y);const[B]=JE("adjust",Y);var{theme:n,marks:F,key:z,adjust:i,frame:V}=U,r=t(function(t={type:"light"}){var{type:e="light"}=t;return Object.assign(Object.assign({},t),{type:e})}(n));const o=new Map;var H=new Map;const a=new Set;for(const m of F){var{type:s=Mm("G2Mark type is required.")}=m,s=R(s)["props"],s=yield jT(m,s,H,r,U,Y);if(s){var[s,G]=s;o.set(s,G);for(const b of Object.values(s.scale))a.add(b)}}var u,l,n=VT(Array.from(a),U,Y),c=GT(n,U),h=function(t,e,n){var[n]=JE("coordinate",n),{innerHeight:t,innerWidth:i}=t,{coordinate:e=[]}=e;const r=(e=e).find(t=>"cartesian"===t.type)?e:[...e,{type:"cartesian"}];return new ET({x:0,y:0,width:i,height:t,transformations:r.map(n).flat()})}(c,U,Y),d=(WT(n,h,c),{});const p=[];for([u,l]of o.entries()){const{scale:k,children:x,filter:w,facet:S=!0,dataDomain:E,style:T={},animate:_={}}=u,{index:M,channels:P,defaultShape:O}=l;var f=function(i,r){return Object.entries(i).reduce((t,[e,n])=>(t[e]=r(n,e,i),t),{})}(k,j);Object.assign(d,f);const C=uS.of(P).call(OT,f).call($T,M,_,O,Y).call(JT,M,T,O,Y).value();var y=S&&w?M.filter(w):M;const A=e(u);var[v,g]=A(y,f,C,h);const N=[],L=[];for(let t=0;t<v.length;t++){var W=v[t];const D=g[t];D.every(([t,e])=>Pm(t)&&Pm(e))&&(N.push(W),L.push(D))}y=E||N.length;const I=i?B(i)(g,y,c):[];y=N.map((i,t)=>Object.entries(C).reduce((t,[e,n])=>(t[e]=n[i],t),{points:L[t],transform:I[t]})),y=(l.data=y,l.index=N,null===x||void 0===x?void 0:x(y,f,c));p.push(...y||[])}return[{layout:c,theme:r,coordinate:h,components:n,markState:o,key:z,frame:V,scale:d},p]})}function qT(a,l,c){F(this,void 0,void 0,function*(){const{components:t,theme:s,layout:e,markState:n,coordinate:u,key:i,frame:r=!1}=a;l.selectAll(".component").data(t,(t,e)=>t.type+"-"+e).join(t=>t.append("g").style("zIndex",({zIndex:t})=>t||-1).attr("className","component").append(t=>HT(t,u,s,c)),t=>t.each(function(t){t=HT(t,u,s,c).attributes;const[e]=this.childNodes;e.update(Object.assign({},t))})),l.selectAll(".plot").data([e],()=>i).join(t=>{const e=t.append("rect").attr("className","plot").style("fill","transparent").call(KT,r).call(XT).call(ZT,Array.from(n.keys()));return e.append("g").attr("className","selection").style("fill","transparent"),e.append("g").attr("className","transient").style("fill","transparent"),e},t=>t.call(XT).call(ZT,Array.from(n.keys())));for(const[{key:i},{data:o}]of n.entries())l.select("#"+i).selectAll(".element").data(o,t=>t.key).join(t=>t.append(t=>{var{shape:e,points:n}=t;return e(n,_(t,["shape","points"]),u,s)}).attr("className","element").each(function(t){var e=t["enterType"],{enterDelay:t,enterDuration:n,enterEasing:i}=_(t,["enterType"]);e(this,{delay:t,duration:n,easing:i},u,s)}),t=>t.each(function(t){var{shape:e,points:n}=t,e=e(n,_(t,["shape","points"]),u,s);{var i=this,r,o,n=(n=e)["attributes"];const a=new Set(["id","className"]);for([r,o]of Object.entries(n))a.has(r)||i.attr(r,o);return}}))})}function XT(t){t.style("x",t=>t.paddingLeft).style("y",t=>t.paddingTop).style("width",t=>t.innerWidth).style("height",t=>t.innerHeight)}function KT(t,e){e&&t.style("lineWidth",1).style("stroke","black")}function ZT(t,e){t.selectAll(".main").data(e.map(t=>t.key)).join(t=>t.append("g").attr("className","main").attr("id",t=>t).style("fill","transparent"),t=>t,t=>t.remove())}function $T(t,e,n,i,r){const[,o]=JE("shape",r),[a]=JE("animation",r),s=t["enterType"];r=o(i).props.defaultEnterAnimation;const{enter:u={}}=n,{type:l=r}=u;i=Array.isArray(s)?s.map(t=>a(Object.assign(Object.assign({},u),{type:t}))):e.reduce((t,e)=>(t[e]=a(Object.assign(Object.assign({},u),{type:l})),t),[]);return Object.assign(Object.assign({},t),{enterType:i})}function JT(t,e,n,i,r){const[o]=JE("shape",r),a=t["shape"];r=Array.isArray(a)?a.map(t=>o(Object.assign(Object.assign({},function(t){return"object"==typeof t?t:{type:t}}(t)),n))):e.reduce((t,e)=>(t[e]=o(Object.assign({type:i},n)),t),[]);return Object.assign(Object.assign({},t),{shape:r})}R.createLibrary=$E,R.render=function(t,e={},n){const{width:i=640,height:r=480}=t,o=function(t){t=O({},t);const e=new Map([[t,null]]),n=new Map([[null,-1]]),i=[t];for(;i.length;){const u=i.shift();void 0===u.key&&(o=e.get(u),r=n.get(u),o=null===o?"0":o.key+"-"+r,u.key=o);var r,o,{children:a=[]}=u;if(Array.isArray(a))for(let t=0;t<a.length;t++){var s=a[t];e.set(s,u),n.set(s,t),i.push(s)}}return t}(t),{canvas:a=Vy({width:i,height:r,container:document.createElement("div")}),library:s=$E()}=e,u=(e.canvas=a,e.library=s,Cm(a.document.documentElement));return requestAnimationFrame(()=>F(this,void 0,void 0,function*(){yield UT(Object.assign(Object.assign({},o),{width:i,height:r}),u,s),null!=n&&n()})),"string"==typeof(t=a.getConfig().container)?document.getElementById(t):t},Object.defineProperty(R,"__esModule",{value:!0})});
