{"markdown":"# Point\n\n主要用于绘制散点图等图。\n\n## 开始\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/basement_prod/6b4aa721-b039-49b9-99d8-540b3f87d339.json',\n    })\n    .encode('x', 'height')\n    .encode('y', 'weight')\n    .encode('color', 'gender');\n\n  return chart.render().node();\n})();\n```\n\n## 选项\n\n> style\n\n| 参数 | 说明                            | 类型     | 默认值 |\n| ---- | ------------------------------- | -------- | ------ |\n| r    | 半径，优先级比 `encode.size` 低 | `number` | -      |\n\n## 案例\n\n### 一维散点图\n\n```js\n(() => {\n  const chart = new G2.Chart({ height: 120 });\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/basement_prod/6b4aa721-b039-49b9-99d8-540b3f87d339.json',\n    })\n    .encode('x', 'height');\n\n  return chart.render().node();\n})();\n```\n\n### 数据标签\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value:\n        ' https://gw.alipayobjects.com/os/bmw-prod/474e51c8-b47b-4bb6-b3ed-87813a960df2.csv',\n    })\n    .scale('x', { nice: true, domainMax: 38 })\n    .scale('y', { nice: true })\n    .encode('x', 'mpg')\n    .encode('y', 'hp')\n    .encode('color', 'steelblue')\n    .label({\n      text: 'name',\n      stroke: '#fff',\n      textAnchor: 'start',\n      textBaseline: 'middle',\n      dx: 10,\n      position: 'left',\n      fontSize: 10,\n      lineWidth: 2,\n    });\n\n  return chart.render().node();\n})();\n```\n\n### 气泡图\n\nPoint 的 Size 通道的比例尺默认是 Sqrt 比例尺，是圆的半径。\n\n```js\n(() => {\n  const chart = new G2.Chart({\n    paddingLeft: 150,\n    paddingTop: 50,\n  });\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/2b48887c-56fb-437e-a91c-6f48e80e5a91.csv',\n      transform: [\n        {\n          type: 'filterBy',\n          fields: [['Entity', (d) => d !== 'All natural disasters']],\n        },\n      ],\n    })\n    .encode('x', 'Year')\n    .encode('y', 'Entity')\n    .encode('size', 'Deaths')\n    .encode('color', 'Entity')\n    .encode('shape', 'point')\n    .scale('size', { rangeMax: 35 })\n    .legend(false)\n    .style('stroke', 'black')\n    .style('opacity', 0.8)\n    .style('lineWidth', 1);\n\n  return chart.render().node();\n})();\n```\n\n### 对数气泡图\n\n当数据分布不均匀的时候可以使用 Log 比例尺。\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value: 'https://gw.alipayobjects.com/os/antvdemo/assets/data/bubble.json',\n    })\n    .encode('x', 'GDP')\n    .encode('y', 'LifeExpectancy')\n    .encode('size', 'Population')\n    .encode('color', 'continent')\n    .encode('shape', 'point')\n    .scale('size', { type: 'log', range: [4, 20] })\n    .style('fillOpacity', 0.3)\n    .style('lineWidth', 1);\n\n  return chart.render().node();\n})();\n```\n\n### 不同形状\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/bd73a175-4417-4749-8b88-bc04d955e899.csv',\n    })\n    .encode('x', 'x')\n    .encode('y', 'y')\n    .encode('shape', 'category')\n    .encode('color', 'category')\n    .scale('shape', { range: ['point', 'plus', 'diamond'] })\n    .style('r', 5);\n\n  return chart.render().node();\n})();\n```\n\n### 堆叠点图\n\n```js\n(() => {\n  const chart = new G2.Chart({ height: 360 });\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/88c601cd-c1ff-4c9b-90d5-740d0b710b7e.json',\n    })\n    .transform({ type: 'stackY' })\n    .encode('x', (d) => 2021 - d.birth)\n    .encode('y', (d) => (d.gender === 'M' ? 1 : -1))\n    .encode('color', 'gender')\n    .encode('shape', 'point')\n    .axis('x', { title: 'Age →', nice: true })\n    .axis('y', {\n      title: '← Women · Men →',\n      tickFormatter: Math.abs,\n    })\n    .legend('color', { title: 'Gender' });\n\n  chart.lineY().data([0]).style('stroke', 'black');\n\n  return chart.render().node();\n})();\n```\n\n### 扰动点图\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/2c813e2d-2276-40b9-a9af-cf0a0fb7e942.csv',\n    })\n    .transform({ type: 'sortX', by: 'x', reducer: (I, V) => +V[0] })\n    .transform({ type: 'jitterX' })\n    .encode('y', 'Horsepower')\n    .encode('x', 'Cylinders')\n    .encode('color', 'Cylinders')\n    .scale('x', { type: 'point' })\n    .scale('color', { type: 'ordinal' });\n\n  return chart.render().node();\n})();\n```\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart.coordinate({ type: 'polar' });\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/antvdemo/assets/data/diamond.json',\n    })\n    .transform({ type: 'jitter' })\n    .encode('x', 'clarity')\n    .encode('color', 'clarity')\n    .legend(false);\n\n  return chart.render().node();\n})();\n```\n\n### 线标注\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .point()\n    .data([\n      { x: 95, y: 95, z: 13.8, name: 'BE', country: 'Belgium' },\n      { x: 86.5, y: 102.9, z: 14.7, name: 'DE', country: 'Germany' },\n      { x: 80.8, y: 91.5, z: 15.8, name: 'FI', country: 'Finland' },\n      { x: 80.4, y: 102.5, z: 12, name: 'NL', country: 'Netherlands' },\n      { x: 80.3, y: 86.1, z: 11.8, name: 'SE', country: 'Sweden' },\n      { x: 78.4, y: 70.1, z: 16.6, name: 'ES', country: 'Spain' },\n      { x: 74.2, y: 68.5, z: 14.5, name: 'FR', country: 'France' },\n      { x: 73.5, y: 83.1, z: 10, name: 'NO', country: 'Norway' },\n      { x: 71, y: 93.2, z: 24.7, name: 'UK', country: 'United Kingdom' },\n      { x: 69.2, y: 57.6, z: 10.4, name: 'IT', country: 'Italy' },\n      { x: 68.6, y: 20, z: 16, name: 'RU', country: 'Russia' },\n      { x: 65.5, y: 126.4, z: 35.3, name: 'US', country: 'United States' },\n      { x: 65.4, y: 50.8, z: 28.5, name: 'HU', country: 'Hungary' },\n      { x: 63.4, y: 51.8, z: 15.4, name: 'PT', country: 'Portugal' },\n      { x: 64, y: 82.9, z: 31.3, name: 'NZ', country: 'New Zealand' },\n    ])\n    .encode('x', 'x')\n    .encode('y', 'y')\n    .encode('color', '#1890ff')\n    .encode('size', 'z')\n    .encode('shape', 'point')\n    .scale('x', { nice: true })\n    .scale('y', { nice: true, domainMax: 165, zero: true })\n    .scale('size', { range: [10, 40] })\n    .style('stroke', '#1890ff')\n    .style('fillOpacity', 0.3)\n    .label({\n      text: 'name',\n      position: 'inside',\n      fill: '#1890ff',\n      stroke: '#fff',\n    });\n\n  chart.lineY().data([50]).style('stroke', '#54545').label({\n    text: 'Safe sugar intake 50g/day',\n    position: 'right',\n    textBaseline: 'bottom',\n  });\n\n  chart.lineX().data([65]).style('stroke', '#54545').label({\n    text: 'Safe fat intake 65g/day',\n    position: 'top-left',\n    textBaseline: 'bottom',\n  });\n\n  return chart.render().node();\n})();\n```\n\n### 连接点图\n\n```js\n(() => {\n  const chart = new G2.Chart({\n    width: 800,\n    height: 1200,\n  });\n\n  const xy = (node) => node.encode('x', 'state').encode('y', 'population');\n\n  chart.coordinate({ type: 'transpose' });\n\n  chart.data({\n    type: 'fetch',\n    value:\n      'https://gw.alipayobjects.com/os/bmw-prod/b6f2ff26-b232-447d-a613-0df5e30104a0.csv',\n  });\n\n  chart\n    .link()\n    .axis('y', { tickFormatter: '.0%' })\n    .transform({ type: 'groupX', y: 'min', y1: 'max' })\n    .call(xy)\n    .style('stroke', '#000');\n\n  chart\n    .point()\n    .scale('color', { palette: 'spectral' })\n    .call(xy)\n    .encode('shape', 'point')\n    .encode('color', 'age');\n\n  return chart.render().node();\n})();\n```\n\n### 打包图\n\n```js\n(() => {\n  const width = 800;\n  const height = 800;\n  const padding = 0;\n  const layout = (data) => {\n    const root = d3.hierarchy(data);\n    root.count();\n    d3.pack().size([width, height]).padding(5)(root);\n    return root.descendants();\n  };\n\n  const chart = new G2.Chart({\n    padding,\n    width,\n    height,\n  });\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/bf0d3c4e-7369-4dfb-9e88-df5064223f18.json',\n      transform: [{ type: 'custom', callback: layout }],\n    })\n    .axis(false)\n    .legend(false)\n    .scale('x', { domain: [0, width] })\n    .scale('y', { domain: [0, height] })\n    .scale('size', { type: 'identity' })\n    .scale('color', {\n      domain: [0, 5],\n      range: ['hsl(152,80%,80%)', 'hsl(228,30%,40%)'],\n      interpolate: d3.interpolateHcl,\n    })\n    .encode('x', 'x')\n    .encode('y', 'y')\n    .encode('size', 'r')\n    .encode('color', 'depth')\n    .encode('shape', 'point');\n\n  return chart.render().node();\n})();\n```\n\n### 序列散点图\n\n```js\n(() => {\n  const chart = new G2.Chart({\n    width: 800,\n  });\n\n  chart\n    .point()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/56b6b137-e04e-4757-8af5-d75bafaef886.csv',\n    })\n    .encode('x', 'date')\n    .encode('y', 'value')\n    .encode('color', 'value')\n    .encode('shape', 'point')\n    .scale('color', {\n      type: 'sequential',\n      palette: 'rdBu',\n      offset: (t) => 1 - t,\n    })\n    .style('stroke', '#000')\n    .style('strokeOpacity', 0.2);\n\n  chart.lineY().data([0]).style('stroke', '#000').style('strokeOpacity', 0.2);\n\n  return chart.render().node();\n})();\n```\n\n## 依赖\n\n```js | dom \"pin: false\"\nd3 = (async () => {\n  const { hierarchy, pack } = await genji.require('d3-hierarchy');\n  const { interpolateHcl } = await genji.require('d3-interpolate');\n  return { hierarchy, pack, interpolateHcl };\n})();\n```\n"}