{"markdown":"# Interval\n\n常用于条形图、柱状图、饼图等。\n\n## 开始\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/fb9db6b7-23a5-4c23-bbef-c54a55fee580.csv',\n    })\n    .encode('x', 'letter')\n    .encode('y', 'frequency')\n    .encode('color', 'steelblue')\n    .axis('y', { tickFormatter: '.0%' });\n\n  return chart.render().node();\n})();\n```\n\n## 选项\n\n> style\n\n| 参数              | 说明                       | 类型     | 默认值 |\n| ----------------- | -------------------------- | -------- | ------ |\n| radius            | 圆角                       | `number` | `0`    |\n| radiusTopLeft     | 左上角圆角                 | `number` | `0`    |\n| radiusTopRight    | 右上角圆角                 | `number` | `0`    |\n| radiusBottomRight | 右下角圆角                 | `number` | `0`    |\n| radiusBottomLeft  | 左下角圆角                 | `number` | `0`    |\n| inset             | 扇形之间的间隔，单位为角度 | `number` | `0`    |\n\n## 案例\n\n### 柱状图\n\n竖直方向的条形图又被称为柱状图，并且常常用 **SortX** 进行排序。\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/fb9db6b7-23a5-4c23-bbef-c54a55fee580.csv',\n      format: 'csv',\n    })\n    .transform({ type: 'sortX' })\n    .encode('x', 'letter')\n    .encode('y', 'frequency')\n    .encode('color', 'steelblue')\n    .axis('y', { tickFormatter: '.0%' });\n\n  return chart.render().node();\n})();\n```\n\n### 水平条形图\n\n指定 `Transpose` 坐标系变换可以将一个竖直方向的条形图变成水平方向的条形图，同时可以通过 `label` 设置数据标签。\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart.coordinate({ type: 'transpose' });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/fb9db6b7-23a5-4c23-bbef-c54a55fee580.csv',\n      format: 'csv',\n    })\n    .transform({ type: 'sortX', reverse: true })\n    .encode('x', 'letter')\n    .encode('y', 'frequency')\n    .encode('color', 'steelblue')\n    .axis('y', { tickFormatter: '.0%' })\n    .label({\n      text: 'frequency',\n      textAnchor: (d) => (+d.frequency > 0.008 ? 'right' : 'start'),\n      fill: (d) => (+d.frequency > 0.008 ? '#fff' : '#000'),\n      dx: (d) => (+d.frequency > 0.008 ? '-5px' : '5px'),\n      formatter: '.1%',\n    });\n\n  return chart.render().node();\n})();\n```\n\n### 堆叠条形图\n\n条会根据 color 通道进行分组，当每一个 x 有多个条时，可以使用 **StackY** 转换堆叠条形图，防止重叠。\n\n```js\n(() => {\n  const chart = new G2.Chart({ width: 1000 });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/f129b517-158d-41a9-83a3-3294d639b39e.csv',\n      format: 'csv',\n    })\n    .transform({ type: 'stackY' })\n    .transform({ type: 'sortX', by: 'y', reverse: true })\n    .encode('x', 'state')\n    .encode('y', 'population')\n    .encode('color', 'age')\n    .axis('y', { tickFormatter: '~s' });\n\n  return chart.render().node();\n})();\n```\n\n### 重叠条形图\n\n如果不使用 **StackY**，当每一个 x 有多个条时，会形成堆叠条形图。\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/87b2ff47-2a33-4509-869c-dae4cdd81163.csv',\n      format: 'csv',\n      transform: [\n        {\n          type: 'filterBy',\n          fields: [['year', (d) => d === 2000]],\n        },\n      ],\n    })\n    .transform({ type: 'groupX', y: 'sum' })\n    .encode('x', 'age')\n    .encode('y', 'people')\n    .encode('color', 'sex')\n    .scale('color', { type: 'ordinal', range: ['#ca8861', '#675193'] })\n    .axis('y', { tickFormatter: '~s' })\n    .style('fillOpacity', 0.7);\n\n  return chart.render().node();\n})();\n```\n\n### 分组条形图\n\n除了可以通过 **StackY** 来防止重叠之外，有两种方式来绘制分组条形图：\n\n- 指定 **series** 通道。\n- 指定 **DodgeX** 转换。\n\n```js\n(() => {\n  const chart = new G2.Chart({ paddingLeft: 50 });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/f129b517-158d-41a9-83a3-3294d639b39e.csv',\n      format: 'csv',\n    })\n    .transform({ type: 'sortX', by: 'y', reverse: true, slice: 6 })\n    .transform({ type: 'dodgeX' })\n    .encode('x', 'state')\n    .encode('y', 'population')\n    .encode('color', 'age')\n    .axis('y', { tickFormatter: '~s' });\n\n  return chart.render().node();\n})();\n```\n\n### 发散条形图\n\n当条 y 方向的值为负数的时候，就可以绘制一个发散条形图。比如下面的人口金字塔。\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart.coordinate({ type: 'transpose' });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/87b2ff47-2a33-4509-869c-dae4cdd81163.csv',\n      transform: [\n        {\n          type: 'filterBy',\n          fields: [['year', (d) => d === 2000]],\n        },\n      ],\n    })\n    .encode('x', 'age')\n    .encode('y', (d) => (d.sex === 1 ? -d.people : d.people))\n    .encode('color', 'sex')\n    .scale('color', { type: 'ordinal', range: ['#ca8861', '#675193'] })\n    .axis('y', { tickFormatter: '~s' })\n    .scale('x', { range: [1, 0] });\n\n  return chart.render().node();\n})();\n```\n\n### 发散堆叠条形图\n\n除了普通的发散条形图，当每个 x 对应条的时候，也可以绘制发散堆叠条形图。这里需要注意的是，小于零的 y 会反方向堆叠，从而保持视觉上和数据本来的顺序一致。\n\n```js\n(() => {\n  const chart = new G2.Chart({\n    paddingLeft: 80,\n  });\n  const types = [\n    'Strongly disagree',\n    'Disagree',\n    'Neither agree nor disagree',\n    'Agree',\n    'Strongly agree',\n  ];\n  const colors = ['#c30d24', '#f3a583', '#cccccc', '#94c6da', '#1770ab'];\n\n  chart.coordinate({ type: 'transpose' });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/82c97016-0f99-433b-ab21-9ecf14244610.csv',\n    })\n    .transform({ type: 'stackY' })\n    .encode('x', 'question')\n    .encode('color', 'type')\n    .encode('y', (d) =>\n      d.type === 'Disagree' || d.type === 'Strongly disagree'\n        ? -d.percentage\n        : d.type === 'Neither agree nor disagree'\n        ? -d.percentage / 2\n        : +d.percentage,\n    )\n    .scale('y', { nice: true })\n    .scale('color', { domain: types, range: colors });\n\n  return chart.render().node();\n})();\n```\n\n### 聚合条形图\n\n可以通过 **GroupX** 来实现聚合条形图。\n\n```js\n(() => {\n  const chart = new G2.Chart({ paddingLeft: 60 });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/antvdemo/assets/data/diamond.json',\n    })\n    .transform({\n      type: 'groupX',\n      y: 'max',\n    })\n    .encode('x', 'clarity')\n    .encode('y', 'price')\n    .encode('color', 'clarity')\n    .axis('y', { tickFormatter: '~s' });\n\n  return chart.render().node();\n})();\n```\n\n### 堆叠聚合条形图\n\n当聚合的条在 x 方向重叠的时候，同样可以使用 **StackY** 来防止重叠。\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/3ed6f372-5362-4861-a33b-a16a9efbc922.csv',\n    })\n    .transform({ type: 'groupX', y: 'count' })\n    .transform({ type: 'stackY', reverse: true, orderBy: 'series' })\n    .encode('x', (d) => new Date(d.date).getMonth())\n    .encode('color', 'weather')\n    .scale('color', {\n      domain: ['sun', 'fog', 'drizzle', 'rain', 'snow'],\n      range: ['#e7ba52', '#c7c7c7', '#aec7e8', '#1f77b4', '#9467bd'],\n    });\n\n  return chart.render().node();\n})();\n```\n\n### 归一化堆叠条形图\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart.coordinate({ type: 'transpose' });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/87b2ff47-2a33-4509-869c-dae4cdd81163.csv',\n      transform: [\n        {\n          type: 'filterBy',\n          fields: [['year', (d) => d === 2000]],\n        },\n      ],\n    })\n    .transform({ type: 'groupX', y: 'sum' })\n    .transform({ type: 'stackY' })\n    .transform({ type: 'normalizeY' })\n    .encode('x', 'age')\n    .encode('y', 'people')\n    .encode('color', 'sex')\n    .scale('color', { type: 'ordinal', range: ['#ca8861', '#675193'] })\n    .axis('y', { tickFormatter: '.0%' })\n    .label({ text: 'people', position: 'inside', fill: 'white' });\n\n  return chart.render().node();\n})();\n```\n\n### 弹性条形图\n\n可以通过 **FlexX** 转化来实现不等宽条形图。\n\n```js\n(() => {\n  const chart = new G2.Chart({\n    width: 1000,\n    paddingBottom: 100,\n  });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/90873879-09d7-4842-a493-03fb560267bc.csv',\n    })\n    .transform({ type: 'flexX', field: 'gdp' })\n    .encode('x', 'country')\n    .encode('y', 'value')\n    .encode('color', 'country')\n    .axis('y', { tickFormatter: '~s' });\n\n  return chart.render().node();\n})();\n```\n\n### 不等宽条形图\n\n```js\n(() => {\n  const chart = new G2.Chart({\n    width: 1000,\n    paddingBottom: 100,\n  });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/90873879-09d7-4842-a493-03fb560267bc.csv',\n    })\n    .encode('x', 'country')\n    .encode('y', 'value')\n    .encode('color', 'country')\n    .encode('size', 'gdp')\n    .scale('size', { range: [10, 60] })\n    .axis('y', { tickFormatter: '~s' });\n\n  return chart.render().node();\n})();\n```\n\n### 马赛克图\n\n```js\n(() => {\n  const chart = new G2.Chart({\n    width: 900,\n    height: 800,\n    paddingLeft: 0,\n    paddingRight: 0,\n  });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/3041da62-1bf4-4849-aac3-01a387544bf4.csv',\n    })\n    .transform({ type: 'flexX', reducer: 'sum' })\n    .transform({ type: 'stackY' })\n    .transform({ type: 'normalizeY' })\n    .encode('x', 'market')\n    .encode('y', 'value')\n    .encode('color', 'segment')\n    .axis('y', false)\n    .scale('x', { paddingOuter: 0, paddingInner: 0.01 })\n    .label({\n      text: 'segment',\n      x: 5,\n      y: 5,\n      textAnchor: 'start',\n      textBaseline: 'top',\n      fontSize: 10,\n      fill: '#fff',\n    })\n    .label({\n      text: 'value',\n      x: 5,\n      y: 5,\n      textAnchor: 'start',\n      dy: '1.5em',\n      fontSize: 10,\n      fill: '#fff',\n    });\n\n  return chart.render().node();\n})();\n```\n\n### 区间条形图\n\n可以指定 y 通道为一个数组通道来绘制区间条形图。\n\n```js\n(() => {\n  const chart = new G2.Chart({\n    paddingLeft: 60,\n  });\n\n  chart\n    .interval()\n    .data([\n      { month: 'Jan.', profit: 387264, start: 0, end: 387264 },\n      { month: 'Feb.', profit: 772096, start: 387264, end: 1159360 },\n      { month: 'Mar.', profit: 638075, start: 1159360, end: 1797435 },\n      { month: 'Apr.', profit: -211386, start: 1797435, end: 1586049 },\n      { month: 'May', profit: -138135, start: 1586049, end: 1447914 },\n      { month: 'Jun', profit: -267238, start: 1447914, end: 1180676 },\n      { month: 'Jul.', profit: 431406, start: 1180676, end: 1612082 },\n      { month: 'Aug.', profit: 363018, start: 1612082, end: 1975100 },\n      { month: 'Sep.', profit: -224638, start: 1975100, end: 1750462 },\n      { month: 'Oct.', profit: -299867, start: 1750462, end: 1450595 },\n      { month: 'Nov.', profit: 607365, start: 1450595, end: 2057960 },\n      { month: 'Dec.', profit: 1106986, start: 2057960, end: 3164946 },\n      { month: 'Total', start: 0, end: 3164946 },\n    ])\n    .encode('x', 'month')\n    .encode('y', ['end', 'start'])\n    .encode('color', (d) =>\n      d.month === 'Total' ? 'Total' : d.profit > 0 ? 'Increase' : 'Decrease',\n    )\n    .axis('y', { tickFormatter: '~s' });\n\n  return chart.render().node();\n})();\n```\n\n### 固定宽度的圆角条形图\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart\n    .interval()\n    .data([\n      { name: 'MODIFY', value: 138, washaway: 0.21014492753623193 },\n      { name: 'PRERELEASE', value: 109, washaway: 0.5596330275229358 },\n      { name: 'RELEASING', value: 48, washaway: 0 },\n    ])\n    .encode('x', 'name')\n    .encode('y', 'value')\n    .encode('color', 'name')\n    .encode('size', 80)\n    .style('radiusTopLeft', 10)\n    .style('radiusTopRight', 20)\n    .style('radiusBottomRight', 30)\n    .style('radiusBottomLeft', 40);\n\n  return chart.render().node();\n})();\n```\n\n### 饼图\n\n```js\n(() => {\n  const chart = new G2.Chart({ height: 640 });\n\n  chart.coordinate({ type: 'theta' });\n\n  chart\n    .interval()\n    .transform({ type: 'stackY' })\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/79fd9317-d2af-4bc4-90fa-9d07357398fd.csv',\n    })\n    .encode('y', 'value')\n    .encode('color', 'name')\n    .style('stroke', 'white')\n    .scale('color', {\n      palette: 'spectral',\n      offset: (t) => t * 0.8 + 0.1,\n    })\n    .legend(false)\n    .label({ text: 'name', radius: 0.8, fontSize: 10, fontWeight: 'bold' })\n    .label({\n      text: (d, i, data) => (i < data.length - 3 ? d.value : ''),\n      radius: 0.8,\n      fontSize: 9,\n      dy: '0.75em',\n    });\n\n  return chart.render().node();\n})();\n```\n\n### 甜甜圈图\n\n```js\n(() => {\n  const chart = new G2.Chart({ height: 640 });\n\n  chart.coordinate({ type: 'theta', innerRadius: 0.6 });\n\n  chart\n    .interval()\n    .transform({ type: 'stackY' })\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/79fd9317-d2af-4bc4-90fa-9d07357398fd.csv',\n    })\n    .encode('y', 'value')\n    .encode('color', 'name')\n    .style('stroke', 'white')\n    .style('inset', 1)\n    .style('radius', 10)\n    .scale('color', {\n      palette: 'spectral',\n      offset: (t) => t * 0.8 + 0.1,\n    })\n    .legend(false)\n    .label({ text: 'name', fontSize: 10, fontWeight: 'bold' })\n    .label({\n      text: (d, i, data) => (i < data.length - 3 ? d.value : ''),\n      fontSize: 9,\n      dy: '0.75em',\n    });\n\n  return chart.render().node();\n})();\n```\n\n### 玫瑰图\n\n```js\n(() => {\n  const chart = new G2.Chart({ width: 720, height: 720 });\n\n  chart.coordinate({ type: 'polar' });\n\n  chart\n    .interval()\n    .transform({ type: 'groupX', y: 'sum' })\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/87b2ff47-2a33-4509-869c-dae4cdd81163.csv',\n    })\n    .encode('x', 'year')\n    .encode('y', 'people')\n    .scale('y', { type: 'sqrt' })\n    .axis('y', {\n      tickFormatter: '~s',\n      tickCount: 5,\n      tickFilter: (d, i) => i !== 0,\n      direction: 'right',\n    });\n\n  return chart.render().node();\n})();\n```\n\n### 堆叠玫瑰图\n\n```js\n(() => {\n  const chart = new G2.Chart({\n    width: 800,\n    height: 800,\n  });\n  const colors = [\n    '#98abc5',\n    '#8a89a6',\n    '#7b6888',\n    '#6b486b',\n    '#a05d56',\n    '#d0743c',\n    '#ff8c00',\n  ];\n\n  chart.coordinate({ type: 'polar', innerRadius: 0.4 });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/d582a447-2057-4a74-97ed-1d73a5459ea4.csv',\n      transform: [\n        {\n          type: 'fold',\n          fields: [\n            'Under 5 Years',\n            '5 to 13 Years',\n            '14 to 17 Years',\n            '18 to 24 Years',\n            '25 to 44 Years',\n            '45 to 64 Years',\n            '65 Years and Over',\n          ],\n          as: ['Age', 'Population'],\n        },\n      ],\n    })\n    .transform({ type: 'stackY' })\n    .encode('x', 'State')\n    .encode('y', 'Population')\n    .encode('color', 'Age')\n    .scale('color', {\n      range: colors,\n      guide: { position: 'center', title: null, dx: 64, dy: 54 },\n    })\n    .scale('y', {\n      type: 'sqrt',\n    })\n    .axis('y', {\n      tickFormatter: '~s',\n      tickFilter: (_, i) => i !== 0,\n      direction: 'center',\n    })\n    .axis('x', { position: 'bottom' });\n\n  return chart.render().node();\n})();\n```\n\n```js\n(() => {\n  const chart = new G2.Chart({\n    width: 800,\n    height: 800,\n  });\n  const colors = [\n    '#98abc5',\n    '#8a89a6',\n    '#7b6888',\n    '#6b486b',\n    '#a05d56',\n    '#d0743c',\n    '#ff8c00',\n  ];\n\n  chart.coordinate({ type: 'polar', innerRadius: 0.4 });\n\n  chart\n    .interval()\n    .data({\n      type: 'fetch',\n      value:\n        'https://gw.alipayobjects.com/os/bmw-prod/d582a447-2057-4a74-97ed-1d73a5459ea4.csv',\n      transform: [\n        {\n          type: 'fold',\n          fields: [\n            'Under 5 Years',\n            '5 to 13 Years',\n            '14 to 17 Years',\n            '18 to 24 Years',\n            '25 to 44 Years',\n            '45 to 64 Years',\n            '65 Years and Over',\n          ],\n          as: ['Age', 'Population'],\n        },\n      ],\n    })\n    .transform({ type: 'stackY' })\n    .transform({ type: 'sortX', reverse: true })\n    .encode('x', 'State')\n    .encode('y', 'Population')\n    .encode('color', 'Age')\n    .scale('color', {\n      range: colors,\n      guide: { position: 'center', title: null, dx: 64, dy: 54 },\n    })\n    .scale('y', {\n      type: 'sqrt',\n      formatter: '~s',\n      tickFilter: (_, i) => i !== 0,\n    })\n    .axis('x', { position: 'bottom' });\n\n  return chart.render().node();\n})();\n```\n\n### 玉钰图\n\n```js\n(() => {\n  const chart = new G2.Chart();\n\n  chart.coordinate({ type: 'radial', innerRadius: 0.1, endAngle: Math.PI });\n\n  chart\n    .interval()\n    .data([\n      { question: '问题 1', percent: 0.21 },\n      { question: '问题 2', percent: 0.4 },\n      { question: '问题 3', percent: 0.49 },\n      { question: '问题 4', percent: 0.52 },\n      { question: '问题 5', percent: 0.53 },\n      { question: '问题 6', percent: 0.84 },\n      { question: '问题 7', percent: 1.0 },\n      { question: '问题 8', percent: 1.2 },\n    ])\n    .encode('x', 'question')\n    .encode('y', 'percent')\n    .encode('color', 'percent')\n    .style('stroke', 'white')\n    .scale('color', {\n      range: '#BAE7FF-#1890FF-#0050B3',\n    })\n    .scale('y', { tickFilter: (d, i) => i !== 0 });\n\n  return chart.render().node();\n})();\n```\n"}